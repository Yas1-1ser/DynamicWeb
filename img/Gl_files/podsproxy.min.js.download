function _array_like_to_array(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _array_with_holes(e){if(Array.isArray(e))return e}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function asyncGeneratorStep(e,r,t,n,o,s,i){try{var a=e[s](i),u=a.value}catch(e){return void t(e)}a.done?r(u):Promise.resolve(u).then(n,o)}function _async_to_generator(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var s=e.apply(r,t);function i(e){asyncGeneratorStep(s,n,o,i,a,"next",e)}function a(e){asyncGeneratorStep(s,n,o,i,a,"throw",e)}i(void 0)}))}}function _class_call_check(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _create_class(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _define_property(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _instanceof(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](e):e instanceof r}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterable_to_array_limit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,s=[],i=!0,a=!1;try{for(t=t.call(e);!(i=(n=t.next()).done)&&(s.push(n.value),!r||s.length!==r);i=!0);}catch(e){a=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(a)throw o}}return s}}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){_define_property(e,r,t[r])}))}return e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _object_spread_props(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})),e}function _sliced_to_array(e,r){return _array_with_holes(e)||_iterable_to_array_limit(e,r)||_unsupported_iterable_to_array(e,r)||_non_iterable_rest()}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,r){if(e){if("string"==typeof e)return _array_like_to_array(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_array_like_to_array(e,r):void 0}}function _ts_generator(e,r){var t,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,n=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=r.call(e,i)}catch(e){s=[6,e],n=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.PodsProxy=r():e.PodsProxy=r()}(window,(function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=6)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(3);n.__exportStar(t(4),r),n.__exportStar(t(5),r)},function(e,r,t){"use strict";var n,o="object"==typeof Reflect?Reflect:null,s=o&&"function"==typeof o.apply?o.apply:function(e,r,t){return Function.prototype.apply.call(e,r,t)};n=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,r){return new Promise((function(t,n){function o(t){e.removeListener(r,s),n(t)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",o),t([].slice.call(arguments))}v(e,r,s,{once:!0}),"error"!==r&&function(e,r,t){"function"==typeof e.on&&v(e,"error",r,{once:!0})}(e,o)}))},a.EventEmitter=a,a.prototype.u=void 0,a.prototype.h=0,a.prototype._=void 0;var u=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+(void 0===e?"undefined":_type_of(e)))}function l(e){return void 0===e._?a.defaultMaxListeners:e._}function d(e,r,t,n){var o,s,i,a;if(c(t),void 0===(s=e.u)?(s=e.u=Object.create(null),e.h=0):(void 0!==s.newListener&&(e.emit("newListener",r,t.listener?t.listener:t),s=e.u),i=s[r]),void 0===i)i=s[r]=t,++e.h;else if("function"==typeof i?i=s[r]=n?[t,i]:[i,t]:n?i.unshift(t):i.push(t),(o=l(e))>0&&i.length>o&&!i.warned){i.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=r,u.count=i.length,a=u,console&&console.warn&&console.warn(a)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,r,t){var n={fired:!1,wrapFn:void 0,target:e,type:r,listener:t},o=f.bind(n);return o.listener=t,n.wrapFn=o,o}function y(e,r,t){var n=e.u;if(void 0===n)return[];var o=n[r];return void 0===o?[]:"function"==typeof o?t?[o.listener||o]:[o]:t?function(e){for(var r=new Array(e.length),t=0;t<r.length;++t)r[t]=e[t].listener||e[t];return r}(o):_(o,o.length)}function h(e){var r=this.u;if(void 0!==r){var t=r[e];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function _(e,r){for(var t=new Array(r),n=0;n<r;++n)t[n]=e[n];return t}function v(e,r,t,n){if("function"==typeof e.on)n.once?e.once(r,t):e.on(r,t);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+(void 0===e?"undefined":_type_of(e)));e.addEventListener(r,(function o(s){n.once&&e.removeEventListener(r,o),t(s)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),a.init=function(){void 0!==this.u&&this.u!==Object.getPrototypeOf(this).u||(this.u=Object.create(null),this.h=0),this._=this._||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var r=[],t=1;t<arguments.length;t++)r.push(arguments[t]);var n="error"===e,o=this.u;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var i;if(r.length>0&&(i=r[0]),_instanceof(i,Error))throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)s(u,this,r);else{var c=u.length,l=_(u,c);for(t=0;t<c;++t)s(l[t],this,r)}return!0},a.prototype.addListener=function(e,r){return d(this,e,r,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,r){return d(this,e,r,!0)},a.prototype.once=function(e,r){return c(r),this.on(e,p(this,e,r)),this},a.prototype.prependOnceListener=function(e,r){return c(r),this.prependListener(e,p(this,e,r)),this},a.prototype.removeListener=function(e,r){var t,n,o,s,i;if(c(r),void 0===(n=this.u))return this;if(void 0===(t=n[e]))return this;if(t===r||t.listener===r)0==--this.h?this.u=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,t.listener||r));else if("function"!=typeof t){for(o=-1,s=t.length-1;s>=0;s--)if(t[s]===r||t[s].listener===r){i=t[s].listener,o=s;break}if(o<0)return this;0===o?t.shift():function(e,r){for(;r+1<e.length;r++)e[r]=e[r+1];e.pop()}(t,o),1===t.length&&(n[e]=t[0]),void 0!==n.removeListener&&this.emit("removeListener",e,i||r)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var r,t,n;if(void 0===(t=this.u))return this;if(void 0===t.removeListener)return 0===arguments.length?(this.u=Object.create(null),this.h=0):void 0!==t[e]&&(0==--this.h?this.u=Object.create(null):delete t[e]),this;if(0===arguments.length){var o,s=Object.keys(t);for(n=0;n<s.length;++n)"removeListener"!==(o=s[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this.u=Object.create(null),this.h=0,this}if("function"==typeof(r=t[e]))this.removeListener(e,r);else if(void 0!==r)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this},a.prototype.listeners=function(e){return y(this,e,!0)},a.prototype.rawListeners=function(e){return y(this,e,!1)},a.listenerCount=function(e,r){return"function"==typeof e.listenerCount?e.listenerCount(r):h.call(e,r)},a.prototype.listenerCount=h,a.prototype.eventNames=function(){return this.h>0?n(this.u):[]}},,function(e,r,t){"use strict";t.r(r),t.d(r,"__extends",(function(){return o})),t.d(r,"__assign",(function(){return s})),t.d(r,"__rest",(function(){return i})),t.d(r,"__decorate",(function(){return a})),t.d(r,"__param",(function(){return u})),t.d(r,"__esDecorate",(function(){return c})),t.d(r,"__runInitializers",(function(){return l})),t.d(r,"__propKey",(function(){return d})),t.d(r,"__setFunctionName",(function(){return f})),t.d(r,"__metadata",(function(){return p})),t.d(r,"__awaiter",(function(){return y})),t.d(r,"__generator",(function(){return h})),t.d(r,"__createBinding",(function(){return _})),t.d(r,"__exportStar",(function(){return v})),t.d(r,"__values",(function(){return m})),t.d(r,"__read",(function(){return g})),t.d(r,"__spread",(function(){return S})),t.d(r,"__spreadArrays",(function(){return I})),t.d(r,"__spreadArray",(function(){return w})),t.d(r,"__await",(function(){return b})),t.d(r,"__asyncGenerator",(function(){return C})),t.d(r,"__asyncDelegator",(function(){return P})),t.d(r,"__asyncValues",(function(){return E})),t.d(r,"__makeTemplateObject",(function(){return x})),t.d(r,"__importStar",(function(){return A})),t.d(r,"__importDefault",(function(){return T})),t.d(r,"__classPrivateFieldGet",(function(){return k})),t.d(r,"__classPrivateFieldSet",(function(){return M})),t.d(r,"__classPrivateFieldIn",(function(){return R})),t.d(r,"__addDisposableResource",(function(){return j})),t.d(r,"__disposeResources",(function(){return W}));var n=function(e,r){return(n=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])})(e,r)};function o(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var s=function(){return(s=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function i(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t}function a(e,r,t,n){var o,s=arguments.length,i=s<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,r,t,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(r,t,i):o(r,t))||i);return s>3&&i&&Object.defineProperty(r,t,i),i}function u(e,r){return function(t,n){r(t,n,e)}}function c(e,r,t,n,o,s){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,u=n.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!r&&e?n.static?e:e.prototype:null,d=r||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),f=!1,p=t.length-1;p>=0;p--){var y={};for(var h in n)y[h]="access"===h?{}:n[h];for(var h in n.access)y.access[h]=n.access[h];y.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");s.push(i(e||null))};var _=(0,t[p])("accessor"===u?{get:d.get,set:d.set}:d[c],y);if("accessor"===u){if(void 0===_)continue;if(null===_||"object"!=typeof _)throw new TypeError("Object expected");(a=i(_.get))&&(d.get=a),(a=i(_.set))&&(d.set=a),(a=i(_.init))&&o.unshift(a)}else(a=i(_))&&("field"===u?o.unshift(a):d[c]=a)}l&&Object.defineProperty(l,n.name,d),f=!0}function l(e,r,t){for(var n=arguments.length>2,o=0;o<r.length;o++)t=n?r[o].call(e,t):r[o].call(e);return n?t:void 0}function d(e){return"symbol"===(void 0===e?"undefined":_type_of(e))?e:"".concat(e)}function f(e,r,t){return"symbol"===(void 0===r?"undefined":_type_of(r))&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:t?"".concat(t," ",r):r})}function p(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)}function y(e,r,t,n){return new(t||(t=Promise))((function(o,s){function i(e){try{u(n.next(e))}catch(e){s(e)}}function a(e){try{u(n.throw(e))}catch(e){s(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,_instanceof(r,t)?r:new t((function(e){e(r)}))).then(i,a)}u((n=n.apply(e,r||[])).next())}))}function h(e,r){var t,n,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=r.call(e,i)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var _=Object.create?function(e,r,t,n){void 0===n&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&!("get"in o?!r.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]};function v(e,r){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||_(r,e,t)}function m(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,o,s=t.call(e),i=[];try{for(;(void 0===r||r-- >0)&&!(n=s.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(t=s.return)&&t.call(s)}finally{if(o)throw o.error}}return i}function S(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(g(arguments[r]));return e}function I(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var s=arguments[r],i=0,a=s.length;i<a;i++,o++)n[o]=s[i];return n}function w(e,r,t){if(t||2===arguments.length)for(var n,o=0,s=r.length;o<s;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))}function b(e){return _instanceof(this,b)?(this.v=e,this):new b(e)}function C(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=t.apply(e,r||[]),s=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(r){return new Promise((function(t,n){s.push([e,r,t,n])>1||a(e,r)}))})}function a(e,r){try{_instanceof((t=o[e](r)).value,b)?Promise.resolve(t.value.v).then(u,c):l(s[0][2],t)}catch(e){l(s[0][3],e)}var t}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,r){e(r),s.shift(),s.length&&a(s[0][0],s[0][1])}}function P(e){var r,t;return r={},n("next"),n("throw",(function(e){throw e})),n("return"),r[Symbol.iterator]=function(){return this},r;function n(n,o){r[n]=e[n]?function(r){return(t=!t)?{value:b(e[n](r)),done:!1}:o?o(r):r}:o}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,t=e[Symbol.asyncIterator];return t?t.call(e):(e=m(e),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(t){r[t]=e[t]&&function(r){return new Promise((function(n,o){!function(e,r,t,n){Promise.resolve(n).then((function(r){e({value:r,done:t})}),r)}(n,o,(r=e[t](r)).done,r.value)}))}}}function x(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}var O=Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r};function A(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&_(r,e,t);return O(r,e),r}function T(e){return e&&e.__esModule?e:{default:e}}function k(e,r,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof r?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(e):n?n.value:r.get(e)}function M(e,r,t,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof r?e!==r||!o:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,t):o?o.value=t:r.set(e,t),t}function R(e,r){if(null===r||"object"!=typeof r&&"function"!=typeof r)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?r===e:e.has(r)}function j(e,r,t){if(null!=r){if("object"!=typeof r&&"function"!=typeof r)throw new TypeError("Object expected.");var n;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=r[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=r[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:r,dispose:n,async:t})}else t&&e.stack.push({async:!0});return r}var N="function"==typeof SuppressedError?SuppressedError:function(e,r,t){var n=new Error(t);return n.name="SuppressedError",n.error=e,n.suppressed=r,n};function W(e){function r(r){e.error=e.hasError?new N(r,e.error,"An error was suppressed during disposal."):r,e.hasError=!0}return function t(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(t,(function(e){return r(e),t()}))}catch(e){r(e)}}if(e.hasError)throw e.error}()}r.default={__extends:o,__assign:s,__rest:i,__decorate:a,__param:u,__metadata:p,__awaiter:y,__generator:h,__createBinding:_,__exportStar:v,__values:m,__read:g,__spread:S,__spreadArrays:I,__spreadArray:w,__await:b,__asyncGenerator:C,__asyncDelegator:P,__asyncValues:E,__makeTemplateObject:x,__importStar:A,__importDefault:T,__classPrivateFieldGet:k,__classPrivateFieldSet:M,__classPrivateFieldIn:R,__addDisposableResource:j,__disposeResources:W}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0})},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChangeGate=void 0;var n=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();r.ChangeGate=n},function(e,r,t){"use strict";var n,o;t.r(r),t.d(r,"exposed",(function(){return I})),t.d(r,"setupGlobals_PodsProxy",(function(){return w})),t.d(r,"PodsProxy",(function(){return b})),t.d(r,"PodsProxyRequestType",(function(){return n})),t.d(r,"PodsProxyRequestStageType",(function(){return o})),t.d(r,"PodsProxyConstants",(function(){return a})),t.d(r,"ClientColorSettings",(function(){return s})),t.d(r,"SlideImageAppendOption",(function(){return i})),t.d(r,"GetRequestItemIds",(function(){return l})),t.d(r,"ErrorCode",(function(){return u})),t.d(r,"ErrorCategory",(function(){return c})),t.d(r,"ItemType",(function(){return d})),function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(n||(n={})),function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(o||(o={}));var s,i,a=function e(){_class_call_check(this,e)};a.unknown="unknown",a.ErrorCode="ErrorCode",a.ErrorCategory="ErrorCategory",a.errorCategory="errorCategory",a.errorCode="errorCode",a.IsIntentional="IsIntentional",a.isIntentional="isIntentional",a.XCorrelationId="X-CorrelationId",a.ContentType="Content-Type",a.ContentLength="Content-Length",a.ContenEncoding="Content-Encoding",a.TransferEncoding="Transfer-Encoding",a.XusedOutputCache="X-usedOutputCache",a.Xnewsnapurl="x-newsnapurl",a.ContentDisposition="Content-Disposition",a.CallerCorrelationId="CallerCorrelationId",a.action="action",a.parser="parser",a.server="server",a.callId="callId",a.dateHeader="x-ms-date",a.clientTimeoutHeader="x-ms-client-timeout",a.clientRequestIdHeader="x-ms-client-request-id",a.newSnapUrlHeader="x-newsnapurl",a.correlationId="correlationId",a.firstResponseCheck="firstResponseCheck",a.fetchBoundary="fetchBoundary",a.downloadResponse="downloadResponse",a.parserCallback="parserCallback",a.createResponse="createResponse",a.contentLength="contentLength",a.usedOutputCache="usedOutputCache",a.itemUsedOutputCacheMap="itemUsedOutputCacheMap",a.podsProxyCallSuceeded="podsProxyCallSuceeded",a.PriorityHint="PriorityHint",a.RequestInfo="RequestInfo",a.ResponseHeaders="ResponseHeaders",a.IsBootRequest="IsBootRequest",a.XErrorCode="X-ErrorCode",function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(s||(s={})),function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(i||(i={}));var u,c,l=function e(){_class_call_check(this,e)};l.PresInfoMetaData="presinfo/metadata",l.PresinfoslimSlideOrder="presinfo/slimSlideOrder",l.slideInfoIndex="pres/sldIdx",l.slideInfoSid="pres/sldSid",l.slideNotesIndex="pres/NotesSldIdx",l.slideNotesSid="pres/NotesSldSid",l.slideCommentsIndex="pres/CommentsSldIdx",l.slideCommentsSid="pres/CommentsSldSid",l.slideMetadataIndex="pres/SlideMetadatasldIdx",l.slideMetadataSid="pres/SlideMetadataSldSid",l.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",l.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid",function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.ErrorRESERVEDItemFailed="ErrorRESERVEDItemFailed",e.ErrorDownloadResponseStreamTimeout="ErrorDownloadResponseStreamTimeout",e.ErrorRequestFailed="ErrorRequestFailed",e.ErrorRequestFailedServiceUnavailable="ErrorRequestFailedServiceUnavailable",e.ErrorRequestFailedBadGateway="ErrorRequestFailedBadGateway",e.ErrorRequestFailedGatewayTimeout="ErrorRequestFailedGatewayTimeout",e.ErrorRequestFailedServerNotFound="ErrorRequestFailedServerNotFound",e.ErrorContentDispositionHeaderNotValid="ErrorContentDispositionHeaderNotValid",e.ErrorItemNameNotValid="ErrorItemNameNotValid",e.ErrorResponseNotValid="ErrorResponseNotValid",e.ErrorCannotParseResponse="ErrorCannotParseResponse",e.ErrorRequestTimeout="ErrorRequestTimeout",e.ErrorFailedToFetch="ErrorFailedToFetch",e.ErrorRequestCanceled="ErrorRequestCanceled",e.ErrorRequestAbort="ErrorRequestAbort",e.ErrorConnectionLost="ErrorConnectionLost",e.ErrorSoftwareConnectionAbort="ErrorSoftwareConnectionAbort",e.ErrorFailedToDownloadFile="ErrorFailedToDownloadFile",e.ErrorFileDownloadNetworkError="ErrorFileDownloadNetworkError",e.ErrorFileDownloadResourceInconsistent="ErrorFileDownloadResourceInconsistent",e.ErrorResourceInconsistentResnaptimeout="ErrorResourceInconsistentResnaptimeout",e.ErrorResourceInconsistentResnapNotStarted="ErrorResourceInconsistentResnapNotStarted",e.ErrorResourceInconsistentResnapUrlMissing="ErrorResourceInconsistentResnapUrlMissing",e.ServerErrorFileDownloadResourceInconsistent="ServerErrorFileDownloadResourceInconsistent",e.ServerErrorResourceInconsistentResnaptimeout="ServerErrorResourceInconsistentResnaptimeout",e.ServerErrorResourceInconsistentResnapNotStarted="ServerErrorResourceInconsistentResnapNotStarted",e.ServerErrorResourceInconsistentResnapUrlMissing="ServerErrorResourceInconsistentResnapUrlMissing"}(u||(u={})),function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.BadRequest="BadRequest",e.Fatal="Fatal",e.NotSupported="NotSupported",e.Transient="Transient"}(c||(c={}));var d=function e(){_class_call_check(this,e)};d.JsonType="application/json",d.ImagePng="image/png",d.ImageJpg="image/jpg",d.PlainTextType="text/plain";var f,p,y=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"processMultipartResponse",value:function(e,r,t){var n=this;return _async_to_generator((function(){var o,s;return _ts_generator(this,(function(i){if(null==e)throw"multipartContentBuffer is empty";try{o=new TextDecoder("utf-8").decode(e),n.parseMultipart(o,r).forEach((function(e){var r=n.parseResponsePart(e);t(r)}))}catch(e){s={Err:new Error(e)},t(s)}return[2]}))}))()}},{key:"fetchBoundary",value:function(e){var r=e.split("boundary=");if(2===r.length)return r[1];throw"No Boundary"}},{key:"processMultipartBinaryResponse",value:function(e,r,t){var n=this;return _async_to_generator((function(){var o,s,i,a,u,c,l,d,f,p,y,h,_,v,m,g,S,I,w,b,C,P,E,x,O;return _ts_generator(this,(function(A){switch(A.label){case 0:if(!e)throw"multipartContentBufferOrStream is empty";o="",s=void 0,i=0,a=[],u=null,l=_instanceof(e,Uint8Array),A.label=1;case 1:A.trys.push([1,7,,8]),A.label=2;case 2:return l?(c=e,[3,5]):[3,3];case 3:return[4,e.read()];case 4:if(d=A.sent(),f=d.done,p=d.value,f)return[3,6];c=p,A.label=5;case 5:y=!0,h=!1,_=void 0;try{for(v=c[Symbol.iterator]();!(y=(m=v.next()).done);y=!0)g=m.value,S=10===g||13===g,I=10===g&&13===u,w=10===u&&13===g,a.push(g),S||(o+=String.fromCharCode(g)),0===i&&I?"--".concat(r)===o&&(i=1,o="",a=[]):1===i&&w?(s=new Uint8Array(a),i=2,o="",a=[]):2===i&&I?(i=3,o="",a=[]):3===i&&(o.length>r.length+4&&(o=""),"--".concat(r)===o&&(b=a.length-o.length,C=a.slice(0,b-1),i=1,P=n.processHeader(s),E={Headers:P,Body:new Uint8Array(C)},t(E),o="",s=void 0,a=[]),I&&(o="")),u=g}catch(e){h=!0,_=e}finally{try{y||null==v.return||v.return()}finally{if(h)throw _}}return l?[3,6]:[3,2];case 6:return[3,8];case 7:return x=A.sent(),O={Err:new Error(x)},t(O),[3,8];case 8:return[2]}}))}))()}},{key:"parseMultipart",value:function(e,r){var t="--".concat(r);return e.split(t).map((function(e){return e.trim()})).filter((function(e){return""!==e&&"--"!==e}))}},{key:"parseResponsePart",value:function(e){var r=this.parseResponseHeaderFromPart(e).split("\n"),t=new Map;r.forEach((function(e){var r=e.split(": ");2===r.length&&t.set(r[0],r[1])}));var n=this.parseResponseBodyFromPart(e),o=(new TextEncoder).encode(n);return{Headers:t,Body:o}}},{key:"parseResponseBodyFromPart",value:function(e){var r=e.split("\n\r\n");if(2===r.length)return r[1];throw"No response Body"}},{key:"parseResponseHeaderFromPart",value:function(e){var r=e.split("\n\r\n");if(2===r.length)return r[0];throw"No response Headers"}},{key:"processHeader",value:function(e){var r=new Map;if(e){for(var t="",n=0;n<e.byteLength;n+=1)t+=String.fromCharCode(e[n]);t.split("\n").forEach((function(e){var t=e.split(": ");2===t.length&&r.set(t[0],t[1])}))}return r}}]),e}(),h=t(0),_=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"sendTraceTag",value:function(){}},{key:"shipAssertTag",value:function(){}},{key:"debugAssertTag",value:function(){}},{key:"setCorrelationId",value:function(){}}]),e}(),v=new(function(){function e(){_class_call_check(this,e),this.externalLogger=new _}return _create_class(e,[{key:"setCorrelationId",value:function(e){this.externalLogger.setCorrelationId(e)}},{key:"setLogger",value:function(e){this.externalLogger=e}},{key:"sendTraceTag",value:function(e,r,t,n){this.externalLogger.sendTraceTag(e,r,t,n)}},{key:"debugAssertTag",value:function(e,r,t,n){this.externalLogger.debugAssertTag(e,r,t,n)}},{key:"shipAssertTag",value:function(e,r,t,n){this.externalLogger.shipAssertTag(e,r,t,n)}}]),e}());!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry"}(f||(f={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(p||(p={}));var m=t(1),g=function(){function e(r,t,n,o){_class_call_check(this,e),this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=r,this.m_responses=t,this.m_perfDictionary=n,this.m_parsedBasedResponse=o}return _create_class(e,[{key:"parsePart",value:function(r){if(r&&r.Headers){this.m_perfDictionary[a.parserCallback]?(this.m_perfDictionary[a.parserCallback].callCounter=this.m_perfDictionary[a.parserCallback].callCounter+1,this.m_perfDictionary[a.parserCallback].lastCallStart=b.performanceNowTrimmed()):this.m_perfDictionary[a.parserCallback]={lastCallStart:b.performanceNowTrimmed(),lastCallEnd:b.performanceNowTrimmed(),callCounter:0,slidesHaveImages:[],slidesHaveImageResources:[]};var t=r.Headers.get(a.ContentDisposition),n=r.Headers.get(a.ContentType);this.m_parsedBasedResponse.usedOutputCache=r.Headers.get(a.XusedOutputCache),this.m_parsedBasedResponse.newSnapUrl=r.Headers.get(a.Xnewsnapurl);var o=r.Headers.get(a.ErrorCode)||u.ErrorRESERVEDSuccess,s=r.Headers.get(a.ErrorCategory)||c.ErrorRESERVEDSuccess,i=r.Headers.get(a.XusedOutputCache);if(t){var l,d=t.indexOf("pres%2fSlideMetadatasldIdx")>0;try{l=decodeURIComponent(t.substring(t.indexOf("name=")+5).trim())}catch(e){v.sendTraceTag(595641600,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(e))}if(l){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(l,o),this.m_parsedBasedResponse.itemErrorCategoryMap.set(l,s),i&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(l,i),o&&o.trim().toLowerCase()===u.ErrorRESERVEDSuccess.toLowerCase())if(t.indexOf("presinfo%2fslimSlideOrder")>0){var y=JSON.parse(new TextDecoder("utf-8").decode(r.Body)),_=!0,m=!1,g=void 0;try{for(var S,I=y[Symbol.iterator]();!(_=(S=I.next()).done);_=!0){var w=S.value;this.parsedResponse.slideOrder.push({sid:w,cid:0})}}catch(e){m=!0,g=e}finally{try{_||null==I.return||I.return()}finally{if(m)throw g}}}else if(t.indexOf("presinfo%2fmetadata")>0){var C=JSON.parse(new TextDecoder("utf-8").decode(r.Body)),P=[],E=!0,x=!1,O=void 0;try{for(var A,T=C.SidSlideOrder[Symbol.iterator]();!(E=(A=T.next()).done);E=!0){var k=A.value;P.push({sid:k,cid:0})}}catch(e){x=!0,O=e}finally{try{E||null==T.return||T.return()}finally{if(x)throw O}}var M=C.SidHiddenSlides?C.SidHiddenSlides.map((function(e){return{sid:e,cid:0}})):h.ChangeGate.isChangeGateEnabled("FixHiddenOrderIfNotPresentInResponse")?void 0:[],R={Item:null};C.SlideShowProperties.Item||(R={Item:null}),C.SlideShowProperties.Item.s?R={Item:{sid:C.SlideShowProperties.Item.s}}:C.SlideShowProperties.Item.st&&(R={Item:{start:C.SlideShowProperties.Item.st,end:C.SlideShowProperties.Item.end}});var j={SlideOrder:P,HiddenSlideOrder:M,SlideEmuWidth:C.SlideEmuWidth,SlideEmuHeight:C.SlideEmuHeight,ViewScalingFactor:C.ViewScalingFactor,SlideShowProperties:R,Sections:C.Sections};this.parsedResponse.slideAllInfo.push(j)}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&n&&e.getSupportedImageType(n)){for(var N=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),W="",F=0;F<r.Body.length;F+=1)W+=String.fromCharCode(r.Body[F]);var D="data:".concat(e.getSupportedImageType(n),";base64, ").concat(btoa(W));this.m_perfDictionary[a.parserCallback].slidesHaveImages.push(N),this.m_responses[N]||(this.m_responses[N]={ID:{sid:N,cid:0}}),this.m_responses[N].SlideImageData=D}else if((t.indexOf("pres%2fsldSid")>0||t.indexOf("pres%2fsldIdx")>0)&&n&&-1!==n.indexOf("application/json")){var U=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),L=JSON.parse(new TextDecoder("utf-8").decode(r.Body));h.ChangeGate.isChangeGateEnabled("PodsProxy.getItemsMediaResourceMapping")&&L.mediaUrls?(this.m_responses[U]||(this.m_responses[U]={ID:{sid:L.slideShowInfo.sld[0].id,cid:0}}),this.m_responses[U].SlideShowInfo=L.slideShowInfo,this.m_responses[U].MediaUrls=L.mediaUrls):(this.m_responses[U]||(this.m_responses[U]={ID:{sid:L.sld[0].id,cid:0}}),this.m_responses[U].SlideShowInfo=L)}else if(t.indexOf("pres%2fNotesSldSid")>0||t.indexOf("pres%2fNotesSldIdx")>0){var H=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),J=new TextDecoder("utf-8").decode(r.Body);this.m_responses[H]||(this.m_responses[H]={ID:{sid:H,cid:0}}),this.m_responses[H].NoteHtml=J}else if(t.indexOf("pres%2fCommentsSldSid")>0||t.indexOf("pres%2fCommentsSldIdx")>0){var q=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),B=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[q]||(this.m_responses[q]={ID:{sid:q,cid:0}}),this.m_responses[q].Comments=B}else if(t.indexOf("pres%2fSlideMetadataSldSid")>0||d){var G=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),z=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[G]||(this.m_responses[G]={ID:z.ID}),this.m_responses[G].Title=z.Title,this.m_responses[G].HasAnimation=z.HasAnimation,this.m_responses[G].Hidden=z.Hidden,this.m_responses[G].HasTransition=z.HasTransition}else if(t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||t.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){var V=e.getSlideKeyFromHeader(t,t.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),K=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[V]||(this.m_responses[V]={ID:K.ID}),this.m_responses[V].AccessibilityModel=K.AccessibilityModel}else if(t.indexOf("Res%2fSldSid")>0&&n&&e.getSupportedImageType(n)){var X=e.extractStringInBetweenStrings(t,"Res%2fSldSid","%2f"),$=e.extractStringInBetweenStrings(t,"filename=","\r");if(X&&$){var Y,Q,Z={sid:+X,cid:0},ee=e.getSupportedImageType(n);if(r.Body)if(this.m_settings.allowImagesAsBinary)Y={Id:$,Base64:"",Binary:r.Body,MimeType:ee,ByteCount:r.Body.length};else{for(var re="",te=0;te<r.Body.length;te+=1)re+=String.fromCharCode(r.Body[te]);var ne="data:".concat(ee,";base64,").concat(btoa(re));Y={Id:$,Base64:ne,MimeType:ee,ByteCount:ne.length}}else v.sendTraceTag(508420494,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - Body is undefined. slideId:".concat(X,", resourceId:").concat($)),Y={Id:$,Base64:"",MimeType:ee,ByteCount:0};this.m_perfDictionary[a.parserCallback].slidesHaveImageResources.push(Z.sid);var oe=!0,se=!1,ie=void 0;try{for(var ae,ue=Object.entries(this.m_responses)[Symbol.iterator]();!(oe=(ae=ue.next()).done);oe=!0){var ce=_sliced_to_array(ae.value,2)[1];ce.ID&&ce.ID.sid===Z.sid&&(Q=ce)}}catch(e){se=!0,ie=e}finally{try{oe||null==ue.return||ue.return()}finally{if(se)throw ie}}Q?Q.ResourceData?Q.ResourceData.push(Y):Q.ResourceData=[Y]:this.m_responses[Z.sid]={ID:Z,ResourceData:[Y]}}else v.sendTraceTag(595628568,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:".concat(X,", resourceId:").concat($)),this.m_parsedBasedResponse.responseErrorCode=u.ErrorResponseNotValid}}else this.m_parsedBasedResponse.responseErrorCode=u.ErrorItemNameNotValid}else r.Headers.get("x-ms-content-id")&&(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(r.Headers.get("x-ms-content-id"),o),this.m_parsedBasedResponse.itemErrorCategoryMap.set(r.Headers.get("x-ms-content-id"),s)),this.m_parsedBasedResponse.responseErrorCode=u.ErrorContentDispositionHeaderNotValid;this.m_perfDictionary[a.parserCallback].lastCallEnd=b.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode=u.ErrorResponseNotValid;r.Err&&(this.m_parsedBasedResponse.responseErrorCode=u.ErrorResponseNotValid,v.sendTraceTag(595687003,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(r.Err)))}}],[{key:"getSupportedImageType",value:function(e){return b.s_supportedImageType.find((function(r){return-1!==e.indexOf(r)}))||""}},{key:"getSlideKeyFromHeader",value:function(e,r){var t=new RegExp(".*".concat(r,"(.*)"));if(!e)return v.sendTraceTag(508420493,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;var n=t.exec(e);return null!=n&&n.length>=2?+n[1]:(v.sendTraceTag(508420492,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::getSlideLocationFromHeader - regex result is null header:".concat(e,", itemId: ").concat(r)),-1)}},{key:"extractStringInBetweenStrings",value:function(e,r,t){var n=e.indexOf(r)+r.length,o=t?e.indexOf(t,n):-1;return-1===o?e.substring(n):e.substring(n,o)}}]),e}(),S=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"load",value:function(r){for(var t in r)e.m_settings[t]=r[t]}},{key:"readBooleanOrDefault",value:function(r,t){var n=void 0===e.m_settings?"":_type_of(e.m_settings[r]);return"string"===n?"true"===e.m_settings[r].toLowerCase():"boolean"===n?e.m_settings[r]:t}},{key:"readNumberOrDefault",value:function(r,t){var n=void 0===e.m_settings?"":_type_of(e.m_settings[r]);return"string"===n||"number"===n?Number(e.m_settings[r]):t}},{key:"readStringOrDefault",value:function(r,t){return void 0===e.m_settings||"string"!=typeof e.m_settings[r]?t:e.m_settings[r]}},{key:"addOrUpdateSettingsFromUrl",value:function(r,t){var n=t.get("wdset");if(!n)return r;var o=!0,s=!1,i=void 0;try{for(var a,u=n.split(",")[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value.split(":"),l=c[0].split("."),d=l[0],f=l[1],p=c[1];f&&p&&e.addOrUpdateSetting(r,d,f,p)}}catch(e){s=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw i}}return r}},{key:"addOrUpdateSetting",value:function(e,r,t,n){"__proto__"!==r&&(e[r]||(e[r]={}),e[r][t]=n)}}]),e}();S.m_settings={};var I={};function w(e){e.logger&&v.setLogger(e.logger),e.settings&&S.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&h.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=I)}var b=function(){function e(r,t,n,o,s,i,a){var u=this;if(_class_call_check(this,e),this.events=new m.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new y,v.setLogger(o),v.sendTraceTag(508420489,f.msoulscat_Wac_PptSession,r&&t&&t.DownloadUrl&&n&&t.DocID?p.Info:p.Warning,"PodsProxy::constructor - podsUrl:".concat(r,", fileExtension:").concat(n,", docId:").concat(t.DocID,"}")),v.sendTraceTag(508420488,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::constructor - presentUrl:".concat(s,"}")),this.m_podsUrl=r,this.m_presentUrl=s,this.m_downloadUrl=t.DownloadUrl,this.m_settings=a||{timeout:3e4,throwHttpErrors:!0},h.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),this.m_wacFallbackDownloadUrl=a?a.wacFallbackDownloadUrl:void 0,i&&i.forEach((function(e,r){u.m_requestHeaders.append(r,e)})),this.m_getPresInfoRequest={Source:t,FileExtension:n||"pptx"},this.m_getItemsRequest={Source:t,FileExtension:n||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0,LocaleName:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),a&&a.perfTimingMonitorEnabled)try{var c=new Set;this.m_presentUrl&&h.ChangeGate.isChangeGateEnabled("PodsProxy.logPFDPerfTiming")&&(c.add("".concat(this.m_presentUrl,"/items")),c.add("".concat(this.m_presentUrl,"/ping"))),c.add("getitems.ashx"),c.add("getmedia.ashx"),c.add("remoteuls.ashx"),c.add("podhandler.ashx"),c.add("remotetelemetry.ashx"),new PerformanceObserver((function(r){return e.logPerformanceEntries(r,c)})).observe({entryTypes:["resource"]})}catch(e){v.sendTraceTag(508420487,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:PerformanceObserver failed with exception ".concat(e))}}return _create_class(e,[{key:"getSlideOrderAsync",value:function(){var e=this;return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return[4,e.getPresInfoAsync("getSlideOrderAsync")];case 1:return[4,t.sent().json()];case 2:return r=t.sent(),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:u.ErrorRESERVEDSuccess,responseErrorCategory:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:r.SlideOrder}]}}))}))()}},{key:"getSlideInfosAsync",value:function(e){var r=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(n){switch(n.label){case 0:return e.RenderOptions&&(r.m_getPresInfoRequest.SlideRanges=[{IDs:e.SlideLocations.map((function(e){return e.slideId})),RenderOptions:e.RenderOptions}]),r.m_getPresInfoRequest.ClientWidth=e.ClientWidth?e.ClientWidth:r.m_getPresInfoRequest.ClientWidth,r.m_getPresInfoRequest.ClientHeight=e.ClientHeight?e.ClientHeight:r.m_getPresInfoRequest.ClientHeight,r.m_getPresInfoRequest.DevicePixelRatio=e.DevicePixelRatio?e.DevicePixelRatio:r.m_getPresInfoRequest.DevicePixelRatio,r.m_getPresInfoRequest.IsHighContrast=e.IsHighContrast?e.IsHighContrast:r.m_getPresInfoRequest.IsHighContrast,r.m_getPresInfoRequest.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:r.m_getPresInfoRequest.ClientColorSettings,r.m_getPresInfoRequest.MinClientWidth=e.MinClientWidth?e.MinClientWidth:r.m_getPresInfoRequest.MinClientWidth,r.m_getPresInfoRequest.MinClientHeight=e.MinClientHeight?e.MinClientHeight:r.m_getPresInfoRequest.MinClientHeight,r.m_getPresInfoRequest.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:r.m_getPresInfoRequest.MaxClientWidth,r.m_getPresInfoRequest.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:r.m_getPresInfoRequest.MaxClientHeight,[4,r.getPresInfoAsync("getSlideInfosAsync")];case 1:return[4,n.sent().json()];case 2:return t=n.sent(),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:u.ErrorRESERVEDSuccess,responseErrorCategory:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:t.Slides}]}}))}))()}},{key:"getItemsSlideOrderAsync",value:function(){var e=this;return _async_to_generator((function(){var r,t;return _ts_generator(this,(function(n){switch(n.label){case 0:return e.m_itemsList=new Array,e.m_itemsList.push({Id:l.PresinfoslimSlideOrder,AcceptTypes:[d.JsonType]}),e.m_getItemsRequest.Items=e.m_itemsList,[4,e.getItemsAsync("getItemsSlideOrderAsync")];case 1:return r=n.sent(),t={},[4,e.createSlideIdResponse(e.parseMultipartResponseAsync(r,t))];case 2:return[2,n.sent()]}}))}))()}},{key:"getItemsPresInfoAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,s,i,u,c;return _ts_generator(this,(function(f){switch(f.label){case 0:return t.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:t.m_presInfoInputProperties.ClientHeight,t.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:t.m_presInfoInputProperties.ClientWidth,t.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:t.m_presInfoInputProperties.IsHighContrast,t.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:t.m_presInfoInputProperties.ClientColorSettings,t.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:t.m_presInfoFilters.FilterHiddenSlideInfo,t.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:t.m_presInfoFilters.IncludeSections,t.m_itemsList=new Array,t.m_itemsList.push({Id:l.PresInfoMetaData,AcceptTypes:[d.JsonType],Options:JSON.stringify(t.m_presInfoOptions)}),t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(a.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(a.XCorrelationId,r.CorrelationId||""),n=_object_spread_props(_object_spread({},r.RequestInfo,t.m_settings.sessionInfo),{CorrelationId:r.CorrelationId}),t.m_requestHeaders.set(a.RequestInfo,JSON.stringify(n)),o=t.objectDictionaryToRequestIdString(n),t.m_requestHeaders.set(a.clientRequestIdHeader,o),t.m_requestHeaders.set(a.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),t.m_requestHeaders.set(a.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),s={action:"getItemsPresInfoAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(s),[4,t.getItemsAsync("getItemsPresInfoAsync")];case 1:return i=f.sent(),s[a.server].end=e.performanceNowTrimmed(),i&&i.response&&i.response.headers&&(s[a.contentLength]=i.response.headers.get(a.ContentLength)),e.logPerf(s),s[a.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},u=t.setTimeoutForParsingResponse(s),[4,t.createPresInfoResponse(t.parseMultipartResponseAsync(i,s))];case 2:return c=f.sent(),clearTimeout(u),s[a.parser].end=e.performanceNowTrimmed(),s[a.usedOutputCache]=!!c.usedOutputCache&&"true"===c.usedOutputCache.trim().toLowerCase(),s[a.itemUsedOutputCacheMap]=!!c.itemUsedOutputCacheMap&&Array.from(c.itemUsedOutputCacheMap.entries()),e.logPerf(s),c.metadata=t.generateReportPerfDictionary(s),[2,c]}}))}))()}},{key:"getItemsPresInfoAndSlideInfosAsync",value:function(r,t,s){var i=this;return _async_to_generator((function(){var y,h,_,m,g,S,I,w,b,C,P,E,x,O,A,T,k;return _ts_generator(this,(function(M){switch(M.label){case 0:y={action:"getItemsPresInfoAndSlideInfoAsync"},h=null,M.label=1;case 1:for(M.trys.push([1,4,,5]),i.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:i.m_presInfoInputProperties.ClientHeight,i.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:i.m_presInfoInputProperties.ClientWidth,i.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:i.m_presInfoInputProperties.IsHighContrast,i.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:i.m_presInfoInputProperties.ClientColorSettings,i.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:i.m_presInfoFilters.FilterHiddenSlideInfo,i.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:i.m_presInfoFilters.IncludeSections,i.m_itemsList=new Array,i.m_itemsList.push({Id:l.PresInfoMetaData,AcceptTypes:[d.JsonType],Options:JSON.stringify(i.m_presInfoOptions)}),i.m_imageOptions.InputProperties.ClientWidth=t.ClientWidth?t.ClientWidth:i.m_imageInputProperties.ClientWidth,i.m_imageOptions.InputProperties.ClientHeight=t.ClientHeight?t.ClientHeight:i.m_imageInputProperties.ClientHeight,i.m_imageOptions.InputProperties.IsHighContrast=t.IsHighContrast?t.IsHighContrast:i.m_imageInputProperties.IsHighContrast,i.m_imageOptions.InputProperties.ClientColorSettings=t.ClientColorSettings?t.ClientColorSettings:i.m_imageInputProperties.ClientColorSettings,i.m_imageOptions.InputProperties.MinClientWidth=t.MinClientWidth?t.MinClientWidth:i.m_imageInputProperties.MinClientWidth,i.m_imageOptions.InputProperties.MinClientHeight=t.MinClientHeight?t.MinClientHeight:i.m_imageInputProperties.MinClientHeight,i.m_imageOptions.InputProperties.MaxClientWidth=t.MaxClientWidth?t.MaxClientWidth:i.m_imageInputProperties.MaxClientWidth,i.m_imageOptions.InputProperties.MaxClientHeight=t.MaxClientHeight?t.MaxClientHeight:i.m_imageInputProperties.MaxClientHeight,i.m_imageOptions.InputProperties.TranslateLanguage=null!=t.TranslateLanguage?t.TranslateLanguage:i.m_imageInputProperties.TranslateLanguage,_=0;_<t.SlideLocations.length;_+=1)t.GetSlideImage?i.m_itemsList.push({Id:t.SlideLocations[_].slideId?l.slideInfoSid+t.SlideLocations[_].slideId.sid.toString():l.slideInfoIndex+t.SlideLocations[_].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(i.m_imageOptions)}):t.Filters&&(i.m_slideInfoOptions.InputProperties={ClientWidth:t.ClientWidth?t.ClientWidth:i.m_slideInfoInputProperties.ClientWidth,ClientHeight:t.ClientHeight?t.ClientHeight:i.m_slideInfoInputProperties.ClientHeight,IsHighContrast:t.IsHighContrast?t.IsHighContrast:i.m_slideInfoInputProperties.IsHighContrast,ColorMode:t.ColorMode?t.ColorMode:i.m_slideInfoInputProperties.ColorMode,ClientColorSettings:t.ClientColorSettings?t.ClientColorSettings:i.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:i.m_slideInfoInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:i.m_slideInfoInputProperties.LocaleName},i.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(t.Filters),i.m_itemsList.push({Id:t.SlideLocations[_].slideId?l.slideInfoSid+t.SlideLocations[_].slideId.sid.toString():l.slideInfoIndex+t.SlideLocations[_].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(i.m_slideInfoOptions)})),i.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:i.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:i.m_slideInfoInputProperties.LocaleName},void 0!==t.GetSlideAccessibilityModelData&&t.GetSlideAccessibilityModelData&&i.m_itemsList.push({Id:t.SlideLocations[_].slideId?l.slideAccessibilityModelSid+t.SlideLocations[_].slideId.sid.toString():l.slideAccessibilityModelIndex+t.SlideLocations[_].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(i.m_slideAccessibilityOptions)}),t.GetSlideNotes&&i.m_itemsList.push({Id:t.SlideLocations[_].slideId?l.slideNotesSid+t.SlideLocations[_].slideId.sid.toString():l.slideCommentsIndex+t.SlideLocations[_].slideIndex.toString(),AcceptTypes:[d.PlainTextType],Options:JSON.stringify(i.m_slideInfoOptions)}),t.GetSlideComments&&i.m_itemsList.push({Id:t.SlideLocations[_].slideId?l.slideCommentsSid+t.SlideLocations[_].slideId.sid.toString():l.slideCommentsIndex+t.SlideLocations[_].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:t.CommentOptions});return i.m_getItemsRequest.Items=i.m_itemsList,i.m_requestHeaders.set(a.CallerCorrelationId,r.CorrelationId||""),i.m_requestHeaders.set(a.XCorrelationId,r.CorrelationId||""),m=_object_spread_props(_object_spread({},r.RequestInfo,i.m_settings.sessionInfo),{CorrelationId:r.CorrelationId}),i.m_requestHeaders.set(a.RequestInfo,JSON.stringify(m)),g=i.objectDictionaryToRequestIdString(m),i.m_requestHeaders.set(a.clientRequestIdHeader,g),i.m_requestHeaders.set(a.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),i.m_requestHeaders.set(a.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),y.correlationId=r.CorrelationId,y[a.server]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(y),i.events.emit("requestStageChanged",{requestType:n.getItemsPresInfoAndSlideInfoAsync,stageInfo:o.GetItemsCall}),[4,i.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:s&&s.overrideGetItemsTimeoutMs})];case 2:if(S=M.sent(),i.m_settings.shouldUpdateNewFileUrlFromSnap&&S.errorCode===u.ServerErrorFileDownloadResourceInconsistent)return[2,{presInfo:void 0,slideInfo:[],responseErrorCode:u.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:S.errorCategory,responseIsIntentional:S.isIntentional,itemErrorCodeMap:void 0}];if(y[a.server].end=e.performanceNowTrimmed(),S&&S.response&&S.response.headers&&(y[a.contentLength]=S.response.headers.get(a.ContentLength),y[a.ContenEncoding]=S.response.headers.get(a.ContenEncoding),y[a.TransferEncoding]=S.response.headers.get(a.TransferEncoding),I=S.response.headers.keys())){w=[],b=!0,C=!1,P=void 0;try{for(E=I[Symbol.iterator]();!(b=(x=E.next()).done);b=!0)O=x.value,w.push(O)}catch(e){C=!0,P=e}finally{try{b||null==E.return||E.return()}finally{if(C)throw P}}y[a.ResponseHeaders]=w}return e.logPerf(y),y[a.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},h=i.setTimeoutForParsingResponse(y),[4,i.parseMultipartResponseAsync(S,y,{shouldTimeoutResponseStreamDownload:s&&s.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:s&&s.overrideDownloadTimeoutMs,requestType:n.getItemsPresInfoAndSlideInfoAsync})];case 3:return(A=M.sent())&&A.responseErrorCode===u.ErrorDownloadResponseStreamTimeout?[2,{presInfo:void 0,slideInfo:[],responseErrorCode:u.ErrorDownloadResponseStreamTimeout,responseErrorCategory:c.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}]:(T=i.createPresInfoAndSlideInfoResponse(A,y),null!==h&&(clearTimeout(h),h=null),y[a.parser].end=e.performanceNowTrimmed(),y[a.usedOutputCache]=!!T.usedOutputCache&&"true"===T.usedOutputCache.trim().toLowerCase(),y[a.itemUsedOutputCacheMap]=!!T.itemUsedOutputCacheMap&&Array.from(T.itemUsedOutputCacheMap.entries()),y[a.podsProxyCallSuceeded]=!0,e.logPerf(y),T.metadata=i.generateReportPerfDictionary(y),[2,T]);case 4:return k=M.sent(),v.sendTraceTag(508420486,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: ".concat(k)),y[a.podsProxyCallSuceeded]=!1,e.logPerf(y),null!==h&&(clearTimeout(h),h=null),[2,{presInfo:void 0,slideInfo:[],responseErrorCode:u.ErrorRESERVEDItemFailed,responseErrorCategory:c.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}];case 5:return[2]}}))}))()}},{key:"getItemsSlideInfosAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,s,i,y,h,_,m,g,S;return _ts_generator(this,(function(I){switch(I.label){case 0:n={action:"getItemsSlideInfosAsync"},I.label=1;case 1:for(I.trys.push([1,7,,8]),t.m_imageOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:t.m_imageInputProperties.ClientWidth,t.m_imageOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:t.m_imageInputProperties.ClientHeight,t.m_imageOptions.InputProperties.IsHighContrast=null!=r.IsHighContrast?r.IsHighContrast:t.m_imageInputProperties.IsHighContrast,t.m_imageOptions.InputProperties.ColorMode=null!=r.ColorMode?r.ColorMode:t.m_imageInputProperties.ColorMode,t.m_imageOptions.InputProperties.ClientColorSettings=null!=r.ClientColorSettings?r.ClientColorSettings:t.m_imageInputProperties.ClientColorSettings,t.m_imageOptions.InputProperties.MinClientWidth=r.MinClientWidth?r.MinClientWidth:t.m_imageInputProperties.MinClientWidth,t.m_imageOptions.InputProperties.MinClientHeight=r.MinClientHeight?r.MinClientHeight:t.m_imageInputProperties.MinClientHeight,t.m_imageOptions.InputProperties.MaxClientWidth=r.MaxClientWidth?r.MaxClientWidth:t.m_imageInputProperties.MaxClientWidth,t.m_imageOptions.InputProperties.MaxClientHeight=r.MaxClientHeight?r.MaxClientHeight:t.m_imageInputProperties.MaxClientHeight,t.m_imageOptions.InputProperties.TranslateLanguage=null!=r.TranslateLanguage?r.TranslateLanguage:t.m_imageInputProperties.TranslateLanguage,t.m_itemsList=new Array,o=0;o<r.SlideLocations.length;o+=1)r.GetSlideImage?t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideInfoSid+r.SlideLocations[o].slideId.sid.toString():l.slideInfoIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(t.m_imageOptions)}):r.Filters&&(t.m_slideInfoOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:t.m_slideInfoInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:t.m_slideInfoInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:t.m_slideInfoInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:t.m_slideInfoInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:t.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideInfoInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:t.m_slideInfoInputProperties.LocaleName},t.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(r.Filters),r.SkipGetSlideInfo||t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideInfoSid+r.SlideLocations[o].slideId.sid.toString():l.slideInfoIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(t.m_slideInfoOptions)})),t.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:r.LocaleName?r.LocaleName:t.m_slideInfoInputProperties.LocaleName},void 0!==r.GetSlideAccessibilityModelData&&r.GetSlideAccessibilityModelData&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideAccessibilityModelSid+r.SlideLocations[o].slideId.sid.toString():l.slideAccessibilityModelIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:JSON.stringify(t.m_slideAccessibilityOptions)}),r.GetSlideNotes&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideNotesSid+r.SlideLocations[o].slideId.sid.toString():l.slideCommentsIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[d.PlainTextType],Options:JSON.stringify(t.m_slideInfoOptions)}),r.GetSlideComments&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideCommentsSid+r.SlideLocations[o].slideId.sid.toString():l.slideCommentsIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[d.JsonType],Options:r.CommentOptions});return 0===t.m_itemsList.length?(v.sendTraceTag(508420485,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:u.ErrorRequestFailed,responseErrorCategory:c.BadRequest,responseIsIntentional:!1,slideInfo:[]}]):(t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(a.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(a.XCorrelationId,r.CorrelationId||""),s=_object_spread_props(_object_spread({},r.RequestInfo,t.m_settings.sessionInfo),{CorrelationId:r.CorrelationId}),t.m_requestHeaders.set(a.RequestInfo,JSON.stringify(s)),i=t.objectDictionaryToRequestIdString(s),t.m_requestHeaders.set(a.clientRequestIdHeader,i),t.m_requestHeaders.set(a.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),t.m_requestHeaders.set(a.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),(y={action:"getItemsSlideInfosAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}}).correlationId=r.CorrelationId,y[a.server]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(y),t.m_settings.shouldFixSlideDataOrder?(r.GetSlideComments&&(_={isGetSlideCommentsRequest:!0}),[4,t.getItemsAsync("getItemsSlideInfosAsync",_)]):[3,3]);case 2:return h=I.sent(),[3,5];case 3:return[4,t.getItemsAsync("getItemsSlideInfosAsync")];case 4:h=I.sent(),I.label=5;case 5:return t.m_settings.shouldUpdateNewFileUrlFromSnap&&h.errorCode===u.ServerErrorFileDownloadResourceInconsistent?[2,{slideInfo:[],responseErrorCode:u.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:h.errorCategory,responseIsIntentional:!!h.headers.get(a.IsIntentional)&&h.headers.get(a.IsIntentional),itemErrorCodeMap:void 0}]:(y[a.server].end=e.performanceNowTrimmed(),h&&h.response&&h.response.headers&&(y[a.contentLength]=h.response.headers.get(a.ContentLength)),y[a.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(y),m=t.setTimeoutForParsingResponse(y),[4,t.createSlideInfoResponse(t.parseMultipartResponseAsync(h,y),y)]);case 6:return g=I.sent(),clearTimeout(m),y[a.parser].end=e.performanceNowTrimmed(),y[a.usedOutputCache]=!!g.usedOutputCache&&"true"===g.usedOutputCache.trim().toLowerCase(),y[a.itemUsedOutputCacheMap]=!!g.itemUsedOutputCacheMap&&Array.from(g.itemUsedOutputCacheMap.entries()),y[a.podsProxyCallSuceeded]=!0,e.logPerf(y),g.metadata=t.generateReportPerfDictionary(y),[2,g];case 7:return S=I.sent(),v.sendTraceTag(508420484,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItemsSlideInfosAsync - exception happened: ".concat(S)),n[a.podsProxyCallSuceeded]=!1,e.logPerf(n),[2,{slideInfo:[],responseErrorCode:u.ErrorRESERVEDItemFailed,responseErrorCategory:c.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0}];case 8:return[2]}}))}))()}},{key:"getItemsResourceAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,s,i,u,c,l,f,p,y,h,_;return _ts_generator(this,(function(v){switch(v.label){case 0:t.m_slideResourceOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:t.m_slideResourceInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:t.m_slideResourceInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:t.m_slideResourceInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:t.m_slideResourceInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:t.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideResourceInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:t.m_slideResourceInputProperties.LocaleName},t.m_slideResourceOptions.Filters.EnableClustering=void 0!==r.EnableClustering&&r.EnableClustering,t.m_itemsList=new Array,n=!0,o=!1,s=void 0;try{for(i=r.ResourceParams[Symbol.iterator]();!(n=(u=i.next()).done);n=!0){switch(c=u.value,t.m_slideResourceOptions.InputProperties.ResourceId=c.Id,l=String(c.Name.match("[^.]+$")),f="",l){case"jpg":f=d.ImageJpg;break;case"png":f=d.ImagePng}t.m_itemsList.push({Id:c.Name,AcceptTypes:f?[f]:e.s_supportedImageType,Options:JSON.stringify(t.m_slideResourceOptions)})}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}return t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(a.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(a.XCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(a.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),p={action:"getItemsResourceAsync",correlationId:r.CorrelationId,server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(p),[4,t.getItemsAsync("getItemsResourceAsync")];case 1:return y=v.sent(),p[a.server].end=e.performanceNowTrimmed(),y&&y.response&&y.response.headers&&(p[a.contentLength]=y.response.headers.get(a.ContentLength)),p[a.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},e.logPerf(p),h=t.setTimeoutForParsingResponse(p),[4,t.createSlideInfoResponse(t.parseMultipartResponseAsync(y,p),p)];case 2:return _=v.sent(),clearTimeout(h),p[a.parser].end=e.performanceNowTrimmed(),p[a.usedOutputCache]=!!_.usedOutputCache&&"true"===_.usedOutputCache.trim().toLowerCase(),p[a.itemUsedOutputCacheMap]=!!_.itemUsedOutputCacheMap&&Array.from(_.itemUsedOutputCacheMap.entries()),e.logPerf(p),_.metadata=t.generateReportPerfDictionary(p),[2,_]}}))}))()}},{key:"getItemsSlideOrderAndSlidesInfoIndexAsync",value:function(r,t,n){var o=this;return _async_to_generator((function(){var s,i,u,c,f;return _ts_generator(this,(function(p){switch(p.label){case 0:return o.m_getItemsRequest.Items.push({Id:l.PresinfoslimSlideOrder,AcceptTypes:[d.JsonType],Options:JSON.stringify(n)}),s=JSON.stringify(t),r&&r.forEach((function(e){o.m_getItemsRequest.Items.push({Id:"".concat(l.slideInfoIndex).concat(e),AcceptTypes:[d.ImagePng,d.ImageJpg],Options:s})})),i={action:"getItemsSlideOrderAndSlidesInfoIndexAsync",server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},e.logPerf(i),[4,o.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync")];case 1:return u=p.sent(),i[a.server].end=e.performanceNowTrimmed(),i[a.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},u&&u.response&&u.response.headers&&(i[a.contentLength]=u.response.headers.get(a.ContentLength)),e.logPerf(i),c=o.setTimeoutForParsingResponse(i),[4,o.createSlideOrderAndSlidesInfoIndexResponse(o.parseMultipartResponseAsync(u,i))];case 2:return f=p.sent(),clearTimeout(c),i[a.parser].end=e.performanceNowTrimmed(),i[a.usedOutputCache]=!!f.usedOutputCache&&"true"===f.usedOutputCache.trim().toLowerCase(),i[a.itemUsedOutputCacheMap]=!!f.itemUsedOutputCacheMap&&Array.from(f.itemUsedOutputCacheMap.entries()),e.logPerf(i),f.metadata=o.generateReportPerfDictionary(i),[2,f]}}))}))()}},{key:"getItemsPresInfoAndSlideInfoIndexAsync",value:function(r,t,n){var o=this;return _async_to_generator((function(){var s,i,u,c,f;return _ts_generator(this,(function(p){switch(p.label){case 0:return o.m_presInfoOptions.InputProperties.ClientHeight=n.ClientHeight?n.ClientHeight:o.m_presInfoInputProperties.ClientHeight,o.m_presInfoOptions.InputProperties.ClientWidth=n.ClientWidth?n.ClientWidth:o.m_presInfoInputProperties.ClientWidth,o.m_presInfoOptions.InputProperties.IsHighContrast=n.IsHighContrast?n.IsHighContrast:o.m_presInfoInputProperties.IsHighContrast,o.m_presInfoOptions.InputProperties.ClientColorSettings=n.ClientColorSettings?n.ClientColorSettings:o.m_presInfoInputProperties.ClientColorSettings,o.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==n.FilterHiddenSlideInfo?n.FilterHiddenSlideInfo:o.m_presInfoFilters.FilterHiddenSlideInfo,o.m_presInfoOptions.Filters.IncludeSections=void 0!==n.IncludeSections?n.IncludeSections:o.m_presInfoFilters.IncludeSections,o.m_getItemsRequest.Items.push({Id:l.PresInfoMetaData,AcceptTypes:[d.JsonType],Options:JSON.stringify(o.m_presInfoOptions)}),s=JSON.stringify(t),r&&r.forEach((function(e){o.m_getItemsRequest.Items.push({Id:"".concat(l.slideInfoIndex).concat(e),AcceptTypes:[d.ImagePng,d.ImageJpg],Options:s})})),i={action:"getItemsPresInfoAndSlideInfoIndexAsync",server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},[4,o.getItemsAsync("getItemsPresInfoAndSlideInfoIndexAsync")];case 1:return u=p.sent(),i[a.server].end=e.performanceNowTrimmed(),i[a.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},u&&u.response&&u.response.headers&&(i[a.contentLength]=u.response.headers.get(a.ContentLength)),c=o.setTimeoutForParsingResponse(i),[4,o.createPresInfoAndSlideInfoIndexResponse(o.parseMultipartResponseAsync(u,i))];case 2:return f=p.sent(),clearTimeout(c),i[a.parser].end=e.performanceNowTrimmed(),i[a.usedOutputCache]=!!f.usedOutputCache&&"true"===f.usedOutputCache.trim().toLowerCase(),i[a.itemUsedOutputCacheMap]=!!f.itemUsedOutputCacheMap&&Array.from(f.itemUsedOutputCacheMap.entries()),e.logPerf(i),f.metadata=o.generateReportPerfDictionary(i),[2,f]}}))}))()}},{key:"getPresInfoAsync",value:function(e){var r=this;return _async_to_generator((function(){var t,n,o;return _ts_generator(this,(function(s){switch(s.label){case 0:return v.sendTraceTag(508420483,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::getPresInfoAsync - Function:".concat(e,", requestCorrelation:").concat(r.m_requestHeaders.get(a.CallerCorrelationId))),t=new AbortController,n=setTimeout((function(){return t.abort()}),3e4),[4,fetch("".concat(r.m_podsUrl,"/presinfo.ashx"),{headers:r.m_requestHeaders,method:"POST",body:JSON.stringify(r.m_getPresInfoRequest),signal:t.signal}).catch((i=_async_to_generator((function(r){return _ts_generator(this,(function(t){throw v.sendTraceTag(508420482,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getPresInfo - Function: ".concat(e,", Error: ").concat(r)),r}))})),function(e){return i.apply(this,arguments)}))];case 1:return o=s.sent(),clearTimeout(n),v.sendTraceTag(508420481,f.msoulscat_Wac_PptSession,o.ok?p.Info:p.Error,"PodsProxy::getPresInfo - Function: ".concat(e,", Status:").concat(o.status,", StatusText: ").concat(o.statusText,", CorrelationId: ").concat(o.headers.get(a.XCorrelationId))),[2,o]}var i}))}))()}},{key:"logGetItemFailureServerHeaders",value:function(e,r,t,n){return _async_to_generator((function(){var o;return _ts_generator(this,(function(s){return(o={functionName:e,requestCorrelation:r,usePresentFrontDoor:t}).headerCorrelationId=n&&n.headers?n.headers.get(a.XCorrelationId):a.unknown,o.headerErrorCode=n&&n.headers?n.headers.get(a.ErrorCode):a.unknown,o.xHeaderErrorCode=n&&n.headers?n.headers.get(a.XErrorCode):a.unknown,o.headerErrorCategory=n&&n.headers?n.headers.get(a.ErrorCategory):a.unknown,o.headerErrorIntentional=!(!n||!n.headers)&&n.headers.get(a.IsIntentional),o.status=n&&n.status?n.status:a.unknown,v.sendTraceTag(506852878,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:logGetItemFailureServerHeaders - ".concat(JSON.stringify(o))),[2]}))}))()}},{key:"getItemsAsync",value:function(r,t){var n=this;return _async_to_generator((function(){var o,s,i,l,d,y,h,_,m,g,I;return _ts_generator(this,(function(w){switch(w.label){case 0:return o=n.m_requestHeaders.get(a.CallerCorrelationId),v.sendTraceTag(508420480,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::getItemsAsync - Function:".concat(r,", requestCorrelation:").concat(o)),s={errorCode:u.ErrorRESERVEDSuccess},i=s,l="getItemsPresInfoAndSlideInfoAsync"===r&&n.m_settings.shouldUseBootRequestTimeout&&n.m_settings.bootRequestTimeout?n.m_settings.bootRequestTimeout:n.m_settings.timeout,t&&t.overrideGetItemsTimeoutMs&&(l=t.overrideGetItemsTimeoutMs),n.m_requestHeaders.set(a.dateHeader,(new Date).toISOString()),n.m_requestHeaders.set(a.clientTimeoutHeader,l.toString()),n.m_requestHeaders.set(a.callId,n.m_settings.callId||"empty"),d=!1,y="".concat(n.m_podsUrl,"/getitems.ashx"),h=t&&t.isGetSlideCommentsRequest,n.m_settings.shouldFixSlideDataOrder&&(h&&n.m_wacFallbackDownloadUrl?n.m_getItemsRequest.Source.DownloadUrl=n.m_wacFallbackDownloadUrl:n.m_getItemsRequest.Source.DownloadUrl=n.m_downloadUrl),h||!n.m_settings.pptoPresentFrontDoorEnabled&&!S.readBooleanOrDefault("enableUsePresentFrontdoor",!1)||(n.m_presentUrl?(y="".concat(n.m_presentUrl,"/items"),d=!0):v.sendTraceTag(508420451,f.msoulscat_Wac_PptSession,p.Warning,"PodsProxy::getItemsAsync enableUsePresentFrontdoor is true but presentUrl is null. Using podsUrl. }")),_=n.m_getItemsRequest.Items.map((function(e){return e.Id})),e.s_events.emit("networkCall",{url:y,itemIds:_}),m=new AbortController,g=setTimeout((function(){return m.abort()}),l),[4,fetch(y,{headers:n.m_requestHeaders,method:"POST",body:JSON.stringify(n.m_getItemsRequest),signal:m.signal}).catch((b=_async_to_generator((function(t){var i,l,y,h,_,m,g,S;return _ts_generator(this,(function(I){return i=t.response&&t.response.headers?t.response.headers.get(a.XCorrelationId):a.unknown,l=t.response&&t.response.headers?t.response.headers.get(a.ErrorCode):a.unknown,y=t.response&&t.response.headers?t.response.headers.get(a.XErrorCode):a.unknown,h=t.response&&t.response.headers?t.response.headers.get(a.ErrorCategory):a.unknown,_=!(!t.response||!t.response.headers)&&t.response.headers.get(a.IsIntentional),m=t.response&&t.response.status?t.response.status:a.unknown,(g=t.toString()).length>0&&("."===g.slice(-1)||""===g.slice(-1))&&(g=g.slice(0,-1)),(S=n.getMappedError(g))?s.errorCode=S:"HTTPError"===t.name&&m!==a.unknown&&500!==m&&n.m_errorMap.has(m)?s.errorCode=n.m_errorMap.get(m):"TimeoutError"===t.name?s.errorCode=u.ErrorRequestTimeout:s.errorCode=e.convertServerError(l,n.m_settings.enableServerSpecificErrorCode),n.m_settings.shouldUpdateNewFileUrlFromSnap&&s.errorCode===u.ServerErrorFileDownloadResourceInconsistent&&(s.newSnapUrl=e.getFieldFromReponseHeader(t.response,a.newSnapUrlHeader)),s.errorCategory=h&&""!==h.trim()&&h!==a.unknown?h:c.Transient,s.isIntentional=_!==a.unknown&&_,v.sendTraceTag(595687001,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItems - Function:".concat(r,", Error:").concat(t,", ErrorName:").concat(t.name,", Status:").concat(t.status,", HeaderCorrelationId:").concat(i,", HeaderErrorCode:").concat(l,", HeaderErrorCategory:").concat(h,", result.isIntentional:").concat(s.isIntentional,", result.errorCode:").concat(s.errorCode,", requestCorrelation:").concat(o,", status:").concat(m,", xErrorCode:").concat(y,", usePresentFrontDoor:").concat(d)),[2,s]}))})),function(e){return b.apply(this,arguments)}))];case 1:return i=w.sent(),v.sendTraceTag(506852877,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:getItemsAsync - fixErrorLoggingGetItemsPodsProxy: ".concat(S.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1))),S.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)&&i&&!1===i.ok?[4,n.logGetItemFailureServerHeaders(r,o,d,i)]:[3,3];case 2:w.sent(),w.label=3;case 3:clearTimeout(g),s.response=i;try{if(n.m_settings.shouldUpdateNewFileUrlFromSnap&&(s.errorCode===u.ServerErrorFileDownloadResourceInconsistent||s.newSnapUrl)){if(v.sendTraceTag(508420449,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),s.newSnapUrl)return s.errorCode===u.ErrorRESERVEDSuccess&&v.sendTraceTag(508420448,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:got new snap url without errorcode"),v.sendTraceTag(508420447,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:getItems get valid new file url"),n.events.emit("downloadUrlChanged",s.newSnapUrl),[2,s];v.sendTraceTag(508420446,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){v.sendTraceTag(508420445,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return 200!==i.status&&s.errorCode===u.ErrorRESERVEDSuccess&&(i.headers&&i.headers.get(a.ErrorCode)?(s[a.errorCode]=e.convertServerError(i.headers.get(a.ErrorCode),n.m_settings.enableServerSpecificErrorCode),s[a.errorCategory]=i.headers.get(a.ErrorCategory)?i.headers.get(a.ErrorCategory):c.BadRequest,s[a.IsIntentional]=!!i.headers.get(a.IsIntentional)&&i.headers.get(a.IsIntentional)):(i.status!==a.unknown&&n.m_errorMap.has(i.status)?s[a.errorCode]=n.m_errorMap.get(i.status):s[a.errorCode]=u.ErrorRequestFailed,s[a.errorCategory]=c.Transient,s[a.IsIntentional]=!1)),I={functionName:r,status:i.status,statusText:i.statusText,headerCorrelation:i.headers?i.headers.get(a.XCorrelationId):"",headerErrorCode:i.headers?i.headers.get(a.ErrorCode):"",headerErrorCategory:i.headers?i.headers.get(a.ErrorCategory):"",headerErrorIntentional:!!i.headers&&i.headers.get(a.IsIntentional),requestCorrelation:o,resultErrorCode:s.errorCode,resultErrorCategory:s.errorCategory,resultIsIntentional:s.IsIntentional},v.sendTraceTag(595687002,f.msoulscat_Wac_PptSession,i.ok?p.Info:p.Error,JSON.stringify(I)),[2,s]}var b}))}))()}},{key:"getSessionUtcAsync",value:function(){var e=this;return _async_to_generator((function(){var r,t,n,o,s;return _ts_generator(this,(function(i){switch(i.label){case 0:return r=-1,t=new AbortController,n=setTimeout((function(){return t.abort()}),2500),[4,fetch("".concat(e.m_podsUrl,"/podhandler.ashx?action=GetSessionUTC&format=jsms"),{headers:new Headers,method:"GET",signal:t.signal}).catch((a=_async_to_generator((function(e){return _ts_generator(this,(function(r){return v.sendTraceTag(508420444,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getSessionUtcAsync - Error: ".concat(e)),[2]}))})),function(e){return a.apply(this,arguments)}))];case 1:o=i.sent(),clearTimeout(n),i.label=2;case 2:return i.trys.push([2,6,,7]),o?[4,o.text()]:[3,4];case 3:return r=parseInt.apply(void 0,[i.sent(),10]),v.sendTraceTag(508420443,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::getSessionUtcAsync: ".concat(r)),[3,5];case 4:v.sendTraceTag(508420442,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getSessionUtcAsync - Null response."),i.label=5;case 5:return[3,7];case 6:return s=i.sent(),v.sendTraceTag(508420441,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::getSessionUtcAsync - error parsing response. ".concat(s)),[3,7];case 7:return[2,r]}var a}))}))()}},{key:"updateDocSource",value:function(e){v.sendTraceTag(508420440,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:v.sendTraceTag(508420439,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:v.sendTraceTag(508420438,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}},{key:"generateSnapDownloadUrlAsync",value:function(e,r){var t=this;return _async_to_generator((function(){var n,o,s,i,u,c,l,d;return _ts_generator(this,(function(y){switch(y.label){case 0:return y.trys.push([0,4,,5]),v.sendTraceTag(508420437,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ".concat(e.ID,".")),(n=new Headers).append(a.ContentType,"application/json; charset=utf-8"),n.append(a.CallerCorrelationId,e.ID),r&&r.forEach((function(e,r){n.append(r,e)})),o="".concat(t.m_podsUrl,"/SnapUrlHandler.ashx"),s=new AbortController,i=setTimeout((function(){return s.abort()}),t.m_settings.timeout),[4,fetch(o,{headers:n,method:"POST",body:JSON.stringify(e),signal:s.signal}).catch((h=_async_to_generator((function(e){return _ts_generator(this,(function(r){return v.sendTraceTag(508420436,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : ".concat(e)),[2]}))})),function(e){return h.apply(this,arguments)}))];case 1:return u=y.sent(),clearTimeout(i),c="",u?[4,u.json()]:[3,3];case 2:l=y.sent(),v.sendTraceTag(508420435,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:".concat(l.FSuccess,", ErrorCode:").concat(l.ErrorCode)),l.FSuccess?c=l.SnapUrl:v.sendTraceTag(508420434,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : ".concat(l.ErrorCode)),y.label=3;case 3:return[2,c];case 4:return d=y.sent(),v.sendTraceTag(508420433,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:generateSnapDownloadUrlAsync - exception: ".concat(d)),[2,""];case 5:return[2]}var h}))}))()}},{key:"setErrorMap",value:function(){for(var e=["cancelled","cancelado","","Abgebrochen","","","annul","","avbruten","","annullato","zrueno","poniteno","geannuleerd","","avbrutt","annulleret","",""," hu","Kumottu","dibatalkan","vazgeildi","anulat","anulowane","","visszavonva"],r=0;r<e.length;r+=1)this.m_errorMap.set(e[r],u.ErrorRequestCanceled);for(var t=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexin de red se perdi","","La connexion rseau a t perdue","  ","","","   ","","Ntverksanslutningen frlorades","A conexo de rede foi perdida","A balants kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione  stata persa","A ligao  rede foi interrompida","Mistet nettverksforbindelsen","La conexin de red se ha perdido",""," mt kt ni mng","Kehilangan jaringan koneksi","   ","","  ","Verkkoyhteys katkesi","Netvrksforbindelsen gik tabt","Bylo ztraceno pipojen k sti","Poczenie sieciowe zostao utracone","A conexo  internet parece estar desativada","The Internet connection appears to be offline","La conexin a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de reea a fost pierdut","","  ","NetworkError when attempting to fetch resource","","No se ha podido establecer conexin con el servidor","Tidak dapat terhubung ke server","","No se pudo establecer conexin con el servidor","A hlzati kapcsolat megszakadt"],n=0;n<t.length;n+=1)this.m_errorMap.set(t[n],u.ErrorConnectionLost);for(var o=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operacin. El software caus la anulacin de la conexin","Khng th hon tt tc v. Phn mm  khin kt ni b hy b","  .       ","   .    ","The operation couldnt be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","Lopration na pas pu sachever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operacin. El software caus la anulacin de la conexin","A operao no pde ser concluda. O software provocou o cancelamento da conexo","No se ha podido completar la operacin. El software ha causado la anulacin de la conexin","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","","",""," ","","Postupak se nije mogao dovriti. Softver je uzrokovao prekid veze","tgrden kunde inte slutfras. Program orsakade avbrott i anslutningen","lem tamamlanamad. Yazlm balantnn kesilmesine neden oldu","   .   "],s=0;s<o.length;s+=1)this.m_errorMap.set(o[s],u.ErrorSoftwareConnectionAbort);for(var i=["The request timed out","","La requte a expir","","Se agot el tiempo de espera","Esgotou-se o tempo limite da solicitao",""],a=0;a<i.length;a+=1)this.m_errorMap.set(i[a],u.ErrorRequestTimeout);for(var c=["cannot parse response","impossible danalyser la rponse",""],l=0;l<c.length;l+=1)this.m_errorMap.set(c[l],u.ErrorCannotParseResponse);this.m_errorMap.set("The operation was aborted",u.ErrorRequestAbort),this.m_errorMap.set("Failed to fetch",u.ErrorFailedToFetch),this.m_errorMap.set(404,u.ErrorRequestFailedServerNotFound),this.m_errorMap.set(502,u.ErrorRequestFailedBadGateway),this.m_errorMap.set(503,u.ErrorRequestFailedServiceUnavailable),this.m_errorMap.set(504,u.ErrorRequestFailedGatewayTimeout)}},{key:"getMappedError",value:function(r){var t=r;return(t=e.trimErrorName(t,["TypeError:","Loading failed:"])).indexOf("Bylo ztraceno")>=0?u.ErrorConnectionLost:t.indexOf("AbortError:")>=0?u.ErrorRequestAbort:this.m_errorMap.get(t)}},{key:"parseMultipartResponseAsync",value:function(r,t,s){var i=this;return _async_to_generator((function(){var l,d,y,_,m,I,w,b,C,P,E,x,O,A,T,k,M,R,j,N,W,F,D,U,L,H,J,q,B,G,z,V,K,X,$,Y,Q,Z,ee,re;return _ts_generator(this,(function(te){switch(te.label){case 0:if(l={},d={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:u.ErrorRESERVEDSuccess,responseErrorCategory:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,data:void 0},y={slideOrder:[],slideAllInfo:[]},t[a.firstResponseCheck]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},!(r.response&&r.response.body&&r.response.headers&&r.response.headers.get(a.ContentType)))return[3,12];_=r.response,m="";try{t[a.fetchBoundary]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},m=i.m_multipartParser.fetchBoundary(_.headers.get(a.ContentType)),t[a.fetchBoundary].end=e.performanceNowTrimmed()}catch(e){return I=_.headers.get(a.ErrorCode),w=_.headers.get(a.ErrorCategory),b=!!r[a.IsIntentional]&&r[a.IsIntentional],C=_.headers.get(a.XCorrelationId),v.sendTraceTag(508420432,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ".concat(_.headers.get(a.ContentType),", ErrorCode:").concat(I,", ErrorCategory:").concat(w,", IsIntentional:").concat(b," , Correlation:").concat(C,", Exception:").concat(e)),d.responseErrorCode=I||u.ErrorRequestFailed,d.responseErrorCategory=w||c.BadRequest,[2,d]}return P=e.performanceNowTrimmed(),t[a.downloadResponse]={start:P,end:P},v.sendTraceTag(508420431,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::parseMultipartResponse - download response stream start: ".concat(P)),s&&s.requestType===n.getItemsPresInfoAndSlideInfoAsync&&i.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.DownloadResponseStream}),E=!1,x=void 0,O=null,T=_.headers?_.headers.get(a.ContentLength):-1,k=-1,v.sendTraceTag(508420430,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: ".concat(i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength)),i.m_settings.parsingWhileDownloadingEnabled?(M=!1,R=!1,j=function(r){M=!0,R=r;var u={receivedDataLength:k,responseContentLength:T,duration:e.performanceNowTrimmed()-P,downloadFailed:R};v.sendTraceTag(508420429,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(u)));var c=e.performanceNowTrimmed();v.sendTraceTag(508420428,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat(c,", duration: ").concat(c-P)),t[a.downloadResponse].end=c,t[a.downloadResponse].length=k,!E&&s&&s.requestType===n.getItemsPresInfoAndSlideInfoAsync&&i.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.ParseMultipartResponse})},k=0,N=_.body,W=_sliced_to_array(N.tee(),2),F=W[0],D=W[1],U=new Promise((oe=_async_to_generator((function(e){var r,t,n,o,s,i;return _ts_generator(this,(function(a){switch(a.label){case 0:a.trys.push([0,4,,5]),r=S.readNumberOrDefault("hackMaxBytes",-1),t=F.getReader(),a.label=1;case 1:return[4,t.read()];case 2:if(n=a.sent(),o=n.done,s=n.value,o)return j(!1),e(),[3,3];if(s&&(k+=s.length,r>0&&k>r))throw"hackMaxBytes hit";return[3,1];case 3:return[3,5];case 4:return i=a.sent(),v.sendTraceTag(508420427,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::measuringDownloadPromise - exception ".concat(i,".")),j(!0),e(),[3,5];case 5:return[2]}}))})),function(e){return oe.apply(this,arguments)})),s&&s.shouldTimeoutResponseStreamDownload&&(H=s&&s.overrideDownloadTimeoutMs?s.overrideDownloadTimeoutMs:i.m_settings.responseStreamDownloadTimeout?i.m_settings.responseStreamDownloadTimeout:3e4,L=window.setTimeout((function(){M||(E=!0,v.sendTraceTag(508420426,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),v.sendTraceTag(508420425,f.msoulscat_Wac_PptSession,p.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),F.cancel(),D.cancel())}),H)),J=new g(i.m_settings,l,t,d),q=i.m_multipartParser.processMultipartBinaryResponse(D.getReader(),m,(function(e){J.parsePart(e)})),[4,Promise.all([U,q])]):[3,2];case 1:if(te.sent(),R)return h.ChangeGate.isChangeGateEnabled("retryOnNetworkFailure")&&(d.responseErrorCode=u.ErrorRequestFailed,d.responseErrorCategory=c.Transient),d.data=void 0,[2,d];if(s&&s.shouldTimeoutResponseStreamDownload&&(clearTimeout(L),v.sendTraceTag(508420424,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:E,shouldUseResponseStreamWhenReceivedTotalLength:i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:k,responseContentLength:T})))),E){if(!(i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&T>0&&k>0&&T===k))return d.responseErrorCode=u.ErrorDownloadResponseStreamTimeout,[2,d];v.sendTraceTag(508420423,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens")}return y=J.parsedResponse,[3,11];case 2:return s&&s.shouldTimeoutResponseStreamDownload?(B=s&&s.overrideDownloadTimeoutMs?s.overrideDownloadTimeoutMs:i.m_settings.responseStreamDownloadTimeout?i.m_settings.responseStreamDownloadTimeout:3e4,G="downloadResponseStreamTimeout",V=new Promise((function(e){x=setTimeout((function(){v.sendTraceTag(508420422,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),z&&(v.sendTraceTag(508420421,f.msoulscat_Wac_PptSession,p.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),z.cancel()),e(G)}),B)})),z=_.body.getReader(),(O=i.readResponseStream(z,T)).then((function(r){var t={receivedDataLength:k=r&&r.length||-1,responseContentLength:T,duration:e.performanceNowTrimmed()-P};v.sendTraceTag(508420420,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(t)))})),[4,Promise.race([O,V])]):[3,4];case 3:return(A=te.sent())===G?E=!0:void 0!==x&&clearTimeout(x),[3,6];case 4:return K=Uint8Array.bind,[4,_.arrayBuffer()];case 5:A=new(K.apply(Uint8Array,[void 0,te.sent()])),(X=S.readNumberOrDefault("hackMaxBytes",-1))>0&&A.length>X&&(A=A.slice(0,X)),te.label=6;case 6:return s&&s.shouldTimeoutResponseStreamDownload&&v.sendTraceTag(508420419,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:E,shouldUseResponseStreamWhenReceivedTotalLength:i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:k,responseContentLength:T}))),E?i.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&O&&T>0&&k>0&&T===k?(v.sendTraceTag(508420418,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),[4,O]):[3,8]:[3,9];case 7:return A=te.sent(),[3,9];case 8:return d.responseErrorCode=u.ErrorDownloadResponseStreamTimeout,[2,d];case 9:return $=e.performanceNowTrimmed(),v.sendTraceTag(508420417,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat($,", duration: ").concat($-P)),Y=A,t[a.downloadResponse].end=$,Y&&Y.length&&(t[a.downloadResponse].length=Y.length),s&&s.requestType===n.getItemsPresInfoAndSlideInfoAsync&&i.events.emit("requestStageChanged",{requestType:s.requestType,stageInfo:o.ParseMultipartResponse}),Q=new g(i.m_settings,l,t,d),[4,i.m_multipartParser.processMultipartBinaryResponse(Y,m,(function(e){Q.parsePart(e)}))];case 10:te.sent(),y=Q.parsedResponse,te.label=11;case 11:return[3,13];case 12:Z=r.hasOwnProperty(a.errorCode)&&r[a.errorCode]!==u.ErrorRESERVEDSuccess?r[a.errorCode]:u.ErrorRequestFailed,ee=r[a.errorCategory]?r[a.errorCategory]:c.BadRequest,re=!!r[a.IsIntentional]&&r[a.IsIntentional],d.responseErrorCode=Z,d.responseErrorCategory=ee,v.sendTraceTag(508420416,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - responseErrorCode:".concat(Z,", responseErrorCategory:").concat(ee,", IsIntentional:").concat(re)),te.label=13;case 13:for(var ne in t[a.firstResponseCheck].end=e.performanceNowTrimmed(),d.responseErrorCode!==u.ErrorRESERVEDSuccess&&d.responseErrorCategory===c.ErrorRESERVEDSuccess&&(d.responseErrorCategory=c.BadRequest,v.sendTraceTag(508420387,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:".concat(d.responseErrorCode))),l)y.slideAllInfo.push({ID:l[ne].ID,SlideImageData:l[ne].SlideImageData,SlideShowInfo:l[ne].SlideShowInfo,Title:l[ne].Title,NoteHtml:l[ne].NoteHtml,Comments:l[ne].Comments,HasAnimation:l[ne].HasAnimation,Hidden:l[ne].Hidden,HasTransition:l[ne].HasTransition,ResourceData:l[ne].ResourceData,AccessibilityModel:l[ne].AccessibilityModel,MediaUrls:l[ne].MediaUrls});try{if(S.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)&&(d.itemErrorCodeMap&&Object.values(d.itemErrorCodeMap).includes(u.ServerErrorFileDownloadResourceInconsistent)||d.newSnapUrl)){if(d.newSnapUrl)return 0===d.itemErrorCodeMap.size&&v.sendTraceTag(508420386,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:got new snap url without errorcode"),v.sendTraceTag(508420385,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy:getItems get valid new file url"),i.events.emit("downloadUrlChanged",d.newSnapUrl),[2,d];v.sendTraceTag(508420384,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){v.sendTraceTag(508420383,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return d.data=y,[2,d]}var oe}))}))()}},{key:"readResponseStream",value:function(e,r){var t=this;return _async_to_generator((function(){var n,o,s,i;return _ts_generator(this,(function(a){switch(a.label){case 0:n=new Uint8Array(0),a.label=1;case 1:return a.trys.push([1,6,,7]),[4,e.read()];case 2:o=a.sent(),a.label=3;case 3:if(o.done)return[3,5];if(n=new Uint8Array(_to_consumable_array(n).concat(_to_consumable_array(o.value))),(s=S.readNumberOrDefault("hackMaxBytes",-1))>0&&n.length>s)throw n=n.slice(0,s),"hackMaxBytes hit";return r>0&&n.length===r&&(v.sendTraceTag(508420382,f.msoulscat_Wac_PptSession,p.Info,"PodsProxy::readResponseStream - received length reached content length: ".concat(r)),t.m_settings.shouldUseResponseStreamWhenReceivedTotalLength)?[3,5]:[4,e.read()];case 4:return o=a.sent(),[3,3];case 5:return[3,7];case 6:return i=a.sent(),v.sendTraceTag(508420381,f.msoulscat_Wac_PptSession,p.Error,"PodsProxy::readResponseStream - exception ".concat(i,".")),[2,new Uint8Array(0)];case 7:return[2,n]}}))}))()}},{key:"generateReportPerfDictionary",value:function(e){var r={};return e[a.action]&&(r[a.action]=e[a.action]),e[a.correlationId]&&(r[a.correlationId]=e[a.correlationId]),e[a.server]&&(r[a.server]=e[a.server]),e[a.parser]&&(r[a.parser]=e[a.parser]),e[a.downloadResponse]&&(r[a.downloadResponse]=e[a.downloadResponse]),e[a.usedOutputCache]&&(r[a.usedOutputCache]=e[a.usedOutputCache]),e[a.contentLength]&&(r[a.contentLength]=e[a.contentLength]),r}},{key:"createPresInfoAndSlideInfoResponse",value:function(r,t){var n=(u.ErrorRESERVEDSuccess,c.ErrorRESERVEDSuccess);return t[a.createResponse]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},n={itemErrorCodeMap:r.itemErrorCodeMap,itemErrorCategoryMap:r.itemErrorCategoryMap,responseErrorCode:r.responseErrorCode,responseErrorCategory:r.responseErrorCategory,responseIsIntentional:!1,presInfo:r.data&&r.data.slideAllInfo&&r.data.slideAllInfo.length>0?r.data.slideAllInfo[0]:void 0,slideInfo:r.data&&r.data.slideAllInfo?r.data.slideAllInfo.slice(1):[],usedOutputCache:r.usedOutputCache,itemUsedOutputCacheMap:r.itemUsedOutputCacheMap},t[a.createResponse].end=e.performanceNowTrimmed(),n}},{key:"createSlideInfoResponse",value:function(r,t){var n=this;return _async_to_generator((function(){var o;return _ts_generator(this,(function(s){switch(s.label){case 0:return o={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:u.ErrorRESERVEDSuccess,responseErrorCategory:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[]},t[a.createResponse]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},[4,r.then((function(e){n.m_settings.shouldFixSlideDataOrder&&n.fixSlideImageDataOrder(e),o={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return s.sent(),t[a.createResponse].end=e.performanceNowTrimmed(),[2,o]}}))}))()}},{key:"fixSlideImageDataOrder",value:function(e){e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.forEach((function(e){if(e&&e.ResourceData&&e.SlideShowInfo&&e.SlideShowInfo.sld){var r=new Map(e.ResourceData.map((function(e){return[e.Id,e.Base64]})));e.SlideShowInfo.sld.forEach((function(e){e.resCat.forEach((function(e){r.has(e.id)&&""===e.base64&&(e.base64=r.get(e.id))}))}))}}))}},{key:"createSlideIdResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:u.ErrorRESERVEDSuccess,responseErrorCategory:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"createPresInfoResponse",value:function(e){var r=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(n){switch(n.label){case 0:return t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:u.ErrorRESERVEDSuccess,responseErrorCategory:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0},[4,e.then((function(e){r.m_settings.shouldFixSlideDataOrder&&r.fixHiddenSlideOrder(e),t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return n.sent(),[2,t]}}))}))()}},{key:"fixHiddenSlideOrder",value:function(e){e.data.slideAllInfo[0].HiddenSlideOrder=e.data.slideAllInfo[0].HiddenSlideOrder?e.data.slideAllInfo[0].HiddenSlideOrder:[]}},{key:"createSlideOrderAndSlidesInfoIndexResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:c.ErrorRESERVEDSuccess,responseErrorCode:u.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"createPresInfoAndSlideInfoIndexResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:c.ErrorRESERVEDSuccess,responseErrorCode:u.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0].SlideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"setTimeoutForParsingResponse",value:function(e){return window.setTimeout((function(){v.sendTraceTag(508420380,f.msoulscat_Wac_PptSession,p.Warning,"Parsing didn't finish in the time. ".concat(JSON.stringify(e)))}),this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}},{key:"objectDictionaryToRequestIdString",value:function(e){var r="";for(var t in e)e[t]&&(r="".concat(r).concat(t,"=").concat(e[t],";"));return r}}],[{key:"getFieldFromReponseHeader",value:function(e,r){return e.headers?e.headers.get(r):a.unknown}},{key:"trimErrorName",value:function(e,r){for(var t=e,n=0;n<r.length;n+=1)t.lastIndexOf(r[n])>=0&&(t=t.substring(t.lastIndexOf(r[n])+r[n].length));return t?t.trim():""}},{key:"convertServerError",value:function(e,r){return r&&e&&""!==e.trim()&&e!==a.unknown?"Server".concat(e):u.ErrorRequestFailed}},{key:"logPerf",value:function(e){}},{key:"ensureISlideInfoFilters",value:function(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}},{key:"performanceNowTrimmed",value:function(){return Math.round(performance.now())}},{key:"logPerformanceEntries",value:function(e,r){var t=e.getEntriesByType("resource"),n={},o=!0,s=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;if("fetch"===c.initiatorType){var l=!1,d=!0,y=!1,_=void 0;try{for(var m,g=r[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var S=m.value;if(c.name.indexOf(S)>0||c.name.startsWith(S)){l=!0;break}}}catch(e){y=!0,_=e}finally{try{d||null==g.return||g.return()}finally{if(y)throw _}}if(l){if(n.name=c.name,n.dateTime=performance.now(),h.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){var I=new URL(c.name);n.hostname=I.hostname,n.pathname=I.pathname}n.start=c.startTime,n.redirectStart=c.redirectStart,n.redirectEnd=c.redirectEnd,n.domainLookupStart=c.domainLookupStart,n.domainLookupEnd=c.domainLookupEnd,n.tcpHandshakeStart=c.connectStart,n.tcpHandshakeEnd=c.connectEnd,n.secureConnectionStart=c.secureConnectionStart,n.responseStart=c.responseStart,n.responseEnd=c.responseEnd,n.fetchStart=c.fetchStart,n.requestStart=c.requestStart,"decodedBodySize"in c&&(n.decodedBodySize=c.decodedBodySize),"encodedBodySize"in c&&(n.encodedBodySize=c.encodedBodySize),"transferSize"in c&&(n.transferSize=c.transferSize),Object.keys(n).length>0&&v.sendTraceTag(572379986,f.msoulscat_Wac_PptSession,p.Info,"".concat(JSON.stringify(n)))}}}}catch(e){s=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(s)throw i}}}}]),e}();b.s_events=new m.EventEmitter,b.s_supportedImageType=[d.ImagePng,d.ImageJpg]}])}));