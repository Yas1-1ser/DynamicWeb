var StateServicePreviewerClient=function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){"use strict";var i,s,a,r,o,l;n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),function(e){e[e.Handshake=0]="Handshake",e[e.GetCurrentPosition=3]="GetCurrentPosition",e[e.OnPositionChanged=5]="OnPositionChanged",e[e.MediaEvent=8]="MediaEvent",e[e.OnExitSlideshow=23]="OnExitSlideshow",e[e.GoToPresenter=25]="GoToPresenter",e[e.AppReadyForPostMessage=28]="AppReadyForPostMessage",e[e.TogglePrivateViewing=47]="TogglePrivateViewing",e[e.OnSlideViewBoundsChanged=48]="OnSlideViewBoundsChanged",e[e.AnnotationEvent=53]="AnnotationEvent",e[e.BlankSlideState=54]="BlankSlideState",e[e.BootStageChanged=56]="BootStageChanged",e[e.RoleChangedOutbound=57]="RoleChangedOutbound",e[e.InitMediaSyncEvent=63]="InitMediaSyncEvent",e[e.AddinEventOutbound=70]="AddinEventOutbound",e[e.InitAddinSyncEvent=71]="InitAddinSyncEvent",e[e.OpticalZoomStateChanged=74]="OpticalZoomStateChanged",e[e.CameraStateChanged=76]="CameraStateChanged",e[e.SubtitlesStateChanged=78]="SubtitlesStateChanged"}(i||(i={})),function(e){e[e.GetCurrentPosition=3]="GetCurrentPosition",e[e.GoToSlide=9]="GoToSlide",e[e.SwitchRole=34]="SwitchRole",e[e.RecordMetrics=36]="RecordMetrics",e[e.SwitchRoleV2=45]="SwitchRoleV2",e[e.SetPrivateViewingToggle=47]="SetPrivateViewingToggle",e[e.AnnotationEvent=53]="AnnotationEvent",e[e.BlankSlideState=54]="BlankSlideState",e[e.SendiOSAuthTokenWithConfig=56]="SendiOSAuthTokenWithConfig",e[e.MediaEvent=59]="MediaEvent",e[e.AddinEventInbound=72]="AddinEventInbound",e[e.OpticalZoomStateChanged=74]="OpticalZoomStateChanged",e[e.CameraStateChanged=76]="CameraStateChanged",e[e.SubtitlesStateChanged=78]="SubtitlesStateChanged"}(s||(s={})),function(e){e[e.GetCurrentState=68]="GetCurrentState",e[e.OnStateChanged=69]="OnStateChanged"}(a||(a={})),function(e){e[e.GoToState=62]="GoToState",e[e.GetCurrentState=68]="GetCurrentState"}(r||(r={})),function(e){e[e.Attendee=0]="Attendee",e[e.Presenter=1]="Presenter",e[e.PrivateViewing=2]="PrivateViewing"}(o||(o={})),function(e){e.Ink="Ink",e.Nav="Nav",e.NavSync="NavSync",e.Media="Media",e.PresUrl="PresUrl",e.PrivateViewingToggleSync="PriViewToggle",e.LiveAppSync="LiveAppSync",e.AddinStateSync="AddinStateSync",e.OpticalZoomSync="OpticalZoomSync",e.BlankSlideState="BlankSlideState",e.Cameo="Cameo",e.Subtitles="Subtitles"}(l||(l={}))},function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),s(n(10),t),s(n(3),t),s(n(26),t)},function(e,t,n){"use strict";var i=n(11),s=Object.prototype.toString;function a(e){return"[object Array]"===s.call(e)}function r(e){return void 0===e}function o(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==s.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===s.call(e)}function h(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),a(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:a,isArrayBuffer:function(e){return"[object ArrayBuffer]"===s.call(e)},isBuffer:function(e){return null!==e&&!r(e)&&null!==e.constructor&&!r(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isPlainObject:l,isUndefined:r,isDate:function(e){return"[object Date]"===s.call(e)},isFile:function(e){return"[object File]"===s.call(e)},isBlob:function(e){return"[object Blob]"===s.call(e)},isFunction:c,isStream:function(e){return o(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:h,merge:function e(){var t={};function n(n,i){l(t[i])&&l(n)?t[i]=e(t[i],n):l(n)?t[i]=e({},n):a(n)?t[i]=n.slice():t[i]=n}for(var i=0,s=arguments.length;i<s;i++)h(arguments[i],n);return t},extend:function(e,t,n){return h(t,(function(t,s){e[s]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageTrackingOption=t.ConnectionState=t.ServiceGeneratedClientIdName=t.SystemCommandsStateName=t.ConfigurationName=t.SystemSessionStateName=t.StateSubscriptionsName=void 0,t.StateSubscriptionsName="ConfigStateSubscriptions",t.SystemSessionStateName="systemSessionState",t.ConfigurationName="config",t.SystemCommandsStateName="systemCommands",t.ServiceGeneratedClientIdName="serviceGeneratedClientId",function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting"}(t.ConnectionState||(t.ConnectionState={})),function(e){e[e.All=0]="All",e[e.Last=1]="Last",e[e.None=2]="None"}(t.MessageTrackingOption||(t.MessageTrackingOption={}))},function(e,t,n){var i=n(58),s=i.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function r(e,t,n){return s(e,t,n)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=i:(a(i,t),t.Buffer=r),a(s,r),r.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,n)},r.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=s(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},r.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},r.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){var i=n(4).Buffer;function s(e,t){this._block=i.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}s.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=i.from(e,t));for(var n=this._block,s=this._blockSize,a=e.length,r=this._len,o=0;o<a;){for(var l=r%s,c=Math.min(a-o,s-l),h=0;h<c;h++)n[l+h]=e[o+h];o+=c,(r+=c)%s==0&&this._update(n)}return this._len+=a,this},s.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var i=(4294967295&n)>>>0,s=(n-i)/4294967296;this._block.writeUInt32BE(s,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var a=this._hash();return e?a.toString(e):a},s.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=s},function(e,t,n){"use strict";var i,s="object"==typeof Reflect?Reflect:null,a=s&&"function"==typeof s.apply?s.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=s&&"function"==typeof s.ownKeys?s.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function s(){void 0!==a&&e.removeListener("error",a),n([].slice.call(arguments))}var a;"error"!==t&&(a=function(n){e.removeListener(t,s),i(n)},e.once("error",a)),e.once(t,s)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function h(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var s,a,r,o;if(c(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),r=a[t]),void 0===r)r=a[t]=n,++e._eventsCount;else if("function"==typeof r?r=a[t]=i?[n,r]:[r,n]:i?r.unshift(n):r.push(n),(s=h(e))>0&&r.length>s&&!r.warned){r.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=r.length,o=l,console&&console.warn&&console.warn(o)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function m(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},s=u.bind(i);return s.listener=n,i.wrapFn=s,s}function g(e,t,n){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"==typeof s?n?[s.listener||s]:[s]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(s):p(s,s.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return h(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var o=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw o.context=r,o}var l=s[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var c=l.length,h=p(l,c);for(n=0;n<c;++n)a(h[n],this,t)}return!0},o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return c(t),this.on(e,m(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,m(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,s,a,r;if(c(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){r=n[a].listener,s=a;break}if(s<0)return this;0===s?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,s),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,r||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var s,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(s=a[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return g(this,e,!0)},o.prototype.rawListeners=function(e){return g(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){"use strict";(function(t){var i=n(2),s=n(35),a=n(13),r={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var l,c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(l=n(14)),l),transformRequest:[function(e,t){return s(t,"Accept"),s(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(o(t,"application/json"),function(e,t,n){if(i.isString(e))try{return(0,JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,r=!n&&"json"===this.responseType;if(r||s&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(r){if("SyntaxError"===e.name)throw a(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){c.headers[e]=i.merge(r)})),e.exports=c}).call(this,n(34))},function(e,t,n){var i=n(48),s=n(49),a=s;a.v1=i,a.v4=s,e.exports=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info"}(t.TraceLevel||(t.TraceLevel={}))},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},function(e,t,n){"use strict";var i=n(2);function s(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var a;if(n)a=n(t);else if(i.isURLSearchParams(t))a=t.toString();else{var r=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),r.push(s(t)+"="+s(e))})))})),a=r.join("&")}if(a){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}},function(e,t,n){"use strict";e.exports=function(e,t,n,i,s){return e.config=t,n&&(e.code=n),e.request=i,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var i=n(2),s=n(36),a=n(37),r=n(12),o=n(38),l=n(41),c=n(42),h=n(15);e.exports=function(e){return new Promise((function(t,n){var d=e.data,u=e.headers,m=e.responseType;i.isFormData(d)&&delete u["Content-Type"];var g=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",p=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";u.Authorization="Basic "+btoa(f+":"+p)}var _=o(e.baseURL,e.url);function S(){if(g){var i="getAllResponseHeaders"in g?l(g.getAllResponseHeaders()):null,a={data:m&&"text"!==m&&"json"!==m?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:i,config:e,request:g};s(t,n,a),g=null}}if(g.open(e.method.toUpperCase(),r(_,e.params,e.paramsSerializer),!0),g.timeout=e.timeout,"onloadend"in g?g.onloadend=S:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(S)},g.onabort=function(){g&&(n(h("Request aborted",e,"ECONNABORTED",g)),g=null)},g.onerror=function(){n(h("Network Error",e,null,g)),g=null},g.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(h(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",g)),g=null},i.isStandardBrowserEnv()){var v=(e.withCredentials||c(_))&&e.xsrfCookieName?a.read(e.xsrfCookieName):void 0;v&&(u[e.xsrfHeaderName]=v)}"setRequestHeader"in g&&i.forEach(u,(function(e,t){void 0===d&&"content-type"===t.toLowerCase()?delete u[t]:g.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(g.withCredentials=!!e.withCredentials),m&&"json"!==m&&(g.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&g.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&g.upload&&g.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){g&&(g.abort(),n(e),g=null)})),d||(d=null),g.send(d)}))}},function(e,t,n){"use strict";var i=n(13);e.exports=function(e,t,n,s,a){var r=new Error(e);return i(r,t,n,s,a)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var i=n(2);e.exports=function(e,t){t=t||{};var n={},s=["url","method","data"],a=["headers","auth","proxy","params"],r=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function l(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function c(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=l(void 0,e[s])):n[s]=l(e[s],t[s])}i.forEach(s,(function(e){i.isUndefined(t[e])||(n[e]=l(void 0,t[e]))})),i.forEach(a,c),i.forEach(r,(function(s){i.isUndefined(t[s])?i.isUndefined(e[s])||(n[s]=l(void 0,e[s])):n[s]=l(void 0,t[s])})),i.forEach(o,(function(i){i in t?n[i]=l(e[i],t[i]):i in e&&(n[i]=l(void 0,e[i]))}));var h=s.concat(a).concat(r).concat(o),d=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===h.indexOf(e)}));return i.forEach(d,c),n}},function(e,t,n){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var s=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),s[t]=e>>>((3&t)<<3)&255;return s}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,s=n;return[s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],"-",s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]],s[e[i++]]].join("")}},function(e,t,n){var i=n(5),s=n(6),a=n(4).Buffer,r=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function l(){this.init(),this._w=o,s.call(this,64,56)}function c(e,t,n){return n^e&(t^n)}function h(e,t,n){return e&t|n&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function u(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function m(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}i(l,s),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,n=this._w,i=0|this._a,s=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,g=0|this._f,f=0|this._g,p=0|this._h,_=0;_<16;++_)n[_]=e.readInt32BE(4*_);for(;_<64;++_)n[_]=0|(((t=n[_-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[_-7]+m(n[_-15])+n[_-16];for(var S=0;S<64;++S){var v=p+u(l)+c(l,g,f)+r[S]+n[S]|0,y=d(i)+h(i,s,a)|0;p=f,f=g,g=l,l=o+v|0,o=a,a=s,s=i,i=v+y|0}this._a=i+this._a|0,this._b=s+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0,this._f=g+this._f|0,this._g=f+this._g|0,this._h=p+this._h|0},l.prototype._hash=function(){var e=a.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},function(e,t,n){var i=n(5),s=n(6),a=n(4).Buffer,r=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function l(){this.init(),this._w=o,s.call(this,128,112)}function c(e,t,n){return n^e&(t^n)}function h(e,t,n){return e&t|n&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function u(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function m(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function g(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function f(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function p(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function _(e,t){return e>>>0<t>>>0?1:0}i(l,s),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,n=0|this._ah,i=0|this._bh,s=0|this._ch,a=0|this._dh,o=0|this._eh,l=0|this._fh,S=0|this._gh,v=0|this._hh,y=0|this._al,C=0|this._bl,I=0|this._cl,b=0|this._dl,T=0|this._el,w=0|this._fl,M=0|this._gl,P=0|this._hl,A=0;A<32;A+=2)t[A]=e.readInt32BE(4*A),t[A+1]=e.readInt32BE(4*A+4);for(;A<160;A+=2){var E=t[A-30],L=t[A-30+1],k=m(E,L),O=g(L,E),x=f(E=t[A-4],L=t[A-4+1]),R=p(L,E),N=t[A-14],U=t[A-14+1],D=t[A-32],W=t[A-32+1],B=O+U|0,j=k+N+_(B,O)|0;j=(j=j+x+_(B=B+R|0,R)|0)+D+_(B=B+W|0,W)|0,t[A]=j,t[A+1]=B}for(var F=0;F<160;F+=2){j=t[F],B=t[F+1];var V=h(n,i,s),J=h(y,C,I),$=d(n,y),Z=d(y,n),G=u(o,T),H=u(T,o),Y=r[F],z=r[F+1],q=c(o,l,S),K=c(T,w,M),X=P+H|0,Q=v+G+_(X,P)|0;Q=(Q=(Q=Q+q+_(X=X+K|0,K)|0)+Y+_(X=X+z|0,z)|0)+j+_(X=X+B|0,B)|0;var ee=Z+J|0,te=$+V+_(ee,Z)|0;v=S,P=M,S=l,M=w,l=o,w=T,o=a+Q+_(T=b+X|0,b)|0,a=s,b=I,s=i,I=C,i=n,C=y,n=Q+te+_(y=X+ee|0,X)|0}this._al=this._al+y|0,this._bl=this._bl+C|0,this._cl=this._cl+I|0,this._dl=this._dl+b|0,this._el=this._el+T|0,this._fl=this._fl+w|0,this._gl=this._gl+M|0,this._hl=this._hl+P|0,this._ah=this._ah+n+_(this._al,y)|0,this._bh=this._bh+i+_(this._bl,C)|0,this._ch=this._ch+s+_(this._cl,I)|0,this._dh=this._dh+a+_(this._dl,b)|0,this._eh=this._eh+o+_(this._el,T)|0,this._fh=this._fh+l+_(this._fl,w)|0,this._gh=this._gh+S+_(this._gl,M)|0,this._hh=this._hh+v+_(this._hl,P)|0},l.prototype._hash=function(){var e=a.allocUnsafe(64);function t(t,n,i){e.writeInt32BE(t,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},function(e,t,n){"use strict";n.d(t,"b",(function(){return L})),n.d(t,"a",(function(){return k}));var i,s,a=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout"}(s||(s={})),function(){function e(){}e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,n,i){return"tag_"+e.tagIntToString(t)+" ["+s[n]+"] "+i},e.prototype.sendTraceTag=function(t,n,s,a){var r=this.logMessage;switch(s){case i.Error:r=this.logError;break;case i.Warning:r=this.logWarning;break;case i.Info:r=this.logInfo;break;case i.Verbose:r=this.logVerbose;break;case i.Spam:default:r=this.logMessage}try{r(e.getLogMessage(t,n,a))}catch(e){var o="undefined"!=typeof navigator?navigator:void 0;if(o&&!/rv:11.0/i.test(o.userAgent))throw e}},e.prototype.shipAssertTag=function(t,n,i,s){console.assert(i,e.getLogMessage(t,n,s))},e.prototype.debugAssertTag=function(e,t,n,i){this.shipAssertTag(e,t,n,i)},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789"}();var r,o=new(function(){function e(){this.externalLogger=new a}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,i){this.externalLogger.sendTraceTag(e,t,n,i)},e.prototype.debugAssertTag=function(e,t,n,i){this.externalLogger.debugAssertTag(e,t,n,i)},e.prototype.shipAssertTag=function(e,t,n,i){this.externalLogger.shipAssertTag(e,t,n,i)},e}());!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(r||(r={})),function(){function e(t,n){var i=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){i.triggerUpload(!1,!1)},this.flush=function(){i.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return i.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,n){window.clearTimeout(i.timeoutId),i.logCache.length>0&&(i.uploadId+=1,function(e,t,n){if(""!==t)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(t,e);else{var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,n),i.send(e))}}(function(e,t,n,i){var s=e.map((function(e){return function(e,t){var n={};n.G=e.tag,n.T=e.timestamp-t,n.M=e.message,n.C=e.category;var i=1e3*e.type+e.level;return n.D=i,n}(e,i)})),a=function(e,t,n,i){var s={};return s.T=e,s.L=t,s.S=n,s.I=i,s.V=1,s}(i,s,t,n);return JSON.stringify(a)}(i.logCache,i.userSessionId,i.uploadId,i.timestampBase),i.remoteUrlEndpoint,n),i.logCache=[],i.timestampBase=Date.now()),t&&(i.timeoutId=window.setTimeout(i.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=n+"?usid="+t,window.setTimeout((function(){return i.triggerUpload(!0,!0)}),0)}e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===i.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]"}(),i.Info;var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};!function(e){!function(e,t){function n(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}((function(){return null!==e&&e.apply(this,arguments)||this}),e)}(a);var c,h=n(1),d=n(7),u=n(24),m=n(0);!function(e){e.ReceiveMessageFromViewer="State_Notified",e.SendMessageToViewer="State_Local"}(c||(c={}));class g{static addTimestamp(e,t){return g.addMetadataEntry(e,t,Date.now())}static addSenderId(e,t){return t?g.addMetadataEntry(e,"senderId",t):e}static addCachedFlag(e){return g.addMetadataEntry(e,"fCached",!0)}static addMetadataEntry(e,t,n){return e?(e[t]=n,e):{key:n}}}class f{constructor(){this._currentTag=0}tagOutbound(e){e.metadata&&f.isTaggable(e.objectId)&&(this._currentTag+=1,e.metadata.StateServiceClientTag=this._currentTag.toString())}static isTaggable(e){return"navigationState"===e||"mediaState"===e||"dryInk"===e}validateInbound(e,t,n){try{if(!t&&e.metadata&&e.metadata.StateServiceClientTag){if(!e.senderId||"system"===e.senderId)return this._lastSenderId=e.senderId,void o.sendTraceTag(526946849,s.msoulscat_Wac_PptLive,h.TraceLevel.Info,"StateServiceClientTagManager::validateInbound not tracking message since sender is "+e.senderId);const i=Number(e.metadata.StateServiceClientTag);if(e.senderId!==this._lastSenderId)return o.sendTraceTag(526946850,s.msoulscat_Wac_PptLive,h.TraceLevel.Info,`StateServiceClientTagManager::validateInbound presenter changed from ${this._lastSenderId} to ${e.senderId}; reset currentTag to messageTag:${i}.`),this._lastSenderId=e.senderId,void(this._currentTag=i);this._lastReceivedTypes+=`${e.objectId}-${i};`,i!==this._currentTag+1?(o.sendTraceTag(526946851,s.msoulscat_Wac_PptLive,h.TraceLevel.Info,`StateServiceClientTagManager::validateInbound failed, type:${e.objectId} messageTag:${i}, currentTag:${this._currentTag}; isPresenter:${t}; sender:${e.senderId}; id:${e.messageId}; lastReceivedTypes: ${this._lastReceivedTypes}`),n&&n.recordQosError("SyncPipelineOutOfOrderEvents",["SharingOutOfOrderEvents"],!1,!0,!1,!1)):this._currentTag%5==0&&(o.sendTraceTag(526946880,s.msoulscat_Wac_PptLive,h.TraceLevel.Info,"StateServiceClientTagManager::validateInbound past 5 messages were sent in order: "+this._lastReceivedTypes),this._lastReceivedTypes=""),this._currentTag=i}}catch(e){o.sendTraceTag(526946881,s.msoulscat_Wac_PptLive,h.TraceLevel.Warning,"StateServiceClientTagManager::validateInbound exception "+e)}}}const p=new Map([['"color":{"r":227,"g":24,"b":45,"a":1}',"Pen_Red"],['"color":{"r":254,"g":212,"b":48,"a":1}',"Pen_DarkYellow"],['"color":{"r":251,"g":174,"b":23,"a":1}',"Pen_LightOrange"],['"color":{"r":243,"g":99,"b":35,"a":1}',"Pen_Orange"],['"color":{"r":91,"g":49,"b":141,"a":1}',"Pen_DarkPurple"],['"color":{"r":145,"g":75,"b":184,"a":1}',"Pen_Purple"],['"color":{"r":207,"g":18,"b":120,"a":1}',"Pen_Magenta"],['"color":{"r":193,"g":0,"b":81,"a":1}',"Pen_DarkRed"],['"color":{"r":62,"g":204,"b":253,"a":1}',"Pen_LightBlue"],['"color":{"r":0,"g":120,"b":215,"a":1}',"Pen_Blue"],['"color":{"r":126,"g":196,"b":0,"a":1}',"Pen_LightGreen"],['"color":{"r":0,"g":180,"b":75,"a":1}',"Pen_Green"],['"color":{"r":235,"g":235,"b":235,"a":1}',"Pen_LightGray"],['"color":{"r":182,"g":182,"b":182,"a":1}',"Pen_Gray"],['"color":{"r":31,"g":31,"b":31,"a":1}',"Pen_Black"],['"color":{"r":255,"g":78,"b":0,"a":1}',"Pen_Rainbow"],['"color":{"r":174,"g":25,"b":141,"a":1}',"Pen_Galaxy"],['"color":{"r":255,"g":252,"b":0,"a":0.5}',"Highlighter_Yellow"],['"color":{"r":253,"g":132,"b":45,"a":0.5}',"Highlighter_Orange"],['"color":{"r":235,"g":23,"b":80,"a":0.5}',"Highlighter_Red"],['"color":{"r":253,"g":76,"b":252,"a":0.5}',"Highlighter_Pink"],['"color":{"r":40,"g":246,"b":45,"a":0.5}',"Highlighter_LightGreen"],['"color":{"r":26,"g":177,"b":80,"a":0.5}',"Highlighter_Green"],['"color":{"r":162,"g":212,"b":105,"a":0.5}',"Highlighter_FadedGreen"],['"color":{"r":215,"g":175,"b":253,"a":0.5}',"Highlighter_Purple"],['"color":{"r":44,"g":252,"b":254,"a":0.5}',"Highlighter_LightBlue"],['"color":{"r":14,"g":106,"b":172,"a":0.5}',"Highlighter_Blue"],['"color":{"r":170,"g":216,"b":253,"a":0.5}',"Highlighter_FadedBlue"],['"color":{"r":253,"g":172,"b":212,"a":0.5}',"Highlighter_FadedRed"],['"color":{"r":245,"g":245,"b":245,"a":0.5}',"Highlighter_LightGray"],['"color":{"r":149,"g":149,"b":149,"a":0.5}',"Highlighter_Gray"],['"color":{"r":31,"g":31,"b":31,"a":0.5}',"Highlighter_Black"]]),_=new Map([['"color":{"r":227,"g":24,"b":45,"a":1}',"Laser_Red"],['"color":{"r":253,"g":76,"b":252,"a":1}',"Laser_Pink"],['"color":{"r":253,"g":132,"b":45,"a":1}',"Laser_LightOrange"],['"color":{"r":255,"g":252,"b":0,"a":1}',"Laser_Yellow"],['"color":{"r":162,"g":212,"b":105,"a":1}',"Laser_LightGreen"],['"color":{"r":14,"g":106,"b":172,"a":1}',"Laser_LightBlue"]]),S=new Map([['"width":1,"height":1,',"Pen_Thickness_1"],['"width":2,"height":2,',"Pen_Thickness_2"],['"width":4,"height":4,',"Pen_Thickness_3"],['"width":6,"height":6,',"Pen_Thickness_4"],['"width":8,"height":8,',"Pen_Thickness_5"],['"width":12,"height":12,',"Pen_Thickness_6"],['"width":2,"height":8,',"Highlighter_Thickness_1"],['"width":3,"height":12,',"Highlighter_Thickness_2"],['"width":4,"height":16,',"Highlighter_Thickness_3"],['"width":6,"height":24,',"Highlighter_Thickness_4"],['"width":7,"height":28,',"Highlighter_Thickness_5"],['"width":8,"height":32,',"Highlighter_Thickness_6"]]);class v{constructor(){this._annotationInited=!1,this._invalidSlideId="-1",this._invalidDefaultZoomXYValue=-1,this._invalidOffSetXYValue=1,this._invalidScaleValue=0,this._invalidCursorPositionXYValue=-1,this._invalidAttributeValue=-1,this._invalidEphemeralValue=!1,this._invalidCursorPosition={slideId:this._invalidSlideId,x:this._invalidCursorPositionXYValue,y:this._invalidCursorPositionXYValue},this._invalidLaserColor={r:this._invalidAttributeValue,g:this._invalidAttributeValue,b:this._invalidAttributeValue,a:this._invalidAttributeValue},this._invalidLaserAttributes={width:this._invalidAttributeValue,height:this._invalidAttributeValue,color:this._invalidLaserColor},this._invalidLaserPointerAttributes={ephemeral:this._invalidEphemeralValue,tailLength:this._invalidAttributeValue},this._invalidLaserAllAttributes={laserAttributes:this._invalidLaserAttributes,laserPointerAttributes:this._invalidLaserPointerAttributes},this._invalidZoomState={slideId:this._invalidSlideId,defaultZoomX:this._invalidDefaultZoomXYValue,defaultZoomY:this._invalidDefaultZoomXYValue,offSetX:this._invalidOffSetXYValue,offSetY:this._invalidOffSetXYValue,scale:this._invalidScaleValue},this._annotationCursorPosition=this._invalidCursorPosition,this._annotationZoomState=this._invalidZoomState,this._annotationLaserAllAttributes=this._invalidLaserAllAttributes,this.isLaserColorNotReceivedWithLaserStartEvent=!0,this.isLaserColorNotSendWithLaserStartEvent=!0,this.isPostMessageReadyCompleted=!1,this.numSemiDryInkSent=0,this.numSemiDryInkReceived=0,this.numSemiDryInkFromSnapshot=0,this.numDeleteSemiDryInkSent=0,this.numDeleteSemiDryInkReceived=0,this.numLaserStrokeSent=0,this.numLaserStrokeReceived=0,this.numAnnotationHandled=0,this.annotationInfo={},this.previousLaserColor="",this.isLaserMovedAfterStart=!1,this.previousLaserType=void 0,this.shortTailLaserSlideMap=[],this.snapshotLoadedBy="NA"}static getLoggableFeatureName(){return"Annotation"}initialize(e){return this._stateServiceClient=e,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._stateServiceClient.on("postMessageReady",()=>this.onPostMessageReady()),this._stateServiceClient.on("close",()=>this.close()),this.initAnnotationStateMapsAndCell()}getSessionTelemetry(){return{SemiDryInkSent:this.numSemiDryInkSent.toString(),SemiDryInkReceived:this.numSemiDryInkReceived.toString(),SemiDryInkFromSnapshot:this.numSemiDryInkFromSnapshot.toString(),DeleteSemiDryInkSent:this.numDeleteSemiDryInkSent.toString(),DeleteSemiDryInkReceived:this.numDeleteSemiDryInkReceived.toString(),LaserStrokeSent:this.numLaserStrokeSent.toString(),LaserStrokeReceived:this.numLaserStrokeReceived.toString(),AnnotationHandled:this.numAnnotationHandled.toString(),SnapshotLoadedBy:this.snapshotLoadedBy,AnnotationInfo:this.annotationInfo}}onMessage(e){if(e.m_type===m.d.AnnotationEvent&&this._stateServiceClient.isPresenter())switch(e.m_annotationEventType){case 10:this.annotationInited=!0;break;case 12:this.annotationCursorPosition=JSON.parse(e.m_annotationEventJson);break;case 13:this.annotationCursorPosition={slideId:e.m_annotationSlideID,x:this._invalidCursorPositionXYValue,y:this._invalidCursorPositionXYValue};break;case 3:case 4:case 5:case 14:case 15:e.m_annotationSlideID&&e.m_annotationStrokeID&&(e.m_annotationEventJson||15===e.m_annotationEventType)&&this.setWetInkMap(e.m_annotationEventType,e.m_annotationSlideID,e.m_annotationStrokeID,e.m_annotationEventJson,e.m_metadata);break;case 6:case 7:case 8:case 9:e.m_annotationSlideID&&e.m_annotationStrokeID&&this.setLaserMap(e.m_annotationEventType,e.m_annotationSlideID,e.m_annotationStrokeID,e.m_annotationEventJson,e.m_metadata);break;case 0:e.m_annotationSlideID&&e.m_annotationStrokeID&&e.m_annotationEventJson&&this.setSemiDryInkMap(e.m_annotationSlideID,e.m_annotationStrokeID,e.m_annotationEventJson,e.m_metadata);break;case 1:e.m_annotationSlideID&&e.m_annotationStrokeID&&this.deleteFromSemiDryInkMap(e.m_annotationSlideID,e.m_annotationStrokeID);break;case 2:e.m_annotationSlideID&&this.deleteFromSemiDryInkMap(e.m_annotationSlideID);break;case 16:this.annotationZoomState=JSON.parse(e.m_annotationEventJson)}}onPostMessageReady(){let e=this.getSemiDryInkSnapshotMap(),t=this.getWetInkSnapshotMap();e||t&&t.length>=1&&t[0].strokes.length>=1?this.handleAnnotationEvents(11,void 0,t?t[0].slideID:void 0,t?t[0].strokes[0].strokeID:void 0,void 0,e,t?t[0].strokes[0].startPointJson:void 0,t?t[0].strokes[0].appendPointJsons:void 0):this._annotationInited&&this.handleAnnotationEvents(10,void 0),this.isValidZoomState(this._annotationZoomState)&&this.handleAnnotationEvents(16,void 0,this._annotationZoomState.slideId,void 0,JSON.stringify(this._annotationZoomState)),this.isPostMessageReadyCompleted=!0}close(){this.numSemiDryInkSent=0,this.numSemiDryInkReceived=0,this.numSemiDryInkFromSnapshot=0,this.numDeleteSemiDryInkSent=0,this.numDeleteSemiDryInkReceived=0,this.numLaserStrokeSent=0,this.numLaserStrokeReceived=0,this.numAnnotationHandled=0,this.annotationInfo={},this.shortTailLaserSlideMap=[],this.snapshotLoadedBy="NA",this.previousLaserColor="",this.previousLaserType=void 0,this._annotationInitedCell&&(this._annotationInitedCell.removeAllListeners("valueChanged"),this._annotationInitedCell.removeAllListeners("valueUnacknowledged")),this._semiDryInkMap&&(this._semiDryInkMap.removeAllListeners("valueChanged"),this._semiDryInkMap.removeAllListeners("valueDeleted"),this._semiDryInkMap.removeAllListeners("valueUnacknowledged")),this._wetInkMap&&(this._wetInkMap.removeAllListeners("valueChanged"),this._wetInkMap.removeAllListeners("valueUnacknowledged")),this._laserMap&&(this._laserMap.removeAllListeners("valueChanged"),this._laserMap.removeAllListeners("valueUnacknowledged")),this._annotationCursorPositionCell&&(this._annotationCursorPositionCell.removeAllListeners("valueChanged"),this._annotationCursorPositionCell.removeAllListeners("valueUnacknowledged")),this._annotationZoomStateCell&&(this._annotationZoomStateCell.removeAllListeners("valueChanged"),this._annotationZoomStateCell.removeAllListeners("valueUnacknowledged")),this._annotationLaserAllAttributesCell&&(this._annotationLaserAllAttributesCell.removeAllListeners("valueChanged"),this._annotationLaserAllAttributesCell.removeAllListeners("valueUnacknowledged"))}async initAnnotationStateMapsAndCell(){this._semiDryInkMap=await this._stateServiceClient.initMap("dryInk",this.onInitSemiDryInkMap.bind(this),!1,h.MessageTrackingOption.All),this._semiDryInkMap.on("valueChanged",this.onSemiDryInkChanged.bind(this)),this._semiDryInkMap.on("valueDeleted",this.onSemiDryInkDeleted.bind(this)),this._semiDryInkMap.on("valuesDeletedWithPrefix",this.onSemiDryInkDeletedWithProfix.bind(this)),this._semiDryInkMap.on("valueUnacknowledged",(e,t)=>this.onValueUnacknowledged(t)),this._wetInkMap=await this._stateServiceClient.initMap("wetInk",e=>this._wetInk=e,!1,h.MessageTrackingOption.All),this._wetInkMap.on("valueChanged",this.onWetInkChanged.bind(this)),this._wetInkMap.on("valueUnacknowledged",(e,t)=>this.onValueUnacknowledged(t)),this._laserMap=await this._stateServiceClient.initMap("laser",e=>this._laser=e,!1,h.MessageTrackingOption.All),this._laserMap.on("valueChanged",this.onLaserChange.bind(this)),this._laserMap.on("valueUnacknowledged",(e,t)=>this.onValueUnacknowledged(t)),this._annotationInitedCell=await this._stateServiceClient.initCell("annotationInited",e=>this._annotationInited=e,!1,h.MessageTrackingOption.All),this._annotationInitedCell.on("valueChanged",this.onAnnotationInitedChanged.bind(this)),this._annotationInitedCell.on("valueUnacknowledged",(e,t)=>this.onValueUnacknowledged(t)),this._annotationCursorPositionCell=await this._stateServiceClient.initCell("cursorChange",e=>this._annotationCursorPosition=e,!1,h.MessageTrackingOption.All),this._annotationCursorPositionCell.on("valueChanged",this.onAnnotationCursorPosChanged.bind(this)),this._annotationCursorPositionCell.on("valueUnacknowledged",(e,t)=>this.onValueUnacknowledged(t)),this._annotationZoomStateCell=await this._stateServiceClient.initCell("zoomChange",e=>this._annotationZoomState=e,!1,h.MessageTrackingOption.All),this._annotationZoomStateCell.on("valueChanged",this.onAnnotationZoomStateChanged.bind(this)),this._annotationZoomStateCell.on("valueUnacknowledged",(e,t)=>this.onValueUnacknowledged(t)),this._annotationLaserAllAttributesCell=await this._stateServiceClient.initCell("laserColorChange",e=>this._annotationLaserAllAttributes=e,!1,h.MessageTrackingOption.All),this._annotationLaserAllAttributesCell.on("valueChanged",this.onAnnotationLaserAttributeChange.bind(this)),this._annotationLaserAllAttributesCell.on("valueUnacknowledged",(e,t)=>this.onValueUnacknowledged(t))}getSemiDryInkSnapshotMap(){if(this._semiDryInk&&this._semiDryInk.size>0){let e=[];return this._semiDryInk.forEach((t,n)=>{let i=this.decodeAnnotationKey(n);if(void 0!==i&&i.StrokeID){let n=i.SlideID,s=i.StrokeID;this.logSemiDryInkFromSnapshotInfo(s,n);let a=!1;e.forEach(e=>{e.slideID===n&&(e.strokes.push({strokeID:s,strokeJson:t.eventJson}),a=!0)}),a||e.push({slideID:n,strokes:[{strokeID:s,strokeJson:t.eventJson}]})}}),this.snapshotLoadedBy=this._stateServiceClient.isPresenter()?"Presenter":"Attendee",e}}getWetInkSnapshotMap(){}async onAnnotationInitedChanged(e,t){!this._stateServiceClient.isLocalChange(t.senderId)&&this._annotationInited!==e&&e&&(this._annotationInited=e,this.handleAnnotationEvents(10,t.senderId))}set annotationInited(e){this._annotationInited!==e&&e&&(this._annotationInited=e,this._annotationInitedCell&&this._annotationInitedCell.setAsync(e))}async onAnnotationCursorPosChanged(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&e.slideId!==this._invalidSlideId){this._annotationCursorPosition=e;const n=this._annotationCursorPosition.x===this._invalidCursorPositionXYValue&&this._annotationCursorPosition.y===this._invalidCursorPositionXYValue;this.handleAnnotationEvents(n?13:12,t.senderId,n?e.slideId:void 0,void 0,n?void 0:JSON.stringify(e))}}set annotationCursorPosition(e){e.slideId!==this._invalidSlideId&&(this._annotationCursorPosition=e,this._annotationCursorPositionCell&&this._annotationCursorPositionCell.setAsync(e))}async onAnnotationZoomStateChanged(e,t){!this._stateServiceClient.isLocalChange(t.senderId)&&this.isValidZoomState(e)&&(this._annotationZoomState=e,this.handleAnnotationEvents(16,t.senderId,e.slideId,void 0,JSON.stringify(e)))}async onAnnotationLaserAttributeChange(e){this.isValidLaserAllAttributes(e)&&(this._annotationLaserAllAttributes=e)}set annotationZoomState(e){this.isValidZoomState(e)&&(this._annotationZoomState=e,this._annotationZoomStateCell&&this._annotationZoomStateCell.setAsync(e))}set annotationLaserAllAttributes(e){this.isValidLaserAllAttributes(e)&&(this._annotationLaserAllAttributes=e,this._annotationLaserAllAttributesCell&&this._annotationLaserAllAttributesCell.setAsync(e))}isValidLaserAllAttributes(e){return void 0!==e&&this.isValidLaserAttributes(e.laserAttributes)&&this.isValidLaserPointerAttributes(e.laserPointerAttributes)}isValidLaserAttributes(e){return void 0!==e&&void 0!==e.width&&e.width!==this._invalidLaserAttributes.width&&void 0!==e.height&&e.height!==this._invalidLaserAttributes.height&&void 0!==e.color&&e.color.r!==this._invalidLaserAttributes.color.r&&e.color.g!==this._invalidLaserAttributes.color.g&&e.color.b!==this._invalidLaserAttributes.color.b&&e.color.a!==this._invalidLaserAttributes.color.a}isValidLaserPointerAttributes(e){return void 0!==e}isValidZoomState(e){return e.slideId!==this._invalidSlideId&&e.scale>=1&&e.offSetX<=0&&e.offSetY<=0&&e.defaultZoomX>0&&e.defaultZoomY>0}setSemiDryInkMap(e,t,n,i){if(this._semiDryInkMap&&this._semiDryInk&&e&&t&&n){let s=this.encodeAnnotationKey(e,t);if(void 0!==s){let e={eventType:0,eventJson:n,metadata:i};this._semiDryInkMap.set(s,e),this._semiDryInk.set(s,{eventType:0,eventJson:n,metadata:i}),this.logSemiDryInkSentInfo(n)}}}async onSemiDryInkDeleted(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&this._semiDryInk&&this._semiDryInk.has(e)){this._semiDryInk.delete(e);let n=this.decodeAnnotationKey(e);if(void 0!==n&&n.StrokeID){let e=n.SlideID,i=n.StrokeID;this.handleAnnotationEvents(1,t.senderId,e,i),this.numDeleteSemiDryInkReceived+=1}}}async onSemiDryInkDeletedWithProfix(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&this._semiDryInk){this._semiDryInk.forEach((t,n)=>{n.startsWith(e)&&this._semiDryInk&&(this._semiDryInk.delete(n),this.numDeleteSemiDryInkReceived+=1)});let n=this.decodeAnnotationKey(e);if(void 0!==n){let e=n.SlideID;this.handleAnnotationEvents(2,t.senderId,e)}}}onInitSemiDryInkMap(e){void 0===this._semiDryInk&&(this._semiDryInk=new Map),e.forEach((e,t)=>{let n={eventType:0,eventJson:e&&void 0!==e.eventJson?e.eventJson:e,metadata:e&&e.metadata?e.metadata:void 0};void 0!==this._semiDryInk&&this._semiDryInk.set(t,n)})}logSemiDryInkType(e,t){e.includes('"tip":"ellipse","rasterOperation":"copy"')?this.incrementMessageCount(t,"Pen"):e.includes('"tip":"rectangle","rasterOperation":"mask"')?this.incrementMessageCount(t,"Highlighter"):o.sendTraceTag(556298390,s.msoulscat_Wac_PptLive,i.Error,"logSemiDryInkType: unknown semi dry ink: "+e)}logSemiDryInkColor(e,t){const n=e.match('"color":{"r":[0-9]+,"g":[0-9]+,"b":[0-9]+,"a":[.0-9]+}');if(n){const e=p.get(n[0].toString());e?this.incrementMessageCount(t,e):o.sendTraceTag(556298391,s.msoulscat_Wac_PptLive,i.Error,"logSemiDryInkColor: unknown semi dry ink color: "+n)}else o.sendTraceTag(556282467,s.msoulscat_Wac_PptLive,i.Error,"logSemiDryInkColor: can't find the color info from the Json string: "+e)}getLaserPointerColor(e){if(e.includes("color")){const t=e.match('"color":{"r":[0-9]+,"g":[0-9]+,"b":[0-9]+,"a":[.0-9]+}');if(t){const e=_.get(t[0].toString());e?this.previousLaserColor=e:o.sendTraceTag(556298392,s.msoulscat_Wac_PptLive,i.Error,"getLaserPointerColor: unknown laser pointer color: "+t)}else o.sendTraceTag(556282496,s.msoulscat_Wac_PptLive,i.Error,"getLaserPointerColor: can't find the color info from the Json string: "+e)}}logLaserPointerColor(e){""!==this.previousLaserColor?this.incrementMessageCount(e,this.previousLaserColor):o.sendTraceTag(556298393,s.msoulscat_Wac_PptLive,i.Error,"logLaserPointerColor: no previous laser pointer color.")}logSemiDryInkThickness(e,t){const n=e.match('"width":[1-9]+,"height":[1-9]+,');if(n){const e=S.get(n[0].toString());e?this.incrementMessageCount(t,e):o.sendTraceTag(556298394,s.msoulscat_Wac_PptLive,i.Error,"logSemiDryInkThickness: unknown semi dry ink thickness: "+n)}else o.sendTraceTag(556282497,s.msoulscat_Wac_PptLive,i.Error,"logSemiDryInkThickness: can't find the thick info from the Json string: "+e)}incrementMessageCount(e,t,n){const i=e[t],s=void 0===i?1:i+1;e[t]=void 0===n?s:Math.min(n,s)}logSemiDryInkSentInfo(e){this.numSemiDryInkSent+=1,this.logSemiDryInkType(e,this.annotationInfo),this.logSemiDryInkColor(e,this.annotationInfo),this.logSemiDryInkThickness(e,this.annotationInfo)}logSemiDryInkReceiveInfo(e,t){this.numSemiDryInkReceived+=1,o.sendTraceTag(537478150,s.msoulscat_Wac_PptLive,i.Info,`logSemiDryInkSentInfo: semi dry ink ${e} on slide ${t}`)}logSemiDryInkFromSnapshotInfo(e,t){this.numSemiDryInkFromSnapshot+=1,o.sendTraceTag(537478151,s.msoulscat_Wac_PptLive,i.Info,`logSemiDryInkFromSnapshotInfo: semi dry ink ${e} on slide ${t}`)}logLaserPointerSendInfo(e,t,n){switch(e){case 6:this.getLaserPointerColor(n),this.previousLaserType=e,this.isLaserMovedAfterStart=!1;break;case 7:this.getLaserPointerColor(n),6===this.previousLaserType?this.isLaserMovedAfterStart=!0:this.shortTailLaserSlideMap.includes(t)||(this.incrementMessageCount(this.annotationInfo,"ShortTailLaser"),this.logLaserPointerColor(this.annotationInfo),this.shortTailLaserSlideMap.push(t),this.numLaserStrokeSent+=1);break;case 8:6===this.previousLaserType&&(this.numLaserStrokeSent+=1,this.incrementMessageCount(this.annotationInfo,this.isLaserMovedAfterStart?"LongTailLaser":"ClickLaser"),this.logLaserPointerColor(this.annotationInfo)),this.previousLaserType=e;break;default:this.previousLaserType=e}}async onSemiDryInkChanged(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&this._semiDryInkMap&&this._semiDryInk){let n=await this._semiDryInkMap.get(e),i=n&&void 0!==n.eventJson?n.eventJson:n,s=n&&n.metadata?n.metadata:void 0;this._semiDryInk.set(e,{eventType:0,eventJson:i,metadata:s});let a=this.decodeAnnotationKey(e);if(void 0!==a&&a.StrokeID){let e=a.SlideID,n=a.StrokeID;this.handleAnnotationEvents(0,t.senderId,e,n,i,void 0,void 0,void 0,s),this.logSemiDryInkReceiveInfo(n,e)}}}deleteFromSemiDryInkMap(e,t){if(this._semiDryInkMap&&this._semiDryInk)if(t){let n=this.encodeAnnotationKey(e,t);void 0!==n&&(this._semiDryInkMap.delete(n),this._semiDryInk.has(n)&&this._semiDryInk.delete(n),this.numDeleteSemiDryInkSent+=1,this.incrementMessageCount(this.annotationInfo,"StrokeEraser"))}else{let t=this.encodeAnnotationKey(e);void 0!==t&&(this._semiDryInkMap.deleteWithPrefix(t),this._semiDryInk.forEach((e,n)=>{this._semiDryInk&&void 0!==t&&n.startsWith(t)&&(this._semiDryInk.delete(n),this.numDeleteSemiDryInkSent+=1,this.incrementMessageCount(this.annotationInfo,"EraserAll"))}))}}setWetInkMap(e,t,n,i,s){if(this._wetInkMap&&this._wetInk&&(3===e||4===e||5===e||14===e||15===e)){let a={eventType:e,eventJson:i,metadata:s},r=this.encodeAnnotationKey(t,n);void 0!==r&&(this._wetInkMap.set(r,a),this._wetInk.set(r,a))}}async onWetInkChanged(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&this._wetInkMap&&this._wetInk){let n=await this._wetInkMap.get(e);if(3===n.eventType||4===n.eventType||5===n.eventType||14===n.eventType||15===n.eventType){this._wetInk.set(e,n);let a=this.decodeAnnotationKey(e);if(void 0!==a&&a.StrokeID){let e=a.SlideID,r=a.StrokeID;this.handleAnnotationEvents(n.eventType,t.senderId,e,r,n.eventJson,void 0,void 0,void 0,n.metadata),3!==n.eventType&&5!==n.eventType||o.sendTraceTag(537478152,s.msoulscat_Wac_PptLive,i.Info,`onWetInkChanged: event type: ${n.eventType}, stroke id ${r} on slide ${e};`)}}}}setLaserMap(e,t,n,i,s){if(this._laserMap&&this._laser&&(6===e||7===e||8===e||9===e)){let a={eventType:e,eventJson:i,metadata:s},r=this.encodeAnnotationKey(t,n);if(6===a.eventType&&void 0!==a.eventJson){let e=JSON.parse(a.eventJson);if(void 0!==e.laserAttributes&&void 0!==e.laserPointerAttributes){let t={laserAttributes:e.laserAttributes,laserPointerAttributes:e.laserPointerAttributes};this.annotationLaserAllAttributes=t}}void 0!==r&&(this._laserMap.set(r,a),this._laser.set(r,a),this.logLaserPointerSendInfo(e,n,i))}}async onLaserChange(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&this._laserMap&&this._laser){let n=await this._laserMap.get(e);if(6===n.eventType||7===n.eventType||8===n.eventType||9===n.eventType){this._laser.set(e,n);let i=n.eventJson,s=void 0!==i?JSON.parse(i):void 0;this.isPostMessageReadyCompleted&&this.isLaserColorNotReceivedWithLaserStartEvent&&void 0!==s&&void 0!==s.laserAttributes&&void 0!==s.laserPointerAttributes&&(this.isLaserColorNotReceivedWithLaserStartEvent=!1),this.isPostMessageReadyCompleted&&this.isLaserColorNotReceivedWithLaserStartEvent&&this.isLaserColorNotSendWithLaserStartEvent&&this._annotationLaserAllAttributes&&void 0!==s&&(7===n.eventType||6===n.eventType&&void 0===s.laserAttributes)&&(this.isLaserColorNotSendWithLaserStartEvent=!1,n.eventType=6,s.laserAttributes=this._annotationLaserAllAttributes.laserAttributes,s.laserPointerAttributes=this._annotationLaserAllAttributes.laserPointerAttributes,i=JSON.stringify(s));let a=this.decodeAnnotationKey(e);if(void 0!==a&&a.StrokeID){let e=a.SlideID,s=a.StrokeID;this.handleAnnotationEvents(n.eventType,t.senderId,e,s,i,void 0,void 0,void 0,n.metadata),6===n.eventType&&(this.numLaserStrokeReceived+=1)}}}}handleAnnotationEvents(e,t,n,i,s,a,r,o,l){const c={m_type:m.b.AnnotationEvent,m_eventType:e,m_slideID:n,m_strokeID:i,m_eventJson:s,m_semiDryInkSnapshot:a,m_startPointJson:r,m_appendPointsArray:o,m_metadata:g.addSenderId(l,t)};this._stateServiceClient.postMessageDownward(c,v.isCacheableAnnotationEvent(e)),this.numAnnotationHandled+=1}static isCacheableAnnotationEvent(e){return 0===e||1===e||2===e}onValueUnacknowledged(e){o.sendTraceTag(557598036,s.msoulscat_Wac_PptLive,i.Warning,`StateServiceClient: Annotation Message Unack src: ${e.objectId}; id: ${e.messageId}; ${e.value};`)}encodeAnnotationKey(e,t){return t?0!==e.length&&0!==t.length?`clientID_${e}_${t}`:void o.sendTraceTag(561834018,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::encodeAnnotationKey: slideID and strokeID can't be empty."):0!==e.length?`clientID_${e}_`:void o.sendTraceTag(561834019,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::encodeAnnotationKey: slideID can't be empty.")}decodeAnnotationKey(e){let t=e.split("_",3);return 3===t.length&&0!==t[1].length&&0===t[2].length?{SlideID:t[1]}:3===t.length&&0!==t[1].length&&0!==t[2].length?{SlideID:t[1],StrokeID:t[2]}:void o.sendTraceTag(561834048,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::decodeAnnotationKey: failed to decode annotation key.")}}class y{constructor(){}static getLoggableFeatureName(){return"MediaSync"}initialize(e){return this._stateServiceClient=e,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._stateServiceClient.on("postMessageReady",()=>this.initSetMediaState()),this._stateServiceClient.on("close",()=>this.close()),this.initMediaStateMap()}getSessionTelemetry(){return{}}onMessage(e){this._stateServiceClient.isPresenter()&&(e.m_type===m.d.MediaEvent||e.m_type===m.d.InitMediaSyncEvent)&&this._mediaStateMap&&this._mediaState&&this.updateMediaStateSyncMap(e)}close(){this._mediaStateMap&&this._mediaStateMap.removeAllListeners("valueChanged")}getMediaState(e){if(this._mediaStateMap)return this._mediaStateMap.get(e)}updateMediaStateSyncMap(e){if(!this._mediaStateMap||!this._mediaState)return;let t;if(void 0!==e.m_mediaPlayerState)t=e.m_mediaPlayerState;else switch(e.m_mediaEventType){case 1:t=1;break;case 0:t=0;break;case 6:t=6;break;default:let n=this._mediaStateMap.get(e.m_mediaPlayerName);t=n&&6===n.playerState&&3===e.m_mediaEventType?0:n?n.playerState:void 0}let n={mediaName:e.m_mediaPlayerName,position:e.m_mediaPosition,playerState:t,volume:e.m_mediaVolume,muted:e.m_mediaMuted,metadata:e.m_metadata,eventType:e.m_mediaEventType,isInitState:e.m_type===m.d.InitMediaSyncEvent};if(void 0===e.m_mediaMuted){const e=this._mediaState.get(n.mediaName);e&&(n.muted=e.muted)}this.updateMediaSyncMetadataAndLog("Sending to State Service",n),this._mediaState.set(n.mediaName,n),this._mediaStateMap.set(n.mediaName,n),o.sendTraceTag(556119965,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: MediaSyncFeature, updateMediaStateSyncMap "+JSON.stringify(n))}async initMediaStateMap(){o.sendTraceTag(545019804,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: Begin init MediaStateMap."),this._mediaStateMap=await this._stateServiceClient.initMap("mediaState",e=>this._mediaState=e),this._mediaStateMap.on("valueChanged",(e,t)=>{this.onMediaStateChanged(e,t)}),o.sendTraceTag(545019805,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: End init MediaStateMap; mediaState:"+(this._mediaState?JSON.stringify(this._mediaState):"Null"))}async initSetMediaState(){o.sendTraceTag(545019806,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: initSetMediaState; mediaState:"+(this._mediaState?JSON.stringify(this._mediaState):"Null")),this._mediaState&&this._mediaState.forEach(e=>{const t={m_type:m.b.MediaEvent,m_mediaPlayerName:e.mediaName,m_volume:e.volume,m_muted:e.muted,m_position:e.position,m_playerState:e.playerState,m_metadata:e.metadata,m_eventType:e.eventType,m_isInitState:e.isInitState};this.updateMediaSyncMetadataAndLog("Passing to SlideShowAPI",e,!0),this._stateServiceClient.postMessageDownward(t,!0)})}async onMediaStateChanged(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&this._mediaStateMap&&this._mediaState){let n=await this._mediaStateMap.get(e);this._mediaState.set(n.mediaName,n),this.updateMediaSyncMetadataAndLog("Passing to SlideShowAPI",n),n.metadata=g.addSenderId(n.metadata,t.senderId);const a={m_type:m.b.MediaEvent,m_mediaPlayerName:n.mediaName,m_volume:n.volume,m_muted:n.muted,m_position:n.position,m_playerState:n.playerState,m_metadata:n.metadata,m_eventType:n.eventType,m_isInitState:n.isInitState};this._stateServiceClient.postMessageDownward(a,!0),o.sendTraceTag(556119966,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: MediaSyncFeature, postMessageDownward media state change ${JSON.stringify(n)}; id: ${t.messageId}; sender: ${t.senderId};`)}}updateMediaSyncMetadataAndLog(e,t,n){let a=t.metadata;if(!a||!a.mediaSyncTimeLine)return void o.sendTraceTag(524862616,s.msoulscat_Wac_PptLive,i.Info,"MediaSync::updateMediaSyncMetadataAndLog: Message doesn't contain metadata or mediaSyncTimeLine.");const r="MediaSync: "+e;a.mediaSyncTimeLine.push(r),a.isFromStateServiceCache=n;const l={fileName:"MediaSync",mediaName:t.mediaName,playerState:t.playerState,position:t.position,volume:t.volume,muted:t.muted,isFromStateServiceCache:n,isInitState:t.isInitState,metadata:a};o.sendTraceTag(542955594,s.msoulscat_Wac_PptLive,i.Info,JSON.stringify(l))}}class C{constructor(e,t){this._sessionTelemetry={},this._onPresentationUrlSet=e,this._docUrlHash=t}static getLoggableFeatureName(){return"PresUrl"}initialize(e,t){return this._stateServiceClient=e,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._sessionTelemetry.Init=Date.now(),this._isPresentationUrlFeatureEnabled=t.enabledFeatures&&t.enabledFeatures.includes(m.f.PresUrl)||!1,o.sendTraceTag(554574289,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: PresentationUrlEnabledCellChanged initialized."),this.initPresentationUrlStateCell()}getPresentationUrlEnabled(){return this._presentationUrlEnabled}getPresentationUrlSyncState(){return this._presentationUrlSyncState}getSessionTelemetry(){const e=!!this._presentationUrlEnabled&&this._presentationUrlEnabled.isPresentationUrlEnabled,t=this._presentationUrlSyncState?this._presentationUrlSyncState.presentationUrl.length:"";return this._sessionTelemetry.isPresUrlEnabled=e,this._sessionTelemetry.presUrl=t,this._sessionTelemetry}onMessage(e){this._isPresentationUrlFeatureEnabled&&"presentationUrl"===e.m_type&&this._stateServiceClient.isPresenter()&&(this.presentationUrlSyncState={presentationUrl:e.m_url,metadata:e.m_metadata,docUrlHash:this._docUrlHash})}async initPresentationUrlStateCell(){this._presentationUrlEnabledSyncCell=await this._stateServiceClient.initCell("presentationUrlEnabled",e=>this._presentationUrlEnabled=e,!1,h.MessageTrackingOption.All),this._presentationUrlEnabledSyncCell.on("valueChanged",(e,t)=>this.onPresentationUrlEnabledCellChanged(e,t)),this._presentationUrlSyncCell=await this._stateServiceClient.initCell("presentationUrl",e=>this._presentationUrlSyncState=e,!1,h.MessageTrackingOption.All),this._presentationUrlSyncCell.on("valueChanged",(e,t)=>this.onPresentationUrlCellChanged(e,t)),this._stateServiceClient.isPresenter()?this.presentationUrlEnabled={isPresentationUrlEnabled:this._isPresentationUrlFeatureEnabled}:(void 0!==this._presentationUrlEnabled&&this.onPresentationUrlEnabledSet(this._presentationUrlEnabled.isPresentationUrlEnabled),void 0!==this._presentationUrlSyncState&&this.onPresentationUrlSet(this._presentationUrlSyncState.presentationUrl))}set presentationUrlEnabled(e){this._presentationUrlEnabled!==e&&(this._presentationUrlEnabled=e,this._presentationUrlEnabledSyncCell&&(this._sessionTelemetry.UrlEnabled_Broadcast=Date.now(),this._presentationUrlEnabledSyncCell.setAsync(this._presentationUrlEnabled)))}set presentationUrlSyncState(e){this._presentationUrlSyncState!==e&&(this._presentationUrlSyncState=e,this._presentationUrlSyncCell&&(this._sessionTelemetry.Url_Broadcast=Date.now(),this._presentationUrlSyncCell.setAsync(this._presentationUrlSyncState)))}onPresentationUrlEnabledCellChanged(e,t){this._presentationUrlEnabled=e;const n=this._stateServiceClient.isLocalChange(t.senderId);o.sendTraceTag(554574290,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: PresentationUrlEnabledCellChanged ${JSON.stringify(e)};\n      id: ${t.messageId}; sender: ${t.senderId}; isLocal: ${n};\n      isPresUrlFeatureEnabled: ${this._isPresentationUrlFeatureEnabled};`),n||this.onPresentationUrlEnabledSet(e.isPresentationUrlEnabled)}onPresentationUrlEnabledSet(e){this._sessionTelemetry.UrlEnabled_Receive=Date.now(),e?this._isPresentationUrlFeatureEnabled&&o.sendTraceTag(554574291,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: PresentationUrlEnabled ${e}; indicating presenter ${e?"will":"will not"} send me a PresentationUrl sync message.`):(this._sessionTelemetry.Callback_Notify_Value=!1,this._onPresentationUrlSet({isPresentationUrlEnabled:!1}))}onPresentationUrlCellChanged(e,t){this._presentationUrlSyncState=e;const n=this._stateServiceClient.isLocalChange(t.senderId),a=this._presentationUrlSyncState.metadata||{};o.sendTraceTag(554574292,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::PresentationUrlCellChanged ${JSON.stringify(this.redactSensitiveInfo(e))};\n      id: ${t.messageId}; sender: ${t.senderId}; isLocal: ${n};\n      isPresUrlFeatureEnabled: ${this._isPresentationUrlFeatureEnabled}; bootMetrics: ${JSON.stringify(a)}`),n||this.onPresentationUrlSet(this._presentationUrlSyncState.presentationUrl)}onPresentationUrlSet(e){const t=this._presentationUrlSyncState&&this._presentationUrlSyncState.metadata||{};t.isPresenter=this._stateServiceClient.isPresenter(),!this._presentationUrlSyncState||this._presentationUrlSyncState.docUrlHash===this._docUrlHash||this._stateServiceClient.hasSessionSecretKey()?(o.sendTraceTag(553934946,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::onPresentationUrlSet ${JSON.stringify(this.redactSensitiveInfo(this._presentationUrlSyncState)||{})};\n      isPresUrlFeatureEnabled: ${this._isPresentationUrlFeatureEnabled}; bootMetrics: ${JSON.stringify(t)}; hasSessionSecretKey: ${this._stateServiceClient.hasSessionSecretKey()}`),this._sessionTelemetry.Url_Receive=Date.now(),this._isPresentationUrlFeatureEnabled&&(this._sessionTelemetry.Callback_Notify_Value=!0,this._onPresentationUrlSet({isPresentationUrlEnabled:!0,url:e,metadata:t}))):o.sendTraceTag(540148829,s.msoulscat_Wac_PptLive,i.Warning,`StateServiceClient::onPresentationUrlSet early return because called with stale presUrl: ${JSON.stringify(this.redactSensitiveInfo(this._presentationUrlSyncState)||{})}; isPresUrlFeatureEnabled: ${this._isPresentationUrlFeatureEnabled}; bootMetrics: ${JSON.stringify(t)};`)}redactSensitiveInfo(e){return e?{metadata:e.metadata?e.metadata:"",presenterErrorInfo:e.presenterErrorInfo?e.presenterErrorInfo:""}:e}close(){}}class I{constructor(){this._navMessagesSent=0,this._navMessagesLocalReceived=0,this._navMessagesRemoteReceived=0}static getLoggableFeatureName(){return"Nav"}initialize(e,t){return this._stateServiceClient=e,this._isNavSyncEnabled=t.enabledFeatures&&t.enabledFeatures.includes(m.f.NavSync)||!1,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._stateServiceClient.on("switchRole",e=>this.onSwitchRole(e.oldRole,e.newRole)),this._stateServiceClient.on("close",()=>this.close()),this.initNavigationStateCell()}getSessionTelemetry(){return{NavMessagesSent:this._navMessagesSent,NavMessagesLocalReceived:this._navMessagesLocalReceived,NavMessagesRemoteReceived:this._navMessagesRemoteReceived}}onMessage(e){if(this._stateServiceClient.isPresenter()&&(e.m_type===m.d.OnPositionChanged||e.m_type===m.d.GetCurrentPosition)&&!isNaN(e.m_slideIndex)&&e.m_slideIndex>=0&&!isNaN(e.m_slideId)&&e.m_slideId>=0&&null!=e.m_timeLineMappings){if(e.m_metadata&&!0===e.m_metadata.shouldPreventBroadcast)return void o.sendTraceTag(509726819,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: shouldPreventBroadcast=true, prevent presenter from broadcasting navigationState message "+JSON.stringify(e.m_slideLocation));let t;t=e.m_slideLocation&&e.m_animationState&&e.m_animationState.timelineStates?{to:{location:e.m_slideLocation,timelineMappings:e.m_animationState.timelineStates.map(e=>this.convertFromModernAnimationState(e))}}:{to:{location:{slideId:{sid:e.m_slideId,cid:0},slideIndex:e.m_slideIndex},timelineMappings:e.m_timeLineMappings.map(e=>this.convertFromLegacyTimelineMapping(e))}},t.metadata=e.m_metadata,this.navigationState=t,o.sendTraceTag(520364106,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: Set navigationState to slide ${JSON.stringify(t.to)}.`),this._navMessagesSent+=1}}getNavigationState(){return this._navigationState}close(){this._navigationStateCell&&this._navigationStateCell.removeAllListeners("valueChanged")}async initNavigationStateCell(){o.sendTraceTag(542204050,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: Begin init NavigationStateCell."),this._navigationStateCell=await this._stateServiceClient.initCell("navigationState",e=>this.onInitCellCompleted(e),!1,h.MessageTrackingOption.All),this._navigationStateCell.on("valueChanged",(e,t)=>this.onNavigationStateCellChanged(e,t)),this._navigationStateCell.on("valueUnacknowledged",e=>this.onNavigationStateCellValueUnacknowledged(e)),o.sendTraceTag(542204051,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: End init NavigationStateCell: "+(this._navigationState?JSON.stringify(this._navigationState):"None"))}onInitCellCompleted(e){this._navigationState=e;const t={m_type:m.b.GoToSlide,m_slideLocation:this._navigationState.to.location,m_animationState:this._navigationState.to.timelineMappings,m_metadata:this._navigationState.metadata};this._stateServiceClient.postMessageDownward(t,!0)}onNavigationStateCellChanged(e,t){this._navigationState=e;const n=this._navigationState.metadata&&this._navigationState.metadata.stateServiceNavSync||!1,a=this._stateServiceClient.isLocalChange(t.senderId);if(o.sendTraceTag(561849377,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: NavigationStateChanged ${JSON.stringify(e)}; id: ${t.messageId}; sender: ${t.senderId};\n      navSyncEnabled: ${this._isNavSyncEnabled}; isLocal: ${a};\n      fMessageContainsStateServiceNavSyncFlag: ${n}`),a)this._navMessagesLocalReceived+=1;else{const e={timelineStates:this._navigationState.to.timelineMappings.map(e=>this.convertToModernAnimationState(e))};if(this._navMessagesRemoteReceived+=1,this._isNavSyncEnabled&&n){const n={m_type:m.b.GoToSlide,m_slideLocation:this._navigationState.to.location,m_animationState:e,m_metadata:g.addSenderId(this._navigationState.metadata,t.senderId)};this._stateServiceClient.postMessageDownward(n,!0)}}}onSwitchRole(e,t){if(e===m.e.PrivateViewing&&t===m.e.Presenter){const e={m_type:m.b.GetCurrentPosition};this._stateServiceClient.postMessageDownward(e,!0)}}onNavigationStateCellValueUnacknowledged(e){o.sendTraceTag(557602698,s.msoulscat_Wac_PptLive,i.Warning,`StateServiceClient: NavigationState Message Unack id: ${e.messageId}; ${e.value};`)}set navigationState(e){this._navigationState!==e&&(this._navigationState=e,this._navigationStateCell&&this._navigationStateCell.setAsync(this._navigationState))}convertFromLegacyTimelineMapping(e){return{timelineId:e.TimeLineId,step:e.Step,sequenceId:""}}convertFromModernAnimationState(e){return{timelineId:e.timelineId,step:e.step,sequenceId:""}}convertToModernAnimationState(e){return{timelineId:e.timelineId,step:e.step}}}class b{constructor(){}static getLoggableFeatureName(){return"LiveAppSync"}initialize(e,t){return o.sendTraceTag(527292307,s.msoulscat_Wac_PptLive,i.Info,"LiveAppNavigationSync: Initialize with params "+t),this._stateServiceClient=e,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._stateServiceClient.on("switchRole",e=>this.onSwitchRole(e.oldRole,e.newRole)),this._stateServiceClient.on("close",()=>this.close()),this.initNavigationStateCell()}getSessionTelemetry(){return{}}onMessage(e){if(this._stateServiceClient.isPresenter()&&(e.m_type===m.c.OnStateChanged||e.m_type===m.c.GetCurrentState)&&null!=e.m_state&&e.m_state.length>0&&null!=e.m_app){const t={to:{app:e.m_app,state:e.m_state},metadata:e.metadata};this.navigationState=t}}getNavigationState(){return this._liveNavSyncState}set navigationState(e){this._liveNavSyncState!==e&&(this._liveNavSyncState=e,this._liveNavSyncStateCell&&this._liveNavSyncStateCell.setAsync(this._liveNavSyncState))}close(){this._liveNavSyncStateCell&&this._liveNavSyncStateCell.removeAllListeners("valueChanged")}onSwitchRole(e,t){if(e===m.e.PrivateViewing&&t===m.e.Presenter){const e={m_type:m.a.GetCurrentState};this._stateServiceClient.postMessageDownward(e,!1)}}async initNavigationStateCell(){o.sendTraceTag(527294602,s.msoulscat_Wac_PptLive,i.Info,"LiveAppNavigationSync: Begin init NavigationStateCell."),this._liveNavSyncStateCell=await this._stateServiceClient.initCell("navigationState",e=>this._liveNavSyncState=e,!1,h.MessageTrackingOption.All),this._liveNavSyncStateCell.on("valueChanged",(e,t)=>this.onNavigationStateCellChanged(e,t)),this._liveNavSyncStateCell.on("valueUnacknowledged",e=>this.onNavigationStateCellValueUnacknowledged(e)),o.sendTraceTag(527294603,s.msoulscat_Wac_PptLive,i.Info,"LiveAppNavigationSync: End init NavigationStateCell: "+(this._liveNavSyncState?JSON.stringify(this._liveNavSyncState):"None"))}onNavigationStateCellChanged(e,t){this._liveNavSyncState=e;const n=this._liveNavSyncState.metadata&&this._liveNavSyncState.metadata.stateServiceLiveAppSync||!1,a=this._stateServiceClient.isLocalChange(t.senderId);if(o.sendTraceTag(527294604,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: NavigationStateChanged ${JSON.stringify(e)}; id: ${t.messageId}; sender: ${t.senderId};\n      isLocal: ${a};\n      fMessageContainsStateServiceNavSyncFlag: ${n}`),!a&&n){let e={m_type:m.a.GoToState,m_app:this._liveNavSyncState.to.app,m_state:this._liveNavSyncState.to.state,m_metadata:g.addTimestamp(this._liveNavSyncState.metadata,c.SendMessageToViewer)};this._stateServiceClient.postMessageDownward(e,!1)}}onNavigationStateCellValueUnacknowledged(e){o.sendTraceTag(527294605,s.msoulscat_Wac_PptLive,i.Warning,`LiveAppNavigationSync: NavigationState Message Unack id: ${e.messageId}; ${e.value};`)}}class T{constructor(){}static getLoggableFeatureName(){return"AddinSync"}initialize(e){return this._stateServiceClient=e,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._stateServiceClient.on("postMessageReady",()=>this.initSetAddinState()),this._stateServiceClient.on("close",()=>this.close()),this.initAddinStateMap()}getSessionTelemetry(){return{}}onMessage(e){this._stateServiceClient.isPresenter()&&e.m_type===m.d.AddinEventOutbound&&this._addinStateSyncMap&&this._addinInstanceStates&&this.updateAddinStateSyncMap(e)}close(){this._addinStateSyncMap&&this._addinStateSyncMap.removeAllListeners("valueChanged")}getAddinState(e){if(this._addinStateSyncMap)return this._addinStateSyncMap.get(e)}updateAddinStateSyncMap(e){if(!this._addinStateSyncMap||!this._addinInstanceStates)return;let t={instanceId:e.m_addinInstanceId,state:e.m_addinStateData,isInitState:e.m_type===m.d.InitAddinSyncEvent};this._addinInstanceStates.set(t.instanceId,t),this._addinStateSyncMap.set(t.instanceId,t),o.sendTraceTag(521414406,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: AddinSyncFeature, updateAddinStateSyncMap "+JSON.stringify(t))}async initAddinStateMap(){o.sendTraceTag(521414405,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: Begin init AddinStateMap."),this._addinStateSyncMap=await this._stateServiceClient.initMap("addinState",e=>this._addinInstanceStates=e),this._addinStateSyncMap.on("valueChanged",(e,t)=>{this.onAddinStateChanged(e,t)}),o.sendTraceTag(521414404,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: End init AddinStateMap; addinState:"+(this._addinInstanceStates?JSON.stringify(this._addinInstanceStates):"Null"))}async initSetAddinState(){o.sendTraceTag(521414403,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: initSetAddinState; addinState:"+(this._addinInstanceStates?JSON.stringify(this._addinInstanceStates):"Null")),this._addinInstanceStates&&this._addinInstanceStates.forEach(e=>{const t={m_type:m.b.AddinEventInbound,m_addinInstanceId:e.instanceId,m_addinStateData:e.state,m_isInitState:e.isInitState};this._stateServiceClient.postMessageDownward(t,!0)})}async onAddinStateChanged(e,t){if(!this._stateServiceClient.isLocalChange(t.senderId)&&this._addinStateSyncMap&&this._addinInstanceStates){let n=await this._addinStateSyncMap.get(e);this._addinInstanceStates.set(n.instanceId,n);const a={m_type:m.b.AddinEventInbound,m_addinInstanceId:n.instanceId,m_addinStateData:n.state,m_isInitState:n.isInitState};this._stateServiceClient.postMessageDownward(a,!0),o.sendTraceTag(521414402,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: AddinSyncFeature, postMessageDownward addin state change ${JSON.stringify(n)}; id: ${t.messageId}; sender: ${t.senderId};`)}}}class w{constructor(){}static getLoggableFeatureName(){return"PrivateViewingToggleSync"}initialize(e,t){return this._stateServiceClient=e,this._isPrivateViewingToggleSyncEnabled=t.enabledFeatures&&t.enabledFeatures.includes(m.f.PrivateViewingToggleSync)||!1,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._stateServiceClient.on("close",()=>this.close()),this.initPrivateViewingToggleCell()}getSessionTelemetry(){return{}}onMessage(e){if(this._isPrivateViewingToggleSyncEnabled&&this._stateServiceClient.isPresenter()&&e.m_type===m.d.TogglePrivateViewing){o.sendTraceTag(508339673,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: Set private viewing toggle to ${JSON.stringify(e.m_enabled)}.`);let t={enabled:e.m_enabled};this.privateViewingToggleState=t}}close(){this._privateViewingToggleCell&&this._privateViewingToggleCell.removeAllListeners("valueChanged")}getPrivateViewingToggleState(){return this._privateViewingToggleState}async initPrivateViewingToggleCell(){o.sendTraceTag(508339672,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: Begin init PrivateViewingToggleCell."),this._privateViewingToggleCell=await this._stateServiceClient.initCell("privateViewingToggle",e=>this.onInitCellCompleted(e),!1,h.MessageTrackingOption.All),this._privateViewingToggleCell.on("valueChanged",(e,t)=>{this.onPrivateViewingToggleCellChanged(e,t)}),this._privateViewingToggleCell.on("valueUnacknowledged",e=>this.onPrivateViewingToggleCellValueUnacknowledged(e)),o.sendTraceTag(508339671,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: End init PrivateViewingToggleCell:"+(this._privateViewingToggleState?JSON.stringify(this._privateViewingToggleState):"Null"))}onInitCellCompleted(e){this._privateViewingToggleState=e;const t={m_type:m.b.SetPrivateViewingToggle,m_enabled:this._privateViewingToggleState.enabled};this._stateServiceClient.postMessageDownward(t,!0)}async onPrivateViewingToggleCellChanged(e,t){this._privateViewingToggleState=e;const n=this._stateServiceClient.isLocalChange(t.senderId);if(o.sendTraceTag(508339670,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: PrivateViewingToggleStateChanged ${JSON.stringify(e)}; id: ${t.messageId}; sender: ${t.senderId};\n      isLocal: ${n}`),!n&&this._isPrivateViewingToggleSyncEnabled){const e={m_type:m.b.SetPrivateViewingToggle,m_enabled:this._privateViewingToggleState.enabled};this._stateServiceClient.postMessageDownward(e,!0)}}onPrivateViewingToggleCellValueUnacknowledged(e){o.sendTraceTag(508339669,s.msoulscat_Wac_PptLive,i.Warning,`StateServiceClient: PrivateViewingToggleState Message Unack id: ${e.messageId}; ${e.value};`)}set privateViewingToggleState(e){this._privateViewingToggleState!==e&&(this._privateViewingToggleState=e,this._privateViewingToggleCell&&this._privateViewingToggleCell.setAsync(this._privateViewingToggleState))}}class M{constructor(){this._messagesSent=0,this._messagesLocalReceived=0,this._messagesRemoteReceived=0}static getLoggableFeatureName(){return"BlankSlideState"}initialize(e,t){return this._stateServiceClient=e,this._stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this._stateServiceClient.on("close",()=>this.close()),this.initBlankSlideStateCell()}getSessionTelemetry(){return{MessagesSent:this._messagesSent,MessagesLocalReceived:this._messagesLocalReceived,MessagesRemoteReceived:this._messagesRemoteReceived}}onMessage(e){if(this._stateServiceClient.isPresenter()&&e.m_type===m.d.BlankSlideState){let t={to:e.m_blankSlideState};t.metadata=e.m_metadata,this.blankSlideState=t,o.sendTraceTag(507323589,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: Set blankSlideState to ${JSON.stringify(t.to)}.`),this._messagesSent+=1}}close(){this._blankSlideStateCell&&this._blankSlideStateCell.removeAllListeners("valueChanged")}async initBlankSlideStateCell(){o.sendTraceTag(507323588,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: Begin init BlankSlideStateCell."),this._blankSlideStateCell=await this._stateServiceClient.initCell("blankSlideState",e=>this.onInitCellCompleted(e),!1,h.MessageTrackingOption.All),this._blankSlideStateCell.on("valueChanged",(e,t)=>this.onBlankSlideStateCellChanged(e,t)),this._blankSlideStateCell.on("valueUnacknowledged",e=>this.onBlankSlideStateCellValueUnacknowledged(e)),o.sendTraceTag(507323587,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: End init BlankSlideStateCell: "+(this._blankSlideState?JSON.stringify(this._blankSlideState):"None"))}onInitCellCompleted(e){this._blankSlideState=e;const t={m_type:m.b.BlankSlideState,m_blankSlideState:this._blankSlideState.to,m_metadata:this._blankSlideState.metadata};this._stateServiceClient.postMessageDownward(t,!0)}onBlankSlideStateCellChanged(e,t){this._blankSlideState=e;const n=this._stateServiceClient.isLocalChange(t.senderId);if(o.sendTraceTag(507323586,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: BlankSlideStateChanged ${JSON.stringify(e)}; id: ${t.messageId}; sender: ${t.senderId}; isLocal: ${n};`),n)this._messagesLocalReceived+=1;else{this._messagesRemoteReceived+=1;const e={m_type:m.b.BlankSlideState,m_blankSlideState:this._blankSlideState.to,m_metadata:g.addSenderId(this._blankSlideState.metadata,t.senderId)};this._stateServiceClient.postMessageDownward(e,!0)}}onBlankSlideStateCellValueUnacknowledged(e){o.sendTraceTag(507323585,s.msoulscat_Wac_PptLive,i.Warning,`StateServiceClient: BlankSlideState Message Unack id: ${e.messageId}; ${e.value};`)}set blankSlideState(e){this._blankSlideState!==e&&(this._blankSlideState=e,this._blankSlideStateCell&&this._blankSlideStateCell.setAsync(this._blankSlideState))}}class P{constructor(){}static getLoggableFeatureName(){return"Cameo"}set cameoState(e){this.m_cameoSyncState=e,this.m_cameoStateCell&&this.m_cameoStateCell.setAsync(this.m_cameoSyncState)}initialize(e){return this.m_stateServiceClient=e,this.m_stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this.m_stateServiceClient.on("postMessageReady",()=>this.initSetCameoState()),this.m_stateServiceClient.on("close",()=>this.close()),this.initCameoStateCellAsync()}getSessionTelemetry(){return{}}onMessage(e){e.m_type===m.d.CameraStateChanged&&(this.cameoState={cameoButtonEnabled:e.m_cameoButtonEnabled},o.sendTraceTag(507597643,s.msoulscat_Wac_PptLive,i.Info,"CameoSyncFeature::onMessage: Set cameoState to "+JSON.stringify(this.m_cameoSyncState)))}close(){this.m_cameoStateCell&&this.m_cameoStateCell.removeAllListeners("valueChanged")}initSetCameoState(){if(o.sendTraceTag(507320280,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: initSetCameoState; cameoState:"+(this.m_cameoSyncState?JSON.stringify(this.m_cameoSyncState):"Null")),!this.m_cameoSyncState)return;const e={m_type:m.b.CameraStateChanged,m_cameoButtonEnabled:this.m_cameoSyncState.cameoButtonEnabled};this.m_stateServiceClient.postMessageDownward(e,!0)}async initCameoStateCellAsync(){o.sendTraceTag(507320279,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initCameoStateCell: Begin initCameoStateCell."),this.m_cameoStateCell=await this.m_stateServiceClient.initCell("cameoState",e=>this.m_cameoSyncState=e),this.m_cameoStateCell.on("valueChanged",(e,t)=>this.onCameoStateCellChanged(e,t))}onCameoStateCellChanged(e,t){if(this.m_stateServiceClient.isLocalChange(t.senderId))return;this.m_cameoSyncState=e;const n={m_type:m.b.CameraStateChanged,m_cameoButtonEnabled:e.cameoButtonEnabled};this.m_stateServiceClient.postMessageDownward(n,!0)}}class A{constructor(){}static getLoggableFeatureName(){return"Subtitles"}set subtitlesState(e){this.m_subtitlesSyncState=e,this.m_subtitlesStateCell&&this.m_subtitlesStateCell.setAsync(this.m_subtitlesSyncState)}initialize(e){return this.m_stateServiceClient=e,this.m_stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this.m_stateServiceClient.on("postMessageReady",()=>this.initSetSubtitlesState()),this.m_stateServiceClient.on("close",()=>this.close()),this.initSubtitlesStateCellAsync()}getSessionTelemetry(){return{}}onMessage(e){e.m_type===m.d.SubtitlesStateChanged&&(this.subtitlesState={subtitlesEnabled:e.m_subtitlesEnabled},o.sendTraceTag(507315593,s.msoulscat_Wac_PptLive,i.Info,"SubtitlesSyncFeature::onMessage: Set subtitlesState to "+JSON.stringify(this.m_subtitlesSyncState)))}close(){this.m_subtitlesStateCell&&this.m_subtitlesStateCell.removeAllListeners("valueChanged")}initSetSubtitlesState(){if(o.sendTraceTag(507315592,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initSetSubtitlesState; subtitlesState:"+(this.m_subtitlesSyncState?JSON.stringify(this.m_subtitlesSyncState):"Null")),!this.m_subtitlesSyncState)return;const e={m_type:m.b.SubtitlesStateChanged,m_subtitlesEnabled:this.m_subtitlesSyncState.subtitlesEnabled};this.m_stateServiceClient.postMessageDownward(e,!0)}async initSubtitlesStateCellAsync(){o.sendTraceTag(507315591,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initSubtitlesStateCellAsync: Begin initSubtitlesStateCellAsync."),this.m_subtitlesStateCell=await this.m_stateServiceClient.initCell("subtitlesState",e=>this.m_subtitlesSyncState=e),this.m_subtitlesStateCell.on("valueChanged",(e,t)=>this.onSubtitlesStateCellChanged(e,t))}onSubtitlesStateCellChanged(e,t){if(this.m_stateServiceClient.isLocalChange(t.senderId))return;this.m_subtitlesSyncState=e;const n={m_type:m.b.SubtitlesStateChanged,m_subtitlesEnabled:e.subtitlesEnabled};this.m_stateServiceClient.postMessageDownward(n,!0)}}class E{constructor(){}static getLoggableFeatureName(){return"OpticalZoomSync"}set opticalZoomState(e){this.m_opticalZoomSyncState=e,this.m_opticalZoomStateCell&&this.m_opticalZoomStateCell.setAsync(this.m_opticalZoomSyncState)}initialize(e){return this.m_stateServiceClient=e,this.m_stateServiceClient.on("viewerMessage",e=>this.onMessage(e)),this.m_stateServiceClient.on("postMessageReady",()=>this.initSetOpticalZoomState()),this.m_stateServiceClient.on("close",()=>this.close()),this.initOpticalZoomStateCell()}getSessionTelemetry(){return{}}onMessage(e){e.m_type===m.d.OpticalZoomStateChanged&&(this.opticalZoomState={opticalZoomState:e.m_opticalZoomState,shouldAnimate:e.m_shouldAnimate,metadata:e.m_metadata},o.sendTraceTag(508953296,s.msoulscat_Wac_PptLive,i.Info,"OpticalZoomSyncFeature::onMessage: Set opticalZoomState to "+JSON.stringify(this.m_opticalZoomSyncState)))}close(){this.m_opticalZoomStateCell&&this.m_opticalZoomStateCell.removeAllListeners("valueChanged")}initSetOpticalZoomState(){if(o.sendTraceTag(508933504,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: initSetOpticalZoomState; opticalZoomState:"+(this.m_opticalZoomSyncState?JSON.stringify(this.m_opticalZoomSyncState):"Null")),!this.m_opticalZoomSyncState)return;const e={m_type:m.b.OpticalZoomStateChanged,m_opticalZoomState:this.m_opticalZoomSyncState.opticalZoomState,m_shouldAnimate:this.m_opticalZoomSyncState.shouldAnimate,m_metadata:this.m_opticalZoomSyncState.metadata};this.m_stateServiceClient.postMessageDownward(e,!0)}async initOpticalZoomStateCell(){o.sendTraceTag(508953295,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initOpticalZoomStateCell: Begin init OpticalZoomStateCell."),this.m_opticalZoomStateCell=await this.m_stateServiceClient.initCell("opticalZoomState",e=>this.m_opticalZoomSyncState=e),this.m_opticalZoomStateCell.on("valueChanged",(e,t)=>this.onOpticalZoomStateCellChanged(e,t))}onOpticalZoomStateCellChanged(e,t){if(this.m_stateServiceClient.isLocalChange(t.senderId))return;this.m_opticalZoomSyncState=e;const n={m_type:m.b.OpticalZoomStateChanged,m_opticalZoomState:this.m_opticalZoomSyncState.opticalZoomState,m_shouldAnimate:this.m_opticalZoomSyncState.shouldAnimate,m_metadata:g.addSenderId(this.m_opticalZoomSyncState.metadata,t.senderId)};this.m_stateServiceClient.postMessageDownward(n,!0)}}class L{constructor(e,t){this._hostSessionId="",this._lastKnownSenderIds=[],this._role=m.e.Attendee,this.events=new d.EventEmitter,this._enabledStateServiceFeatures=new Map,this._isPostMessageReady=!1,this._cachedPrePostMessageReadyMessages=[],this._sessionTelemetry={},this._isClosing=!1,this.onDomEventMessage=e=>{let t;try{t=JSON.parse(e.data)}catch(e){o.sendTraceTag(571770523,s.msoulscat_Wac_PptLive,i.Warning,"StateServiceClient::OnDomEventMessage Failed to parse message from iframe")}if(t)switch(t.m_metadata&&(t.m_metadata=g.addTimestamp(t.m_metadata,c.ReceiveMessageFromViewer)),this.events.emit("viewerMessage",t),t.m_type){case m.d.RoleChangedOutbound:this.switchRole(t.m_role);break;case m.d.BootStageChanged:break;case m.d.AnnotationEvent:case m.d.GetCurrentPosition:case m.d.Handshake:case m.d.OnPositionChanged:case m.d.OnSlideViewBoundsChanged:case m.d.TogglePrivateViewing:case m.c.OnStateChanged:case m.c.GetCurrentState:case m.d.CameraStateChanged:case m.d.SubtitlesStateChanged:this.postMessageReady=!0}},this._frameContainerContext=t,this._stateServiceClientSettings=e,this._tagManager=new f}on(e,t){return this.events.on(e,t),this}off(e,t){return this.events.off(e,t),this}removeAllListeners(e){return this.events.removeAllListeners(e),this}getEnabledFeatures(){return this._enabledStateServiceFeatures}async init(e,t,n,a,r,l,c,h,d,u,m,g,f,p,_,S){if(void 0!==this._initImplPromise)return o.sendTraceTag(506303246,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::init called when already in progress. Ignoring new attempt."),!1;if(this._isClosing)return o.sendTraceTag(506303245,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::init called when close in progress. Ignoring new attempt."),!1;try{return this._initImplPromise=this.initImpl(e,t,n,a,r,l,c,h,d,u,m,g,f,p,_,S),await this._initImplPromise}finally{this._initImplPromise=void 0}}async initImpl(e,t,n,a,r,l,c,h,d,u,g,f,p,_,S,v){try{o.sendTraceTag(571762715,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::init.");const a=Date.now();this._logger=n,o.setLogger(this._logger),this._userId=f||"",this._authEnabled=_||!1,e.correlationId&&(this._hostSessionId=e.correlationId),this._onPresentationUrlSet=u,this._docUrlHash=O(c),this._healthLogger=d,S&&(this._sessionSecretKey=S);const v=await this.getEndpointUrl(l.toLowerCase(),c,t,g,S);if(this._isClosing)return o.sendTraceTag(506303244,s.msoulscat_Wac_PptLive,i.Warning,"StateServiceClient::initImpl cancelled as a close was requested. Preventing StateServiceProxy setup and further initialization."),!1;if(!v)throw new Error("Failed to get endpointUrl");if(this._role=r?m.e.Presenter:m.e.Attendee,await this.setupStateServiceProxy(v.sessionId,v.endpoint,e,p),this._isClosing)return o.sendTraceTag(506303243,s.msoulscat_Wac_PptLive,i.Warning,"StateServiceClient::initImpl cancelled as a close was requested. Preventing event registeration and feature init."),!1;if(!this._stateServiceProxy)throw new Error("Failed to create stateServiceProxy");const y=Date.now();this._stateServiceProxy.on("connectionStateChanged",()=>{o.sendTraceTag(512553735,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: ConnectionStateChanged: "+this._stateServiceProxy.getConnectionState())}),this.clientId&&this.onClientIdChanged(),this._stateServiceProxy.on("clientIdChanged",()=>this.onClientIdChanged()),this._stateServiceProxy.on("messageRoundTripped",e=>{let t="";e&&e.details&&(t=`clientId:${e.details.clientId}, hashedSessionId:${O(e.details.sessionId)}, messageId:${e.details.messageId}, objectId:${e.details.objectId}, operation:${e.details.operation}, latencyInMs:${e.details.latencyInMs}`),o.sendTraceTag(571762716,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: MessageRoundTripped: {isPresenter:${this.isPresenter()}}`+t)});const C=Date.now();this._sessionTelemetry.RegisterListeners=C-y,this._sessionTelemetry.isPresenter=r,this._stateServiceClientSettings&&this._stateServiceClientSettings.webviewContainerEnabled&&this._frameContainerContext?this._frameContainerContext.addMessageListener(this.onDomEventMessage.bind(this)):window.addEventListener("message",this.onDomEventMessage);const I=Date.now();await Promise.all(this.getEnabledFeaturesInitPromises(h));const b=Date.now();this._sessionTelemetry.InitPromises=b-I;const T=Date.now();return this._sessionTelemetry.HashedStateServiceSessionId=O(v.sessionId),this._sessionTelemetry.Initialize=T-a,o.sendTraceTag(520364107,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: init complete. "+JSON.stringify(this._sessionTelemetry)),!0}catch(e){return o.sendTraceTag(571762717,s.msoulscat_Wac_PptLive,i.Error,`StateServiceClient: Exception in Init: ${e}.`),!1}}onClientIdChanged(){o.sendTraceTag(520364108,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient: clientIdChanged to "+this.clientId),this._sessionTelemetry.ClientId=this.clientId,this.sendNotifyClientIdMessage("clientIdChanged")}sendNotifyClientIdMessage(e){if(!this._authEnabled&&this.isPresenter()){const t={m_type:m.b.RecordMetrics,m_statName:"StateServiceClientId",m_data:{clientId:this.clientId,source:e}};this._isPostMessageReady?this.postMessageDownward(t,!0):this._cachedPrePostMessageReadyMessages.push(t)}}getEnabledFeaturesInitPromises(e){let t=[];if(!e||0===e.length)return t;try{o.sendTraceTag(571770520,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient: Enabled features: ${e.toString()}.`);for(let t of e)switch(t){case m.f.LiveAppSync:this._enabledStateServiceFeatures.get(b.getLoggableFeatureName())||this._enabledStateServiceFeatures.set(b.getLoggableFeatureName(),new b);break;case m.f.Nav:case m.f.NavSync:this._enabledStateServiceFeatures.get(I.getLoggableFeatureName())||this._enabledStateServiceFeatures.set(I.getLoggableFeatureName(),new I);break;case m.f.Ink:this._enabledStateServiceFeatures.set(v.getLoggableFeatureName(),new v);break;case m.f.Media:this._enabledStateServiceFeatures.set(y.getLoggableFeatureName(),new y);break;case m.f.AddinStateSync:this._enabledStateServiceFeatures.set(T.getLoggableFeatureName(),new T);break;case m.f.OpticalZoomSync:this._enabledStateServiceFeatures.set(E.getLoggableFeatureName(),new E);break;case m.f.PrivateViewingToggleSync:this._enabledStateServiceFeatures.get(w.getLoggableFeatureName())||this._enabledStateServiceFeatures.set(w.getLoggableFeatureName(),new w);break;case m.f.PresUrl:this._enabledStateServiceFeatures.get(C.getLoggableFeatureName())||this._enabledStateServiceFeatures.set(C.getLoggableFeatureName(),new C(this._onPresentationUrlSet,this._docUrlHash));break;case m.f.BlankSlideState:this._enabledStateServiceFeatures.get(M.getLoggableFeatureName())||this._enabledStateServiceFeatures.set(M.getLoggableFeatureName(),new M);break;case m.f.Cameo:this._enabledStateServiceFeatures.get(P.getLoggableFeatureName())||this._enabledStateServiceFeatures.set(P.getLoggableFeatureName(),new P);break;case m.f.Subtitles:this._enabledStateServiceFeatures.get(A.getLoggableFeatureName())||this._enabledStateServiceFeatures.set(A.getLoggableFeatureName(),new A)}const n={enabledFeatures:e};this._enabledStateServiceFeatures.forEach(e=>{t.push(e.initialize(this,n))})}catch(t){o.sendTraceTag(571770521,s.msoulscat_Wac_PptLive,i.Error,`StateServiceClient: Failed to parse features ${e.toString()}.`)}return t}hasSessionSecretKey(){return void 0!==this._sessionSecretKey}async setupStateServiceProxy(e,t,n,i){const s={getAuthTokenAsync:i&&this._authEnabled?i.getAuthTokenAsync:void 0,getForceRefreshedTokenAsync:i&&this._authEnabled?i.getForceRefreshedTokenAsync:void 0,patchMessage:this.patchMessage.bind(this),validateMessage:this.validateMessage.bind(this)},a=Date.now(),r=this._stateServiceClientSettings&&this._stateServiceClientSettings.clientType?this._stateServiceClientSettings.clientType:"Previewer";this._stateServiceProxy=await Object(h.createStateServiceProxyAsync)(e,r,t,new k(this._logger),n,s);const o=Date.now();this.sendNotifyClientIdMessage("init"),this._sessionTelemetry.SetupStateServiceProxy=o-a}getEndpointUrl(e,t,n,a,r){let l,c=!1,h=new URL(a||(n?"https://pptservicescast.edog.officeapps.live.com/":"https://pptservicescast.officeapps.live.com/")).href.replace("https","wss");if(r)l=`${this._stateServiceClientSettings&&this._stateServiceClientSettings.configName?this._stateServiceClientSettings.configName:"sharing"}_${e}_${r}`,c=!0;else{const a=n?"":function(e){if(e){let t=e.split("tempauth=");if(t&&t.length>=1){let e=t[0];if(e)return O(e)}}return o.sendTraceTag(571512966,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient: Failed to get document Url."),""}(t);l=""===a||n?"sharing_"+e:`sharing_${e}_${a}`}return o.sendTraceTag(520721362,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::getEndpointUrl useRegionalUrl: ${null!==a}; Endpoint: ${h}; useSecretKey: ${c}`),Promise.resolve({endpoint:h+"/StateServiceHandler.ashx",sessionId:l})}async close(){if(this._isClosing)o.sendTraceTag(506303242,s.msoulscat_Wac_PptLive,i.Warning,"StateServiceClient::close is already in progress. Ignoring new attempt.");else{this._isClosing=!0;try{if(void 0!==this._initImplPromise)try{await this._initImplPromise}catch(e){o.sendTraceTag(506303241,s.msoulscat_Wac_PptLive,i.Warning,"StateServiceClient::close ignoring error caught while waiting for init to finish: "+e)}this._stateServiceProxy?(this._sessionTelemetry.ServiceTelemetry=this._stateServiceProxy.getServiceTelemetry(),this._stateServiceProxy.close()):o.sendTraceTag(512557843,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::close stateServiceProxy is undefined."),o.sendTraceTag(571762718,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::close SessionTelemetry: "+JSON.stringify(this._sessionTelemetry));let e={};for(let[t,n]of this._enabledStateServiceFeatures)e[t]=n.getSessionTelemetry();o.sendTraceTag(539768733,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::close FeatureTelemetry: "+JSON.stringify(e)),this.events.emit("close"),this._sessionTelemetry={},this._stateServiceClientSettings&&this._stateServiceClientSettings.webviewContainerEnabled&&this._frameContainerContext?this._frameContainerContext.removeEventListener(this.onDomEventMessage):window.removeEventListener("message",this.onDomEventMessage)}finally{this._isClosing=!1}}}get iframe(){return this._iframe||(this._iframe=document.querySelector('[id^="pptframe-"]')),this._iframe}onMessage(e){if(e)try{switch(e.m_type){case m.b.SwitchRole:case m.b.SwitchRoleV2:this.switchRole(e.m_role);break;case m.b.RecordMetrics:"NavigationMetadata"===e.m_statName?this._lastKnownSenderIds.push(e.m_data):"PostMessageReady"===e.m_statName&&(this.postMessageReady=!0);break;case m.b.SendiOSAuthTokenWithConfig:this._stateServiceProxy&&this._stateServiceProxy.sendConfigMessage(e.m_configs);break;case"presentationUrl":this.events.emit("viewerMessage",e)}}catch(e){o.sendTraceTag(561517587,s.msoulscat_Wac_PptLive,i.Warning,"StateServiceClient::OnMessage Failed to parse message.")}}postMessageDownward(e,t){this._isPostMessageReady?this._stateServiceClientSettings&&this._stateServiceClientSettings.webviewContainerEnabled&&this._frameContainerContext?e&&(e.m_metadata&&(e.m_metadata=g.addTimestamp(e.m_metadata,c.SendMessageToViewer)),e.m_id=this._hostSessionId,L.tryLogPostMessageData(e,!0),this._frameContainerContext.postMessageDownward(e)):null!==this.iframe&&null!==this.iframe.contentWindow&&(0!==this.iframe.src.length||this.iframe.name.indexOf("slideshowframe")>=0)?(e&&e.m_metadata&&(e.m_metadata=g.addTimestamp(e.m_metadata,c.SendMessageToViewer)),L.tryLogPostMessageData(e,!1),this.iframe.contentWindow.postMessage(JSON.stringify(e),""===this.iframe.src?"*":this.iframe.src)):o.sendTraceTag(546096085,s.msoulscat_Wac_PptLive,i.Warning,`StateServiceClient::PostMessage not posting: postMessageReady:${this._isPostMessageReady}; isIframeExists:${null!==this.iframe}; contentWindowExists:${null!==this.iframe.contentWindow}; \n        iframeSrcExists:${0!==this.iframe.src.length}; \n        slideshowFrameExists:${this.iframe.name.indexOf("slideshowframe")>=0};`):(o.sendTraceTag(545104136,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::PostMessage not postMessageReady. isCacheable:${t}; message:${JSON.stringify(e)}`),t&&this._cachedPrePostMessageReadyMessages.push(e))}static tryLogPostMessageData(e,t){try{let n={...e};e&&e.m_metadata&&(n.m_metadata="REDACTED"),o.sendTraceTag(527294606,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::PostMessage isWebview:${t}; message: ${JSON.stringify(n)}`)}catch(e){o.sendTraceTag(527294607,s.msoulscat_Wac_PptLive,i.Warning,"StateServiceClient::PostMessage message: logging caught exception "+e)}}validateMessage(e){return this._tagManager.validateInbound(e,this.isPresenter(),this._healthLogger),this.isPresenter()||"system"===e.senderId||this._lastKnownSenderIds.includes(e.senderId)||o.sendTraceTag(557180642,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::validateMessage Failed to validate message: {senderId: ${e.senderId}, ObjectId: ${e.objectId}, MessageId: ${e.messageId}}`),!0}patchMessage(e){e.metadata||(e.metadata={}),this._tagManager.tagOutbound(e),this._authEnabled&&(e.metadata.mri=this._userId)}get clientId(){return this._stateServiceProxy?this._stateServiceProxy.clientId():""}isPresenter(){return this._role===m.e.Presenter}isInPrivateViewing(){return this._role===m.e.PrivateViewing}switchRole(e){this._role!==e&&(o.sendTraceTag(561517588,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::SwitchRole from ${this._role} to ${e}`),this.events.emit("switchRole",{oldRole:this._role,newRole:e}),this._role=e,this.sendNotifyClientIdMessage("switchRole"))}isLocalChange(e){return this.clientId===e}set postMessageReady(e){e&&this._isPostMessageReady!==e&&(this._isPostMessageReady=e,this.events.emit("postMessageReady"),this._cachedPrePostMessageReadyMessages.length>0&&this._cachedPrePostMessageReadyMessages.forEach(e=>this.postMessageDownward(e,!1)),o.sendTraceTag(545104137,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::PostMessageReady. Cached:"+this._cachedPrePostMessageReadyMessages.length))}async initCell(e,t,n,a){this._stateServiceProxy||o.sendTraceTag(512557842,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::initCell - stateServiceProxy is undefined."),o.sendTraceTag(541869155,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initCell - begin:"+e);let r=await this._stateServiceProxy.waitCellAsync(e,n,a);o.sendTraceTag(541869184,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initCell - got cell:"+e);const l=await r.getAsync();l&&t(l);let c=l;return"presentationUrl"===e&&(c=""),o.sendTraceTag(541869185,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::initCell - backingStore set:${e}; val:${c}`),r}async initMap(e,t,n,a){this._stateServiceProxy||o.sendTraceTag(512557841,s.msoulscat_Wac_PptLive,i.Error,"StateServiceClient::initMap - stateServiceProxy is undefined."),o.sendTraceTag(541869186,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initMap - begin:"+e);let r=await this._stateServiceProxy.waitMapAsync(e,n,a);o.sendTraceTag(541869187,s.msoulscat_Wac_PptLive,i.Info,"StateServiceClient::initMap - got map:"+e);const l=new Map;return r.forEach((t,n)=>{l.set(n,t),o.sendTraceTag(541869188,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::initMap - backingStore set:${e}; k: ${n}; v: ${t}`)}),t(l),o.sendTraceTag(541869189,s.msoulscat_Wac_PptLive,i.Info,`StateServiceClient::initMap - backingStore set:${e}; size: ${l.size}`),r}}class k{constructor(e){this._logger=e}sendTraceTag(e,t,n){this._logger.sendTraceTag(e,s.msoulscat_Wac_PptLive,t,n)}}function O(e){return e?""+(new u.sha256).update(e).digest("hex"):""}},function(e,t,n){(t=e.exports=function(e){e=e.toLowerCase();var n=t[e];if(!n)throw new Error(e+" is not supported (we accept pull requests)");return new n}).sha=n(57),t.sha1=n(63),t.sha224=n(64),t.sha256=n(21),t.sha384=n(65),t.sha512=n(22)},function(e,t,n){"use strict";n.r(t);var i=n(0);n.d(t,"OutboundViewerEventType",(function(){return i.d})),n.d(t,"InboundViewerEventType",(function(){return i.b})),n.d(t,"OutboundLiveEventType",(function(){return i.c})),n.d(t,"InboundLiveEventType",(function(){return i.a})),n.d(t,"SlideShowRole",(function(){return i.e})),n.d(t,"StateServiceEnabledEventType",(function(){return i.f}));var s=n(23);n.d(t,"StateServiceClient",(function(){return s.b})),n.d(t,"LoggerAdapter",(function(){return s.a}));var a=n(3);for(var r in a)["default","OutboundViewerEventType","InboundViewerEventType","OutboundLiveEventType","InboundLiveEventType","SlideShowRole","StateServiceEnabledEventType","StateServiceClient","LoggerAdapter"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r)},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,a,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=2&a[0]?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(6===a[0]&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.createStateServiceProxyAsync=void 0;var a=n(27);t.createStateServiceProxyAsync=function(e,t,n,r,o,l){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){switch(s.label){case 0:return[4,(i=new a.SimpleStateServiceProxy(e,t,n,r,o,l)).connectAsync()];case 1:return s.sent(),[2,i]}}))}))}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,a,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=2&a[0]?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(6===a[0]&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleStateServiceProxy=void 0;var o=r(n(28)),l=n(7),c=n(9),h=n(50),d=n(51),u=n(10),m=n(3),g=n(52),f=n(53),p=n(55),_=n(56),S=[2e3,2e3,3e3,3e3,5e3],v=function(){function e(e,t,n,i,s,a){var r;this.m_events=new l.EventEmitter,this.m_clientId="",this.m_connectionState=m.ConnectionState.Disconnected,this.m_handlers=new Map,this.m_connection=null,this.m_clientIds=new Set,this.m_initTimeoutDurationInMS=0,this.m_retryAttempts=0,this.m_sessionRetryAttempts=0,this.m_maxSessionRetries=0,this.m_outboundMessageInfo=new Map,this.m_initPromise={promise:null,resolve:null,reject:null},this.m_messageBuffer=[],this.m_batchWaitTimeMS=20,this.m_batchMessageTypeName="list",this.m_closeConnectionTimer=null,this.m_lastCloseCode=0,this.m_lastCloseReason="",this.m_offlineMessageCache=[],this.m_unacknowledgedMessages=new Map,this.m_sessionId=e,this.m_logger=i,this.m_connectionAliveTimeAfterLoseFocusInMS=s.websocketAliveTimeAfterLoseFocusInMS,this.m_useServiceGeneratedClientId=s.useServiceGeneratedClientId||!1,this.m_wsUrl=n+"?docId="+this.m_sessionId+"&clientType="+t,s.correlationId&&(this.m_wsUrl+="&cid="+s.correlationId),s.isAutomation&&(this.m_wsUrl+="&automation=true"),s.autoRoutingEnabled&&(this.m_wsUrl+="&routing=true"),this.m_useServiceGeneratedClientId||(this.m_clientId=s.customClientId||c.v4(),this.m_wsUrl+="&clientId="+this.m_clientId),this.m_deltasBaseUrl=n.replace("wss://","https://").replace("ws://","http://"),this.setupSystemClientsCell(),this.setUpSystemCommandsCell(),this.setupServiceGeneratedClientIdCell(),this.m_useServiceGeneratedClientId&&(this.m_clientIdEvictingQueue=new d.EvictingQueue(20)),this.m_telemetry=new p.SimpleServiceTelemetry(this.m_clientId,this.m_sessionId,s.maxRoundtripRaw),this.m_verbose=s.verbose||!1,this.m_batchedRequestsEnabled=s.batchedRequestsEnabled,this.m_initTimeoutDurationInMS=s.initTimeoutDurationInMs||0,this.m_pingTimeoutInMs=s.pingTimeoutInMs,this.m_pongTimeoutInMs=s.pongTimeoutInMs,this.m_user=a,this.m_metadata=s.metadata,this.m_retryIntervalsInMs=s.retryIntervalsInMs||S,this.m_maxSessionRetries=s.maxSessionRetries,this.m_offlineMessageCacheEnabled=s.offlineMessageCacheEnabled,this.m_maxOfflineMessageCacheTimeInMs=s.maxOfflineMessageCacheTimeInMs,this.m_maxOfflineMessageCacheLength=s.maxOfflineMessageCacheLength,this.m_allowReconnectOnMessageSend=s.allowReconnectOnSendMessage||!1,this.m_unacknowledgedMaxTimeInMs=null!==(r=s.unacknowledgeMessageTimeoutInMs)&&void 0!==r?r:0,this.m_subscriptions=s.subscriptions,this.m_connectionSettings={getAuthTokenAsync:this.getAuthToken.bind(this),createSetupMessage:this.createSetupMessage.bind(this),metadata:this.m_metadata,subscriptions:this.m_subscriptions}}return Object.defineProperty(e.prototype,"lastCloseReason",{get:function(){return this.m_lastCloseReason},enumerable:!1,configurable:!0}),e.prototype.senderId=function(){return this.m_clientId},e.prototype.countOfOutboundMessagesNotRoundTrippedYet=function(){return this.m_outboundMessageInfo.size},e.prototype.canRetry=function(){return this.m_connectionState===m.ConnectionState.Disconnected&&4321!==this.m_lastCloseCode},e.prototype.getServiceTelemetry=function(){return this.m_telemetry.wsState=m.ConnectionState[this.getConnectionState()],this.m_telemetry.messagePendingAckCount=this.m_outboundMessageInfo.size,this.m_telemetry},e.prototype.activeClientCount=function(){return this.m_clientIds.size},e.prototype.activeClientIds=function(){return this.m_clientIds},e.prototype.clientId=function(){return this.m_clientId},e.prototype.getConnectionState=function(){return this.m_connectionState},e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.connectAsync=function(){return i(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.m_initPromise.promise=new Promise((function(t,n){e.m_initPromise.resolve=t,e.m_initPromise.reject=n})),this.setConnectionState(m.ConnectionState.Connecting),[2,new Promise((function(t,n){return i(e,void 0,void 0,(function(){var e,i=this;return s(this,(function(s){switch(s.label){case 0:return e=this,[4,_.StateServiceWebSocketConnection.CreateAsync(this.m_wsUrl,this.m_connectionSettings)];case 1:return e.m_connection=s.sent(),this.m_connection.onopen=function(){i.handleConnectionOpen(),i.startInitTimeoutTimerWithRetry(i.m_initTimeoutDurationInMS,i.m_initPromise.reject),t()},this.m_connection.onerror=function(e){var s;i.m_logger.sendTraceTag(590213388,u.TraceLevel.Error,"SimpleStateServiceProxy::connect - "+(null===(s=i.m_connection)||void 0===s?void 0:s.name)+" onerror. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Error: "+JSON.stringify(e)+"}"),i.retryConnection((function(e){var t,s="failed to reconnect after "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" error: "+h.errorToString(e);i.m_logger.sendTraceTag(579463185,u.TraceLevel.Error,s),n(s)}),!1,(function(){return t()}))},this.m_connection.onlog=function(e){var t;i.m_logger.sendTraceTag(556909603,e.detail.level,"SimpleStateServiceProxy::log - "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Message: "+e.detail.message+"}")},this.m_connection.onclose=function(e){var s,a;i.m_logger.sendTraceTag(590213389,u.TraceLevel.Error,"SimpleStateServiceProxy::connect - "+(null===(s=i.m_connection)||void 0===s?void 0:s.name)+" onclose. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Code: "+e.code+", Reason: "+e.reason+"}"),i.m_lastCloseCode=e.code,i.m_lastCloseReason=e.reason,4321!==e.code?i.retryConnection((function(e){var t="failed to reconnect after service side disconnect: "+h.errorToString(e);i.m_logger.sendTraceTag(579463186,u.TraceLevel.Error,t),n(t)}),!1,(function(){return t()})):(i.setConnectionState(m.ConnectionState.Disconnected),i.m_logger.sendTraceTag(588009741,u.TraceLevel.Error,"SimpleStateServiceProxy::connect - "+(null===(a=i.m_connection)||void 0===a?void 0:a.name)+" onclose. Not retryable close code. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+"}"))},this.m_connection.onmessage=function(e){var t;try{i.handleConnectionMessage(e)}catch(e){i.m_logger.sendTraceTag(590213390,u.TraceLevel.Error,"SimpleStateServiceProxy::onmessage - "+(null===(t=i.m_connection)||void 0===t?void 0:t.name)+" error. {sessionId: "+i.m_sessionId+", ClientId: "+i.m_clientId+", Error: "+h.errorToString(e)+"}")}},[2]}}))}))}))]}))}))},e.prototype.close=function(){var e;this.m_logger.sendTraceTag(590213400,u.TraceLevel.Info,"SimpleStateServiceProxy::close. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.closeAndClearConnection(),this.m_retryTimer&&(clearTimeout(this.m_retryTimer),this.m_retryTimer=null),this.m_unacknowledgedMessages.clear(),this.clearPingPongTimer(),this.clearOfflineMessageCacheTimer(),this.clearInitTimeoutTimer(),this.clearUnacknowledgedTimer(),null===(e=this.m_clientIdEvictingQueue)||void 0===e||e.clear(),0!==this.countOfOutboundMessagesNotRoundTrippedYet()&&(this.m_events.emit("messageFailedToRoundTripOnClose",this.m_outboundMessageInfo.size),this.m_outboundMessageInfo.clear())},e.prototype.sendStateMessage=function(e){this.sendStateMessageImpl(e)},e.prototype.createMapAsync=function(e,t,n,a){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){return i=new f.SimpleSyncMap(e,this,t,n,a),this.m_handlers.set(e,i),[2,i]}))}))},e.prototype.getMapAsync=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitMapAsync=function(e,t,n,a){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){switch(s.label){case 0:return[4,this.m_initPromise.promise];case 1:return s.sent(),[4,this.getMapAsync(e)];case 2:return(i=s.sent())?[3,4]:[4,this.createMapAsync(e,t,n,a)];case 3:i=s.sent(),s.label=4;case 4:return[2,i]}}))}))},e.prototype.createCellAsync=function(e,t,n,a){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){return i=new g.SimpleSyncCell(e,this,t,n,a),this.m_handlers.set(e,i),[2,i]}))}))},e.prototype.getCellAsync=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){return(t=this.m_handlers.get(e))?[2,t]:[2,null]}))}))},e.prototype.waitCellAsync=function(e,t,n,a){return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){switch(s.label){case 0:return this.m_logger.sendTraceTag(520161040,u.TraceLevel.Info,"SimpleStateServiceProxy::waitCellAsync - awaiting initPromise "+e),[4,this.m_initPromise.promise];case 1:return s.sent(),this.m_logger.sendTraceTag(520161039,u.TraceLevel.Info,"SimpleStateServiceProxy::waitCellAsync - getCellAsync "+e),[4,this.getCellAsync(e)];case 2:return(i=s.sent())?[3,4]:(this.m_logger.sendTraceTag(520161038,u.TraceLevel.Info,"SimpleStateServiceProxy::waitCellAsync - createCellAsync "+e),[4,this.createCellAsync(e,t,n,a)]);case 3:i=s.sent(),s.label=4;case 4:return[2,i]}}))}))},e.prototype.onFocusChanged=function(e){var t=this;e?(window.clearTimeout(this.m_closeConnectionTimer),this.m_connection||(this.m_logger.sendTraceTag(590213392,u.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - retryConnection due to getting focus again. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.retryConnection((function(e){t.m_logger.sendTraceTag(579463187,u.TraceLevel.Error,"failed to reconnect after regaining focus: "+h.errorToString(e))}),!0))):this.m_closeConnectionTimer=window.setTimeout((function(){var e;t.m_connection&&(t.m_logger.sendTraceTag(590213391,u.TraceLevel.Info,"SimpleStateServiceProxy::onFocusChanged - "+(null===(e=t.m_connection)||void 0===e?void 0:e.name)+" close due to losing focus. {sessionId: "+t.m_sessionId+", ClientId: "+t.m_clientId+"}"),t.m_connection.onclose=function(){},t.m_connection.close(),t.m_connection=null)}),this.m_connectionAliveTimeAfterLoseFocusInMS)},e.prototype.getHistoryAsync=function(e,t){return i(this,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return(n=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),n.searchParams.append("docId",this.m_sessionId),n.searchParams.append("cid",this.m_clientId),n.searchParams.append("objectId",e),t&&n.searchParams.append("property",t),[4,o.default.get(n.toString())];case 1:return(i=s.sent().data).forEach((function(e){return e.value=JSON.parse(e.value)})),[2,i]}}))}))},e.prototype.getHistoryWithPaginationAsync=function(e,t,n){return i(this,void 0,void 0,(function(){var i,a;return s(this,(function(s){switch(s.label){case 0:return(i=new URL(this.m_deltasBaseUrl)).searchParams.append("action","deltas"),i.searchParams.append("docId",this.m_sessionId),i.searchParams.append("cid",this.m_clientId),i.searchParams.append("objectId",e),i.searchParams.append("pagination","true"),n&&i.searchParams.append("cursor",n),t&&i.searchParams.append("property",t),[4,o.default.get(i.toString())];case 1:return(a=s.sent().data).messages.forEach((function(e){return e.value=JSON.parse(e.value)})),[2,a]}}))}))},e.prototype.setupSystemClientsCell=function(){var e=this;this.m_clientsCell=new g.SimpleSyncCell("systemClients",this),this.m_handlers.set(this.m_clientsCell.id(),this.m_clientsCell),this.m_clientsCell.on("valueChanged",(function(t){e.m_clientIds=new Set(t),e.m_events.emit("activeClientCountChanged")}))},e.prototype.setUpSystemCommandsCell=function(){var e=this;this.m_systemCommandsCell=new g.SimpleSyncCell(m.SystemCommandsStateName,this),this.m_handlers.set(this.m_systemCommandsCell.id(),this.m_systemCommandsCell),this.m_systemCommandsCell.on("valueChanged",(function(t){return i(e,void 0,void 0,(function(){var e,n,i;return s(this,(function(s){switch(s.label){case 0:switch(t){case"refreshToken":return[3,1]}return[3,6];case 1:if(!this.m_user||!this.m_user.getForceRefreshedTokenAsync)return[3,5];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,this.m_user.getForceRefreshedTokenAsync()];case 3:return e=s.sent(),n={},e&&(n.authorization=e.token,n.authProvider=e.authProvider,n.mri=e.mri||"",n.huid=e.hashedUserEmail||""),this.sendConfigMessage(n),[3,5];case 4:return i=s.sent(),this.m_logger.sendTraceTag(574107847,u.TraceLevel.Error,"Error getting force refreshed auth token: "+h.errorToString(i)),[3,5];case 5:return[3,7];case 6:return this.m_logger.sendTraceTag(574107848,u.TraceLevel.Error,"Unknown system command cell value: "+t),[3,7];case 7:return[2]}}))}))}))},e.prototype.setupServiceGeneratedClientIdCell=function(){var e=this;this.m_serviceGeneratedClientIdCell=new g.SimpleSyncCell(m.ServiceGeneratedClientIdName,this),this.m_handlers.set(this.m_serviceGeneratedClientIdCell.id(),this.m_serviceGeneratedClientIdCell),this.m_serviceGeneratedClientIdCell.on("valueChanged",(function(t){e.m_logger.sendTraceTag(520161037,u.TraceLevel.Info,"SimpleStateServiceProxy::serviceGeneratedClientId changed to "+t+"}"),e.setClientId(t,!0),e.processClientIdQueue(),e.m_useServiceGeneratedClientId&&(e.processOfflineMessageCache(!0),e.clearOfflineMessageCacheTimer())})),this.m_logger.sendTraceTag(509743689,u.TraceLevel.Info,"SimpleStateServiceProxy::setupServiceGeneratedClientIdCell completed.")},e.prototype.handleConnectionOpen=function(){var e;this.m_logger.sendTraceTag(590213387,u.TraceLevel.Info,"SimpleStateServiceProxy::connect - "+(null===(e=this.m_connection)||void 0===e?void 0:e.name)+" onopen. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryAttempts=0,this.setConnectionState(m.ConnectionState.Connected),this.startPingTimer(),this.m_useServiceGeneratedClientId||(this.processOfflineMessageCache(!1),this.clearOfflineMessageCacheTimer())},e.prototype.setConnectionState=function(e){this.m_connectionState!==e&&(this.m_connectionState=e,e===m.ConnectionState.Disconnected&&this.m_useServiceGeneratedClientId&&this.setClientId("",!1),this.m_events.emit("connectionStateChanged"))},e.prototype.setClientId=function(e,t){this.m_clientId!==e&&(this.m_clientId=e,t&&this.m_events.emit("clientIdChanged"))},e.prototype.processClientIdQueue=function(){var e=this;this.m_clientIdEvictingQueue&&this.m_clientIdEvictingQueue.forEach((function(t){t.senderId=e.m_clientId,e.sendConnectionMessage(t,!0)}))},e.prototype.sendGetInitialSystemStateMessages=function(){try{var e={messageId:c.v4(),senderId:this.senderId(),objectId:m.SystemSessionStateName,type:"",operation:"get",value:""};this.sendStateMessage(e);var t={messageId:c.v4(),senderId:this.senderId(),objectId:m.ServiceGeneratedClientIdName,type:"",operation:"get",value:""};this.sendStateMessage(t),this.m_logger.sendTraceTag(509141838,u.TraceLevel.Info,"SimpleStateServiceProxy::sendGetInitialSystemStateMessages - sent messages.")}catch(e){this.m_logger.sendTraceTag(509141837,u.TraceLevel.Error,"SimpleStateServiceProxy::sendGetInitialSystemStateMessages - caught error "+e)}},e.prototype.createSetupMessage=function(e){var t=e.authToken,n=e.metadata,i=e.subscriptions,s=[];if(t||n){var a={};t&&(a.authorization=t.token,a.authProvider=t.authProvider,a.mri=t.mri||"",a.huid=t.hashedUserEmail||""),n&&(a.metadata=JSON.stringify(n));var r={messageId:c.v4(),senderId:this.senderId(),objectId:m.ConfigurationName,type:"",operation:"",value:JSON.stringify(a)};s.push(JSON.stringify(r))}return i&&(r={messageId:c.v4(),senderId:this.senderId(),objectId:m.StateSubscriptionsName,type:"",operation:"",value:JSON.stringify(i)},s.push(JSON.stringify(r))),s},e.prototype.sendConfigMessage=function(e){var t={messageId:c.v4(),senderId:this.senderId(),objectId:m.ConfigurationName,type:"",operation:"",value:JSON.stringify(e)};this.sendStateMessage(t)},e.prototype.retryConnection=function(e,t,n){var a=this;if(this.clearPingPongTimer(),this.clearInitTimeoutTimer(),this.m_retryAttempts>=this.m_retryIntervalsInMs.length||this.m_sessionRetryAttempts>=this.m_maxSessionRetries)return this.setConnectionState(m.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213393,u.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection reached max retry attempts. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),void(e&&e(new Error("reached max retry attempts")));if(this.setConnectionState(m.ConnectionState.Connecting),t||this.m_connection&&!this.m_retryTimer){var r=this.m_retryIntervalsInMs[this.m_retryAttempts];this.m_retryAttempts+=1,this.m_sessionRetryAttempts+=1,this.m_telemetry.wsReconnectCount+=1,this.closeAndClearConnection(),this.m_retryTimer=setTimeout((function(){return i(a,void 0,void 0,(function(){var t;return s(this,(function(i){switch(i.label){case 0:this.m_logger.sendTraceTag(590213395,u.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}"),this.m_retryTimer=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.connectAsync()];case 2:return i.sent(),n&&n(),[3,4];case 3:return t=i.sent(),this.setConnectionState(m.ConnectionState.Disconnected),this.m_logger.sendTraceTag(590213396,u.TraceLevel.Error,"SimpleStateServiceProxy::retryConnection failed. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}, "+h.errorToString(t)),this.m_retryAttempts>=this.m_retryIntervalsInMs.length&&e(t),[3,4];case 4:return[2]}}))}))}),r)}else this.m_logger.sendTraceTag(590213394,u.TraceLevel.Info,"SimpleStateServiceProxy::retryConnection skipped. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", NullConnection: "+(null===this.m_connection)+", NullRetryTimer: "+(null===this.m_retryTimer)+"}")},e.prototype.startPingTimer=function(){var e=this;this.m_connection&&this.m_connection.shouldSendPings&&(this.m_pingTimeoutInMs<=0||this.m_pongTimeoutInMs<=0||(this.clearPingPongTimer(),this.m_pingTimer=setTimeout((function(){return i(e,void 0,void 0,(function(){return s(this,(function(e){return this.sendPingMessage(),this.m_pingTimer=null,[2]}))}))}),this.m_pingTimeoutInMs)))},e.prototype.sendPingMessage=function(){var e=this;this.m_connection&&(this.m_connection.isOpen?(this.m_verbose&&this.m_logger.sendTraceTag(559952470,u.TraceLevel.Info,"SimpleStateServiceProxy::sendPingMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", __ping__"),this.m_connection.send("__ping__"),this.clearPongTimer(),this.m_pongTimer=setTimeout((function(){return i(e,void 0,void 0,(function(){var e=this;return s(this,(function(t){return this.retryConnection((function(t){e.m_logger.sendTraceTag(579463188,u.TraceLevel.Error,"failed to reconnect after missing ping: "+h.errorToString(t))}),!1),this.m_pongTimer=null,[2]}))}))}),this.m_pongTimeoutInMs)):(this.retryConnection((function(t){e.m_logger.sendTraceTag(579463189,u.TraceLevel.Error,"failed to reconnect after closed connection: "+h.errorToString(t))}),!1),this.clearPongTimer()))},e.prototype.clearPingPongTimer=function(){this.clearPingTimer(),this.clearPongTimer()},e.prototype.clearPingTimer=function(){this.m_pingTimer&&(clearTimeout(this.m_pingTimer),this.m_pingTimer=null)},e.prototype.clearPongTimer=function(){this.m_pongTimer&&(clearTimeout(this.m_pongTimer),this.m_pongTimer=null)},e.prototype.handleConnectionMessage=function(e){if("string"==typeof e.data){if(this.startPingTimer(),"__pong__"===e.data)return void(this.m_verbose&&this.m_logger.sendTraceTag(559952471,u.TraceLevel.Info,"SimpleStateServiceProxy::handleConnectionMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", __pong__"));var t=Date.now();try{var n=JSON.parse(e.data);Array.isArray(n)&&n.length>0?this.handleAggregatedStateMessages(n):this.handleStateMessage(n),this.m_telemetry.addMessageHandleLatency(Date.now()-t),n.objectId===m.SystemSessionStateName?(this.m_logger.sendTraceTag(520161036,u.TraceLevel.Info,"SimpleStateServiceProxy::handleConnectionMessage - systemSessionState - initPromise resolved."),this.m_initPromise.resolve(),this.clearInitTimeoutTimer()):n.objectId===m.ServiceGeneratedClientIdName&&this.m_logger.sendTraceTag(509743688,u.TraceLevel.Info,"SimpleStateServiceProxy::handleConnectionMessage - serviceGeneratedClientId received.")}catch(e){this.m_logger.sendTraceTag(578102302,u.TraceLevel.Error,"handleConnectionMessage: "+h.errorToString(e))}}else this.m_logger.sendTraceTag(590213397,u.TraceLevel.Error,"SimpleStateServiceProxy::handleConnectionMessage - Unknown data type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+typeof e.data+"}")},e.prototype.handleAggregatedStateMessages=function(e){var t,n,i=this;if(e&&0!==e.length){var s=e.map((function(e){return JSON.parse(e)})),r={};s.forEach((function(e){return r[e.objectId]=1+(r[e.objectId]||0)})),Object.keys(r).forEach((function(e){if(r[e]>1){var t=i.m_handlers.get(e);t&&t.beginAggregatedStateUpdating&&t.beginAggregatedStateUpdating()}}));try{for(var o=a(s),l=o.next();!l.done;l=o.next()){var c=l.value;this.handleStateMessage(c)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}Object.keys(r).forEach((function(e){if(r[e]>1){var t=i.m_handlers.get(e);t&&t.endAggregatedStateUpdating&&t.endAggregatedStateUpdating()}}))}},e.prototype.handleStateMessage=function(e){var t=this;if(this.m_verbose&&this.m_logger.sendTraceTag(590213398,u.TraceLevel.Info,"SimpleStateServiceProxy::handleStateMessage. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),"list"===e.type)JSON.parse(e.value).forEach((function(e){t.handleStateMessage(e)}));else{if(this.m_user&&this.m_user.validateMessage&&!this.m_user.validateMessage(e))return void this.m_logger.sendTraceTag(588009742,u.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage rejected message: {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}");var n=this.getHandlerForMessage(e);if(e.senderId===this.senderId()&&(this.acknowledgeMessage(e,n),this.m_telemetry.incrementAcknowledgedCount(e.objectId)),this.measureMessageRoundTripLatency(e),this.m_telemetry.incrementReceivedCount(e.objectId),n)return void n.handleStateMessage(e)}},e.prototype.getAuthToken=function(){return i(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:if(!this.m_user||!this.m_user.getAuthTokenAsync)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.m_user.getAuthTokenAsync()];case 2:return e=n.sent(),[3,4];case 3:return t=n.sent(),this.m_logger.sendTraceTag(578102469,u.TraceLevel.Error,"Error getting auth token: "+h.errorToString(t)),[3,4];case 4:return[2,e]}}))}))},e.prototype.getHandlerForMessage=function(e){var t=this.m_handlers.get(e.objectId);return t||("cell"===e.type?t=new g.SimpleSyncCell(e.objectId,this):"map"===e.type?t=new f.SimpleSyncMap(e.objectId,this):this.m_logger.sendTraceTag(559204164,u.TraceLevel.Error,"SimpleStateServiceProxy::handleStateMessage - Unknown message type. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Type: "+e.type+"}"),t&&this.m_handlers.set(e.objectId,t),t)},e.prototype.sendStateMessageImpl=function(e){var t,n=this;if(this.m_verbose&&this.m_logger.sendTraceTag(590213403,u.TraceLevel.Info,"SimpleStateServiceProxy::sendStateMessageImpl. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}"),e.objectId!==m.StateSubscriptionsName&&e.objectId!==m.ConfigurationName){if(this.m_outboundMessageInfo.set(e.messageId,Date.now()),this.m_telemetry.incrementRequestedCount(e.objectId),this.m_unacknowledgedMaxTimeInMs>0){var i=null===(t=this.getHandlerForMessage(e))||void 0===t?void 0:t.messageTrackingOption();if(i&&i!==m.MessageTrackingOption.None){var s=this.getUnacknowledgedMessagesMapKey(e,i);this.m_unacknowledgedMessages.set(s,{message:e,timestamp:Date.now()}),this.startUnacknowledgeMessageTimer()}}if(this.m_useServiceGeneratedClientId&&this.m_clientIdEvictingQueue&&!this.m_clientId&&"get"!==e.operation)return this.m_logger.sendTraceTag(508348254,u.TraceLevel.Info,"SimpleStateServiceProxy::enqueueMessage "+JSON.stringify(e)),void this.m_clientIdEvictingQueue.enqueue(e)}this.m_user&&this.m_user.patchMessage&&this.m_user.patchMessage(e),this.m_batchedRequestsEnabled?(this.m_messageBuffer.push(e),this.m_processBufferTimer||(this.m_processBufferTimer=setTimeout((function(){n.processMessageBuffer()}),this.m_batchWaitTimeMS))):this.sendConnectionMessage(e,!0)},e.prototype.createListMessage=function(e){if(0!==e.length)return 1===e.length?e[0]:{value:JSON.stringify(e),type:this.m_batchMessageTypeName,operation:"",messageId:c.v4(),objectId:"batch",senderId:this.senderId()}},e.prototype.processMessageBuffer=function(){var e=this.m_messageBuffer.length,t=this.m_messageBuffer.splice(0,e),n=this.createListMessage(t);this.m_processBufferTimer&&clearTimeout(this.m_processBufferTimer),this.m_processBufferTimer=null,n&&this.sendConnectionMessage(n,!0)},e.prototype.processOfflineMessageCache=function(e){var t=this;this.m_offlineMessageCacheEnabled&&(this.m_offlineMessageCache.forEach((function(n){e&&(n.message.senderId=t.m_clientId),t.sendConnectionMessage(n.message,!1),t.m_telemetry.offlineCacheTelemetry.resentCount+=1})),this.m_offlineMessageCache=[])},e.prototype.purgeOfflineMessageCache=function(){var e=this;if(this.m_offlineMessageCacheEnabled&&this.m_maxOfflineMessageCacheTimeInMs){var t=Date.now(),n=this.m_offlineMessageCache.filter((function(n){return e.m_maxOfflineMessageCacheTimeInMs&&n.timestamp+e.m_maxOfflineMessageCacheTimeInMs>=t}));this.m_telemetry.offlineCacheTelemetry.expiredCount+=this.m_offlineMessageCache.length-n.length,this.m_offlineMessageCache=n,0===this.m_offlineMessageCache.length&&this.clearOfflineMessageCacheTimer()}},e.prototype.clearOfflineMessageCacheTimer=function(){this.m_offlineMessageCacheEnabled&&this.m_offlineMessageCacheTimer&&(clearInterval(this.m_offlineMessageCacheTimer),this.m_offlineMessageCacheTimer=null)},e.prototype.getUnacknowledgedMessagesMapKey=function(e,t){return t===m.MessageTrackingOption.None?"":t===m.MessageTrackingOption.All?e.messageId:e.objectId},e.prototype.startUnacknowledgeMessageTimer=function(){var e=this;this.m_unacknowledgedMaxTimeInMs>0&&!this.m_unacknowledgedTimer&&(this.m_unacknowledgedTimer=setInterval((function(){e.notifyUnacknowledgedMessages(),e.m_unacknowledgedMessages.size<=0&&e.clearUnacknowledgedTimer()}),this.m_unacknowledgedMaxTimeInMs/2))},e.prototype.acknowledgeMessage=function(e,t){if(e.senderId===this.senderId()&&t&&!(this.m_unacknowledgedMessages.size<=0)){var n=this.getUnacknowledgedMessagesMapKey(e,t.messageTrackingOption()),i=this.m_unacknowledgedMessages.get(n);i&&e.messageId===i.message.messageId&&this.m_unacknowledgedMessages.delete(n)}},e.prototype.notifyUnacknowledgedMessages=function(){var e=this,t=Date.now();this.m_unacknowledgedMessages.forEach((function(n,i){if(n.timestamp+e.m_unacknowledgedMaxTimeInMs<t){var s=e.getHandlerForMessage(n.message);null==s||s.handleUnacknowledgedMessage(n.message),e.m_unacknowledgedMessages.delete(i),e.m_telemetry.unacknowledgedMessagesCount+=1}}))},e.prototype.clearUnacknowledgedTimer=function(){this.m_unacknowledgedTimer&&(clearInterval(this.m_unacknowledgedTimer),this.m_unacknowledgedTimer=null)},e.prototype.startInitTimeoutTimerWithRetry=function(e,t){var n=this;this.startInitTimeoutTimer(e,(function(){n.m_logger.sendTraceTag(509141836,u.TraceLevel.Error,"SimpleStateServiceProxy::startInitTimeoutTimer - failed to init after "+e+" ms; requesting get messages and retrying"),n.sendGetInitialSystemStateMessages(),n.startInitTimeoutTimer(e,t)}))},e.prototype.startInitTimeoutTimer=function(e,t){e>0&&(this.clearInitTimeoutTimer(),this.m_initTimeoutTimer=setTimeout((function(){t("Initialization timed out after "+e+" ms")}),e))},e.prototype.clearInitTimeoutTimer=function(){this.m_initTimeoutTimer&&clearTimeout(this.m_initTimeoutTimer)},e.prototype.sendConnectionMessage=function(e,t){var n,i,s=this;if(this.m_allowReconnectOnMessageSend&&this.m_connectionState===m.ConnectionState.Disconnected&&(this.updateRetryAttempts(),this.retryConnection((function(e){s.m_logger.sendTraceTag(559428289,u.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - failed to reconnect with error: "+h.errorToString(e)+" ")}),!1)),this.m_offlineMessageCacheEnabled&&t){if(!this.m_connection||this.m_connectionState!==m.ConnectionState.Connected)return!this.m_maxOfflineMessageCacheLength||this.m_offlineMessageCache.length>=this.m_maxOfflineMessageCacheLength?(this.m_telemetry.offlineCacheTelemetry.rejectedCount+=1,void this.m_logger.sendTraceTag(570807006,u.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - Dropping message because offline cache is full. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Status: "+(null===(n=this.m_connection)||void 0===n?void 0:n.readyState)+"}")):(!this.m_offlineMessageCacheTimer&&this.m_maxOfflineMessageCacheTimeInMs&&(this.m_offlineMessageCacheTimer=setInterval((function(){s.purgeOfflineMessageCache()}),this.m_maxOfflineMessageCacheTimeInMs/2)),this.m_offlineMessageCache.push({message:e,timestamp:Date.now()}),void(this.m_telemetry.offlineCacheTelemetry.cachedCount+=1))}else{if(!this.m_connection)return void this.m_logger.sendTraceTag(590213401,u.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - connection is not set. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+"}");if(!this.m_connection.isOpen)return void this.m_logger.sendTraceTag(590213402,u.TraceLevel.Error,"SimpleStateServiceProxy::sendConnectionMessage - "+this.m_connection.name+" status is not open. {sessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", Status: "+this.m_connection.readyState+"}")}null===(i=this.m_connection)||void 0===i||i.send(JSON.stringify(e))},e.prototype.closeAndClearConnection=function(){if(this.m_connection){if(this.m_connection.onclose=function(){},this.m_connection.isOpen)this.m_connection.close();else{var e=this.m_connection;e.onopen=function(){return e.close()}}this.m_connection=null}},e.prototype.updateRetryAttempts=function(){this.m_retryAttempts>=this.m_retryIntervalsInMs.length&&(this.m_retryAttempts=0),this.m_sessionRetryAttempts>=this.m_maxSessionRetries&&(this.m_sessionRetryAttempts=0)},e.prototype.measureMessageRoundTripLatency=function(e){if(e.senderId===this.senderId())try{var t=this.m_outboundMessageInfo.get(e.messageId);if(void 0!==t){this.m_outboundMessageInfo.delete(e.messageId);var n=Date.now()-t;this.m_events.emit("messageRoundTripped",{clientId:this.m_clientId,sessionId:this.m_sessionId,messageId:e.messageId,objectId:e.objectId,operation:e.operation,latencyInMs:n}),this.m_telemetry.addRoundtripLatency(n)}else this.m_verbose&&this.m_logger.sendTraceTag(590213404,u.TraceLevel.Info,"SimpleStateServiceProxy::measureMessageRoundTripLatency. Failed to find outbound message info for {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", ObjectId: "+e.objectId+", MessageId: "+e.messageId+"}")}catch(t){this.m_logger.sendTraceTag(590213405,u.TraceLevel.Error,"SimpleStateServiceProxy::measureMessageRoundTripLatency - Exception thrown error. {SessionId: "+this.m_sessionId+", ClientId: "+this.m_clientId+", MessageId: "+e.messageId+", Error: "+t.message+"}")}},e}();t.SimpleStateServiceProxy=v},function(e,t,n){e.exports=n(29)},function(e,t,n){"use strict";var i=n(2),s=n(11),a=n(30),r=n(17);function o(e){var t=new a(e),n=s(a.prototype.request,t);return i.extend(n,a.prototype,t),i.extend(n,t),n}var l=o(n(8));l.Axios=a,l.create=function(e){return o(r(l.defaults,e))},l.Cancel=n(18),l.CancelToken=n(45),l.isCancel=n(16),l.all=function(e){return Promise.all(e)},l.spread=n(46),l.isAxiosError=n(47),e.exports=l,e.exports.default=l},function(e,t,n){"use strict";var i=n(2),s=n(12),a=n(31),r=n(32),o=n(17),l=n(43),c=l.validators;function h(e){this.defaults=e,this.interceptors={request:new a,response:new a}}h.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=o(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean,"1.0.0"),forcedJSONParsing:c.transitional(c.boolean,"1.0.0"),clarifyTimeoutError:c.transitional(c.boolean,"1.0.0")},!1);var n=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var s,a=[];if(this.interceptors.response.forEach((function(e){a.push(e.fulfilled,e.rejected)})),!i){var h=[r,void 0];for(Array.prototype.unshift.apply(h,n),h=h.concat(a),s=Promise.resolve(e);h.length;)s=s.then(h.shift(),h.shift());return s}for(var d=e;n.length;){var u=n.shift(),m=n.shift();try{d=u(d)}catch(e){m(e);break}}try{s=r(d)}catch(e){return Promise.reject(e)}for(;a.length;)s=s.then(a.shift(),a.shift());return s},h.prototype.getUri=function(e){return e=o(this.defaults,e),s(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){h.prototype[e]=function(t,n){return this.request(o(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){h.prototype[e]=function(t,n,i){return this.request(o(i||{},{method:e,url:t,data:n}))}})),e.exports=h},function(e,t,n){"use strict";var i=n(2);function s(){this.handlers=[]}s.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},s.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},s.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=s},function(e,t,n){"use strict";var i=n(2),s=n(33),a=n(16),r=n(8);function o(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return o(e),e.headers=e.headers||{},e.data=s.call(e,e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||r.adapter)(e).then((function(t){return o(e),t.data=s.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return a(t)||(o(e),t&&t.response&&(t.response.data=s.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var i=n(2),s=n(8);e.exports=function(e,t,n){var a=this||s;return i.forEach(n,(function(n){e=n.call(a,e,t)})),e}},function(e,t){var n,i,s=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(e){i=r}}();var l,c=[],h=!1,d=-1;function u(){h&&l&&(h=!1,l.length?c=l.concat(c):d=-1,c.length&&m())}function m(){if(!h){var e=o(u);h=!0;for(var t=c.length;t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function f(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new g(e,t)),1!==c.length||h||o(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){"use strict";var i=n(2);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},function(e,t,n){"use strict";var i=n(15);e.exports=function(e,t,n){var s=n.config.validateStatus;n.status&&s&&!s(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var i=n(2);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,s,a,r){var o=[];o.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),i.isString(s)&&o.push("path="+s),i.isString(a)&&o.push("domain="+a),!0===r&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var i=n(39),s=n(40);e.exports=function(e,t){return e&&!i(t)?s(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var i=n(2),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,a,r={};return e?(i.forEach(e.split("\n"),(function(e){if(a=e.indexOf(":"),t=i.trim(e.substr(0,a)).toLowerCase(),n=i.trim(e.substr(a+1)),t){if(r[t]&&s.indexOf(t)>=0)return;r[t]="set-cookie"===t?(r[t]?r[t]:[]).concat([n]):r[t]?r[t]+", "+n:n}})),r):r}},function(e,t,n){"use strict";var i=n(2);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function s(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=s(window.location.href),function(t){var n=i.isString(t)?s(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var i=n(44),s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var a={},r=i.version.split(".");function o(e,t){for(var n=t?t.split("."):r,i=e.split("."),s=0;s<3;s++){if(n[s]>i[s])return!0;if(n[s]<i[s])return!1}return!1}s.transitional=function(e,t,n){var s=t&&o(t);function r(e,t){return"[Axios v"+i.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,o){if(!1===e)throw new Error(r(i," has been removed in "+t));return s&&!a[i]&&(a[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}},e.exports={isOlderVersion:o,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),s=i.length;s-- >0;){var a=i[s],r=t[a];if(r){var o=e[a],l=void 0===o||r(o,a,e);if(!0!==l)throw new TypeError("option "+a+" must be "+l)}else if(!0!==n)throw Error("Unknown option "+a)}},validators:s}},function(e){e.exports=JSON.parse('{"_args":[["axios@0.21.4","D:\\\\a\\\\_work\\\\1\\\\s\\\\Packages\\\\StateServicePreviewerClient"]],"_from":"axios@0.21.4","_id":"axios@0.21.4","_inBundle":false,"_integrity":"sha1-xnuQ3AVo5cHPKwuFjEO6KOLtpXU=","_location":"/axios","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"axios@0.21.4","name":"axios","escapedName":"axios","rawSpec":"0.21.4","saveSpec":null,"fetchSpec":"0.21.4"},"_requiredBy":["/@powerpoint-webcomponents/stateservice-proxy"],"_resolved":"https://office.pkgs.visualstudio.com/_packaging/Office/npm/registry/axios/-/axios-0.21.4.tgz","_spec":"0.21.4","_where":"D:\\\\a\\\\_work\\\\1\\\\s\\\\Packages\\\\StateServicePreviewerClient","author":{"name":"Matt Zabriskie"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"bugs":{"url":"https://github.com/axios/axios/issues"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}],"dependencies":{"follow-redirects":"^1.14.0"},"description":"Promise based HTTP client for the browser and node.js","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"homepage":"https://axios-http.com","jsdelivr":"dist/axios.min.js","keywords":["xhr","http","ajax","promise","node"],"license":"MIT","main":"index.js","name":"axios","repository":{"type":"git","url":"git+https://github.com/axios/axios.git"},"scripts":{"build":"NODE_ENV=production grunt build","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","examples":"node ./examples/server.js","fix":"eslint --fix lib/**/*.js","postversion":"git push && git push --tags","preversion":"npm test","start":"node ./sandbox/server.js","test":"grunt test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},"typings":"./index.d.ts","unpkg":"dist/axios.min.js","version":"0.21.4"}')},function(e,t,n){"use strict";var i=n(18);function s(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var e;return{token:new s((function(t){e=t})),cancel:e}},e.exports=s},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){var i,s,a=n(19),r=n(20),o=0,l=0;e.exports=function(e,t,n){var c=t&&n||0,h=t||[],d=(e=e||{}).node||i,u=void 0!==e.clockseq?e.clockseq:s;if(null==d||null==u){var m=a();null==d&&(d=i=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==u&&(u=s=16383&(m[6]<<8|m[7]))}var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:l+1,p=g-o+(f-l)/1e4;if(p<0&&void 0===e.clockseq&&(u=u+1&16383),(p<0||g>o)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=g,l=f,s=u;var _=(1e4*(268435455&(g+=122192928e5))+f)%4294967296;h[c++]=_>>>24&255,h[c++]=_>>>16&255,h[c++]=_>>>8&255,h[c++]=255&_;var S=g/4294967296*1e4&268435455;h[c++]=S>>>8&255,h[c++]=255&S,h[c++]=S>>>24&15|16,h[c++]=S>>>16&255,h[c++]=u>>>8|128,h[c++]=255&u;for(var v=0;v<6;++v)h[c+v]=d[v];return t||r(h)}},function(e,t,n){var i=n(19),s=n(20);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||i)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[a+o]=r[o];return t||s(r)}},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.errorToString=void 0,t.errorToString=function(e,t){if(void 0===t&&(t=!0),null==e)return"";if("string"==typeof e)return e;try{return JSON.stringify(e,a(s(t)))}catch(e){return"Stringifying error failed"}};var s=function(e){return void 0===e&&(e=!1),function(t,n){return n instanceof Error?i({name:n.name,message:n.message,stack:e?[]:("string"==typeof n.stack?n.stack:"").split("\n").map((function(e){return e.trim()})).filter((function(e){return!!e}))},n):n}},a=function(e){var t=new WeakSet;return function(n,i){if("object"==typeof i&&null!==i){if(t.has(i))return;t.add(i)}return e(n,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EvictingQueue=void 0;var i=function(){function e(e){this.maxSize=e,this._store=[]}return Object.defineProperty(e.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._store.length},enumerable:!1,configurable:!0}),e.prototype.enqueue=function(e){this._store.length>=this.maxSize&&this._store.shift(),this._store.push(e)},e.prototype.dequeue=function(){return this._store.shift()},e.prototype.clear=function(){this._store=[]},e.prototype.forEach=function(e){this._store.forEach(e)},e}();t.EvictingQueue=i},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,a,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=2&a[0]?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(6===a[0]&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncCell=void 0;var a=n(7),r=n(9),o=n(3),l=function(){function e(e,t,n,i,s){this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=n,this.aggregation=s,this.m_events=new a.EventEmitter,this.m_emitUnacknowledgedEventFor=null!=i?i:o.MessageTrackingOption.None}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.messageTrackingOption=function(){return this.m_emitUnacknowledgedEventFor},e.prototype.getAsync=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2,this.m_value]}))}))},e.prototype.setAsync=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){return this.m_value=e,t={messageId:r.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"set",value:JSON.stringify(this.m_value)},this.m_sender.sendStateMessage(t),[2]}))}))},e.prototype.delete=function(){this.m_value=void 0;var e={messageId:r.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"cell",operation:"delete",value:""};this.m_sender.sendStateMessage(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":return void((JSON.stringify(this.m_value)!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_value=JSON.parse(e.value),this.m_events.emit("valueChanged",this.m_value,e)));case"delete":return this.m_value=void 0,void this.m_events.emit("valueDeleted",this.m_value,e);default:return}},e.prototype.handleUnacknowledgedMessage=function(e){this.m_events.emit("valueUnacknowledged",e)},e.prototype.beginAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.beginAggregatedStateUpdating()},e.prototype.endAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.endAggregatedStateUpdating()},e}();t.SimpleSyncCell=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleSyncMap=void 0;var i=n(7),s=n(9),a=n(3),r=n(54),o=function(){function e(e,t,n,s,r){this.m_id=e,this.m_sender=t,this.m_shouldEmitEventForAllMessages=n,this.aggregation=r,this.m_events=new i.EventEmitter,this.m_map=new Map,this.m_emitUnacknowledgedEventFor=null!=s?s:a.MessageTrackingOption.None}return e.prototype.on=function(e,t){return this.m_events.on(e,t),this},e.prototype.off=function(e,t){return this.m_events.off(e,t),this},e.prototype.removeAllListeners=function(e){return this.m_events.removeAllListeners(e),this},e.prototype.id=function(){return this.m_id},e.prototype.messageTrackingOption=function(){return this.m_emitUnacknowledgedEventFor},e.prototype.get=function(e){return this.m_map.get(e)},e.prototype.set=function(e,t){this.m_map.set(e,t);var n={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"set",property:e,value:JSON.stringify(t)};this.m_sender.sendStateMessage(n)},e.prototype.delete=function(e){var t={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"delete",property:e,value:""};this.performLocalDelete(t),this.m_sender.sendStateMessage(t)},e.prototype.deleteWithPrefix=function(e){var t={messageId:s.v4(),senderId:this.m_sender.senderId(),objectId:this.m_id,type:"map",operation:"delete",property:e,value:"prefix"};this.performLocalDelete(t),this.m_sender.sendStateMessage(t)},e.prototype.forEach=function(e){this.m_map.forEach(e)},e.prototype.handleStateMessage=function(e){switch(e.operation){case"set":return void this.handleSet(e);case"delete":return void this.handleDelete(e);default:return}},e.prototype.handleSet=function(e){if(!e.property)throw new Error("property is missing for a map.");(JSON.stringify(this.m_map.get(e.property))!==e.value||this.m_shouldEmitEventForAllMessages)&&(this.m_map.set(e.property,JSON.parse(e.value)),this.m_events.emit("valueChanged",e.property,e))},e.prototype.handleDelete=function(e){this.performLocalDelete(e),r.isPrefixDeleteMessage(e)?this.m_events.emit("valuesDeletedWithPrefix",e.property,e):this.m_events.emit("valueDeleted",e.property||"",e)},e.prototype.handleUnacknowledgedMessage=function(e){this.m_events.emit("valueUnacknowledged",e)},e.prototype.beginAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.beginAggregatedStateUpdating()},e.prototype.endAggregatedStateUpdating=function(){var e;null===(e=this.aggregation)||void 0===e||e.endAggregatedStateUpdating()},e.prototype.performLocalDelete=function(e){var t=this;if(e.property){var n=e.property;r.isPrefixDeleteMessage(e)?this.m_map.forEach((function(e,i){i.startsWith(n)&&t.m_map.delete(i)})):this.m_map.delete(e.property)}else this.m_map.clear()},e}();t.SimpleSyncMap=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPrefixDeleteMessage=void 0,t.isPrefixDeleteMessage=function(e){return"delete"===e.operation&&"prefix"===e.value}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleServicePerformanceTelemetry=t.SimpleServiceTelemetry=void 0;var i=n(3),s=function(){function e(e,t,n){this.backendService="SimpleService",this.clientId=e,this.sessionId=t,this.wsReconnectCount=0,this.wsState=i.ConnectionState[i.ConnectionState.Disconnected],this.maxRoundtripRaw=n||0,this.roundtripTelemetry=new a,this.messageHandleTelemetry=new a,this.offlineCacheTelemetry={cachedCount:0,resentCount:0,expiredCount:0,rejectedCount:0},this.maxRoundtripRaw>0&&(this.roundtripRaw=[]),this.messagePendingAckCount=0,this.unacknowledgedMessagesCount=0,this.messageRequested={},this.messageReceived={},this.messageAcknowledged={}}return e.prototype.addRoundtripLatency=function(e){this.roundtripRaw&&this.roundtripRaw.length<this.maxRoundtripRaw&&this.roundtripRaw.push(e),this.roundtripTelemetry.addLatency(e)},e.prototype.addMessageHandleLatency=function(e){this.messageHandleTelemetry.addLatency(e)},e.prototype.incrementAcknowledgedCount=function(e){this.incrementMessageCount(this.messageAcknowledged,e)},e.prototype.incrementRequestedCount=function(e){this.incrementMessageCount(this.messageRequested,e)},e.prototype.incrementReceivedCount=function(e){this.incrementMessageCount(this.messageReceived,e)},e.prototype.incrementMessageCount=function(e,t){var n=e[t],i=void 0===n?1:n+1;e[t]=i},e}();t.SimpleServiceTelemetry=s;var a=function(){function e(){this.count=0,this.minValue=0,this.maxValue=0,this.avgValue=0}return e.prototype.addLatency=function(e){this.count+=1,this.avgValue=this.avgValue+(e-this.avgValue)/this.count,this.minValue=this.count>1?Math.min(e,this.minValue):e,this.maxValue=Math.max(this.maxValue,e)},e}();t.SimpleServicePerformanceTelemetry=a},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(s,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,o)}l((i=i.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,i,s,a,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=2&a[0]?i.return:a[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[2&a[0],s.value]),a[0]){case 0:case 1:s=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(6===a[0]&&r.label<s[1]){r.label=s[1],s=a;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(a);break}s[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],i=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.StateServiceWebSocketConnection=void 0;var a=function(){function e(e,t){var n=this;this.onopen=null,this.onclose=null,this.onerror=null,this.onmessage=null,this.onlog=null,this.ws=new WebSocket(e),this.settings=t,this.ws.onopen=function(e){return i(n,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.onopen&&this.onopen(e),[4,this.sendSetupMessages()];case 1:return t.sent(),[2]}}))}))},this.ws.onclose=function(e){n.onclose&&n.onclose(e)},this.ws.onerror=function(e){n.onerror&&n.onerror(e)},this.ws.onmessage=function(e){n.onmessage&&n.onmessage(e)}}return e.CreateAsync=function(t,n){return i(this,void 0,void 0,(function(){return s(this,(function(i){return[2,new e(t,n)]}))}))},Object.defineProperty(e.prototype,"name",{get:function(){return"WebSocket"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this.ws.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this.ws.readyState===WebSocket.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shouldSendPings",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.close=function(){this.ws.close()},e.prototype.send=function(e){this.ws.send(e)},e.prototype.sendSetupMessages=function(){return i(this,void 0,void 0,(function(){var e,t,n,i,a,r,o=this;return s(this,(function(s){switch(s.label){case 0:return(t=this.settings.getAuthTokenAsync)?[4,this.settings.getAuthTokenAsync()]:[3,2];case 1:t=s.sent(),s.label=2;case 2:return e=t,n=this.settings,i=n.metadata,a=n.subscriptions,r={authToken:e,metadata:i,subscriptions:a},this.settings.createSetupMessage(r).forEach((function(e){return o.send(e)})),[2]}}))}))},e}();t.StateServiceWebSocketConnection=a},function(e,t,n){var i=n(5),s=n(6),a=n(4).Buffer,r=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,s.call(this,64,56)}function c(e){return e<<30|e>>>2}function h(e,t,n,i){return 0===e?t&n|~t&i:2===e?t&n|t&i|n&i:t^n^i}i(l,s),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,i=0|this._a,s=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=n[d-3]^n[d-8]^n[d-14]^n[d-16];for(var u=0;u<80;++u){var m=~~(u/20),g=0|((t=i)<<5|t>>>27)+h(m,s,a,o)+l+n[u]+r[m];l=o,o=a,a=c(s),s=i,i=g}this._a=i+this._a|0,this._b=s+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,n){"use strict";(function(e){var i=n(60),s=n(61),a=n(62);function r(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=u(e,t),e}(e,t,n,i):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|g(t,n),s=(e=o(e,i)).write(t,n);return s!==i&&(e=e.slice(0,s)),e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|m(t.length);return 0===(e=o(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?o(e,0):u(e,t);if("Buffer"===t.type&&a(t.data))return u(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(h(t),e=o(e,t<0?0:0|m(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t){var n=t.length<0?0:0|m(t.length);e=o(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function m(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function g(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return F(e).length;default:if(i)return j(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return w(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function p(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function _(e,t,n,i,s){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=s?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:S(e,t,n,i,s);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):S(e,[t],n,i,s);throw new TypeError("val must be string, number or Buffer")}function S(e,t,n,i,s){var a,r=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;r=2,o/=2,l/=2,n/=2}function c(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(s){var h=-1;for(a=n;a<o;a++)if(c(e,a)===c(t,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===l)return h*r}else-1!==h&&(a-=a-h),h=-1}else for(n+l>o&&(n=o-l),a=n;a>=0;a--){for(var d=!0,u=0;u<l;u++)if(c(e,a+u)!==c(t,u)){d=!1;break}if(d)return a}return-1}function v(e,t,n,i){n=Number(n)||0;var s=e.length-n;i?(i=Number(i))>s&&(i=s):i=s;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");i>a/2&&(i=a/2);for(var r=0;r<i;++r){var o=parseInt(t.substr(2*r,2),16);if(isNaN(o))return r;e[n+r]=o}return r}function y(e,t,n,i){return V(j(t,e.length-n),e,n,i)}function C(e,t,n,i){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function I(e,t,n,i){return C(e,t,n,i)}function b(e,t,n,i){return V(F(t),e,n,i)}function T(e,t,n,i){return V(function(e,t){for(var n,i,s,a=[],r=0;r<e.length&&!((t-=2)<0);++r)i=(n=e.charCodeAt(r))>>8,s=n%256,a.push(s),a.push(i);return a}(t,e.length-n),e,n,i)}function w(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var i=[],s=t;s<n;){var a,r,o,l,c=e[s],h=null,d=c>239?4:c>223?3:c>191?2:1;if(s+d<=n)switch(d){case 1:c<128&&(h=c);break;case 2:128==(192&(a=e[s+1]))&&(l=(31&c)<<6|63&a)>127&&(h=l);break;case 3:a=e[s+1],r=e[s+2],128==(192&a)&&128==(192&r)&&(l=(15&c)<<12|(63&a)<<6|63&r)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:a=e[s+1],r=e[s+2],o=e[s+3],128==(192&a)&&128==(192&r)&&128==(192&o)&&(l=(15&c)<<18|(63&a)<<12|(63&r)<<6|63&o)>65535&&l<1114112&&(h=l)}null===h?(h=65533,d=1):h>65535&&(h-=65536,i.push(h>>>10&1023|55296),h=56320|1023&h),i.push(h),s+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",i=0;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return n}(i)}function P(e,t,n){var i="";n=Math.min(e.length,n);for(var s=t;s<n;++s)i+=String.fromCharCode(127&e[s]);return i}function A(e,t,n){var i="";n=Math.min(e.length,n);for(var s=t;s<n;++s)i+=String.fromCharCode(e[s]);return i}function E(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var s="",a=t;a<n;++a)s+=B(e[a]);return s}function L(e,t,n){for(var i=e.slice(t,n),s="",a=0;a<i.length;a+=2)s+=String.fromCharCode(i[a]+256*i[a+1]);return s}function k(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,n,i,s,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<a)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function x(e,t,n,i){t<0&&(t=65535+t+1);for(var s=0,a=Math.min(e.length-n,2);s<a;++s)e[n+s]=(t&255<<8*(i?s:1-s))>>>8*(i?s:1-s)}function R(e,t,n,i){t<0&&(t=4294967295+t+1);for(var s=0,a=Math.min(e.length-n,4);s<a;++s)e[n+s]=t>>>8*(i?s:3-s)&255}function N(e,t,n,i,s,a){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,i,a){return a||N(e,0,n,4),s.write(e,t,n,i,23,4),n+4}function D(e,t,n,i,a){return a||N(e,0,n,8),s.write(e,t,n,i,52,8),n+8}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return h(t),t<=0?o(e,t):void 0!==n?"string"==typeof i?o(e,t).fill(n,i):o(e,t).fill(n):o(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return d(null,e)},l.allocUnsafeSlow=function(e){return d(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,s=0,a=Math.min(n,i);s<a;++s)if(e[s]!==t[s]){n=e[s],i=t[s];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),s=0;for(n=0;n<e.length;++n){var r=e[n];if(!l.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(i,s),s+=r.length}return i},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):f.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,s){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===s&&(s=this.length),t<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&t>=n)return 0;if(i>=s)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(s>>>=0)-(i>>>=0),r=(n>>>=0)-(t>>>=0),o=Math.min(a,r),c=this.slice(i,s),h=e.slice(t,n),d=0;d<o;++d)if(c[d]!==h[d]){a=c[d],r=h[d];break}return a<r?-1:r<a?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return _(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return _(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var s=this.length-t;if((void 0===n||n>s)&&(n=s),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return C(this,e,t,n);case"latin1":case"binary":return I(this,e,t,n);case"base64":return b(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var s=t-e;n=new l(s,void 0);for(var a=0;a<s;++a)n[a]=this[a+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||k(e,t,this.length);for(var i=this[e],s=1,a=0;++a<t&&(s*=256);)i+=this[e+a]*s;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||k(e,t,this.length);for(var i=this[e+--t],s=1;t>0&&(s*=256);)i+=this[e+--t]*s;return i},l.prototype.readUInt8=function(e,t){return t||k(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||k(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||k(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||k(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||k(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||k(e,t,this.length);for(var i=this[e],s=1,a=0;++a<t&&(s*=256);)i+=this[e+a]*s;return i>=(s*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||k(e,t,this.length);for(var i=t,s=1,a=this[e+--i];i>0&&(s*=256);)a+=this[e+--i]*s;return a>=(s*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return t||k(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||k(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||k(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||k(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||k(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||k(e,4,this.length),s.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||k(e,4,this.length),s.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||k(e,8,this.length),s.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||k(e,8,this.length),s.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){e=+e,t|=0,n|=0,i||O(this,e,t,n,Math.pow(2,8*n)-1,0);var s=1,a=0;for(this[t]=255&e;++a<n&&(s*=256);)this[t+a]=e/s&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){e=+e,t|=0,n|=0,i||O(this,e,t,n,Math.pow(2,8*n)-1,0);var s=n-1,a=1;for(this[t+s]=255&e;--s>=0&&(a*=256);)this[t+s]=e/a&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var s=Math.pow(2,8*n-1);O(this,e,t,n,s-1,-s)}var a=0,r=1,o=0;for(this[t]=255&e;++a<n&&(r*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/r>>0)-o&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var s=Math.pow(2,8*n-1);O(this,e,t,n,s-1,-s)}var a=n-1,r=1,o=0;for(this[t+a]=255&e;--a>=0&&(r*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/r>>0)-o&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):x(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):x(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var s,a=i-n;if(this===e&&n<t&&t<i)for(s=a-1;s>=0;--s)e[s+t]=this[s+n];else if(a<1e3||!l.TYPED_ARRAY_SUPPORT)for(s=0;s<a;++s)e[s+t]=this[s+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var s=e.charCodeAt(0);s<256&&(e=s)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var r=l.isBuffer(e)?e:j(new l(e,i).toString()),o=r.length;for(a=0;a<n-t;++a)this[a+t]=r[a%o]}return this};var W=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var i=e.length,s=null,a=[],r=0;r<i;++r){if((n=e.charCodeAt(r))>55295&&n<57344){if(!s){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(r+1===i){(t-=3)>-1&&a.push(239,191,189);continue}s=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),s=n;continue}n=65536+(s-55296<<10|n-56320)}else s&&(t-=3)>-1&&a.push(239,191,189);if(s=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function F(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,i){for(var s=0;s<i&&!(s+n>=t.length||s>=e.length);++s)t[s+n]=e[s];return s}}).call(this,n(59))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=c(e),r=i[0],o=i[1],l=new a(function(e,t,n){return 3*(t+n)/4-n}(0,r,o)),h=0,d=o>0?r-4:r;for(n=0;n<d;n+=4)t=s[e.charCodeAt(n)]<<18|s[e.charCodeAt(n+1)]<<12|s[e.charCodeAt(n+2)]<<6|s[e.charCodeAt(n+3)],l[h++]=t>>16&255,l[h++]=t>>8&255,l[h++]=255&t;return 2===o&&(t=s[e.charCodeAt(n)]<<2|s[e.charCodeAt(n+1)]>>4,l[h++]=255&t),1===o&&(t=s[e.charCodeAt(n)]<<10|s[e.charCodeAt(n+1)]<<4|s[e.charCodeAt(n+2)]>>2,l[h++]=t>>8&255,l[h++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,s=n%3,a=[],r=0,o=n-s;r<o;r+=16383)a.push(h(e,r,r+16383>o?o:r+16383));return 1===s?(t=e[n-1],a.push(i[t>>2]+i[t<<4&63]+"==")):2===s&&(t=(e[n-2]<<8)+e[n-1],a.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"=")),a.join("")};for(var i=[],s=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=r.length;o<l;++o)i[o]=r[o],s[r.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function h(e,t,n){for(var s,a,r=[],o=t;o<n;o+=3)s=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(i[(a=s)>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]);return r.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,s){var a,r,o=8*s-i-1,l=(1<<o)-1,c=l>>1,h=-7,d=n?s-1:0,u=n?-1:1,m=e[t+d];for(d+=u,a=m&(1<<-h)-1,m>>=-h,h+=o;h>0;a=256*a+e[t+d],d+=u,h-=8);for(r=a&(1<<-h)-1,a>>=-h,h+=i;h>0;r=256*r+e[t+d],d+=u,h-=8);if(0===a)a=1-c;else{if(a===l)return r?NaN:1/0*(m?-1:1);r+=Math.pow(2,i),a-=c}return(m?-1:1)*r*Math.pow(2,a-i)},t.write=function(e,t,n,i,s,a){var r,o,l,c=8*a-s-1,h=(1<<c)-1,d=h>>1,u=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,m=i?0:a-1,g=i?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,r=h):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+d>=1?u/l:u*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=h?(o=0,r=h):r+d>=1?(o=(t*l-1)*Math.pow(2,s),r+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),r=0));s>=8;e[n+m]=255&o,m+=g,o/=256,s-=8);for(r=r<<s|o,c+=s;c>0;e[n+m]=255&r,m+=g,r/=256,c-=8);e[n+m-g]|=128*f}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var i=n(5),s=n(6),a=n(4).Buffer,r=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function l(){this.init(),this._w=o,s.call(this,64,56)}function c(e){return e<<5|e>>>27}function h(e){return e<<30|e>>>2}function d(e,t,n,i){return 0===e?t&n|~t&i:2===e?t&n|t&i|n&i:t^n^i}i(l,s),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,i=0|this._a,s=0|this._b,a=0|this._c,o=0|this._d,l=0|this._e,u=0;u<16;++u)n[u]=e.readInt32BE(4*u);for(;u<80;++u)n[u]=(t=n[u-3]^n[u-8]^n[u-14]^n[u-16])<<1|t>>>31;for(var m=0;m<80;++m){var g=~~(m/20),f=c(i)+d(g,s,a,o)+l+n[m]+r[g]|0;l=o,o=a,a=h(s),s=i,i=f}this._a=i+this._a|0,this._b=s+this._b|0,this._c=a+this._c|0,this._d=o+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=a.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},function(e,t,n){var i=n(5),s=n(21),a=n(6),r=n(4).Buffer,o=new Array(64);function l(){this.init(),this._w=o,a.call(this,64,56)}i(l,s),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=r.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},function(e,t,n){var i=n(5),s=n(22),a=n(6),r=n(4).Buffer,o=new Array(160);function l(){this.init(),this._w=o,a.call(this,128,112)}i(l,s),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=r.allocUnsafe(48);function t(t,n,i){e.writeInt32BE(t,i),e.writeInt32BE(n,i+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l}]);
//# sourceMappingURL=StateServicePreviewerClient.js.map