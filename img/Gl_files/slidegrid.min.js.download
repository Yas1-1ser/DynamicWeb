var SlideGrid=function(e){var i={};function t(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=i,t.d=function(e,i,s){t.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:s})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,i){if(1&i&&(e=t(e)),8&i)return e;if(4&i&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(t.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var n in e)t.d(s,n,function(i){return e[i]}.bind(null,n));return s},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},t.p="",t(t.s=9)}([function(e,i,t){"use strict";t.d(i,"a",(function(){return s})),t.d(i,"b",(function(){return n}));class s{addBinding(e){this._bindingList.push(e)}constructor(e,i){this._bindingList=[],null!=e&&null!=i&&null!=Object(e)[i]&&(delete Object(e)[i].get,delete Object(e)[i].set),Object.defineProperty(e,i,{set:t=>{Object(e)["_"+i]=t,this._bindingList.forEach(e=>{e.attribute&&""!==e.attribute&&(Object(e.element)[e.attribute]=t),null!=e.onValueChanged&&e.onValueChanged(t)})},get:()=>Object(e)["_"+i],configurable:!0})}}class n{addBinding(e){this._bindingList.push(e)}constructor(e,i){this._bindingList=[],null!=e&&null!=i&&null!=Object(e)[i]&&(delete Object(e)[i].get,delete Object(e)[i].set),Object.defineProperty(e,i,{set:t=>{Object(e)["_"+i]=t,this._bindingList.forEach(e=>{Object(e.target)[i]=t,null!=e.onValueChanged&&e.onValueChanged(t)})},get:()=>Object(e)["_"+i],configurable:!0})}}},function(e,i,t){"use strict";var s,n,a;t.d(i,"c",(function(){return s})),t.d(i,"b",(function(){return n})),t.d(i,"a",(function(){return a})),function(e){e[e.Click=0]="Click",e[e.DoubleClick=1]="DoubleClick",e[e.RightClick=2]="RightClick",e[e.EnterKey=3]="EnterKey",e[e.ActiveSlideChange=4]="ActiveSlideChange",e[e.MouseDown=5]="MouseDown",e[e.ActiveSectionChange=6]="ActiveSectionChange",e[e.ArrowKey=7]="ArrowKey",e[e.CtrlAKey=8]="CtrlAKey",e[e.ShiftHomeKey=9]="ShiftHomeKey",e[e.ShiftEndKey=10]="ShiftEndKey",e[e.TabKey=11]="TabKey"}(s||(s={})),function(e){e[e.Click=0]="Click",e[e.RightClick=2]="RightClick",e[e.ActiveSectionChange=3]="ActiveSectionChange"}(n||(n={})),function(e){e[e.MouseOver=0]="MouseOver",e[e.MouseOut=1]="MouseOut"}(a||(a={}))},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=t(11);s.__exportStar(t(12),i),s.__exportStar(t(13),i)},function(e,i,t){"use strict";t.d(i,"a",(function(){return s}));class s{dispose(){try{this._parent.removeChild(this._container)}catch(e){}}get container(){return this._container}constructor(e){this.m_genericViewClassName="generic-view-class",this._parent=e,this._container=document.createElement("div"),this._container.classList.add(this.m_genericViewClassName),this._parent.appendChild(this._container)}}},function(e,i,t){var s=t(14),n=t(15),a=n;a.v1=s,a.v4=n,e.exports=a},function(e,i,t){"use strict";var s;t.d(i,"a",(function(){return s})),function(e){e.None="None",e.HighContrastBlack="HighContrastBlack"}(s||(s={}))},function(e,i){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var s=new Uint8Array(16);e.exports=function(){return t(s),s}}else{var n=new Array(16);e.exports=function(){for(var e,i=0;i<16;i++)0==(3&i)&&(e=4294967296*Math.random()),n[i]=e>>>((3&i)<<3)&255;return n}}},function(e,i){for(var t=[],s=0;s<256;++s)t[s]=(s+256).toString(16).substr(1);e.exports=function(e,i){var s=i||0,n=t;return[n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],"-",n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]],n[e[s++]]].join("")}},function(e,i,t){"use strict";t.d(i,"a",(function(){return $}));class s{signal(e,i){this.subs.forEach(t=>{t(e,i)})}subscribe(e){this.subs.push(e)}unsubscribe(e){const i=this.subs.indexOf(e);return-1!==i&&(this.subs.splice(i,1),!0)}constructor(){this.subs=[]}}var n=t(3);class a{static CreateThrottler(e,i){let t=0;return s=>{(0===t||t+i-Date.now()<0)&&(e(s),t=Date.now())}}}class r{static CreateDebouncer(e,i){let t;return s=>{clearTimeout(t),t=setTimeout(()=>{e(s)},i)}}}var o,l,d,c=t(5),h=t(2);class g{static MoveSlideByIndex(e,i,t,s,n,a){let r=e.filter(e=>t.indexOf(e.slideOrderIndex)>=0);const o=r.map(e=>e.slideID),l=e.slice();r=r.sort((e,i)=>e.slideOrderIndex-i.slideOrderIndex);for(let t=0;t<r.length;t+=1){const a=null!=l.filter(e=>e.slideID===r[t].slideID)?l.filter(e=>e.slideID===r[t].slideID)[0]:null;if(a){const o=l.map(e=>e.slideID).indexOf(r[t].slideID);if(s>=0){const t=i[a.sectionIndex];t.slideIdList.splice(t.slideIdList.indexOf(a.slideID),1);const r=n>=0?n:e[s].sectionIndex;a.sectionIndex=r,null==i[r].slideIdList&&(i[r].slideIdList=[]),i[r].slideIdList.push(a.slideID)}a.slideOrderIndex,l.splice(o,1)}}let d=h.ChangeGate.isChangeGateEnabled("slideMoveToEmptySectionBugFix")?0:-1;for(let e=0;e<l.length;e+=1)l[e].slideOrderIndex===s&&(d=e);d=a?d+1:d,l.splice(d,0,...r),l.forEach((e,i)=>{e.slideOrderIndex=i});for(let i=0;i<e.length;i+=1)e[i]=l[i];return e.filter(e=>o.indexOf(e.slideID)>=0).map(e=>e.slideOrderIndex)}static isFirstSlideOfSection(e,i){if(i<0||null==e||0===e.length||i>e.length-1)return!1;const t=e[i];return i===e.filter(e=>e.sectionIndex===t.sectionIndex).map(e=>e.slideOrderIndex).reduce((e,i)=>Math.min(e,i))}static isLastSlideOfSection(e,i){if(i<0||null==e||0===e.length||i>e.length-1)return!1;const t=e[i];return i===e.filter(e=>e.sectionIndex===t.sectionIndex).map(e=>e.slideOrderIndex).reduce((e,i)=>Math.max(e,i))}static MoveSlideById(e,i,t,s,n,a){const r=e.filter(e=>e.slideID.slideSid===t.slideSid&&e.slideID.slideCid===t.slideCid)[0].slideOrderIndex,o=e.filter(e=>e.slideID.slideSid===s.slideSid&&e.slideID.slideCid===s.slideCid)[0].slideOrderIndex;g.MoveSlideByIndex(e,i,[r],o,n,a)}static NearestPreviousNonSourceSlide(e,i,t){let s=0,n=e.filter(e=>e.slideOrderIndex<=t&&0===i.filter(i=>i===e.slideOrderIndex).length);return n.length>0&&(n=n.sort((e,i)=>i.slideOrderIndex-e.slideOrderIndex),n.length>0&&(s=n[0].slideOrderIndex)),s}static NearestPreviousNonSourceSlideBySection(e,i,t,s){const n=i.filter(e=>e.sectionIndex<=s&&null!=e.slideIdList&&e.slideIdList.length>0).sort((e,i)=>i.sectionIndex-e.sectionIndex);let a=0;if(null!=n&&n.length>0){let i=e.filter(e=>n.filter(i=>i.sectionIndex===e.sectionIndex).length>0&&0===t.filter(i=>i===e.slideOrderIndex).length);i=i.sort((e,i)=>i.slideOrderIndex-e.slideOrderIndex),i.length>0&&(a=i[0].slideOrderIndex)}return a}static IsSlideIdListEmpty(e){return null!=e&&null!=e.slideIdList&&0===e.slideIdList.length}static IsSlideIdListNotEmpty(e){return null!=e&&null!=e.slideIdList&&e.slideIdList.length>0}static isSlideIDEqual(e,i){return e.slideSid===i.slideSid&&e.slideCid===i.slideCid}static isSlideIDPartialEqual(e,i){return!!g.isSlideIDEqual(e,i)||!e.slideCid&&e.slideSid===i.slideSid}}!function(e){e.None="none",e.Up="up",e.Down="down",e.Left="left",e.Right="right",e.Start="start",e.End="end"}(o||(o={})),function(e){e.MoveSlideUp="moveSlideUp",e.MoveSlideToStart="moveSlideToStart",e.MoveSlideDown="moveSlideDown",e.MoveSlideToEnd="moveSlideToEnd"}(l||(l={})),function(e){e.MoveSectionUp="moveSectionUp",e.MoveSectionDown="moveSectionDown",e.MoveSectionStart="moveSectionStart",e.MoveSectionEnd="moveSectionEnd"}(d||(d={}));class u{handleSlideFocusMove(e,i,t,s,n){let a=-1;switch(e){case o.Up:a=this.handleSlideFocusMoveUp(i,t,s,n);break;case o.Down:a=this.handleSlideFocusMoveDown(i,t,s,n);break;case o.Left:a=this.handleSlideFocusMoveLeft(i);break;case o.Right:a=this.handleSlideFocusMoveRight(i,s.length)}return a}handleSectionFocusMove(e,i,t,s,n,a){let r=-1;switch(e){case o.Up:r=this.handleSectionFocusMoveUp(t,i,n,a,s);break;case o.Down:r=this.handleSectionFocusMoveDown(t,i,n,a,s);break;case o.Left:r=this.handleSectionFocusMoveLeft(t,i,n,a);break;case o.Right:r=this.handleSectionFocusMoveRight(t,i,n,a)}return r}handleSlideFocusMoveFromSectionFocus(e,i,t,s,n){return-1===i?g.IsSlideIdListEmpty(n[t])?-1:this.getFirstSlideInSection(s,t):-1===t?e===o.Up||e===o.Left?i>0?g.IsSlideIdListEmpty(n[i-1])?-1:this.getLastSlideInSection(s,i-1):-1:g.IsSlideIdListEmpty(n[i])?-1:this.getFirstSlideInSection(s,i):g.IsSlideIdListEmpty(n[t])?-1:this.getFirstSlideInSection(s,t)}handleSlideFocusMoveUp(e,i,t,s){if(e<0||i<1||null==t||t.length<=0||e>=t.length)return-1;let n=e-i;if(1===i&&!this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering)return n>=0?n:0;const a=t.filter(i=>i.sectionIndex===t[e].sectionIndex);if(null==a||a.length<=0)return-1;const r=e>=a[0].slideOrderIndex&&e<a[0].slideOrderIndex+i,o=t[e].sectionIndex<=0;if(r){if(o)return e;const a=this.nextNonEmptySectionIndex(!0,s,t[e].sectionIndex);if(-1===a)return e;const r=t.filter(e=>e.sectionIndex===a).length;if(n+=Math.ceil(r/i)*i-r,null!=t[n]&&t[n].sectionIndex===a)return n;const l=t.filter(e=>e.sectionIndex===a);return l[l.length-1].slideOrderIndex}return n}handleSlideFocusMoveDown(e,i,t,s){if(e<0||i<1||null==t||t.length<=0||e>=t.length)return-1;let n=e+i;if(1===i)return n<t.length?n:t.length-1;const a=t.filter(i=>i.sectionIndex===t[e].sectionIndex);if(null==a||a.length<=0)return-1;const r=this.isSlideInSectionLastRow(e,a[0].slideOrderIndex,a.length,i),o=t[e].sectionIndex>=s.length-1;if(r){if(o)return e;if(a.length%i!=0){n-=a.length>i?i-a.length%i:i-a.length}const r=this.nextNonEmptySectionIndex(!1,s,t[e].sectionIndex);if(-1===r)return e;if(null!=t[n]&&t[n].sectionIndex===r)return n;return t.filter(e=>e.sectionIndex===r)[0].slideOrderIndex}return null!=t[n]&&t[n].sectionIndex===t[e].sectionIndex?n:a[a.length-1].slideOrderIndex}handleSlideFocusMoveLeft(e){if(e<0)return-1;return e>0?e-1:0}handleSlideFocusMoveRight(e,i){if(e<0)return-1;return e<i-1?e+1:i-1}handleSectionFocusMoveUp(e,i,t,s,n){if(null===t||0===t.length||null==s||0===s.length||n<0)return-1;if(-1===i)return 0===e?e:g.IsSlideIdListEmpty(s[e-1])?e-1:-1;const a=t.filter(e=>e.sectionIndex===t[i].sectionIndex);if(null==a||a.length<=0)return-1;const r=i>=a[0].slideOrderIndex&&i<a[0].slideOrderIndex+n,o=0===e;return-1===e?r?t[i].sectionIndex:-1:e===t[i].sectionIndex?o?e:g.IsSlideIdListEmpty(s[e-1])?e-1:-1:-1}handleSectionFocusMoveDown(e,i,t,s,n){if(null===t||0===t.length||null==s||0===s.length||n<0)return-1;if(-1===i)return e===s.length-1?e:e+1;const a=t.filter(e=>e.sectionIndex===t[i].sectionIndex);if(null==a||a.length<=0)return-1;const r=this.isSlideInSectionLastRow(i,a[0].slideOrderIndex,a.length,n),o=t[i].sectionIndex,l=o>=s.length-1;return-1===e?r?l?-1:o+1:-1:e===t[i].sectionIndex||g.IsSlideIdListEmpty(s[e])?l?null==a||a.length<=0?e:-1:h.ChangeGate.isChangeGateEnabled("MoveToNextSectionBugFix")?g.IsSlideIdListEmpty(s[e])?e+1:-1:g.IsSlideIdListEmpty(s[e+1])||g.IsSlideIdListEmpty(s[e])?e+1:-1:-1}handleSectionFocusMoveRight(e,i,t,s){if(null===t||0===t.length||null==s||0===s.length)return-1;if(-1===i)return e===s.length-1?e:e+1;if(-1===e){const e=t[i].sectionIndex;return i===this.getLastSlideInSection(t,e)&&e<s.length-1?e+1:-1}return g.IsSlideIdListNotEmpty(s[e])?-1:e<s.length-1?e+1:-1}handleSectionFocusMoveLeft(e,i,t,s){if(null===t||0===t.length||null==s||0===s.length)return-1;if(i<0)return 0===e?e:g.IsSlideIdListEmpty(s[e-1])?e-1:-1;const n=t[i].sectionIndex;if(-1===e){return i===this.getFirstSlideInSection(t,n)?t[i].sectionIndex:-1}return 0===e?0:g.IsSlideIdListEmpty(s[e-1])?e-1:-1}nextNonEmptySectionIndex(e,i,t){const s=e?-1:i.length,n=e?-1:1;for(let e=t+n;e!==s;e+=n)if(g.IsSlideIdListNotEmpty(i[e]))return e;return-1}getFirstSlideInSection(e,i){return e.filter(e=>e.sectionIndex===i).map(e=>e.slideOrderIndex).sort((e,i)=>e-i)[0]}getLastSlideInSection(e,i){const t=e.filter(e=>e.sectionIndex===i).map(e=>e.slideOrderIndex);return t.sort((e,i)=>e-i)[t.length-1]}isSlideInSectionLastRow(e,i,t,s){let n=!1;if(s<=0||e<0||i<0||t<=0)return!1;if(t<=s)return!0;const a=(t-t%s)/s;let r;return r=t%s==0?i+s*(a-1):i+s*a,e>=r&&r<i+t&&(n=!0),n}constructor(e){this.m_slideGridSettings=e}}var m=t(0);class _{static load(e){for(const i in e)_.m_settings[i]=e[i]}static readBooleanOrDefault(e,i){const t=void 0===_.m_settings?"":typeof _.m_settings[e];return"string"===t?"true"===_.m_settings[e].toLowerCase():"boolean"===t?_.m_settings[e]:i}static readNumberOrDefault(e,i){const t=void 0===_.m_settings?"":typeof _.m_settings[e];return"string"===t||"number"===t?Number(_.m_settings[e]):i}static readStringOrDefault(e,i){return void 0===_.m_settings||"string"!=typeof _.m_settings[e]?i:_.m_settings[e]}static addOrUpdateSettingsFromUrl(e,i){const t=i.get("wdset");if(!t)return e;for(const i of t.split(",")){const t=i.split(":"),s=t[0].split("."),n=s[0],a=s[1],r=t[1];a&&r&&_.addOrUpdateSetting(e,n,a,r)}return e}static addOrUpdateSetting(e,i,t,s){"__proto__"!==i&&(e[i]||(e[i]={}),e[i][t]=s)}}_.m_settings={};var p=t(4);class S extends n.a{get onViewAreaChanged(){return this._onViewAreaChanged}get onViewScrolled(){return this._onViewScrolled}get onCurrentActiveFocusChanged(){return this._onCurrentActiveFocusChanged}get onEnterKey(){return this._onEnterKey}get onCtrlAkey(){return this._onCtrlAKey}get onCtrlArrowKey(){return this._onCtrlArrowKey}get onShiftArrowKey(){return this._onShiftArrowKey}get onShiftHomeKey(){return this._onShiftHomeKey}get onShiftEndKey(){return this._onShiftEndKey}get onTabKey(){return this._onTabKey}get renderAreaRect(){const e=this._parent.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}handleHighContrastModeChange(e){switch(e){case c.a.None:this._parent.classList.remove(this.highContrastBlackModeClassName),this._container.classList.remove(this.highContrastBlackModeClassName);break;case c.a.HighContrastBlack:this._parent.classList.add(this.highContrastBlackModeClassName),this._container.classList.add(this.highContrastBlackModeClassName)}}setZeroSectionVerticalThumbnailClass(e){e<=1?this._container.classList.add(this.visibleStyleZeroSectionVerticalThumbClassName):this._container.classList.remove(this.visibleStyleZeroSectionVerticalThumbClassName)}set disableNavigation(e){this.slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e)}get disableNavigation(){return this._disableNavigation}constructor(e,i,t){super(i),this.visibleStyleClassName="section-list-view-visible-class",this.visibleStyleZeroSectionVerticalThumbClassName="section-list-view-visible-zero-vertical-thumbnail-section-class",this.hiddenStyleClassName="section-list-view-hidden-class",this.rtlStyleClassName="rtl-class",this.displayHorizontalStyleClassName="display-horizontal-class",this.highContrastBlackModeClassName="slidegrid-high-contrast-black",this.smallScreenSpaceRegainClassName="small-screen-space-regain",this._elementId="section-list-view-id"+Object(p.v4)(),this._highContrastMode=c.a.None,this._disableNavigation=!1,this._container.id=this._elementId,this._container.classList.add(this.visibleStyleClassName),h.ChangeGate.isChangeGateEnabled("smallScreenSpaceRegain")||this._container.classList.add(this.smallScreenSpaceRegainClassName),this._onViewAreaChanged=new s,this._onViewScrolled=new s,this._onCurrentActiveFocusChanged=new s,this._onEnterKey=new s,this._onCtrlAKey=new s,this._onCtrlArrowKey=new s,this._onShiftArrowKey=new s,this._onShiftHomeKey=new s,this._onShiftEndKey=new s,this._onTabKey=new s,this._events=t,this.slideGridSettings=e,this.slideGridSettings.isRTL&&this._container.classList.add(this.rtlStyleClassName),this.slideGridSettings.isDisplayHorizontal&&this._container.classList.add(this.displayHorizontalStyleClassName);new m.a(this,"highContrastMode").addBinding({element:this._parent,onValueChanged:this.handleHighContrastModeChange.bind(this)});let n=e=>{null!=e&&e.preventDefault(),this._onViewAreaChanged.signal(null,null)},d=e=>{null!=e&&e.preventDefault(),this._events.onVisibleSlideRangeChanged.signal(null,{eventName:e.type})};const g=e=>{null!=e&&e.preventDefault(),this._onViewScrolled.signal(null,null)};e.isMobileScreenReader?(this._container.setAttribute("role","menu"),this._container.setAttribute("aria-label",e.mobileThumbnailSlideAriaLabel)):(this._container.setAttribute("role","listbox"),e.isUsingSlideGridInThumbnail&&e.thumbnailSlideSorterListBoxAriaLabel&&this._container.setAttribute("aria-label",e.thumbnailSlideSorterListBoxAriaLabel)),this.slideGridSettings.isUsingSlideGridInThumbnail?(this._container.addEventListener("scroll",d),window.addEventListener("resize",d)):(this._container.addEventListener("scroll",a.CreateThrottler(n,this.slideGridSettings.throttleTimeoutInMs).bind(this)),this._container.addEventListener("scroll",r.CreateDebouncer(n,this.slideGridSettings.debounceWaitTimeInMs).bind(this)),h.ChangeGate.isChangeGateEnabled("SG.FrequentScrollEvent")&&this._container.addEventListener("scroll",a.CreateThrottler(g,_.readNumberOrDefault("gridViewScrollThrottleTimeoutMs",100)).bind(this)),window.addEventListener("resize",a.CreateThrottler(n,this.slideGridSettings.throttleTimeoutInMs).bind(this)),window.addEventListener("resize",r.CreateDebouncer(n,this.slideGridSettings.debounceWaitTimeInMs).bind(this))),this._container.addEventListener("keydown",e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();const i=e.key.toLowerCase(),t=e.shiftKey,s=e.ctrlKey,n=e.metaKey,a=h.ChangeGate.isChangeGateEnabled("MacSlideReorderingFix");switch(i){case"up":case"arrowup":e.preventDefault(),this.slideGridSettings.isUsingSlideGridInThumbnail?!s&&t&&this.slideGridSettings.allowMultipleSelect?this._onShiftArrowKey.signal(null,{focusMoveType:o.Up}):(a&&n||s)&&!t?this._onCtrlArrowKey.signal(null,{moveType:l.MoveSlideUp}):(a&&n||s)&&t?this._onCtrlArrowKey.signal(null,{moveType:l.MoveSlideToStart}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Up,eventObj:e}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Up,eventObj:e});break;case"down":case"arrowdown":e.preventDefault(),this.slideGridSettings.isUsingSlideGridInThumbnail?!s&&t&&this.slideGridSettings.allowMultipleSelect?this._onShiftArrowKey.signal(null,{focusMoveType:o.Down}):(a&&n||s)&&!t?this._onCtrlArrowKey.signal(null,{moveType:l.MoveSlideDown}):(a&&n||s)&&t?this._onCtrlArrowKey.signal(null,{moveType:l.MoveSlideToEnd}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Down,eventObj:e}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Down,eventObj:e});break;case"left":case"arrowleft":e.preventDefault(),this.slideGridSettings.isUsingSlideGridInThumbnail||(t&&this.slideGridSettings.allowMultipleSelect?this._onShiftArrowKey.signal(null,{focusMoveType:o.Left}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Left}));break;case"right":case"arrowright":e.preventDefault(),this.slideGridSettings.isUsingSlideGridInThumbnail||(t&&this.slideGridSettings.allowMultipleSelect?this._onShiftArrowKey.signal(null,{focusMoveType:o.Right}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Right}));break;case"enter":this.copilotUXHasFocus&&this.slideGridSettings.isUsingSlideGridInThumbnail||e.preventDefault(),this._onEnterKey.signal(null,null);break;case"a":e.preventDefault(),s&&this.slideGridSettings.allowMultipleSelect&&this._onCtrlAKey.signal(null,null);break;case"tab":if(this.slideGridSettings.allowDefaultTabBehavior)break;e.preventDefault(),this.slideGridSettings.isUsingSlideGridInThumbnail&&this._onTabKey.signal(null,{isShiftKey:t});break;case"pagedown":e.preventDefault(),this.slideGridSettings.isUsingSlideGridInThumbnail&&(t?this._onShiftArrowKey.signal(null,{focusMoveType:o.Down}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Down,eventObj:e}));break;case"pageup":e.preventDefault(),this.slideGridSettings.isUsingSlideGridInThumbnail&&(t?this._onShiftArrowKey.signal(null,{focusMoveType:o.Up}):this._onCurrentActiveFocusChanged.signal(null,{focusMoveType:o.Up,eventObj:e}));break;case"home":this.slideGridSettings.isUsingSlideGridInThumbnail&&t&&(e.preventDefault(),this.slideGridSettings.allowMultipleSelect&&this._onShiftHomeKey.signal(null,null));break;case"end":this.slideGridSettings.isUsingSlideGridInThumbnail&&t&&(e.preventDefault(),this.slideGridSettings.allowMultipleSelect&&this._onShiftEndKey.signal(null,null))}}),this.slideGridSettings.isDisplayHorizontal&&this.slideGridSettings.allowHorizontalScrollWithMouseWheel&&this._container.addEventListener("wheel",e=>{const i=e.deltaY<0&&this._container.scrollLeft>0,t=e.deltaY>0&&this._container.scrollLeft<this._container.scrollWidth-this._container.clientWidth;(i||t)&&(e.preventDefault(),this._container.scrollLeft+=e.deltaY)})}}var v,b,f,C,w=t(1);class I extends n.a{get onViewUpdateSectionTitle(){return this.m_viewUpdateSectionTitle}get onViewSelectSection(){return this.m_viewSelectSection}createBasicSectionDom(){this.m_sectionTitleDiv=document.createElement("div"),this.m_sectionTitleSpan=document.createElement("span"),this.m_slideGridSettings.disableAutomaticTabStops||(this.m_sectionTitleSpan.tabIndex=0,this.m_sectionTitleSpan.setAttribute("aria-hidden","false")),this.m_isSectionPasteEnabled&&(this.m_sectionSpan=document.createElement("span"),this.m_slideGridSettings.disableAutomaticTabStops||(this.m_sectionSpan.tabIndex=0,this.m_sectionSpan.setAttribute("aria-hidden","false")),this.m_sectionSpan.className=this.sectionSpanClassName,this._spanElement=document.createElement("span"),this._spanElement.innerText=".",this._spanElement.ariaReadOnly="false",this._spanElement.contentEditable="true",this._spanElement.ariaHidden="true",this.m_sectionTitleSpan.appendChild(this._spanElement),this.m_sectionTitleSpan.appendChild(this.m_sectionSpan),this.m_sectionTitleSpan.setAttribute("contenteditable","true")),this.m_slideGridSettings.loadSectionViewDefaultClassNew?this.m_sectionTitleDiv.className=this.sectionTitleDefaultWithoutShiftClassName:this.m_sectionTitleDiv.className=this.sectionTitleDefaultClassName,this.m_sectionTitleDiv.appendChild(this.m_sectionTitleSpan),this._activeSpan=this.m_isSectionPasteEnabled?this.m_sectionSpan:this.m_sectionTitleSpan;new m.a(this,"sectionTitle").addBinding({element:this._activeSpan,attribute:"innerText",onValueChanged:e=>{this.m_sectionTitleSpan.setAttribute("aria-label",e)}});new m.a(this,"isSelected").addBinding({element:this.m_sectionTitleDiv,onValueChanged:e=>{e?this.m_sectionTitleDiv.classList.add(this.sectionTitleSelectedClassName):this.m_sectionTitleDiv.classList.remove(this.sectionTitleSelectedClassName)}});new m.a(this,"shouldDisplaySection").addBinding({element:this.m_sectionTitleDiv,onValueChanged:e=>{this.m_sectionTitleDiv.style.display=e?"block":"none",e?(this.m_isSectionPasteEnabled&&this.m_sectionSpan.setAttribute("aria-hidden","false"),this.m_sectionTitleSpan.setAttribute("aria-hidden","false"),this.m_sectionTitleSpan.setAttribute("aria-label",this._sectionTitle),this._container.setAttribute("aria-hidden","false")):(this.m_isSectionPasteEnabled&&this.m_sectionSpan.setAttribute("aria-hidden","true"),this.m_sectionTitleSpan.setAttribute("aria-hidden","true"),this.m_slideGridSettings.isUsingSlideGridInThumbnail||this._container.setAttribute("aria-hidden","true"))}});if(new m.a(this,"titleEditMode").addBinding({element:this.m_sectionTitleDiv,onValueChanged:e=>{e&&this.enableEditMode()}}),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering){new m.a(this,"currentActiveSectionIndex").addBinding({element:this.m_sectionTitleDiv,onValueChanged:e=>{e===this.sectionIndex?(this.m_sectionTitleSpan.focus(),this.m_sectionTitleDiv.classList.add(this.sectionTitleFocusStyleClassName)):this.m_sectionTitleDiv.classList.remove(this.sectionTitleFocusStyleClassName)}})}new m.a(this,"isDragOver").addBinding({element:this.m_sectionDragOverDiv,onValueChanged:e=>{e?this.m_sectionDragOverDiv.classList.add(this.sectionDragOverDivVisibleClassName):this.m_sectionDragOverDiv.classList.remove(this.sectionDragOverDivVisibleClassName)}}),this._container.appendChild(this.m_sectionTitleDiv),this._container.classList.add(this.visibleStyleClassName),this.m_slideGridSettings.allowMoveSlide&&(this.m_sectionDragOverDiv=document.createElement("div"),this.m_sectionDragOverDiv.className=this.sectionDragOverDivClassName,this._container.appendChild(this.m_sectionDragOverDiv))}updateSectionTitle(){this.isEmptyTitle(this.m_sectionTitleInput.value)||this.m_sectionTitleInput.readOnly?(this._activeSpan.innerText=this.sectionTitle,this.m_sectionTitleInput.readOnly=!0):this.setSectionTitle(),this.m_isSectionPasteEnabled&&this.m_sectionSpan.setAttribute("aria-hidden","false"),this._activeSpan.style.visibility="",this.m_sectionTitleSpan.setAttribute("aria-hidden","false"),this.m_sectionTitleInput.setAttribute("aria-hidden","true")}enableEditMode(){this.m_sectionTitleInput.setAttribute("aria-hidden","false"),this.m_sectionTitleInput.readOnly=!1,this.m_sectionTitleInput.style.background=this.sectionTitleInputDblClickColorName,this.m_sectionTitleInput.style.border=this.sectionTitleInputDblClickBorderName,this._activeSpan.setAttribute("aria-hidden","true"),this._activeSpan.style.visibility="hidden",""===this.m_sectionTitleInput.value&&(this.m_sectionTitleInput.value=this.sectionTitle),this.m_sectionTitleInput.select()}isEmptyTitle(e){return""===e||0===e.trim().length}setSectionTitle(){const e=this.sectionTitle;this.sectionTitle=this.m_sectionTitleInput.value,this.m_sectionTitleInput.value="",this.m_sectionTitleInput.readOnly=!0,this.m_viewUpdateSectionTitle.signal(null,{sectionTitleBefore:e,sectionTitleAfter:this.sectionTitle})}createSectionDomWithEdit(){if(this.m_viewUpdateSectionTitle=new s,this.m_viewSelectSection=new s,this.m_sectionTitleDiv.classList.add(this.sectionTitleEditClassName),this.m_slideGridSettings.isDisplayVertical&&this.m_sectionTitleDiv.classList.add(this.verticalSectionTitleEditClassName),this.m_sectionTitleInput=document.createElement("input"),this.m_sectionTitleInput.className=this.sectionTitleInputClassName,this.m_sectionTitleInput.maxLength=this.m_slideGridSettings.sectionTitleMaxLength,this.m_sectionTitleInput.readOnly=!0,this.m_slideGridSettings.reflowEnabled||(this.m_sectionTitleInput.style.width=this.m_slideGridSettings.slideWidth+"px"),this.m_slideGridSettings.isDisplayVertical?(this.m_sectionTitleSpan.classList.add(this.sectionTitleVerticalSpanClassName),this.m_isSectionPasteEnabled&&(this.m_sectionTitleSpan.setAttribute("contenteditable","true"),this.m_sectionTitleSpan.style.cursor="default",this.m_sectionTitleSpan.classList.add(this.editableSectionGridStyleClassName))):this.m_sectionTitleSpan.classList.add(this.sectionTitleSpanClassName),this.m_sectionTitleDiv.appendChild(this.m_sectionTitleInput),this.m_slideGridSettings.loadSectionViewDefaultClassNew?this.m_sectionTitleDiv.classList.remove(this.sectionTitleDefaultWithoutShiftClassName):this.m_sectionTitleDiv.classList.remove(this.sectionTitleDefaultClassName),this.m_sectionTitleInput.setAttribute("aria-hidden","true"),this.m_sectionTitleDiv.onclick=()=>{this.disableNavigation||this.m_viewSelectSection.signal(null,{clickedAway:!1,sectionSelectionTrigger:w.b.Click})},this.m_sectionTitleDiv.oncontextmenu=()=>{this.disableNavigation||this.m_viewSelectSection.signal(null,{clickedAway:!1,sectionSelectionTrigger:w.b.RightClick})},this.m_sectionTitleDiv.onmousedown=()=>{this.m_mouseDown=!0},this.m_sectionTitleDiv.onmouseup=()=>{this.m_mouseDown=!1},this._container.onclick=e=>{if(this.disableNavigation)return e.stopPropagation(),void e.preventDefault();e.target!==this.m_sectionTitleDiv&&e.target!==this.m_sectionTitleInput&&e.target!==this._activeSpan&&this.m_viewSelectSection.signal(null,{clickedAway:!0})},this.m_sectionTitleDiv.onfocus=e=>{e.preventDefault(),this.m_mouseDown||this.m_onCurrentActiveSectionChanged.signal(null,{hasFocus:!0,sectionIndex:this.sectionIndex})},this.m_sectionTitleDiv.onblur=e=>{e.preventDefault(),this.m_onCurrentActiveSectionChanged.signal(null,{hasFocus:!1,sectionIndex:this.sectionIndex})},this.m_sectionTitleDiv.ondblclick=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();e.preventDefault(),this.enableEditMode()},this.m_sectionTitleInput.onclick=e=>{e.preventDefault()},this.m_sectionTitleInput.onblur=e=>{e.preventDefault(),this.m_sectionTitleInput.style.background="",this.m_sectionTitleInput.style.border="",this.m_sectionTitleInput.readOnly||this.updateSectionTitle()},this.m_sectionTitleInput.onkeyup=()=>{this.isEmptyTitle(this.m_sectionTitleInput.value)||(this.sectionTitle=this.m_sectionTitleInput.value)},this.m_isSectionPasteEnabled){const e=()=>{this._spanElement.innerText="."};this.m_sectionTitleSpan.addEventListener("input",e)}this.m_sectionTitleInput.onkeydown=e=>{if(!this.m_sectionTitleInput.readOnly){if(13===e.keyCode||27===e.keyCode)this.updateSectionTitle(),this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this.m_sectionTitleSpan.focus(),this.m_sectionTitleInput.style.background="",this.m_sectionTitleInput.style.border="",this.m_slideGridSettings.isPasteViaKeyboardEnabled&&e.preventDefault();else{this.isEmptyTitle(this.m_sectionTitleInput.value)||(this.sectionTitle=this.m_sectionTitleInput.value);const e=null!=this.m_sectionTitleSpan.offsetWidth?this.m_sectionTitleSpan.offsetWidth:0,i=e>0?e.toString():0,t=Number(i)+this.m_sectionTitleInput.offsetHeight,s=null!=this._container.offsetWidth?this._container.offsetWidth:-1,n=s>0?s.toString():"inf";null!=e&&t>this.m_slideGridSettings.slideWidth&&t<=Number(n)?(this.m_sectionTitleInput.style.width=t+"px",this._activeSpan.style.overflow=""):t<this.m_slideGridSettings.slideWidth?this.m_sectionTitleInput.style.width=this.m_slideGridSettings.slideWidth+"px":t>Number(n)&&(this.m_sectionTitleInput.style.width=n,this._activeSpan.style.width=n,this._activeSpan.style.overflow="hidden")}e.stopPropagation()}}}get onCurrentActiveSectionChanged(){return this.m_onCurrentActiveSectionChanged}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e)}get disableNavigation(){return this._disableNavigation}constructor(e,i){super(i),this.visibleStyleClassName="section-view-visible-class",this.sectionTitleDefaultClassName="section-view-title-default-class",this.sectionTitleDefaultWithoutShiftClassName="section-view-title-default-without-shift-class",this.sectionTitleEditClassName="section-view-edit-title-class",this.verticalSectionTitleEditClassName="section-view-edit-title-vertical-class",this.sectionTitleInputClassName="section-view-title-input-class",this.sectionTitleSpanClassName="section-view-title-span-class",this.sectionTitleVerticalSpanClassName="section-view-vertical-title-span-class",this.sectionDragOverDivClassName="section-view-drag-over-div-class",this.sectionDragOverDivVisibleClassName="section-view-drag-over-div-visible-class",this.sectionTitleFocusStyleClassName="section-view-title-focus-class",this.sectionTitleSelectedClassName="section-view-title-selected-class",this.editableSectionGridStyleClassName="section-content-editable-cursor-hide-class",this.sectionSpanClassName="section-span-class",this.smallScreenSpaceRegainClassName="small-screen-space-regain",this.sectionTitleInputDblClickColorName="rgba(255, 255, 255, 0.7)",this.sectionTitleInputDblClickBorderName="1px solid rgb(200, 198, 196)",this._elementId="section-view-id"+Object(p.v4)(),this.m_isSectionPasteEnabled=!1,this._disableNavigation=!1,this.m_slideGridSettings=e,this._container.id=this._elementId,this._container.className=this.visibleStyleClassName,h.ChangeGate.isChangeGateEnabled("smallScreenSpaceRegain")||this._container.classList.add(this.smallScreenSpaceRegainClassName),e.isUsingSlideGridInThumbnail&&e.isPasteViaKeyboardEnabled&&h.ChangeGate.isChangeGateEnabled("SectionPasteSupport")&&e.allowSectionEdit&&(this.m_isSectionPasteEnabled=!0),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(this.m_onCurrentActiveSectionChanged=new s),this.createBasicSectionDom(),this.m_slideGridSettings.allowSectionEdit&&this.createSectionDomWithEdit()}}class y extends n.a{raiseEventFromClick(e){if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();e.preventDefault();const i=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null,t=new RegExp("grid-list-view");if(null!=i){(i.getAttribute("class")||"").search(t)>0&&this._onViewClick.signal(null,{clientX:e.clientX,clientY:e.clientY})}}get onViewClick(){return this._onViewClick}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e)}get disableNavigation(){return this._disableNavigation}constructor(e,i){super(e),this.visibleStyleClassName="grid-list-view-visible-class",this.verticalVisibleStyleClassName="grid-list-view-vertical-visible-class",this._disableNavigation=!1,this._elementId="grid-list-view-id"+Object(p.v4)(),this.m_slideGridSettings=i,this._container.id=this._elementId,this._container.classList.add(this.visibleStyleClassName),i.isDisplayVertical&&this._container.classList.add(this.verticalVisibleStyleClassName),this._onViewClick=new s,this.container.onclick=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();this.raiseEventFromClick(e)},this.container.oncontextmenu=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();e.preventDefault(),this.raiseEventFromClick(e)}}}!function(e){e[e["presence-flyout-collapsed-class-0"]=0]="presence-flyout-collapsed-class-0",e[e["presence-flyout-collapsed-class-1"]=1]="presence-flyout-collapsed-class-1",e[e["presence-flyout-collapsed-class-2"]=2]="presence-flyout-collapsed-class-2"}(v||(v={})),function(e){e["#498205"]="persona-color-498205",e["#e3008c"]="persona-color-e3008c",e["#0078d4"]="persona-color-0078d4",e["#986f0b"]="persona-color-986f0b",e["#a4262c"]="persona-color-a4262c",e["#4f6bed"]="persona-color-4f6bed",e["#c239b3"]="persona-color-c239b3",e["#038387"]="persona-color-038387",e["#393939"]="persona-color-393939",e["#0b6a0b"]="persona-color-0b6a0b",e["#8764b8"]="persona-color-8764b8",e["#750b1c"]="persona-color-750b1c",e["#7a7574"]="persona-color-7a7574",e["#004e8c"]="persona-color-004e8c",e["#8e562e"]="persona-color-8e562e",e["#69797e"]="persona-color-69797e",e["#881798"]="persona-color-881798",e["#005b70"]="persona-color-005b70"}(b||(b={}));class D extends n.a{isMouseInPresenceFlyoutRegion(e){const i=e.clientX,t=e.clientY,s=this._presenceFlyoutContainer.getBoundingClientRect();return i>s.left&&i<s.right&&t>s.top&&t<s.bottom}raiseEventFromClick(e){const i=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null,t=new RegExp("grid-frame-view");if(null!=i){(i.getAttribute("class")||"").search(t)>0&&this._onViewClick.signal(null,null)}}get renderAreaRect(){const e=this._container.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}set presenceUserList(e){for(this._presenceUserList=e,this._totalPresenceUsers=this._presenceUserList.length;this._currentPresenceUsers<this._totalPresenceUsers;){const e=document.createElement("div");this._presenceFlyoutContainer.appendChild(e),this._presenceFlyouts.push(e),this._currentPresenceUsers+=1}for(;this._currentPresenceUsers>this._totalPresenceUsers;){const e=this._presenceFlyoutContainer.firstChild;e&&(this._presenceFlyoutContainer.removeChild(e),this._presenceFlyouts.splice(0,1)),this._currentPresenceUsers-=1}h.ChangeGate.isChangeGateEnabled("PresenceFlyoutDisplayStyle")&&(this._presenceOuterContainer.style.display=this._totalPresenceUsers>0?"block":"none"),this.presenceCollapseStyling()}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e)}get disableNavigation(){return this._disableNavigation}presenceExpandStyling(){if(this._currentPresenceUsers!==this._totalPresenceUsers||null!==this._presenceUserList&&this._currentPresenceUsers!==this._presenceUserList.length)return;let e=this._totalPresenceUsers-1;this._presenceFlyoutContainer.classList.add(this.presenceExpandedContainerClassName),this._presenceFlyouts.forEach(i=>{i.classList.remove(this.presenceFlyoutsCollapsedClassName),i.classList.remove(this.presenceFlyoutCollapsedTextName),i.classList.remove(v[0]),i.classList.remove(v[1]),i.classList.remove(v[2]),i.classList.remove(this.presenceHiddenClassName),i.classList.add(this.presenceFlyoutsExpandedClassName),i.classList.add(this.presenceFlyoutExpandedTextName),i.innerText=this._presenceUserList[e].userName?this._presenceUserList[e].userName:"";const t=b[this._presenceUserList[e].color];i.classList.add(t),e-=1})}presenceCollapseStyling(){if(this._currentPresenceUsers!==this._totalPresenceUsers||null!==this._presenceUserList&&this._currentPresenceUsers!==this._presenceUserList.length)return;let e=this._totalPresenceUsers-1;this._presenceFlyoutContainer.classList.remove(this.presenceExpandedContainerClassName),this._presenceFlyouts.forEach(i=>{i.classList.remove(this.presenceFlyoutsExpandedClassName),i.classList.remove(this.presenceFlyoutExpandedTextName),i.classList.add(this.presenceFlyoutsCollapsedClassName),i.classList.add(this.presenceFlyoutCollapsedTextName),this.presenceCollapseStylingHelper(e,i);const t=b[this._presenceUserList[e].color];i.classList.add(t),e-=1})}presenceCollapseStylingHelper(e,i){switch(e){case 0:i.innerText=this._presenceUserList[e].initials?this._presenceUserList[e].initials:"",i.classList.add(v[0]),i.classList.remove(v[1]),i.classList.remove(v[2]),i.classList.remove(this.presenceHiddenClassName);break;case 1:i.innerText="",i.classList.remove(v[0]),i.classList.add(v[1]),i.classList.remove(v[2]),i.classList.remove(this.presenceHiddenClassName);break;case 2:i.innerText="",i.classList.remove(v[0]),i.classList.remove(v[1]),i.classList.add(v[2]),i.classList.remove(this.presenceHiddenClassName);break;default:i.innerText="",i.classList.remove(v[0]),i.classList.remove(v[1]),i.classList.remove(v[2]),i.classList.add(this.presenceHiddenClassName)}}set isSelected(e){this._isSelected=e,this._isSelected?this._container.classList.add(this.selectedStyleClassName):this._container.classList.remove(this.selectedStyleClassName)}get onViewClick(){return this._onViewClick}get onPresenceHover(){return this._onPresenceHover}set hasActiveFocus(e){this._hasActiveFocus=e,this._hasActiveFocus?(this.m_slideGridSettings.isDisplayVertical||this._container.classList.add(this.activeFocusStyleClassName),this.m_slideGridSettings.allowScrollIntoView&&this._container.scrollIntoView({block:"nearest"})):this.m_slideGridSettings.isDisplayVertical||this._container.classList.remove(this.activeFocusStyleClassName)}set isHiddenSlide(e){this._isHiddenSlide=e,this._isHiddenSlide?this._container.classList.add(this.hiddenSlideStyleClassName):this._container.classList.remove(this.hiddenSlideStyleClassName)}get innerContainer(){return this._innerContainer}get slideInfoContainer(){return this._slideInfoContainer}constructor(e,i,t){if(super(i),this.visibleStyleClassName="grid-frame-view-visible-class",this.verticalVisibleStyleClassName="grid-frame-view-vertical-visible-class",this.visibleStyleClassNameForUsingSlideGridInThumbnail="grid-frame-view-visible-thumbnail-class",this.hiddenStyleClassName="grid-frame-view-hidden-class",this.dragStyleClassName="grid-frame-view-in-drag-class",this.selectedStyleClassName="grid-frame-view-selected-class",this.activeFocusStyleClassName="grid-frame-view-active-focus-class",this.hiddenSlideStyleClassName="grid-frame-view-hidden-slide-class",this.slideInfoContainerClassName="grid-frame-view-slide-info-container-class",this.verticalSlideInfoContainerClassName="grid-frame-view-slide-info-container-vertical-class",this.slideIndexContainerClassName="grid-frame-view-slide-index-container-class",this.slideIndexContainerClassNameForUsingSlideGridInThumbnail="grid-frame-view-slide-index-container-thumbnail-class",this.containerRenderedAsGridStyleClassName="container-rendered-as-grid-class",this.transitionOrAnimationIconContainerClassName="grid-frame-view-transition-or-animation-icon-container-class",this.transitionOrAnimationIconContainerVeticalClassName="grid-frame-view-transition-or-animation-icon-container-vertical-class",this.gridFrameViewInnerContainerClassName="grid-frame-view-inner-container-class",this.gridFrameViewInnerContainerVerticalClassName="grid-frame-view-inner-container-vertical-class",this.gridFrameViewReflowWidth="grid-frame-view-reflow-width",this.commentIconContainerClassName="grid-frame-view-num-comments-with-icon-container-class",this.numCommentsOnCommentIconClassName="grid-frame-view-num-comments-on-comment-icon",this.commentIconClassName="comment-icon-class",this.presenceHiddenClassName="presence-collapsed-hidden-class",this.presenceOuterContainerClassName="presence-outer-container-class",this.presenceOuterContainerVerticalClassName="presence-outer-container-vertical-class",this.presenceOuterContainerVerticalThumbnailClassName="presence-outer-container-vertical-thumbnail-class",this.presenceOuterContainerVerticalRTLThumbnailClassName="presence-outer-container-vertical-rtl-thumbnail-class",this.presenceInnerContainerClassName="presence-inner-container-class",this.presenceTouchTargetClassName="presence-touch-target-class",this.presenceFlyoutContainerClassName="presence-flyout-container-class",this.presenceFlyoutsCollapsedClassName="presence-flyouts-collapsed-class",this.presenceFlyoutCollapsedTextName="presence-flyout-collapsed-text-class",this.presenceFlyoutsExpandedClassName="presence-flyout-expanded-class",this.presenceFlyoutExpandedTextName="presence-flyout-expanded-text-class",this.presenceExpandedContainerClassName="presence-flyout-expanded-container-class",this.postionRelativeClassName="grid-frame-view-postion-relative-class",this.transitionOrAnimationIconClassName="transition-or-animation-icon-class",this.smallScreenSpaceRegainClassName="small-screen-space-regain",this.c_transitionOrAnimationIconStarPath="M 809 1703 l 158 -547 l -455 -374 h 569 l 185 -526 l 194 527 h 570 l -450 368 l 167 544 l -472 -319 z",this.c_transitionOrAnimationIconGlitterPath="M 392 619 l -392 -120 l 50 -98 l 387 122 m -53 640 h -384 v -128 h 384 m -364 668 l 373 -150 l 55 100 l -368 150 z",this.c_collabMarkerViewBox="0 0 2048 2048",this.c_commentIconPath="M 1920 128 v 1280 h -1024 l -512 512 v -512 h -256 v -1280 z",this._elementId="grid-frame-view-id"+Object(p.v4)(),this._presenceFlyouts=new Array,this._totalPresenceUsers=0,this._currentPresenceUsers=0,this._presenceUserList=new Array,this._disableNavigation=!1,this._events=t,this._container.id=this._elementId,this._container.classList.add(this.visibleStyleClassName),h.ChangeGate.isChangeGateEnabled("smallScreenSpaceRegain")||this._container.classList.add(this.smallScreenSpaceRegainClassName),this.m_slideGridSettings=e,e.isDisplayVertical&&this._container.classList.add(this.verticalVisibleStyleClassName),e.isUsingSlideGridInThumbnail&&this._container.classList.add(this.visibleStyleClassNameForUsingSlideGridInThumbnail),this._onViewClick=new s,this._innerContainer=document.createElement("div"),this._container.appendChild(this._innerContainer),this._innerContainer.className=this.gridFrameViewInnerContainerClassName,(e.isDisplayVertical||e.displaySlideInfoOnLeft)&&(this._innerContainer.className=this.gridFrameViewInnerContainerVerticalClassName),this.m_slideGridSettings.isDisplayPresenceIcon&&this._innerContainer.classList.add(this.postionRelativeClassName),this.m_slideGridSettings.reflowEnabled&&this.innerContainer.classList.add(this.gridFrameViewReflowWidth),this._slideIndexContainer=document.createElement("div"),this._slideIndexContainer.classList.add(this.slideIndexContainerClassName),e.isUsingSlideGridInThumbnail&&this._slideIndexContainer.classList.add(this.slideIndexContainerClassNameForUsingSlideGridInThumbnail),this._slideIndexContainer.setAttribute("aria-hidden","true"),this._slideIndexSpan=document.createElement("span"),this._slideIndexContainer.appendChild(this._slideIndexSpan),e.isDisplayPresenceIcon&&(this._onPresenceHover=new s,this._presenceOuterContainer=document.createElement("div"),this._presenceOuterContainer.classList.add(this.presenceOuterContainerClassName),e.isDisplayVertical&&(this._presenceOuterContainer.classList.add(this.presenceOuterContainerVerticalClassName),e.isUsingSlideGridInThumbnail&&(this._presenceOuterContainer.classList.add(this.presenceOuterContainerVerticalThumbnailClassName),e.isRTL&&this._presenceOuterContainer.classList.add(this.presenceOuterContainerVerticalRTLThumbnailClassName))),e.reflowEnabled?(this._presenceOuterContainer.style.width="auto",this._presenceOuterContainer.style.height="100%"):(this._presenceOuterContainer.style.width=this.m_slideGridSettings.slideWidth.toString()+"px",this._presenceOuterContainer.style.height=this.m_slideGridSettings.slideHeight.toString()+"px"),this._innerContainer.appendChild(this._presenceOuterContainer),this._presenceInnerContainer=document.createElement("div"),this._presenceInnerContainer.classList.add(this.presenceInnerContainerClassName),this._presenceOuterContainer.appendChild(this._presenceInnerContainer),this._presenceTouchtarget=document.createElement("div"),this._presenceTouchtarget.classList.add(this.presenceTouchTargetClassName),this._presenceInnerContainer.appendChild(this._presenceTouchtarget),this._presenceFlyoutContainer=document.createElement("div"),this._presenceFlyoutContainer.classList.add(this.presenceFlyoutContainerClassName),this._presenceInnerContainer.appendChild(this._presenceFlyoutContainer),h.ChangeGate.isChangeGateEnabled("PresenceFlyoutDisplayStyle")&&(this._presenceOuterContainer.style.display="none")),e.enableRevisionTrackingInfo||e.commentsEnabled||e.shouldRenderAnimationOrTransitionInfo?(this._slideInfoContainer=document.createElement("div"),this._slideInfoContainer.classList.add(this.slideInfoContainerClassName),e.isDisplayVertical&&(this._slideInfoContainer.classList.add(this.verticalSlideInfoContainerClassName),e.reflowEnabled?this._slideInfoContainer.style.height="auto":this._slideInfoContainer.style.height=this.m_slideGridSettings.slideHeight.toString()+"px"),this._container.classList.add(this.containerRenderedAsGridStyleClassName),this._slideIndexContainer.classList.add(this.containerRenderedAsGridStyleClassName),this._innerContainer.appendChild(this._slideInfoContainer),this._slideInfoContainer.appendChild(this._slideIndexContainer)):this._innerContainer.appendChild(this._slideIndexContainer),e.shouldRenderAnimationOrTransitionInfo){if(this._transitionOrAnimationIconContainer=document.createElement("div"),this._transitionOrAnimationIconContainer.classList.add(this.transitionOrAnimationIconContainerClassName),e.isDisplayVertical&&this._transitionOrAnimationIconContainer.classList.add(this.transitionOrAnimationIconContainerVeticalClassName),this._transitionOrAnimationIconContainer.setAttribute("aria-hidden","true"),this._transitionOrAnimationIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),void 0===this._transitionOrAnimationIcon.classList){let e=this._transitionOrAnimationIcon.getAttribute("class")||"";e=-1===e.split(" ").indexOf(this.transitionOrAnimationIconClassName)?e.concat(" ",this.transitionOrAnimationIconClassName):e,this._transitionOrAnimationIcon.setAttribute("class",e)}else this._transitionOrAnimationIcon.classList.add(this.transitionOrAnimationIconClassName);this._transitionOrAnimationIcon.setAttribute("viewBox",this.c_collabMarkerViewBox),this._transitionOrAnimationIconStarPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this._transitionOrAnimationIconStarPath.setAttribute("d",this.c_transitionOrAnimationIconStarPath),this._transitionOrAnimationIconGlitterPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this._transitionOrAnimationIconGlitterPath.setAttribute("d",this.c_transitionOrAnimationIconGlitterPath),this._transitionOrAnimationIcon.appendChild(this._transitionOrAnimationIconStarPath),this._transitionOrAnimationIcon.appendChild(this._transitionOrAnimationIconGlitterPath),this._transitionOrAnimationIconContainer.appendChild(this._transitionOrAnimationIcon),e.isDisplayVertical||this._slideInfoContainer.appendChild(this._transitionOrAnimationIconContainer)}if(e.commentsEnabled){if(this._numCommentsSpan=document.createElement("span"),this._commentIconContainer=document.createElement("div"),this._commentIconContainer.classList.add(this.commentIconContainerClassName),this._commentIconContainer.setAttribute("aria-hidden","true"),this.m_slideGridSettings.isUsingSlideGridInThumbnail&&(this._commentIconContainer.onclick=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();e&&(this._events.onSlideSelectionChanged.signal(null,{slideIndex:this._slideIndex,slideSelectionTrigger:w.c.DoubleClick,isSelectingRange:!1,isSelectingMultiple:!1,isCommentCountClicked:!0}),this._events.onCommentCountClick.signal(null,{}))}),this._commentIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),void 0===this._commentIcon.classList){let e=this._commentIcon.getAttribute("class")||"";e=e.concat(" ",this.commentIconClassName),this._commentIcon.setAttribute("class",e)}else this._commentIcon.classList.add(this.commentIconClassName);this._commentIcon.setAttribute("viewBox",this.c_collabMarkerViewBox),this._commentIconPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this._commentIconPath.setAttribute("d",this.c_commentIconPath),this._commentIcon.appendChild(this._commentIconPath),this._commentIconContainer.appendChild(this._commentIcon),this._numCommentsSpan.classList.add(this.numCommentsOnCommentIconClassName),this._slideInfoContainer.appendChild(this._commentIconContainer),this._commentIconContainer.appendChild(this._numCommentsSpan)}e.shouldRenderAnimationOrTransitionInfo&&e.isDisplayVertical&&this._slideInfoContainer.appendChild(this._transitionOrAnimationIconContainer);new m.a(this,"slideIndex").addBinding({element:this._slideIndexSpan,onValueChanged:()=>{const e=""+(this._slideIndex+1);this._slideIndexSpan.innerText=e}});if(new m.a(this,"isInDragState").addBinding({element:this._container,attribute:"display",onValueChanged:e=>{if(e){this._container.classList.add(this.containerRenderedAsGridStyleClassName),this._container.style.visibility="hidden";const e=document.querySelector(".grid-content-boundary-view-selected-class");e&&(e.style.visibility="visible")}else this._container.classList.contains(this.containerRenderedAsGridStyleClassName)&&(this._container.style.visibility="visible"),this._container.classList.remove(this.containerRenderedAsGridStyleClassName)}}),e.commentsEnabled){if(new m.a(this,"numComments").addBinding({element:this._numCommentsSpan,attribute:"innerText"}),e.isUsingSlideGridInThumbnail){new m.a(this,"commentsToolTipValue").addBinding({element:this._numCommentsSpan,attribute:"title"})}new m.a(this,"displayCommentIcon").addBinding({element:this._commentIconContainer,attribute:"display",onValueChanged:e=>{e?this._commentIconContainer.classList.remove("grid-frame-view-Comments-icon-hidden-class"):this._commentIconContainer.classList.add("grid-frame-view-Comments-icon-hidden-class")}})}if(e.shouldRenderAnimationOrTransitionInfo){if(new m.a(this,"displayTransitionOrAnimationIcon").addBinding({element:this._transitionOrAnimationIconContainer,attribute:"display",onValueChanged:e=>{e?this._transitionOrAnimationIconContainer.classList.remove("grid-frame-view-transition-or-animation-icon-hidden-class"):this._transitionOrAnimationIconContainer.classList.add("grid-frame-view-transition-or-animation-icon-hidden-class")}}),e.isUsingSlideGridInThumbnail){new m.a(this,"transitionOrAnimationToolTipValue").addBinding({element:this._transitionOrAnimationIconContainer,attribute:"title"})}}e.enableSelectionBetweenSlides&&(this._container.onclick=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();this.raiseEventFromClick(e)},this._container.oncontextmenu=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();e.preventDefault(),this.raiseEventFromClick(e)}),e.isMobileScreenReader&&this._container.addEventListener("click",e=>{e.preventDefault(),this._onViewClick.signal(null,{slideSelectionTrigger:w.c.Click})}),e.isDisplayPresenceIcon&&(this._presenceTouchtarget.addEventListener("mouseout",e=>{this.isMouseInPresenceFlyoutRegion(e)||this._onPresenceHover.signal(null,{presenceTouchTargetTrigger:w.a.MouseOut})}),this._presenceTouchtarget.addEventListener("mouseover",()=>{this._onPresenceHover.signal(null,{presenceTouchTargetTrigger:w.a.MouseOver})}),this._presenceFlyoutContainer.addEventListener("mouseout",e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();this.isMouseInPresenceFlyoutRegion(e)||this._onPresenceHover.signal(null,{presenceTouchTargetTrigger:w.a.MouseOut})})),this._events.onShiftArrowKeyScroll.subscribe((e,i)=>{i.slideIndex===this.slideIndex&&this._container.scrollIntoView({block:"nearest"})})}}class T extends n.a{get onViewClick(){return this._viewClickEvent}set slideIndex(e){this._slideIndex=e}set hasActiveFocus(e){this._hasActiveFocus=e,this._hasActiveFocus&&this._container.focus()}set displayCopilotUXEntryPoint(e){this._displayCopilotUXEntryPoint=e,this._displayCopilotUXEntryPoint&&!this._copilotUXAnchorElement&&(this._copilotUXAnchorElement=document.createElement("div"),this._copilotUXAnchorElement.id=this.copilotUXAnchorId,this._copilotUXAnchorElement.classList.add(this.copilotUXStyleClassName),h.ChangeGate.isChangeGateEnabled("CopilotUXAbsolutePositioning")&&(this._copilotUXAnchorElement.style.position="absolute",this.m_slideGridSettings.reflowEnabled||(this._copilotUXAnchorElement.style.top=this.m_slideGridSettings.slideHeight.toString()+"px")),0==this.slideIndex&&this._container&&this._container.appendChild(this._copilotUXAnchorElement))}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e)}get disableNavigation(){return this._disableNavigation}get renderAreaRect(){const e=this._container.getBoundingClientRect();return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}constructor(e,i){super(i),this.visibleStyleClassName="grid-content-view-visible-class",this.thumbnailVisibleStyleClassName="grid-content-thumbnail-view-visible-class",this.thumbnailzIndexVisibleStyleClassName="grid-content-thumbnail-zIndex-view-visible-class",this.containerRenderedAsGridStyleClassName="container-rendered-as-grid-class",this.hiddenStyleClassName="grid-content-view-hidden-class",this.editableGridStyleClassName="grid-content-editable-cursor-hide-class",this.copilotUXAnchorId="ppt-slidegrid-copilot-start-anchor-element",this.copilotUXStyleClassName="ppt-slidegrid-copilot-ux-class",this._elementId="grid-content-view-id"+Object(p.v4)(),this._disableNavigation=!1,this._container.classList.add(this.visibleStyleClassName),e.isUsingSlideGridInThumbnail&&this._container.classList.add(this.thumbnailVisibleStyleClassName),e.isUsingSlideGridInThumbnail&&h.ChangeGate.isChangeGateEnabled("zIndexIssueOnRibbonFlyoutFix")&&this._container.classList.add(this.thumbnailzIndexVisibleStyleClassName),this._container.id=this._elementId,this.m_slideGridSettings=e,this.m_slideGridSettings.commentsEnabled&&this._container.classList.add(this.containerRenderedAsGridStyleClassName),this._viewClickEvent=new s,e.reflowEnabled?(h.ChangeGate.isChangeGateEnabled("ThumbnailSafariSizeFix")?this._container.style.height="100%":this._container.style.height="auto",this._container.style.width="100%",this.container.style.aspectRatio=`${this.m_slideGridSettings.slideWidth} / ${this.m_slideGridSettings.slideHeight}`):(this._container.style.width=this.m_slideGridSettings.slideWidth.toString()+"px",this._container.style.height=this.m_slideGridSettings.slideHeight.toString()+"px"),this._container.tabIndex=this.m_slideGridSettings.disableAutomaticTabStops?-1:0,e.isUsingSlideGridInThumbnail||this._container.setAttribute("aria-level","1"),e.isMobileScreenReader?this._container.setAttribute("role","menuitem"):this._container.setAttribute("role","option");const t=e=>{if(this.disableNavigation)return e.preventDefault(),e.stopPropagation(),!1;if(this._displayCopilotUXEntryPoint&&this.m_slideGridSettings.isCopilotUXEntryPointEnabled){const i=e.target;if(i&&(i.id===this.copilotUXAnchorId||i.id===this.m_slideGridSettings.copilotUXTabStopId))return!0}return!1};this._container.onclick=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();if(e.preventDefault(),t(e))return;const i=(e.metaKey||e.ctrlKey||e.shiftKey)&&this.m_slideGridSettings.allowMultipleSelect,s=e.shiftKey,n=e.ctrlKey;this.onViewClick.signal(null,{slideSelectionTrigger:w.c.Click,isSelectingMultiple:i,isSelectingRange:s,isCtrlKeyPressed:n})},this.m_slideGridSettings.allowMoveSlide&&(this._container.onmousedown=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();if(0===e.button){if(e.preventDefault(),t(e))return;const i=(e.metaKey||e.ctrlKey||e.shiftKey)&&this.m_slideGridSettings.allowMultipleSelect,s=e.shiftKey,n=e.ctrlKey;if(this.m_slideGridSettings.isDeselectWithCtrlEnabled&&n)return;this.onViewClick.signal(null,{slideSelectionTrigger:w.c.MouseDown,isSelectingMultiple:i,isSelectingRange:s,isCtrlKeyPressed:n,eventObj:e})}}),this.m_slideGridSettings.enableTriggerSelectionFromRightClick&&(this._container.oncontextmenu=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();if(e.preventDefault(),t(e))return;const i=(e.metaKey||e.ctrlKey||e.shiftKey)&&this.m_slideGridSettings.allowMultipleSelect,s=e.shiftKey;h.ChangeGate.isChangeGateEnabled("ContextMenuViaKeyboardFix")&&-1==e.button||this.onViewClick.signal(null,{slideSelectionTrigger:w.c.RightClick,isSelectingMultiple:i,isSelectingRange:s})}),this.m_slideGridSettings.enableTriggerSelectionFromDoubleClick&&(this._container.ondblclick=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();if(e.preventDefault(),t(e))return;const i=(e.metaKey||e.ctrlKey||e.shiftKey)&&this.m_slideGridSettings.allowMultipleSelect,s=e.shiftKey;this.onViewClick.signal(null,{slideSelectionTrigger:w.c.DoubleClick,isSelectingMultiple:i,isSelectingRange:s})});new m.a(this,"totalSlideCount").addBinding({element:this._container,onValueChanged:()=>{this._container.setAttribute("aria-setsize",this._totalSlideCount.toString())}});const n=new m.a(this,"slideTitle");this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&h.ChangeGate.isChangeGateEnabled("CopilotUXThumbnailCustomTooltip")||n.addBinding({element:this._container,onValueChanged:e=>{this._container.title=e}});new m.a(this,"slideAriaLabel").addBinding({element:this._container,onValueChanged:e=>{this._container.setAttribute("aria-label",null!=e&&""!==e?e:this._slideTitle)}});new m.a(this,"slideIndex").addBinding({element:this._container,onValueChanged:()=>{const e=""+(this._slideIndex+1);this._container.setAttribute("aria-posinset",e)}});new m.a(this,"isSelected").addBinding({element:this._container,onValueChanged:()=>{this._container.setAttribute("aria-selected",this._isSelected.toString())}}),e.isPasteViaKeyboardEnabled&&(this._container.classList.add(this.editableGridStyleClassName),this._container.ariaReadOnly="false",this._container.contentEditable="true")}}class x extends n.a{handleImageChange(e){null==e||""===e?(this._container.classList.remove(this.visibleStyleClassName),this._container.classList.add(this.hiddenStyleClassName)):(this._container.classList.remove(this.hiddenStyleClassName),this._container.classList.add(this.visibleStyleClassName))}constructor(e,i){super(e),this.visibleStyleClassName="content-image-view-visible-class",this.hiddenStyleClassName="content-image-view-hidden-class",this.contenteditableClassName="content-editable-class",this._elementId="content-image-view-id"+Object(p.v4)(),this._imageElement=document.createElement("img"),this._container.id=this._elementId,this._container.classList.add(this.visibleStyleClassName),i.isPasteViaKeyboardEnabled&&(this._spanElement=document.createElement("span"),this._spanElement.innerText=".",this._spanElement.ariaReadOnly="false",this._spanElement.contentEditable="true",this._spanElement.classList.add(this.contenteditableClassName),this._container.appendChild(this._spanElement)),this._container.appendChild(this._imageElement),this._container.setAttribute("aria-hidden","true");new m.a(this,"image").addBinding({element:this._imageElement,attribute:"src",onValueChanged:this.handleImageChange.bind(this)});const t=new m.a(this,"slideTitle");i.isCopilotUXEntryPointEnabled&&h.ChangeGate.isChangeGateEnabled("CopilotUXThumbnailCustomTooltip")&&t.addBinding({element:this._container,onValueChanged:e=>{this._container.title=e}})}}class L{dispose(){null!=this._view&&this._view.dispose()}constructor(e){null!=this._parent&&(this._parent=e)}}class M extends L{constructor(e,i,t){super(e),this._events=i,this._view=new x(e,t);new m.b(this,"image").addBinding({target:this._view});new m.b(this,"slideTitle").addBinding({target:this._view})}}!function(e){e[e.Slide=0]="Slide",e[e.Section=1]="Section",e[e.SlidePlaceholder=2]="SlidePlaceholder"}(f||(f={}));class E{isEqual(e){return this.m_index===e.index&&this.dragDropObjectType===e.dragDropObjectType}get index(){return this.m_index}set index(e){this.m_index=e}get dragDropObjectType(){return this.m_type}constructor(e,i){this.m_index=i,this.m_type=e}}class O extends L{set contentImage(e){if(this.m_slideGridSettings.isUsingSlideGridInThumbnail)if(this.m_slideGridSettings.isRenderGridThumbnailPlaceholderEnabled&&!this.slideIndex){const i=this.m_slideGridSettings.isRTL;!e&&this.m_slideGridSettings.showBlankThumbnailPlaceholderExperience?(this._view.container.classList.add(O.gridThumbnailPlaceholderClassName),this.m_slideGridSettings.showBlankThumbnailPlaceholderExperience=!1):e||this.m_slideGridSettings.showBlankThumbnailPlaceholderExperience?(this._view.container.classList.remove(O.gridThumbnailPlaceholderClassName),i?this._view.container.classList.remove(O.thumbnailShimmerEffectClassName,O.thumbnailShimmerEffectRTLClassName):this._view.container.classList.remove(O.thumbnailShimmerEffectClassName)):i?this._view.container.classList.add(O.thumbnailShimmerEffectClassName,O.thumbnailShimmerEffectRTLClassName):this._view.container.classList.add(O.thumbnailShimmerEffectClassName)}else{const i=this.m_slideGridSettings.isRTL;e?i?this._view.container.classList.remove(O.thumbnailShimmerEffectClassName,O.thumbnailShimmerEffectRTLClassName):this._view.container.classList.remove(O.thumbnailShimmerEffectClassName):i?this._view.container.classList.add(O.thumbnailShimmerEffectClassName,O.thumbnailShimmerEffectRTLClassName):this._view.container.classList.add(O.thumbnailShimmerEffectClassName)}this._contentImageViewModel.image=e}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e,this._view.disableNavigation=e,this._draggable&&(this._draggable.disableMoveSlide=this._disableNavigation))}get disableNavigation(){return this._disableNavigation}get renderAreaRect(){return this._view.renderAreaRect}dispose(){super.dispose(),this.m_slideGridSettings.allowMoveSlide&&null!=this._dragDropManager&&this._dragDropManager.removeDraggable(this._draggable)}constructor(e,i,t,s){super(i),this._disableNavigation=!1,this._events=t,this._dragDropManager=s,this.m_slideGridSettings=e,this._view=new T(this.m_slideGridSettings,i),this._contentImageViewModel=new M(this._view.container,this._events,this.m_slideGridSettings),e.allowMoveSlide&&(this._draggable=this._dragDropManager.addNewDraggable(this._view.container,new E(f.Slide,this._slideIndex)),this._draggable&&(this._draggable.reflowEnabled=!!e.reflowEnabled,h.ChangeGate.isChangeGateEnabled("disableNavigationErrorFix")&&(this._draggable.disableMoveSlide=e.allowDisableNavigation&&this.disableNavigation)));new m.b(this,"slideIndex").addBinding({target:this._view,onValueChanged:e=>{this.m_slideGridSettings.allowMoveSlide&&(this._draggable.objectData.index=e)}});new m.b(this,"totalSlideCount").addBinding({target:this._view});new m.b(this,"activeSectionIndex").addBinding({target:this._view});new m.b(this,"slideAriaLabel").addBinding({target:this._view});const n=new m.b(this,"slideTitle");n.addBinding({target:this._view}),n.addBinding({target:this._contentImageViewModel});new m.b(this,"hasActiveFocus").addBinding({target:this._view});new m.b(this,"isSelected").addBinding({target:this._view,onValueChanged:e=>{if(this.m_slideGridSettings.allowMoveSlide){const i=this._dragDropManager.dragReadyElements;if(e)i.indexOf(this._draggable)<0&&(i.push(this._draggable),this._dragDropManager.dragReadyElements=i);else{const e=i.indexOf(this._draggable);e>=0&&(i.splice(e,1),this._dragDropManager.dragReadyElements=i)}}}});new m.b(this,"displayCopilotUXEntryPoint").addBinding({target:this._view}),this._view.onViewClick.subscribe((e,i)=>{const t=this._slideIndex;let s=i.isSelectingMultiple;const n=i.isSelectingRange,a=i.isCtrlKeyPressed,r=i.eventObj;if(this.m_slideGridSettings.allowMoveSlide&&i.slideSelectionTrigger===w.c.RightClick&&this.m_slideGridSettings.allowMultipleSelect){this._dragDropManager.dragReadyElements.indexOf(this._draggable)<0?this._dragDropManager.dragReadyElements=[this._draggable]:s=!0}this._events.onSlideSelectionChanged.signal(null,{slideIndex:t,slideSelectionTrigger:null!=i?i.slideSelectionTrigger:w.c.Click,isSelectingMultiple:s,isSelectingRange:n,isCtrlKeyPressed:a,eventObj:r})})}}O.thumbnailShimmerEffectClassName="thumbsShimmerEffect",O.gridThumbnailPlaceholderClassName="gridThumbnailPlaceholder",O.thumbnailShimmerEffectRTLClassName="thumbsShimmerEffectRTL";class N extends n.a{raiseEventFromClick(e){e.preventDefault();const i=this.m_isBeforeFirstSlideBoundary?0:this.slideIndex+1;this.onViewClick.signal(null,{insertIndex:i})}set displayCopilotUXEntryPoint(e){this._displayCopilotUXEntryPoint=e,this._displayCopilotUXEntryPoint&&0===this.slideIndex&&this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&(this._container.id=this.gridContentBoundaryIdCopilotStart)}get onViewClick(){return this._onViewClick}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e)}get disableNavigation(){return this._disableNavigation}constructor(e,i,t){super(e),this.gridContentPaddingLength=23,this._disableNavigation=!1,this.defaultStyleClassName="grid-content-boundary-view-default-class",this.defaultVerticalStyleClassName="grid-content-boundary-vertical-view-default-class",this.deselectedStyleClassName="grid-content-boundary-view-deselected-class",this.defaultStyleClassNameForUsingSlideGridInThumbnail="grid-content-boundary-view-default-thumbnail-class",this.selectedStyleClassName="grid-content-boundary-view-selected-class",this.hiddenStyleClassName="grid-content-boundary-view-hidden-class",this.firstSlideLeftBoundaryWithSectionsStyleClassName="grid-content-boundary-view-first-slide-with-sections-class",this.firstSlideLeftBoundaryWithoutSectionsStyleClassName="grid-content-boundary-view-first-slide-without-sections-class",this.editableGridStyleClassName="grid-content-editable-cursor-hide-class",this.contenteditableClassName="content-editable-class",this.marginTopCopilotUX=40,this._elementId="grid-content-boundary-view"+Object(p.v4)(),this.gridContentBoundaryIdCopilotStart="ppto-grid-content-lower-boundary-element-copilot-ux",this.m_isBeforeFirstSlideBoundary=!0,this._container.id=this._elementId,this._container.classList.add(this.defaultStyleClassName),this.m_slideGridSettings=i,this.m_slideGridSettings.isDisplayVertical&&this._container.classList.add(this.defaultVerticalStyleClassName),this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this._container.classList.add(this.defaultStyleClassNameForUsingSlideGridInThumbnail),this._onViewClick=new s,this.m_isBeforeFirstSlideBoundary=t,this._container.setAttribute("aria-hidden","true"),this.m_slideGridSettings.isPasteViaKeyboardEnabled&&(this._container.contentEditable="true",this._container.style.cursor="default",this._container.classList.add(this.editableGridStyleClassName),this._container.classList.add(this.contenteditableClassName));new m.a(this,"isSelected").addBinding({element:this._container,onValueChanged:e=>{e?(this._container.classList.add(this.selectedStyleClassName),this._container.tabIndex=0,this._container.focus()):(this._container.classList.remove(this.selectedStyleClassName),this._container.tabIndex=-1,this._container.blur())}});if(new m.a(this,"isVisible").addBinding({element:this._container,onValueChanged:e=>{e?this._container.classList.remove(this.hiddenStyleClassName):(this.isSelected=!1,this._container.classList.add(this.hiddenStyleClassName))}}),t&&!i.isDisplayVertical){new m.a(this,"shouldDisplaySection").addBinding({element:this._container,onValueChanged:e=>{e?(this._container.classList.add(this.firstSlideLeftBoundaryWithSectionsStyleClassName),this._container.classList.remove(this.firstSlideLeftBoundaryWithoutSectionsStyleClassName)):(this._container.classList.add(this.firstSlideLeftBoundaryWithoutSectionsStyleClassName),this._container.classList.remove(this.firstSlideLeftBoundaryWithSectionsStyleClassName))}})}this._container.onclick=e=>{if(this.disableNavigation)return e.stopPropagation(),void e.preventDefault();this.raiseEventFromClick(e)},this._container.oncontextmenu=e=>{if(this.disableNavigation)return e.stopPropagation(),void e.preventDefault();e.preventDefault(),this.raiseEventFromClick(e)},i.isDisplayVertical?(i.reflowEnabled?this._container.style.width="auto":this._container.style.width=(i.slideWidth+this.gridContentPaddingLength).toString()+"px",this.m_isBeforeFirstSlideBoundary&&(this._container.style.margin="0px",this._container.style.paddingTop="0px",this._container.style.marginLeft="4px")):this._container.style.height=(this.m_slideGridSettings.slideHeight+this.gridContentPaddingLength).toString()+"px"}}class F extends L{set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e,this._view.disableNavigation=this._disableNavigation)}constructor(e,i,t,s){super(e),this._disableNavigation=!1,this.m_slideGridSettings=i,this._events=s,this._view=new N(e,i,t);new m.b(this,"isSelected").addBinding({target:this._view});new m.b(this,"slideIndex").addBinding({target:this._view});new m.b(this,"shouldDisplaySection").addBinding({target:this._view});new m.b(this,"isVisible").addBinding({target:this._view});new m.b(this,"displayCopilotUXEntryPoint").addBinding({target:this._view}),this._view.onViewClick.subscribe((e,i)=>{this._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:i.insertIndex})})}}class V extends n.a{showRevisionTrackingFlyout(){this._revisionTrackingFlyoutContainer.classList.remove(this.revisionTrackingViewHiddenClass)}hideRevisionTrackingFlyout(){this._revisionTrackingFlyoutContainer.classList.add(this.revisionTrackingViewHiddenClass)}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e)}get disableNavigation(){return this._disableNavigation}constructor(e,i,t){if(super(e),this.c_revisionTrackingBackgroundLeftOut=8,this.c_revisionTrackingBackgroundRightOut=8,this.c_revisionTrackingBackgroundTopOut=8,this.c_revisionTrackingBackgroundBottomOut=32,this._disableNavigation=!1,this.revisionTrackingBackGroundViewClassName="revisiontracking-background-view-class",this.revisionTrackingContainerClassName="revisiontracking-container-class",this.verticalRevisionTrackingContainerClassName="revisiontracking-container-vertical-class",this.revisionTrackingPawnContainerClassName="revisiontracking-pawn-container-class",this.revisionTrackingPawnClassName="revisiontracking-pawn-class",this.revisionTrackingIconClassName="revisiontracking-icon-class",this.revisionTrackingFlyoutContainerClassName="revisiontracking-flyout-container-class",this.revisionTrackingViewHiddenClass="revisiontracking-view-hidden-class",this.c_revisionTrackingIconPathAttribute="M13,7.5c0,0.5-0.4,0.9-0.9,0.9H9.7l2.6,2.6c0.4,0.4,0.4,0.9,0,1.3c-0.4,0.4-0.9,0.4-1.3,0L8.4,9.7v2.4C8.4,12.6,8,13,7.5,13c-0.5,0-0.9-0.4-0.9-0.9V9.7L4,12.3c-0.4,0.4-0.9,0.4-1.3,0c-0.4-0.4-0.4-0.9,0-1.3l2.6-2.6H2.9C2.4,8.4,2,8,2,7.5C2,7,2.4,6.6,2.9,6.6h2.4L2.7,4c-0.4-0.4-0.4-0.9,0-1.3c0.4-0.4,0.9-0.4,1.3,0l2.6,2.6V2.9C6.6,2.4,7,2,7.5,2C8,2,8.4,2.4,8.4,2.9v2.4L11,2.7c0.4-0.4,0.9-0.4,1.3,0c0.4,0.4,0.4,0.9,0,1.3L9.7,6.6h2.4C12.6,6.6,13,7,13,7.5z M7.5,5.6c-1,0-1.8,0.8-1.8,1.8c0,1,0.8,1.8,1.8,1.8c1,0,1.8-0.8,1.8-1.8C9.3,6.4,8.5,5.6,7.5,5.6z",this.modernRevisionTrackingIconClassName="modern-revisiontracking-icon-class",this.c_modernRevisionTrackingIconPathAttribute="M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0",this.modernRevisionTrackingIconPathClassName="modern-revisiontracking-svg-path-class",this.modernRevisionTrackingFlyoutContainerClassName="modern-revisiontracking-flyout-container-class",this.pointerRevisionTrackingPawnInThumbnailPane="pointer",this.m_slideGridSettings=i,i.shouldDisplayModernCatchupUx||(this._revisionTrackingBackGroundView=document.createElement("div"),this._revisionTrackingBackGroundView.classList.add(this.revisionTrackingBackGroundViewClassName),this._revisionTrackingBackGroundView.style.width=(i.slideWidth+this.c_revisionTrackingBackgroundLeftOut+this.c_revisionTrackingBackgroundRightOut).toString()+"px",this._revisionTrackingBackGroundView.style.height=(i.slideHeight+this.c_revisionTrackingBackgroundTopOut+this.c_revisionTrackingBackgroundBottomOut).toString()+"px",e.appendChild(this._revisionTrackingBackGroundView)),this._revisionTrackingContainer=document.createElement("div"),this._revisionTrackingContainer.classList.add(this.revisionTrackingContainerClassName),i.isDisplayVertical&&this._revisionTrackingContainer.classList.add(this.verticalRevisionTrackingContainerClassName),this._revisionTrackingContainer.setAttribute("aria-label",i.revisionTrackingFlyoutContent),this._revisionTrackingPawnContainer=document.createElement("div"),this._revisionTrackingPawnContainer.classList.add(this.revisionTrackingPawnContainerClassName),this._revisionTrackingPawnContainer.setAttribute("aria-hidden","true"),this._revisionTrackingPawn=document.createElement("div"),this._revisionTrackingPawn.classList.add(this.revisionTrackingPawnClassName),i.isUsingSlideGridInThumbnail&&(this._revisionTrackingPawn.style.cursor=this.pointerRevisionTrackingPawnInThumbnailPane),this._revisionTrackingPawn.onclick=e=>{if(this.disableNavigation)return e.preventDefault(),void e.stopPropagation();if(e){const e=this.hasActiveFocus;t.onSlideSelectionChanged.signal(null,{slideIndex:this.slideIndex,slideSelectionTrigger:w.c.DoubleClick,isSelectingRange:!1,isSelectingMultiple:!1,isCatchup:!0}),t.onCatchupEvent.signal(null,{catchupClick:!0,wasActiveFocusSlide:e})}},this._revisionTrackingIcon=document.createElementNS("http://www.w3.org/2000/svg","svg"),i.shouldDisplayModernCatchupUx)this._revisionTrackingIcon.setAttribute("class",this.modernRevisionTrackingIconClassName),this._revisionTrackingIcon.setAttribute("viewBox","0 0 10 10");else{if(void 0===this._revisionTrackingIcon.classList){let e=this._revisionTrackingIcon.getAttribute("class")||"";e=-1===e.split(" ").indexOf(this.revisionTrackingIconClassName)?e.concat(" ",this.revisionTrackingIconClassName):e,this._revisionTrackingIcon.setAttribute("class",e)}else this._revisionTrackingIcon.classList.add(this.revisionTrackingIconClassName);this._revisionTrackingIcon.setAttribute("viewBox","0 0 16 16")}this._revisionTrackingIconPath=document.createElementNS("http://www.w3.org/2000/svg","path"),i.shouldDisplayModernCatchupUx?(this._revisionTrackingIconPath.setAttribute("d",this.c_modernRevisionTrackingIconPathAttribute),this._revisionTrackingIconPath.setAttribute("class",this.modernRevisionTrackingIconPathClassName)):this._revisionTrackingIconPath.setAttribute("d",this.c_revisionTrackingIconPathAttribute),this._revisionTrackingIcon.appendChild(this._revisionTrackingIconPath),this._revisionTrackingPawn.appendChild(this._revisionTrackingIcon),this._revisionTrackingPawnContainer.appendChild(this._revisionTrackingPawn),this._revisionTrackingContainer.appendChild(this._revisionTrackingPawnContainer),this._revisionTrackingFlyoutContainer=document.createElement("div"),i.shouldDisplayModernCatchupUx?this._revisionTrackingFlyoutContainer.classList.add(this.modernRevisionTrackingFlyoutContainerClassName):this._revisionTrackingFlyoutContainer.classList.add(this.revisionTrackingFlyoutContainerClassName),this._revisionTrackingFlyoutContainer.setAttribute("aria-hidden","true"),this._revisionTrackingFlyout=document.createElement("span"),this._revisionTrackingFlyout.innerText=null!=i.revisionTrackingFlyoutContent?i.revisionTrackingFlyoutContent:"",this._revisionTrackingFlyoutContainer.appendChild(this._revisionTrackingFlyout),this._revisionTrackingContainer.appendChild(this._revisionTrackingFlyoutContainer),e.appendChild(this._revisionTrackingContainer),this.hideRevisionTrackingFlyout();const s=new m.a(this,"displayRevisionTrackingInfo");s.addBinding({element:this._revisionTrackingContainer,onValueChanged:e=>{e?(this.shouldDisplayRevisionTrackingHint||this.hideRevisionTrackingFlyout(),this._revisionTrackingContainer.classList.remove(this.revisionTrackingViewHiddenClass)):this._revisionTrackingContainer.classList.add(this.revisionTrackingViewHiddenClass)}}),i.shouldDisplayModernCatchupUx||s.addBinding({element:this._revisionTrackingBackGroundView,onValueChanged:e=>{e?this._revisionTrackingBackGroundView.classList.remove(this.revisionTrackingViewHiddenClass):this._revisionTrackingBackGroundView.classList.add(this.revisionTrackingViewHiddenClass)}}),this._revisionTrackingPawn.onmouseover=e=>{e.preventDefault(),this.showRevisionTrackingFlyout(),e&&this.hasActiveFocus&&t.onCatchupEvent.signal(null,{catchupMouseOver:!0})},this._revisionTrackingPawn.onmouseout=e=>{e.preventDefault(),this.hideRevisionTrackingFlyout(),e&&this.hasActiveFocus&&t.onCatchupEvent.signal(null,{catchupMouseOut:!0})}}}class G extends L{set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e,this._view.disableNavigation=this._disableNavigation)}constructor(e,i,t){super(e),this._disableNavigation=!1,this.m_slideGridSettings=i,this._view=new V(e,i,t);new m.b(this,"displayRevisionTrackingInfo").addBinding({target:this._view});new m.b(this,"shouldDisplayRevisionTrackingHint").addBinding({target:this._view,onValueChanged:e=>{this.displayRevisionTrackingInfo&&(e?this._view.showRevisionTrackingFlyout():this._view.hideRevisionTrackingFlyout())}});new m.b(this,"slideIndex").addBinding({target:this._view,onValueChanged:e=>{this._view.slideIndex=e}});new m.b(this,"hasActiveFocus").addBinding({target:this._view,onValueChanged:e=>{this._view.hasActiveFocus=e}})}}class k extends L{presenceHoverHandler(e,i){null!=i&&null!=i.presenceTouchTargetTrigger&&(i.presenceTouchTargetTrigger===w.a.MouseOut?this.presenceMouseOutHandler():i.presenceTouchTargetTrigger===w.a.MouseOver&&this.presenceMouseOverHandler())}presenceMouseOutHandler(){this.shouldDisplayCollabMarkersHint||(this._view.presenceCollapseStyling(),this._presenceIconExpanded=!1,null!=this._pendingPresenceUserList&&this._pendingPresenceUserList.length>0&&(this.presenceUserList=this._pendingPresenceUserList,this._pendingPresenceUserList=[]))}presenceMouseOverHandler(){this._view.presenceExpandStyling(),this._presenceIconExpanded=!0}set presenceUserList(e){if(this._presenceIconExpanded)this._pendingPresenceUserList=e;else{const i=this._presenceUserList?this._presenceUserList.length:0,t=e.length;0===i&&t>0&&this._view.onPresenceHover.subscribe(this.m_presenceHoverHandlerBound),i>0&&0===t&&this._view.onPresenceHover.unsubscribe(this.m_presenceHoverHandlerBound),this._presenceUserList=e,this._view.presenceUserList=this._presenceUserList}}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e,this._view.disableNavigation=this._disableNavigation,this._gridContentViewModel.disableNavigation=this._disableNavigation,this._revisionTrackingViewModel.disableNavigation=this._disableNavigation,this._gridContentBoundaryViewModel.disableNavigation=this._disableNavigation)}get disableNavigation(){return this._disableNavigation}set shouldDisplayCollabMarkersHint(e){this._shouldDisplayCollabMarkersHint=e,void 0!==this._revisionTrackingViewModel&&(this._revisionTrackingViewModel.shouldDisplayRevisionTrackingHint=this._shouldDisplayCollabMarkersHint),this.m_slideGridSettings.isDisplayPresenceIcon&&(e?this.presenceMouseOverHandler():this.presenceMouseOutHandler())}get shouldDisplayCollabMarkersHint(){return this._shouldDisplayCollabMarkersHint}set isShowingRedLine(e){this._gridContentBoundaryViewModel.isSelected=e}set contentImage(e){this._gridContentViewModel.contentImage=e}get renderAreaRect(){return this._view.renderAreaRect}get slideID(){return this._slideID}set slideID(e){this._slideID=e}get onFrameDragOver(){return this._onFrameDragOver}get onFrameInDragState(){return this._onFrameInDragState}get contentAreaRect(){return this._gridContentViewModel.renderAreaRect}dispose(){super.dispose(),this._gridContentViewModel.dispose(),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&(this.m_dragDropManager.removeDropContainer(this.m_dropContainer),this.m_dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveEvent.unsubscribe(this.m_dragDropMoveHandlerBound)),this.m_slideGridSettings.isDisplayPresenceIcon&&this._view.onPresenceHover.unsubscribe(this.m_presenceHoverHandlerBound)}dragDropCompletedHandler(){this._view.isInDragState=!1}dragDropMoveHandler(e,i){this._slideIndex===i.draggableObjectData.index&&(this._view.isInDragState=!0,this.onFrameInDragState.signal(null,{index:this._slideIndex}))}constructor(e,i,t,n){super(i),this._disableNavigation=!1,this.m_dragDropCompletedHandlerBound=this.dragDropCompletedHandler.bind(this),this.m_dragDropMoveHandlerBound=this.dragDropMoveHandler.bind(this),this.m_presenceHoverHandlerBound=this.presenceHoverHandler.bind(this),this._presenceIconExpanded=!1,this._events=t,this.m_dragDropManager=n,this.m_slideGridSettings=e,this._onFrameDragOver=new s,this._onFrameInDragState=new s,this._view=new D(e,i,this._events),this._gridContentViewModel=new O(this.m_slideGridSettings,this._view.innerContainer,this._events,this.m_dragDropManager),this.m_slideGridSettings.enableSelectionBetweenSlides&&(this._gridContentBoundaryViewModel=new F(this._view.container,this.m_slideGridSettings,!1,this._events)),this.m_slideGridSettings.allowMoveSlide&&(this.m_dropContainer=this.m_dragDropManager.addNewDropContainer(this._view.container,new E(f.Slide,this.slideIndex)),this.m_dragDropManager.dragDropOperationCompletedEvent.subscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveEvent.subscribe(this.m_dragDropMoveHandlerBound)),this.m_slideGridSettings.enableRevisionTrackingInfo&&(this._revisionTrackingViewModel=new G(this._view.slideInfoContainer,this.m_slideGridSettings,this._events));const a=new m.b(this,"slideIndex");a.addBinding({target:this._view,onValueChanged:e=>{this.m_slideGridSettings.allowMoveSlide&&(this.m_dropContainer.objectData.index=e),this._revisionTrackingViewModel&&(this._revisionTrackingViewModel.slideIndex=e)}});const r=new m.b(this,"displayCopilotUXEntryPoint");r.addBinding({target:this._gridContentViewModel}),r.addBinding({target:this._gridContentBoundaryViewModel}),a.addBinding({target:this._gridContentViewModel}),this.m_slideGridSettings.enableSelectionBetweenSlides&&a.addBinding({target:this._gridContentBoundaryViewModel});new m.b(this,"totalSlideCount").addBinding({target:this._gridContentViewModel});new m.b(this,"activeSectionIndex").addBinding({target:this._gridContentViewModel});new m.b(this,"isHiddenSlide").addBinding({target:this._view});const o=new m.b(this,"isSelected");o.addBinding({target:this._view}),o.addBinding({target:this._gridContentViewModel});const l=new m.b(this,"hasActiveFocus");l.addBinding({target:this._view,onValueChanged:e=>{this._revisionTrackingViewModel&&(this._revisionTrackingViewModel.hasActiveFocus=e)}}),l.addBinding({target:this._gridContentViewModel});new m.b(this,"slideTitle").addBinding({target:this._gridContentViewModel});if(new m.b(this,"slideAriaLabel").addBinding({target:this._gridContentViewModel}),e.commentsEnabled){new m.b(this,"displayCommentIcon").addBinding({target:this._view});if(new m.b(this,"numComments").addBinding({target:this._view}),e.isUsingSlideGridInThumbnail){new m.b(this,"commentsToolTipValue").addBinding({target:this._view})}}if(e.shouldRenderAnimationOrTransitionInfo){if(new m.b(this,"displayTransitionOrAnimationIcon").addBinding({target:this._view}),e.isUsingSlideGridInThumbnail){new m.b(this,"transitionOrAnimationToolTipValue").addBinding({target:this._view})}}if(e.enableRevisionTrackingInfo){new m.b(this,"displayRevisionTrackingInfo").addBinding({target:this._revisionTrackingViewModel})}this._view.onViewClick.subscribe((i,t)=>{if(this._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:this.slideIndex}),e.isMobileScreenReader){const e=this._slideIndex;this._events.onSlideSelectionChanged.signal(null,{slideIndex:e,slideSelectionTrigger:null!=t?t.slideSelectionTrigger:w.c.Click})}})}}class A extends n.a{constructor(e,i){super(i),this.visibleStyleClassName="drag-over-frame-view-visible-class",this.hiddenStyleClassName="drag-over-frame-view-hidden-class",this.redlineStyleClassName="drag-over-frame-view-indicator-class",this.innerRedlineStyleClassName="drag-over-frame-view-inner-indicator-class",this._elementId="drag-over-frame-view-id"+Object(p.v4)(),this.innerRedlinePaddingLength=23,this._container.id=this._elementId,this._container.classList.add(this.hiddenStyleClassName),this.m_dragOverRedLineDiv=document.createElement("div"),this.m_dragOverRedLineInnerDiv=document.createElement("div"),this.m_dragOverRedLineDiv.appendChild(this.m_dragOverRedLineInnerDiv),this._container.appendChild(this.m_dragOverRedLineDiv);new m.a(this,"isHidden").addBinding({element:this._container,onValueChanged:i=>{i?(this._container.classList.remove(this.visibleStyleClassName),this._container.classList.add(this.hiddenStyleClassName),this._container.style.width="0px",this._container.style.height="0px"):(this._container.classList.remove(this.hiddenStyleClassName),this._container.classList.add(this.visibleStyleClassName),this._container.style.width=e.slideWidth+34+"px",this._container.style.height=e.slideHeight+50+"px")}});new m.a(this,"isShowingDragOverRedLine").addBinding({element:this.m_dragOverRedLineDiv,onValueChanged:e=>{e?(this.m_dragOverRedLineDiv.classList.add(this.redlineStyleClassName),this.m_dragOverRedLineInnerDiv.classList.add(this.innerRedlineStyleClassName)):(this.m_dragOverRedLineDiv.classList.remove(this.redlineStyleClassName),this.m_dragOverRedLineInnerDiv.classList.remove(this.innerRedlineStyleClassName))}}),this.m_dragOverRedLineInnerDiv.style.height=(e.slideHeight+this.innerRedlinePaddingLength).toString()+"px"}}class R extends L{dispose(){super.dispose(),this.m_slideGridSettings.allowMoveSlide&&null!=this.m_dragDropManager&&this.m_dragDropManager.removeDropContainer(this.m_dropContainer)}constructor(e,i,t,s){super(i),this._view=new A(e,i);new m.b(this,"isHidden").addBinding({target:this._view});new m.b(this,"isShowingDragOverRedLine").addBinding({target:this._view});new m.b(this,"slideIndex").addBinding({target:this._view,onValueChanged:e=>{this.m_dropContainer.objectData.index=e}}),this._slideIndex=s,this.m_dragDropManager=t,this.m_slideGridSettings=e,e.allowMoveSlide&&(this.m_dropContainer=this.m_dragDropManager.addNewDropContainer(this._view.container,new E(f.SlidePlaceholder,this._slideIndex))),this.isHidden=!0}}class B{set objectData(e){this.m_objectData=e}get objectData(){return this.m_objectData}dropContainerPosition(e,i){const t=this.m_container.getBoundingClientRect(),s=t.left+(t.right-t.left)/2,n=t.top+.6*(t.bottom-t.top),a=t.bottom-.6*(t.bottom-t.top);if(this.slideGridSettings.isDisplayVertical){if(i<n)return C.ContainerTop;if(i>=a)return C.ContainerBottom}return e<s?C.ContainerLeft:C.ContainerRight}isDraggableInRange(e,i){const t=this.m_container.getBoundingClientRect();return t.top<=i&&t.bottom>i&&t.right>=e&&t.left<e}constructor(e,i,t){this.slideGridSettings=t,this.m_objectData=i,this.m_container=e}}class P{onMouseDownHandler(e){e.preventDefault(),0===e.button&&(document.addEventListener("mousemove",this.onMouseMoveHandler),document.addEventListener("mouseup",this.onMouseUpHandler),document.addEventListener("mouseleave",this.m_mouseLeaveHandlerBound),document.addEventListener("mouseenter",this.m_mouseEnterHandlerBound),this.m_horizontalShift=e.pageX-this.m_originalSourceContainer.getBoundingClientRect().left,this.m_verticalShift=e.pageY-this.m_originalSourceContainer.getBoundingClientRect().top,this.m_dragStartSensorEvent.signal(null,{pageX:e.pageX-this.m_horizontalShift,pageY:e.pageY-this.m_verticalShift}),this.m_originalSourceContainer.removeEventListener("mousedown",this.onMouseDownHandler),this.m_mouseDownX=e.pageX,this.m_mouseDownY=e.pageY)}onMouseMoveHandler(e){if(null==this.m_mouseDownX||null==this.m_mouseDownY||null==this.m_verticalShift||null==this.m_horizontalShift)throw Error("Mouse Move before MouseDown");if(this.disableMoveSlide)return e.preventDefault(),void e.stopPropagation();e.preventDefault();let i=!1;if(this.m_draggableContainer&&Math.abs(e.pageX-this.m_mouseDownX)>1&&Math.abs(e.pageY-this.m_mouseDownY)>1){i=!0;const t=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;null!==t&&(this.m_draggableContainer.style.left=e.pageX-this.m_horizontalShift+"px",this.m_draggableContainer.style.top=e.pageY-this.m_verticalShift+"px",this.m_dragMoveSensorEvent.signal(null,{pageX:this.m_horizontalMidpoint,pageY:this.m_verticalMidpoint,target:t})),this.m_isDragging=!0,this.clearDismissTimeoutHandler()}!i&&h.ChangeGate.isChangeGateEnabled("SlideGridDragFix")||(e.pageY>window.innerHeight-this.m_scrollThreshold?this.m_dragToBottomSensorEvent.signal(null,null):e.pageY<this.m_scrollThreshold?this.m_dragToTopSensorEvent.signal(null,null):this.m_dragToCenterSensorEvent.signal(null,null))}onMouseUpHandler(e){if(e.preventDefault(),this.m_isDragging){const i=document.elementFromPoint?document.elementFromPoint(e.clientX,e.clientY):null;null!==i?(this.m_dragStopSensorEvent.signal(null,{target:i,pageX:this.m_horizontalMidpoint,pageY:this.m_verticalMidpoint}),this.m_isDragging=!1):this.m_dragDismissSensorEvent.signal(null,null)}this.finishMouseSensing()}onMouseLeaveHandler(e){e.preventDefault(),this.registerDismissTimeoutHandler()}onMouseEnterHandler(e){e.preventDefault(),this.registerDismissTimeoutHandler()}registerDismissTimeoutHandler(){this.clearDismissTimeoutHandler(),this.m_dismissTimeoutHandle=window.setTimeout(()=>{this.m_dragDismissSensorEvent.signal(null,null),this.finishMouseSensing()},500)}clearDismissTimeoutHandler(){this.m_dismissTimeoutHandle>=0&&window.clearTimeout(this.m_dismissTimeoutHandle)}get m_horizontalMidpoint(){if(!this.m_draggableContainer)throw Error("m_horizontalMidpoint before MouseDown");const e=this.m_draggableContainer.getBoundingClientRect().right-this.m_draggableContainer.getBoundingClientRect().left;return this.m_draggableContainer.getBoundingClientRect().left+Math.round(e/2)}get m_verticalMidpoint(){if(!this.m_draggableContainer)throw Error("m_verticalMidpoint before MouseDown");const e=this.m_draggableContainer.getBoundingClientRect().bottom-this.m_draggableContainer.getBoundingClientRect().top;return this.m_draggableContainer.getBoundingClientRect().top+Math.round(e/2)}finishMouseSensing(){this.clearDismissTimeoutHandler(),document.removeEventListener("mousemove",this.onMouseMoveHandler),document.removeEventListener("mouseup",this.onMouseUpHandler),document.removeEventListener("mouseleave",this.m_mouseLeaveHandlerBound),document.removeEventListener("mouseenter",this.m_mouseEnterHandlerBound),this.m_originalSourceContainer.addEventListener("mousedown",this.onMouseDownHandler),this.m_isDragging=!1,this.m_mouseDownX=-1,this.m_mouseDownY=-1}get dragStopSensorEvent(){return this.m_dragStopSensorEvent}get dragMoveSensorEvent(){return this.m_dragMoveSensorEvent}get dragStartSensorEvent(){return this.m_dragStartSensorEvent}get dragDismissSensorEvent(){return this.m_dragDismissSensorEvent}get dragToBottomSensorEvent(){return this.m_dragToBottomSensorEvent}get dragToTopSensorEvent(){return this.m_dragToTopSensorEvent}get dragToCenterSensorEvent(){return this.m_dragToCenterSensorEvent}set draggableContainer(e){this.m_draggableContainer=e}set disableMoveSlide(e){this.m_disableMoveSlide=e}get disableMoveSlide(){return this.m_disableMoveSlide}constructor(e,i){this.m_dismissTimeoutHandle=-1,this.m_mouseLeaveHandlerBound=this.onMouseLeaveHandler.bind(this),this.m_mouseEnterHandlerBound=this.onMouseEnterHandler.bind(this),this.m_disableMoveSlide=!1,this.m_originalSourceContainer=e,this.m_dragMoveSensorEvent=new s,this.m_dragStartSensorEvent=new s,this.m_dragStopSensorEvent=new s,this.m_dragDismissSensorEvent=new s,this.m_dragToBottomSensorEvent=new s,this.m_dragToTopSensorEvent=new s,this.m_dragToCenterSensorEvent=new s,this.m_isDragging=!1,this.m_scrollThreshold=i,this.onMouseDownHandler=this.onMouseDownHandler.bind(this),this.onMouseUpHandler=this.onMouseUpHandler.bind(this),this.onMouseMoveHandler=this.onMouseMoveHandler.bind(this),this.m_originalSourceContainer.addEventListener("mousedown",this.onMouseDownHandler)}}class H{onDragToCenter(){this.m_dragToCenterEvent.signal(null,null)}onDragToBottom(){this.m_dragToBottomEvent.signal(null,null)}onDragToTop(){this.m_dragToTopEvent.signal(null,null)}onDragStart(){this.m_dragStartEvent.signal(null,{objectData:this.m_objectData}),this.draggableContainer=this.m_dragDropVisualFactory.createDragDropVisual(this.originalSourceContainer,this.m_reflowEnabled),this.sensor.draggableContainer=this.draggableContainer}onDragMove(e){null!=this.draggableContainer&&(document.body.appendChild(this.draggableContainer),this.m_dragMoveEvent.signal(null,{pageX:e.pageX,pageY:e.pageY,objectData:this.m_objectData}))}onDragStop(e){try{this.m_dragStopEvent.signal(null,{objectData:this.m_objectData,pageX:e.pageX,pageY:e.pageY}),null!=this.draggableContainer&&(document.body.removeChild(this.draggableContainer),this.draggableContainer=null)}catch(e){}}onDragDismiss(e){try{this.m_dragStopEvent.signal(null,e),null!=this.draggableContainer&&(document.body.removeChild(this.draggableContainer),this.draggableContainer=null)}catch(e){}}get dragStartEvent(){return this.m_dragStartEvent}get dragMoveEvent(){return this.m_dragMoveEvent}get dragStopEvent(){return this.m_dragStopEvent}get dragToBottomEvent(){return this.m_dragToBottomEvent}get dragToTopEvent(){return this.m_dragToTopEvent}get dragToCenterEvent(){return this.m_dragToCenterEvent}get objectData(){return this.m_objectData}set objectData(e){this.m_objectData=e}set isDragReady(e){this.m_isDragReady=e}get isDragReady(){return this.m_isDragReady}set disableMoveSlide(e){this.m_disableMoveSlide=e,this.sensor.disableMoveSlide=e}get disableMoveSlide(){return this.m_disableMoveSlide}set reflowEnabled(e){this.m_reflowEnabled=e}constructor(e,i,t,n){this.draggableContainer=null,this.m_isDragReady=!1,this.m_disableMoveSlide=!1,this.m_reflowEnabled=!1,this.originalSourceContainer=e,this.m_objectData=i,this.m_dragStartEvent=new s,this.m_dragMoveEvent=new s,this.m_dragStopEvent=new s,this.m_dragToTopEvent=new s,this.m_dragToBottomEvent=new s,this.m_dragToCenterEvent=new s,this.m_dragDropVisualFactory=t,this.m_scrollThreshold=n,this.sensor=new P(this.originalSourceContainer,this.m_scrollThreshold),this.sensor.dragStartSensorEvent.subscribe(()=>{this.m_isDragReady&&this.onDragStart()}),this.sensor.dragMoveSensorEvent.subscribe((e,i)=>{this.onDragMove(i)}),this.sensor.dragStopSensorEvent.subscribe((e,i)=>{this.onDragStop(i)}),this.sensor.dragDismissSensorEvent.subscribe((e,i)=>{this.onDragDismiss(i)}),this.sensor.dragToTopSensorEvent.subscribe(()=>{this.onDragToTop()}),this.sensor.dragToBottomSensorEvent.subscribe(()=>{this.onDragToBottom()}),this.sensor.dragToCenterSensorEvent.subscribe(()=>{this.onDragToCenter()})}}class U{get dragReadyElements(){return this.m_dragReadyElements}set dragReadyElements(e){this.m_dragReadyElements=e}createDragDropVisual(e,i){let t;if(this.m_dragReadyElements&&this.m_dragReadyElements.length>1){t=document.createElement("div"),t.className=this.multipleDraggableOuterContainerStyleClassName;const s=e.cloneNode(!0),n=document.createElement("div");n.className=this.multipleDraggableInnerContainerStyleClassName,s.children[0].className=this.clonedSlideStyleClassName,s.children[0].children[0].className=this.clonedImageStyleClassName;const a=document.createElement("div");a.className=this.draggableContainerCountStyleClassName;const r=document.createElement("span");r.innerText=this.m_dragReadyElements.length.toString();const o=document.createElement("div");if(o.className=this.primarytabbedDraggableStyleClassName,i){const{width:i,height:t}=e.getBoundingClientRect();if(s.style.width=i+"px",s.style.height=t+"px",o.style.width=i+"px",o.style.height=t+"px",h.ChangeGate.isChangeGateEnabled("multiSlideDragLargeBackgroundFix")){s.children[0].style.width=i+"px",s.children[0].style.height=t+"px";const e=s.children[0].querySelector("img");e&&(e.style.width=i+"px",e.style.height=t+"px")}}if(this.m_dragReadyElements.length>2){const t=document.createElement("div");if(t.className=this.secondarytabbedDraggableStyleClassName,n.appendChild(t),i){const{width:i,height:s}=e.getBoundingClientRect();t.style.width=i+"px",t.style.height=s+"px"}}a.appendChild(r),n.appendChild(s),n.appendChild(a),n.appendChild(o),t.appendChild(n)}else if(t=e.cloneNode(!0),t.className=this.singleDraggableStyleClassName,i){const{width:i,height:s}=e.getBoundingClientRect();t.style.width=i+"px",t.style.height=s+"px"}return t.setAttribute("aria-hidden","true"),t.addEventListener("wheel",e=>{null!=e&&e.preventDefault();const i=e.deltaY,t=new CustomEvent("scrollWhileDragging",{detail:{scrollDownValue:i}});document.dispatchEvent(t)}),t}constructor(e){this.singleDraggableStyleClassName="single-select-draggable-class",this.multipleDraggableOuterContainerStyleClassName="multiple-select-draggable-outer-container-class",this.multipleDraggableInnerContainerStyleClassName="multiple-select-draggable-inner-container-class",this.clonedSlideStyleClassName="draggable-cloned-style-class",this.clonedImageStyleClassName="draggable-cloned-image-style-class",this.draggableContainerCountStyleClassName="draggable-count-container-class",this.primarytabbedDraggableStyleClassName="primary-tabbed-draggable-container-class",this.secondarytabbedDraggableStyleClassName="secondary-tabbed-draggable-container-class",this.m_dragReadyElements=e}}!function(e){e[e.ContainerLeft=0]="ContainerLeft",e[e.ContainerRight=1]="ContainerRight",e[e.ContainerTop=2]="ContainerTop",e[e.ContainerBottom=3]="ContainerBottom"}(C||(C={}));class j{addNewDraggable(e,i){const t=new H(e,i,this.m_dragDropVisualFactory,this.m_dragDropSettings.scrollThresholdInPx);return this.m_draggableList.push(t),t.dragStartEvent.subscribe((e,i)=>{this.onDragStart(i)}),t.dragMoveEvent.subscribe((e,i)=>{this.onDragMove(i)}),t.dragStopEvent.subscribe((e,i)=>{this.onDragStop(i),this.m_shouldScrollRootContainer=!1}),t.dragToTopEvent.subscribe(()=>{this.scrollRootContainer(!0),this.m_shouldScrollRootContainer=!0}),t.dragToBottomEvent.subscribe(()=>{this.scrollRootContainer(!1),this.m_shouldScrollRootContainer=!0}),t.dragToCenterEvent.subscribe(()=>{this.m_shouldScrollRootContainer=!1}),t}onDragStop(e){if(document.removeEventListener("scrollWhileDragging",this.scrollWhileDraggingHandler),!this.m_hasDraggingElement)return;const i=[],t=[];let s=this.updateInRangeContainerStatusLists(e,i,t);this.slideGridSettings.isDisplayVertical||1!==t.length||(s=!1);const n=i.map(e=>e.objectData.dragDropObjectType).indexOf(f.Section);if(s){const e={draggableObjectDataList:this.m_currentDraggables.map(e=>e.objectData),dropTargetObjectDataList:i.map(e=>e.objectData),dropContainerPositionList:t,hasValidDropTarget:!0,sectionObjectData:n>-1?i[n].objectData:null};this.m_dragDropOperationCompletedEvent.signal(null,e)}s||this.m_dragDropOperationCompletedEvent.signal(null,{hasValidDropTarget:!1}),this.m_currentDraggables=[],this.m_hasDraggingElement=null!=this.m_dragReadyElements&&this.m_dragReadyElements.length>0,this.m_openedFirstSlidePlaceHolder=!1}onDragMove(e){this.m_hasDraggingElement=!0;const i=[],t=[];let s=this.updateInRangeContainerStatusLists(e,i,t);if(this.slideGridSettings.isDisplayVertical||1!==t.length||(s=!1),s){const s=i.map(e=>e.objectData.dragDropObjectType).indexOf(f.Slide),n=i.map(e=>e.objectData.dragDropObjectType).indexOf(f.SlidePlaceholder),a=i.map(e=>e.objectData.dragDropObjectType).indexOf(f.Section);if(s>=0){let n=i[s].objectData;const r={draggableObjectData:e.objectData,hasValidDropTarget:!0,dropTargetObjectData:n,sectionObjectData:a>=0?i[a].objectData:null,dropPositionData:t};this.m_dragDropMoveOverEvent.signal(null,r),this.m_openedFirstSlidePlaceHolder=!0}else if(n<0){const t={draggableObjectData:e.objectData,dropTargetObjectData:i[0].objectData,hasValidDropTarget:!0,sectionObjectData:a>=0?i[a].objectData:null};this.m_dragDropMoveOverEvent.signal(null,t)}}else this.m_dragDropMoveOverEvent.signal(null,{hasValidDropTarget:!1});for(let e=0;e<this.m_dragReadyElements.length;e+=1)this.m_currentDraggables.indexOf(this.m_dragReadyElements[e])<0&&this.m_currentDraggables.push(this.m_dragReadyElements[e]),this.m_dragDropMoveEvent.signal(null,{draggableObjectData:this.m_dragReadyElements[e].objectData})}onDragStart(e){document.addEventListener("scrollWhileDragging",this.scrollWhileDraggingHandler),this.m_dragDropOperationStartedEvent.signal(null,{draggableObjectData:e.objectData})}addNewDropContainer(e,i){const t=new B(e,i,this.slideGridSettings);return this.m_dropContainerList.push(t),t}set initialDragReadyElements(e){const i=this.m_draggableList.map(e=>e.objectData);for(let t=0;t<i.length;t+=1)e.indexOf(i[t])>=0&&(this.m_dragReadyElements.push(this.m_draggableList[t]),this.m_draggableList[t].isDragReady=!0);this.m_dragDropVisualFactory.dragReadyElements=this.m_dragReadyElements}removeDraggable(e){let i=-1;null!=this.m_currentDraggables&&(i=this.m_currentDraggables.indexOf(e),-1!==i&&this.m_currentDraggables.splice(i,1)),null!=this.m_dragReadyElements&&(i=this.m_dragReadyElements.indexOf(e),-1!==i&&(this.m_dragReadyElements.splice(i,1),this.dragReadyElements=this.m_dragReadyElements)),i=this.m_draggableList.indexOf(e),-1!==i&&this.m_draggableList.splice(i,1)}removeDropContainer(e){const i=this.m_dropContainerList.indexOf(e);return-1!==i&&(this.m_dropContainerList.splice(i,1),!0)}get dragDropOperationCompletedEvent(){return this.m_dragDropOperationCompletedEvent}get dragDropMoveOverEvent(){return this.m_dragDropMoveOverEvent}get dragDropOperationStartedEvent(){return this.m_dragDropOperationStartedEvent}get dragDropMoveEvent(){return this.m_dragDropMoveEvent}set dragDropRootContainer(e){this.m_dragDropRootContainer=e}set dragReadyElements(e){this.m_dragReadyElements=e;for(let e=0;e<this.m_draggableList.length;e+=1)this.m_dragReadyElements.indexOf(this.m_draggableList[e])>=0?this.m_draggableList[e].isDragReady=!0:this.m_draggableList[e].isDragReady=!1;this.m_dragDropVisualFactory.dragReadyElements=this.m_dragReadyElements}get dragReadyElements(){return this.m_dragReadyElements}updateInRangeContainerStatusLists(e,i,t){let s=!1,n=new E(f.Slide,-1);if(null!=e)for(let a=0;a<this.m_dropContainerList.length;a+=1)if(void 0!==e.pageX&&void 0!==e.pageY&&this.m_dropContainerList[a].isDraggableInRange(e.pageX,e.pageY)){const r=this.m_dropContainerList[a].dropContainerPosition(e.pageX,e.pageY);s=!0,n=this.m_dropContainerList[a].objectData,t.push(r),i.push(this.m_dropContainerList[a])}return s}constructor(e,i){this.slideGridSettings=i,this.m_openedFirstSlidePlaceHolder=!1,this.m_shouldScrollRootContainer=!1,this.scrollWhileDraggingHandler=e=>{const i=e;this.scrollRootContainer(i.detail.scrollDownValue<0,i.detail.scrollDownValue)},this.scrollRootContainer=(e,i)=>{let t;t=void 0!==i?i:e?-1:1,this.m_dragDropRootContainer&&(this.m_dragDropRootContainer.scrollTop=Math.min(Math.max(this.m_dragDropRootContainer.scrollTop+t,0),this.m_dragDropRootContainer.scrollHeight)),this.m_shouldScrollRootContainer&&setTimeout(()=>this.scrollRootContainer(e),this.m_dragDropSettings.scrollTimeoutInMs)},this.m_draggableList=[],this.m_dropContainerList=[],this.m_hasDraggingElement=!1,this.m_dragReadyElements=[],this.m_currentDraggables=[],this.m_dragDropOperationCompletedEvent=new s,this.m_dragDropMoveOverEvent=new s,this.m_dragDropMoveEvent=new s,this.m_dragDropOperationStartedEvent=new s,this.m_dragDropSettings=e,this.m_dragDropVisualFactory=new U(this.m_dragReadyElements)}}class K extends L{updateSlideData(e){const i=this._gridFrameViewModelList.find(i=>g.isSlideIDPartialEqual(i.slideID,e.slideID));if(!i)return!1;i.slideID=e.slideID,i.isHiddenSlide=e.isHiddenSlide,i.contentImage=e.thumbnailImage,i.slideTitle=e.slideTitle,i.slideAriaLabel=e.slideAriaLabel,this.m_slideGridSettings.commentsEnabled&&(this.cgThumbnailIconsDisappearOnResize||(i.displayCommentIcon=!1),i.numComments="",null!=e.numComments&&e.numComments>0&&(i.numComments=""+e.numComments,i.commentsToolTipValue=e.commentsToolTipValue,this.cgThumbnailIconsDisappearOnResize||(i.displayCommentIcon=!0))),this.m_slideGridSettings.shouldRenderAnimationOrTransitionInfo&&(this.cgThumbnailIconsDisappearOnResize||(i.displayTransitionOrAnimationIcon=e.hasTransitionOrAnimation),i.transitionOrAnimationToolTipValue=e.transitionOrAnimationToolTipValue),this.cgThumbnailIconsDisappearOnResize||this.m_slideGridSettings.enableRevisionTrackingInfo&&(i.displayRevisionTrackingInfo=e.hasUnreadChanges),this.cgThumbnailIconsDisappearOnResize&&this.updateDisplayIcons(i,e);const t=this._slideDataList.findIndex(i=>g.isSlideIDPartialEqual(i.slideID,e.slideID));return-1!==t&&this._slideDataList.splice(t,1,e),!0}set slideDataList(e){this._slideDataList=e,this.m_slideGridSettings.allowMoveSlide&&(this.m_draggingSlideIndexList=[]),0===this.sectionIndex&&0===this._slideDataList.length&&this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isVisible=!1);let i=0;if(this._slideDataList.forEach(e=>{let t,s;if(0===i&&(this.m_firstSlideIndex=e.slideOrderIndex),0===this.sectionIndex&&this.m_slideGridSettings.enableSelectionBetweenSlides&&this._slideDataList.length>0){if(null==this.m_firstSlideInFirstSectionBoundary){this.m_firstSlideInFirstSectionBoundary=new F(this._view.container,this.m_slideGridSettings,!0,this._events);new m.b(this,"shouldDisplaySection").addBinding({target:this.m_firstSlideInFirstSectionBoundary}),this.m_firstSlideInFirstSectionBoundary.shouldDisplaySection=this.shouldDisplaySection,this.m_firstSlideInFirstSectionBoundary.slideIndex=0}this.m_firstSlideInFirstSectionBoundary.isVisible=!0}if(null==this._gridFrameViewModelList[i]){let n;if(0===i&&(n=new R(this.m_slideGridSettings,this._view.container,this._dragDropManager,e.slideOrderIndex),this._dragOverFrameViewModelList.push(n)),t=new k(this.m_slideGridSettings,this._view.container,this._events,this._dragDropManager),this._gridFrameViewModelList.push(t),this.m_slideGridSettings.allowMoveSlide){let n=0;0===i&&(n=1),s=new R(this.m_slideGridSettings,this._view.container,this._dragDropManager,e.slideOrderIndex+n),t.onFrameInDragState.subscribe((e,i)=>{const t=i.index;this.m_draggingSlideIndexList.push(t)}),this._dragOverFrameViewModelList.push(s)}}else t=this._gridFrameViewModelList[i],this.m_slideGridSettings.allowMoveSlide&&(0===i&&(this._dragOverFrameViewModelList[i].slideIndex=e.slideOrderIndex,null!=this._dragOverFrameViewModelList[i+1]&&(this._dragOverFrameViewModelList[i+1].slideIndex=e.slideOrderIndex+1)),this._dragOverFrameViewModelList[i+1].slideIndex=e.slideOrderIndex+1);t.slideIndex=e.slideOrderIndex,t.slideID=e.slideID,t.isHiddenSlide=e.isHiddenSlide,t.contentImage=e.thumbnailImage,t.slideTitle=e.slideTitle,t.slideAriaLabel=e.slideAriaLabel,t.totalSlideCount=this.m_totalSlideCount,t.displayTransitionOrAnimationIcon=!1,t.displayCommentIcon=!1,t.activeSectionIndex=this.m_activeSectionIndex,t.displayCopilotUXEntryPoint=0===e.slideOrderIndex&&this.m_slideGridSettings.isCopilotUXEntryPointEnabled,this.m_slideGridSettings.commentsEnabled&&(this.cgThumbnailIconsDisappearOnResize||(t.displayCommentIcon=!1),t.numComments="",null!=e.numComments&&e.numComments>0&&(t.numComments=""+e.numComments,this.m_slideGridSettings.isUsingSlideGridInThumbnail&&(t.commentsToolTipValue=e.commentsToolTipValue),this.cgThumbnailIconsDisappearOnResize||(t.displayCommentIcon=!0))),this.cgThumbnailIconsDisappearOnResize?(this.m_slideGridSettings.shouldRenderAnimationOrTransitionInfo&&this.m_slideGridSettings.isUsingSlideGridInThumbnail&&(t.transitionOrAnimationToolTipValue=e.transitionOrAnimationToolTipValue),this.updateDisplayIcons(t,e)):this.m_slideGridSettings.shouldRenderAnimationOrTransitionInfo&&(t.displayTransitionOrAnimationIcon=e.hasTransitionOrAnimation,this.m_slideGridSettings.isUsingSlideGridInThumbnail&&(t.transitionOrAnimationToolTipValue=e.transitionOrAnimationToolTipValue)),this.m_slideGridSettings.enableRevisionTrackingInfo&&(t.displayRevisionTrackingInfo=e.hasUnreadChanges),i+=1}),this._gridFrameViewModelList.length>i&&(this._gridFrameViewModelList.slice(i).forEach(e=>{e.dispose()}),this._gridFrameViewModelList=this._gridFrameViewModelList.slice(0,i),this.m_slideGridSettings.allowMoveSlide&&this._dragOverFrameViewModelList.length>i+1)){const e=0===i?0:i+1;this._dragOverFrameViewModelList.slice(e).forEach(e=>{e.dispose()}),this._dragOverFrameViewModelList=this._dragOverFrameViewModelList.slice(0,e)}}updateDisplayIcons(e,i){let t=this.displayIconsLimit;this.m_slideGridSettings.enableRevisionTrackingInfo&&(e.displayRevisionTrackingInfo=t>0&&i.hasUnreadChanges,e.displayRevisionTrackingInfo&&(t-=1)),this.m_slideGridSettings.commentsEnabled&&(e.displayCommentIcon=t>0&&null!=i.numComments&&i.numComments>0,e.displayCommentIcon&&(t-=1)),this.m_slideGridSettings.shouldRenderAnimationOrTransitionInfo&&(e.displayTransitionOrAnimationIcon=t>0&&i.hasTransitionOrAnimation,e.displayTransitionOrAnimationIcon&&(t-=1))}get slideDataList(){return this._slideDataList}set presenceInfoList(e){this._presenceInfoList=e,this._gridFrameViewModelList.forEach(i=>{const t=e.filter(e=>g.isSlideIDEqual(e.slideID,i.slideID));i.presenceUserList=t.map(e=>e.presenceUser)})}get presenceInfoList(){return this._presenceInfoList}set shouldDisplayCollabMarkersHint(e){this._shouldDisplayCollabMarkersHint=e,this._gridFrameViewModelList.forEach(e=>{const i=e.slideIndex;e.shouldDisplayCollabMarkersHint=!(this._activeFocusSlideIndex!==i||!this._shouldDisplayCollabMarkersHint)})}get shouldDisplayCollabMarkersHint(){return this._shouldDisplayCollabMarkersHint}set insertBetweenSlidesIndex(e){this._gridFrameViewModelList.forEach(i=>{i.isShowingRedLine=e===i.slideIndex+1,this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!1)}),0===e&&this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!0)}calculateInsertionIndex(e,i){for(let t=this._gridFrameViewModelList.length-1;t>=0;t-=1)if(e>=this._gridFrameViewModelList[t].renderAreaRect.right&&this._gridFrameViewModelList[t].renderAreaRect.bottom>=i&&this._gridFrameViewModelList[t].renderAreaRect.top<=i)return this._slideDataList[t].slideOrderIndex+1;return-1}get m_currentLastSlideOfSection(){const e=this._slideDataList.map(e=>e.slideOrderIndex);if(this.m_draggingSlideIndexList&&this.m_draggingSlideIndexList.length>0){const i=e.filter(e=>this.m_draggingSlideIndexList.indexOf(e)<0);return i[i.length-1]}return e[e.length-1]}dispose(){super.dispose(),this._gridFrameViewModelList=[],this.m_slideGridSettings.allowMoveSlide&&null!=this._dragDropManager&&(this._dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this._dragDropManager.dragDropMoveOverEvent.unsubscribe(this.m_dragDropMoveOverHandlerBound))}getVisibleSlideRange(e){const i=[];return e.bottom-e.top<=0||e.right-e.left<=0||this._gridFrameViewModelList.forEach(t=>{const s=t.renderAreaRect;if(this.m_slideGridSettings.isDisplayHorizontal){if(s.left>e.right)return;if(s.right<e.left)return}else{if(s.top>e.bottom)return;if(s.bottom<e.top)return}i.push(t.slideID)}),i}getSlideCapacityPerRow(e){let i=-1;const t=e.right-e.left;if(t<=0)return-1;for(const e of this._gridFrameViewModelList){const s=e.renderAreaRect;if(null!=s){const e=s.right-s.left;if(i=Math.floor(t/e),i>0)break}}return i}getSelectedSlidesContentAreaRect(){const e=[];return this._gridFrameViewModelList.forEach(i=>{i.isSelected&&e.push(i.contentAreaRect)}),e}set currentSelectedSlideIndexes(e){this._currentSelectedSlideIndexes=e,this._gridFrameViewModelList.forEach(e=>{const i=e.slideIndex;e.isSelected=this._currentSelectedSlideIndexes.indexOf(i)>=0})}set activeFocusSlideIndex(e){this._activeFocusSlideIndex=e,this._gridFrameViewModelList.forEach(e=>{const i=e.slideIndex;e.hasActiveFocus=this._activeFocusSlideIndex===i})}set totalSlideCount(e){this.m_totalSlideCount=e}set activeSectionIndex(e){this.m_activeSectionIndex=e}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e,this._view.disableNavigation=this._disableNavigation,this._gridFrameViewModelList.forEach(e=>{e.disableNavigation=this._disableNavigation}),null!=this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.disableNavigation=this._disableNavigation))}get disableNavigation(){return this._disableNavigation}dragDropCompletedHandler(){this._dragOverFrameViewModelList.forEach(e=>{e.isHidden=!0,e.isShowingDragOverRedLine=!1}),this._gridFrameViewModelList.forEach(e=>{e.isShowingRedLine=!1}),this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!1)}dragDropMoveOverHandler(e,i){if(!i.hasValidDropTarget)return this._dragOverFrameViewModelList.forEach(e=>{e.isHidden=!0,e.isShowingDragOverRedLine=!1}),this._gridFrameViewModelList.forEach(e=>{e.isShowingRedLine=!1}),void(this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!1));const t=i.dropTargetObjectData.index;if(i.dropTargetObjectData.dragDropObjectType!==f.Section)for(let e=0;e<this._dragOverFrameViewModelList.length;e+=1){const s=t===this._dragOverFrameViewModelList[e].slideIndex&&null!=i.sectionObjectData&&i.sectionObjectData.index===this.sectionIndex;if(e===this._dragOverFrameViewModelList.length-1)this._gridFrameViewModelList.forEach(e=>e.isShowingRedLine=!1),this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!1);else{let n=this._gridFrameViewModelList.findIndex(e=>e.slideIndex===t);this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!1);let a=i.dropPositionData;if(0===e&&0===n&&a&&2===a.length&&(a.every(e=>e===C.ContainerTop)||a.every(e=>e===C.ContainerLeft))?this.m_firstSlideInFirstSectionBoundary&&(this.m_firstSlideInFirstSectionBoundary.isSelected=!0,this._gridFrameViewModelList.forEach(e=>e.isShowingRedLine=!1)):-1!==n&&this._gridFrameViewModelList.forEach((e,i)=>{e.isShowingRedLine=i===n}),this._dragOverFrameViewModelList[e].isHidden=!0,s)break}}else this._dragOverFrameViewModelList.forEach(e=>{e.slideIndex===this.m_currentLastSlideOfSection+1&&this.sectionIndex;e.isHidden=!0})}parentWidthChanged(e){const i=X(e);i!=this.displayIconsLimit&&(this.displayIconsLimit=i,this._slideDataList.forEach((e,i)=>{const t=this._gridFrameViewModelList[i];t&&g.isSlideIDPartialEqual(t.slideID,e.slideID)&&this.updateDisplayIcons(t,e)}))}constructor(e,i,t,s){super(i),this._currentSelectedSlideIndexes=[],this.m_totalSlideCount=0,this.m_firstSlideIndex=-1,this.m_activeSectionIndex=-1,this._disableNavigation=!1,this.m_dragDropMoveOverHandlerBound=this.dragDropMoveOverHandler.bind(this),this.m_dragDropCompletedHandlerBound=this.dragDropCompletedHandler.bind(this),this._events=t,this.m_slideGridSettings=e,s&&(this._dragDropManager=s),this.cgThumbnailIconsDisappearOnResize=h.ChangeGate.isChangeGateEnabled("ThumbnailIconsDisappearOnResize"),this.m_slideGridSettings.allowMoveSlide&&(this.m_draggingSlideIndexList=[]),this._view=new y(i,e);const n=Object(p.v4)(),a=i.getElementsByTagName("span")[0];a&&(a.setAttribute("id",""+n),this._view.container.setAttribute("aria-labelledby",""+n)),this._gridFrameViewModelList=[],this._dragOverFrameViewModelList=[],this.m_slideGridSettings.enableSelectionBetweenSlides&&this._view.onViewClick.subscribe((e,i)=>{const t=this.calculateInsertionIndex(i.clientX,i.clientY);-1!==t&&this._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:t})}),this._dragDropManager&&this.m_slideGridSettings.allowMoveSlide&&(this._dragDropManager.dragDropMoveOverEvent.subscribe(this.m_dragDropMoveOverHandlerBound),this._dragDropManager.dragDropOperationCompletedEvent.subscribe(this.m_dragDropCompletedHandlerBound)),this.displayIconsLimit=X(i.clientWidth)}}function X(e){return e<=140?1:e<=170?2:3}class W extends L{set presenceInfoList(e){this._presenceInfoList=e,this._gridListViewModel.presenceInfoList=this._presenceInfoList}get presenceInfoList(){return this._presenceInfoList}set shouldDisplayCollabMarkersHint(e){this._shouldDisplayCollabMarkersHint=e,this._gridListViewModel.shouldDisplayCollabMarkersHint=this._shouldDisplayCollabMarkersHint}get shouldDisplayCollabMarkersHint(){return this._shouldDisplayCollabMarkersHint}set slideDataList(e){this.m_slideGridSettings.isHideEmptySection&&0===e.length&&(this._view.shouldDisplaySection=!1),this._gridListViewModel.slideDataList=e}set shouldDisplaySection(e){this.m_slideGridSettings.isHideEmptySection&&0===this.slideDataList.length?this._view.shouldDisplaySection=!1:this._shouldDisplaySection=e}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e,this._view.disableNavigation=this._disableNavigation,this._gridListViewModel.disableNavigation=this._disableNavigation)}get disableNavigation(){return this._disableNavigation}get slideDataList(){return this._gridListViewModel.slideDataList}updateSlideData(e){return this._gridListViewModel.updateSlideData(e)}getVisibleSlideRange(e){return this._gridListViewModel.getVisibleSlideRange(e)}getSlideCapacityPerRow(e){return this._gridListViewModel.getSlideCapacityPerRow(e)}getSelectedSlidesContentAreaRect(){return this._gridListViewModel.getSelectedSlidesContentAreaRect()}dispose(){super.dispose(),this.m_slideGridSettings.allowMoveSlide&&this.m_dragDropManager&&(this.m_dragDropManager.removeDropContainer(this.m_dropContainer),this.m_dragDropManager.dragDropOperationCompletedEvent.unsubscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveOverEvent.unsubscribe(this.m_dragDropMoveOverHandlerBound),this.m_dragDropManager.dragDropMoveEvent.unsubscribe(this.m_dragDropMoveHandlerBound))}dragDropMoveOverHandler(e,i){!i.hasValidDropTarget||null!=this.slideDataList&&this.slideDataList.length-this.m_draggingSlideIndexes.length!=0||i.dropTargetObjectData.index!==this.sectionIndex||i.dropTargetObjectData.dragDropObjectType!==f.Section?this._view.isDragOver=!1:this._view.isDragOver=!0}dragDropMoveHandler(e,i){i.draggableObjectData&&null!=i.draggableObjectData.index&&-1===this.m_draggingSlideIndexes.indexOf(i.draggableObjectData.index)&&this.slideDataList.map(e=>e.slideOrderIndex).indexOf(i.draggableObjectData.index)>=0&&this.m_draggingSlideIndexes.push(i.draggableObjectData.index)}dragDropCompletedHandler(e,i){this._view.isDragOver=!1,this.m_draggingSlideIndexes=[]}get onCurrentActiveSectionChanged(){return this.m_currentActiveSectionChangedEvent}parentWidthChanged(e){this._gridListViewModel.parentWidthChanged(e)}constructor(e,i,t,n){super(i),this._disableNavigation=!1,this.m_dragDropCompletedHandlerBound=this.dragDropCompletedHandler.bind(this),this.m_dragDropMoveOverHandlerBound=this.dragDropMoveOverHandler.bind(this),this.m_dragDropMoveHandlerBound=this.dragDropMoveHandler.bind(this),this._events=t,this.m_slideGridSettings=e,this.m_dragDropManager=n,this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(this.m_currentActiveSectionChangedEvent=new s),this._view=new I(e,i),this._gridListViewModel=new K(this.m_slideGridSettings,this._view.container,this._events,this.m_dragDropManager);new m.b(this,"sectionTitle").addBinding({target:this._view});new m.b(this,"currentSelectedSlideIndexes").addBinding({target:this._gridListViewModel});new m.b(this,"insertBetweenSlidesIndex").addBinding({target:this._gridListViewModel});new m.b(this,"totalSlideCount").addBinding({target:this._gridListViewModel});new m.b(this,"activeSectionIndex").addBinding({target:this._gridListViewModel});new m.b(this,"isSelected").addBinding({target:this._view});new m.b(this,"titleEditMode").addBinding({target:this._view});const a=new m.b(this,"shouldDisplaySection");a.addBinding({target:this._view}),a.addBinding({target:this._gridListViewModel});if(new m.b(this,"activeFocusSlideIndex").addBinding({target:this._gridListViewModel}),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering){new m.b(this,"currentActiveSectionIndex").addBinding({target:this._view})}const r=new m.b(this,"sectionIndex");if(r.addBinding({target:this._gridListViewModel,onValueChanged:e=>{this.m_slideGridSettings.allowMoveSlide&&(this.m_dropContainer.objectData.index=e)}}),r.addBinding({target:this._view}),this.m_slideGridSettings.allowMoveSlide){if(!this.m_dragDropManager)throw new Error("dragDropManager is undefined");this.m_dropContainer=this.m_dragDropManager.addNewDropContainer(this._view.container,new E(f.Section,this.sectionIndex)),this.m_dragDropManager.dragDropOperationCompletedEvent.subscribe(this.m_dragDropCompletedHandlerBound),this.m_dragDropManager.dragDropMoveOverEvent.subscribe(this.m_dragDropMoveOverHandlerBound),this.m_dragDropManager.dragDropMoveEvent.subscribe(this.m_dragDropMoveHandlerBound),this.m_draggingSlideIndexes=[]}e.allowSectionEdit&&(this._view.onViewUpdateSectionTitle.subscribe((e,i)=>{i&&this._events.onSectionTitleUpdate.signal(null,{sectionIndex:this.sectionIndex,sectionTitleBefore:i.sectionTitleBefore,sectionTitleAfter:i.sectionTitleAfter})}),this._view.onViewSelectSection.subscribe((e,i)=>{this._events.onSectionSelectionChanged.signal(null,{clickedAway:i.clickedAway,sectionSelectionTrigger:i.sectionSelectionTrigger,sectionIndex:this.sectionIndex})})),e.allowSectionsInKeyboardFocusOrdering&&this._view.onCurrentActiveSectionChanged.subscribe((e,i)=>{this.m_currentActiveSectionChangedEvent.signal(null,i)})}}var z;!function(e){e[e.Thumbnail=0]="Thumbnail",e[e.CoPilotUX=1]="CoPilotUX"}(z||(z={}));class Y extends L{get currentSelectedSectionIndex(){return this.currentActiveSectionIndex}set currentSelectedSectionIndex(e){this.currentActiveSectionIndex=e,this._sectionViewModelList.forEach(i=>{i.isSelected=i.sectionIndex===e})}set currentEditableSectionIndex(e){e<0||e>=this._sectionViewModelList.length||(this._sectionViewModelList[e].titleEditMode=!0,this._currentEditableSectionIndex=e)}set shouldDisplaySections(e){this._sectionViewModelList.forEach(i=>{i.shouldDisplaySection=e}),this.m_shouldDisplaySections=e}get shouldDisplaySections(){return this.m_shouldDisplaySections}set disableNavigation(e){this.m_slideGridSettings.allowDisableNavigation&&(this._disableNavigation=e,this._view.disableNavigation=e,this._sectionViewModelList.forEach(i=>{i.disableNavigation=e}))}get disableNavigation(){return this._disableNavigation}set presenceInfoList(e){this.m_slideGridSettings.isDisplayPresenceIcon&&(this._presenceInfoList=e,this._sectionViewModelList.forEach(i=>{const t=i.slideDataList.map(e=>e.slideID);i.presenceInfoList=e.filter(e=>t.some(i=>g.isSlideIDEqual(e.slideID,i)))}))}get presenceInfoList(){return this.presenceInfoList}set slideDataList(e){this._slideDataList=e,this._sectionViewModelList.forEach(i=>{i.slideDataList=e.filter(e=>e.sectionIndex===i.sectionIndex),i.totalSlideCount=e.length})}updateSlideData(e){const i=this._sectionViewModelList.find(i=>i.sectionIndex==e.sectionIndex);if(!i)return;if(i.updateSlideData(e)){if(!this._slideDataList)throw new Error("updateSlideData this._slideDataList is null");const i=this._slideDataList.findIndex(i=>g.isSlideIDPartialEqual(i.slideID,e.slideID));-1!==i&&this._slideDataList.splice(i,1,e)}}set sectionDataList(e){this._sectionDataList=e,this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this._view.setZeroSectionVerticalThumbnailClass(this._sectionDataList.length);let i=0;this._currentSelectedSlideIndexesVMDB=new m.b(this,"currentSelectedSlideIndexes"),this._activeFocusSlideIndexVMDB=new m.b(this,"activeFocusSlideIndex"),(this.m_slideGridSettings.enableRevisionTrackingInfo||this.m_slideGridSettings.isDisplayPresenceIcon)&&(this._shouldDisplayCollabMarkersHintVMDB=new m.b(this,"shouldDisplayCollabMarkersHint")),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&(this._currentActiveSectionIndexVMDB=new m.b(this,"currentActiveSectionIndex")),this.m_slideGridSettings.enableSelectionBetweenSlides&&(this._insertBetweenSlidesIndexVMDB=new m.b(this,"insertBetweenSlidesIndex")),this._activeFocusSlideIndexVMDB.addBinding({target:this._view,onValueChanged:()=>{this.m_shiftArrowKeyFocusIndex=-1}});const t=this._slideDataList;if(!t)throw new Error("slideDataList is null");this._sectionDataList.forEach(e=>{let s;if(null==this._sectionViewModelList[i]?(s=new W(this.m_slideGridSettings,this._view.container,this._events,this.m_dragDropManager),this._sectionViewModelList.push(s)):s=this._sectionViewModelList[i],s.sectionTitle=e.sectionTitle,s.sectionIndex=e.sectionIndex,s.slideDataList=t.filter(i=>i.sectionIndex===e.sectionIndex),s.activeSectionIndex=this.currentActiveSectionIndex,!this._currentSelectedSlideIndexesVMDB||!this._activeFocusSlideIndexVMDB)throw new Error("sectionDataList callback called before rest of sectionDataList set? Should be impossible");if(this._currentSelectedSlideIndexesVMDB.addBinding({target:s}),this._activeFocusSlideIndexVMDB.addBinding({target:s}),this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering){if(!this._currentActiveSectionIndexVMDB)throw new Error("sectionDataList callback called before rest of sectionDataList set? Should be impossible");this._currentActiveSectionIndexVMDB.addBinding({target:s})}if(this.m_slideGridSettings.enableSelectionBetweenSlides){if(!this._insertBetweenSlidesIndexVMDB)throw new Error("sectionDataList callback called before rest of sectionDataList set? Should be impossible");this._insertBetweenSlidesIndexVMDB.addBinding({target:s})}if(this.m_slideGridSettings.enableRevisionTrackingInfo||this.m_slideGridSettings.isDisplayPresenceIcon){if(!this._shouldDisplayCollabMarkersHintVMDB)throw new Error("sectionDataList callback called before rest of sectionDataList set? Should be impossible");this._shouldDisplayCollabMarkersHintVMDB.addBinding({target:s})}i+=1,this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&s.onCurrentActiveSectionChanged.subscribe((e,i)=>{i.hasFocus?this.currentActiveSectionIndex=i.sectionIndex:this.currentActiveSectionIndex=-1})}),this._sectionViewModelList.length>i&&(this._sectionViewModelList.slice(i).forEach(e=>{e.dispose()}),this._sectionViewModelList=this._sectionViewModelList.slice(0,i))}get slideDataList(){var e;return null!==(e=this._slideDataList)&&void 0!==e?e:[]}get sectionDataList(){var e;return null!==(e=this._sectionDataList)&&void 0!==e?e:[]}dispose(){super.dispose(),this._sectionViewModelList=[]}get visibleSlideRange(){let e=[];return this._sectionViewModelList.forEach(i=>{const t=this._view.renderAreaRect,s=i.getVisibleSlideRange(t);e=e.concat(s)}),e}get selectedSlidesContentAreaRect(){let e=[];return this._sectionViewModelList.forEach(i=>{const t=i.getSelectedSlidesContentAreaRect();e=e.concat(t)}),e}ctrlArrowKeyHandler(e){if(e.moveType!==l.MoveSlideUp&&e.moveType!==l.MoveSlideToStart&&e.moveType!==l.MoveSlideDown&&e.moveType!==l.MoveSlideToEnd)return;const i=this.sectionDataList.length,t=this.slideDataList.length;if(this.currentActiveSectionIndex>=0&&this.currentActiveSectionIndex<i)return void(e.moveType===l.MoveSlideUp||e.moveType===l.MoveSlideDown?this._events.onMoveSection.signal(null,{sectionIndex:this.currentActiveSectionIndex,moveType:e.moveType===l.MoveSlideUp?d.MoveSectionUp:d.MoveSectionDown}):!h.ChangeGate.isChangeGateEnabled("PPTO_isSectionStartEndMoveEnabled")||e.moveType!==l.MoveSlideToStart&&e.moveType!==l.MoveSlideToEnd||this._events.onMoveSection.signal(null,{sectionIndex:this.currentActiveSectionIndex,moveType:e.moveType===l.MoveSlideToStart?d.MoveSectionStart:d.MoveSectionEnd}));const s=this.currentSelectedSlideIndexes;if(!s||!s.length)return;if(s.length>1)return void(h.ChangeGate.isChangeGateEnabled("MultipleSlideReOrdering")&&this.multipleSlideReordering(e));if(0==this.activeFocusSlideIndex&&0==this.slideDataList[this.activeFocusSlideIndex].sectionIndex&&(e.moveType==l.MoveSlideUp||e.moveType==l.MoveSlideToStart))return;if(this.activeFocusSlideIndex==t-1&&this.slideDataList[this.activeFocusSlideIndex].sectionIndex==i-1&&(e.moveType==l.MoveSlideDown||e.moveType==l.MoveSlideToEnd))return;const n=s;let a=this.activeFocusSlideIndex,r=!0,o=this.activeFocusSlideIndex,c=-1;switch(e.moveType){case l.MoveSlideUp:0==this.activeFocusSlideIndex&&this.slideDataList[this.activeFocusSlideIndex].sectionIndex>0?(o=0,a=o,c=this.slideDataList[this.activeFocusSlideIndex].sectionIndex-1,r=!1):this.slideDataList[this.activeFocusSlideIndex].sectionIndex!=this.slideDataList[this.activeFocusSlideIndex-1].sectionIndex?(o=this.activeFocusSlideIndex>0?this.activeFocusSlideIndex-1:this.activeFocusSlideIndex,r=this.activeFocusSlideIndex>0,a=r?o+1:o,c=this.slideDataList[this.activeFocusSlideIndex].sectionIndex-1):(o=this.activeFocusSlideIndex-1,a=o,c=this.slideDataList[this.activeFocusSlideIndex].sectionIndex,r=!1);break;case l.MoveSlideDown:this.activeFocusSlideIndex==t-1&&this.slideDataList[this.activeFocusSlideIndex].sectionIndex<i-1?(o=this.activeFocusSlideIndex-1,a=o+1,c=this.slideDataList[this.activeFocusSlideIndex].sectionIndex+1):this.slideDataList[this.activeFocusSlideIndex].sectionIndex==this.slideDataList[this.activeFocusSlideIndex+1].sectionIndex?(o=this.activeFocusSlideIndex+1,a=o,c=this.slideDataList[this.activeFocusSlideIndex].sectionIndex):(o=this.activeFocusSlideIndex>0?this.activeFocusSlideIndex-1:0,c=this.slideDataList[this.activeFocusSlideIndex].sectionIndex+1,r=this.activeFocusSlideIndex>0,a=r?o+1:o);break;case l.MoveSlideToStart:o=0,c=0,a=o,r=!1;break;case l.MoveSlideToEnd:o=t-1,a=t-1,c=i-1;break;default:return}if(this._events.onMoveSlide.signal("ctrlArrowKeyHandler",{dropTargetIndex:o,dragStartIndexes:n,sectionIndex:c,shouldInsertSlideAfter:r,slideMoveType:e.moveType}),!this._currentSelectedSlideIndexes)throw new Error("ctrlArrowKeyHandler _currentSelectedSlideIndexes is null");this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,this.activeFocusSlideIndex=a}isContinuous(e){return e[e.length-1]-e[0]==e.length-1}belongToSameSection(e){return this.slideDataList[e[0]].sectionIndex===this.slideDataList[e[e.length-1]].sectionIndex}multipleSlideReordering(e){const i=this.sectionDataList.length,t=this.slideDataList.length;if(!this.currentSelectedSlideIndexes)throw new Error("multipleSlideReordering currentSelectedSlideIndexes is null");const s=this.currentSelectedSlideIndexes.length,n=this.currentSelectedSlideIndexes.slice().sort((e,i)=>e-i),a=n[0],r=n[s-1];let o=-1;for(let e=0;e<s;e+=1)if(n[e]==this.activeFocusSlideIndex){o=e;break}if(this.currentSelectedSlideIndexes.length>1&&(!this.belongToSameSection(n)||!this.isContinuous(n)))return;if(0==a&&0==this.slideDataList[a].sectionIndex&&(e.moveType==l.MoveSlideUp||e.moveType==l.MoveSlideToStart))return;if(r==t-1&&this.slideDataList[r].sectionIndex==i-1&&(e.moveType==l.MoveSlideDown||e.moveType==l.MoveSlideToEnd))return;let d=!0,c=-1,h=-1,g=e.moveType==l.MoveSlideUp||e.moveType==l.MoveSlideToStart?n[0]:n[n.length-1];switch(e.moveType){case l.MoveSlideUp:{const e=0==g||this.slideDataList[g].sectionIndex!=this.slideDataList[g-1].sectionIndex;c=e?g:g-1,h=e?this.slideDataList[g].sectionIndex-1:this.slideDataList[g].sectionIndex,d=!1;break}case l.MoveSlideDown:g==t-1&&this.slideDataList[g].sectionIndex<i-1?(g=n[0],c=g,h=this.slideDataList[g].sectionIndex+1,d=!1):this.slideDataList[g].sectionIndex==this.slideDataList[g+1].sectionIndex?(c=g+1,h=this.slideDataList[g].sectionIndex):(g=n[0],c=g>0?g-1:0,h=this.slideDataList[g].sectionIndex+1,d=g>0);break;case l.MoveSlideToStart:c=0,h=0,d=!1;break;case l.MoveSlideToEnd:c=t-1,h=i-1;break;default:return}if(this._events.onMoveSlide.signal("multipleSlideReordering",{dropTargetIndex:c,dragStartIndexes:this.currentSelectedSlideIndexes,sectionIndex:h,shouldInsertSlideAfter:d}),!this._currentSelectedSlideIndexes)throw new Error("multipleSlideReordering _currentSelectedSlideIndexes is null");this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,this.activeFocusSlideIndex=this._currentSelectedSlideIndexes[o]}currentActiveFocusChangedHandler(e){let i=e.focusMoveType,t=e.eventObj;if(this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this.copilotUXHasFocus)return void(i===o.Up?(this.activeFocusSlideIndex=0,this.currentSelectedSlideIndexes=[0],this.copilotUXHasFocus=!1):i===o.Down&&(this.slideDataList.length<=1||(this.activeFocusSlideIndex=1,this.currentSelectedSlideIndexes=[1],this.copilotUXHasFocus=!1)));this.m_slideGridSettings.isRTL&&(i===o.Left?i=o.Right:i===o.Right&&(i=o.Left));let s=this.activeFocusSlideIndex,n=!1;if(this.m_slideGridSettings.enableSelectionBetweenSlides){if(this.insertBetweenSlidesIndex===this.slideDataList.length&&(i===o.Down||i===o.Right)&&this.slideDataList[this.slideDataList.length-1].sectionIndex===this.sectionDataList[this.sectionDataList.length-1].sectionIndex)return;this.activeFocusSlideIndex<0&&this.insertBetweenSlidesIndex>=0&&(s=0===this.insertBetweenSlidesIndex?0:this.insertBetweenSlidesIndex-1,n=!0)}let a=s;if(!n||!(i===o.Left||this.m_slideGridSettings.isDisplayVertical&&i===o.Up)||0===a){if(this.m_slideGridSettings.allowSectionsInKeyboardFocusOrdering&&this.shouldDisplaySections){const e=void 0===this.currentActiveSectionIndex?-1:this.currentActiveSectionIndex,t=e,n=this.m_slideGridFocusMoveUtils.handleSectionFocusMove(i,s,e,this.slideCapacityPerRow,this.slideDataList,this.sectionDataList);this.currentActiveSectionIndex=n;if(this.currentActiveSectionIndex!==t||0===this.currentActiveSectionIndex||this.currentActiveSectionIndex===this.sectionDataList.length-1){const e=this.m_slideGridFocusMoveUtils.handleSlideFocusMoveFromSectionFocus(i,t,this.currentActiveSectionIndex,this.slideDataList,this.sectionDataList);return h.ChangeGate.isChangeGateEnabled("DontSignalSlideSelectionForSectionFocusChange")||this._events.onSlideSelectionChanged.signal(null,{slideIndex:e,slideSelectionTrigger:w.c.ActiveSectionChange}),this._events.onSectionSelectionChanged.signal(null,{clickedAway:this.currentActiveSectionIndex<0,sectionSelectionTrigger:w.b.ActiveSectionChange,sectionIndex:this.currentActiveSectionIndex}),void this._events.onActiveSectionFocusChanged.signal(null,{currentActiveFocusSectionIndex:this.currentActiveSectionIndex,newActiveSlideIndex:e})}}a=i===o.Start?0:i===o.End?this.slideDataList.length-1:this.m_slideGridFocusMoveUtils.handleSlideFocusMove(i,s,this.slideCapacityPerRow,this.slideDataList,this.sectionDataList)}a>-1&&(this.m_slideGridSettings.enableTriggerSelectionFromActiveSlideChange?this._events.onSlideSelectionChanged.signal(null,{slideIndex:a,slideSelectionTrigger:w.c.ActiveSlideChange,eventObj:t}):this.activeFocusSlideIndex=a)}dragDropOperationCompletedHandler(e){if(e.hasValidDropTarget){if(1===e.dropTargetObjectDataList.length&&e.dropTargetObjectDataList[0].dragDropObjectType===f.Section&&this._sectionViewModelList[e.dropTargetObjectDataList[0].index].shouldDisplaySection){const i=this._sectionViewModelList[e.dropTargetObjectDataList[0].index],t=null==i.slideDataList||0===i.slideDataList.length;if(e.dropTargetObjectDataList[0].dragDropObjectType===f.Section)if(t){const i=e.draggableObjectDataList.map(e=>e.index),t=e.dropTargetObjectDataList[0].index;this.handleDragDropIntoEmptySection(i,t)}else{const t=e.draggableObjectDataList.map(e=>e.index),s=i.slideDataList[i.slideDataList.length-1].slideOrderIndex;if(!this._slideDataList)throw new Error("dragDropOperationCompletedHandler with drop containe type section - m_slideDataList is null");const n=g.NearestPreviousNonSourceSlide(this._slideDataList,t,s),a=!0,r=i.sectionIndex>=0?i.sectionIndex:-1;this._events.onMoveSlide.signal("dragDropOperationCompletedHandler",{dropTargetIndex:n,dragStartIndexes:t,sectionIndex:r,shouldInsertSlideAfter:a})}}else{let i=-1;for(let t=0;t<e.dropTargetObjectDataList.length;t+=1)e.dropTargetObjectDataList[t].dragDropObjectType===f.Section&&(i=t);if(-1===i)return;for(let t=0;t<e.dropTargetObjectDataList.length;t+=1)if(e.dropTargetObjectDataList[t].dragDropObjectType===f.Slide||e.dropTargetObjectDataList[t].dragDropObjectType===f.SlidePlaceholder||1===e.dropTargetObjectDataList.length&&e.dropTargetObjectDataList[0].dragDropObjectType===f.Section&&!this._sectionViewModelList[e.dropTargetObjectDataList[0].index].shouldDisplaySection){const s=e.draggableObjectDataList.map(e=>e.index);let n=e.dropTargetObjectDataList[t].index;const a=g.isFirstSlideOfSection(this.slideDataList,n),r=e.dropTargetObjectDataList[i].index;let o;if(e.dropTargetObjectDataList[t].dragDropObjectType===f.SlidePlaceholder){const e=n-1;o=null!=this.slideDataList[e],null!=this.slideDataList[e]&&(n=e)}else o=!(a&&(e.dropContainerPositionList[t]===C.ContainerLeft||e.dropContainerPositionList[t]===C.ContainerTop));if(!this._slideDataList)throw new Error("dragDropOperationCompletedHandler with drop containe type non-section - m_slideDataList is null");n=g.NearestPreviousNonSourceSlide(this._slideDataList,s,n),0===n&&1===s.length&&0===s[0]&&(o=!1),this._events.onMoveSlide.signal("dragDropOperationCompletedHandler",{dropTargetIndex:n,dragStartIndexes:s,sectionIndex:r,shouldInsertSlideAfter:o});break}}if(!this._currentSelectedSlideIndexes)throw new Error("dragDropOperationCompletedHandler _currentSelectedSlideIndexes is null");this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,this.activeFocusSlideIndex=this._currentSelectedSlideIndexes[0]}}handleDragDropIntoEmptySection(e,i){if(!this._sectionDataList||!this._slideDataList)throw new Error("handleDragDropIntoEmptySection called before slideDataList set");if(null!=this._sectionDataList[i]&&(null==!this._sectionDataList[i].slideIdList||0===this._sectionDataList[i].slideIdList.length)){const t=g.NearestPreviousNonSourceSlideBySection(this._slideDataList,this._sectionDataList,e,i);this._events.onMoveSlide.signal("handleDragDropIntoEmptySection",{dragStartIndexes:e,dropTargetIndex:t,sectionIndex:i,shouldInsertSlideAfter:t>0})}}get slideCapacityPerRow(){const e=this._view.renderAreaRect;let i=-1;for(const t of this._sectionViewModelList)if(i=t.getSlideCapacityPerRow(e),i>0)break;return i}set copilotUXHasFocus(e){this._copilotUXHasFocus=e}get copilotUXHasFocus(){return this._copilotUXHasFocus}parentWidthChanged(e){this._sectionViewModelList.forEach(i=>i.parentWidthChanged(e))}constructor(e,i,t,s){super(i),this.m_shouldDisplaySections=!1,this._disableNavigation=!1,this.currentSelectedSlideIndexes=[],this.activeFocusSlideIndex=-1,this.insertBetweenSlidesIndex=-1,this._highContrastMode=c.a.None,this._copilotUXHasFocus=!1,this.shouldDisplayCollabMarkersHint=!1,this._currentEditableSectionIndex=-1,this.m_shiftArrowKeyFocusIndex=-1,this.setFocusInView=e=>!!h.ChangeGate.isChangeGateEnabled("ThumbnailPaneF6TabbingOrdering")&&this.m_tabManager.setFocusInView(e),this.setFocusOnTabId=e=>{switch(e){case z.Thumbnail:return this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this.copilotUXHasFocus&&(this.activeFocusSlideIndex=0,this.currentSelectedSlideIndexes=[0],this.copilotUXHasFocus=!1),!0;case z.CoPilotUX:if(this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&this.m_slideGridSettings.isUsingSlideGridInThumbnail&&this.m_slideGridSettings.copilotUXTabStopId){const e=document.getElementById(this.m_slideGridSettings.copilotUXTabStopId);if(e)return e.focus(),this.copilotUXHasFocus=!0,this.activeFocusSlideIndex=-1,this.currentSelectedSlideIndexes=[],!0}}return!1},this._events=t,this.m_slideGridSettings=e,this.m_slideGridFocusMoveUtils=new u(this.m_slideGridSettings),this.m_dragDropManager=s,this.m_tabManager=new q(this.setFocusOnTabId,e),this._view=new S(this.m_slideGridSettings,i,this._events),this._sectionViewModelList=[];new m.b(this,"highContrastMode").addBinding({target:this._view});if(new m.b(this,"copilotUXHasFocus").addBinding({target:this._view}),null!=this.m_slideGridSettings.highContrastMode&&(this.highContrastMode=this.m_slideGridSettings.highContrastMode),this._view.onViewAreaChanged.subscribe(()=>{this.visibleSlideRange;t.onVisibleSlideRangeChanged.signal(null,null)}),this._view.onViewScrolled.subscribe(()=>{t.onSlideGridScrolled.signal(null,null)}),this._events.onMoveSlide.subscribe((e,i)=>{const t=i.dragStartIndexes,s=i.dropTargetIndex,n=null!=i.sectionIndex?i.sectionIndex:-1;let a=!0;if(void 0!==i.shouldInsertSlideAfter&&(a=i.shouldInsertSlideAfter),!this._slideDataList||!this._sectionDataList)throw new Error("moveSlide before slideDataList set");const r=g.MoveSlideByIndex(this._slideDataList,this._sectionDataList,t,s,n,a);this.slideDataList=this._slideDataList,this.sectionDataList=this._sectionDataList,this._currentSelectedSlideIndexes=r}),this._events.onSlideSelectionChanged.subscribe((i,t)=>{if(this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&this.m_slideGridSettings.isUsingSlideGridInThumbnail&&t.slideSelectionTrigger!==w.c.EnterKey&&(this.copilotUXHasFocus=!1),!this._currentSelectedSlideIndexes)throw new Error("onSlideSelectionChanged before _currentSelectedSlideIndexes set");const s=t.slideIndex,n=this._currentSelectedSlideIndexes.indexOf(t.slideIndex)>=0;if(this.m_slideGridSettings.isDeselectWithCtrlEnabled&&t.isCtrlKeyPressed&&!t.isSelectingRange&&n){const e=this._currentSelectedSlideIndexes.indexOf(t.slideIndex);this._currentSelectedSlideIndexes.splice(e,1),this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes,0==this.currentSelectedSlideIndexes.length?this.activeFocusSlideIndex=-1:this.activeFocusSlideIndex=this.currentSelectedSlideIndexes[this.currentSelectedSlideIndexes.length-1]}else{if(this.m_slideGridSettings.allowMultipleSelect&&t.isSelectingMultiple){if(!(this._currentSelectedSlideIndexes.indexOf(t.slideIndex)>=0&&t.slideSelectionTrigger===w.c.MouseDown)){if(t.isSelectingRange){this._currentSelectedSlideIndexes=[];let e=this.activeFocusSlideIndex<=s?this.activeFocusSlideIndex:s,i=this.activeFocusSlideIndex<=s?s:this.activeFocusSlideIndex;t.slideSelectionTrigger===w.c.CtrlAKey&&(e=0,i=this.slideDataList.length-1);for(let t=e;t<=i;t+=1)this._currentSelectedSlideIndexes.push(t);this.m_shiftArrowKeyFocusIndex=s}else this._currentSelectedSlideIndexes.indexOf(s)<0&&this._currentSelectedSlideIndexes.push(s);this.currentSelectedSlideIndexes=this._currentSelectedSlideIndexes}}else this._currentSelectedSlideIndexes.indexOf(t.slideIndex)>=0&&t.slideSelectionTrigger===w.c.MouseDown&&!t.isSelectingRange||(this.currentSelectedSlideIndexes=[s]);t.isSelectingRange&&1!==this._currentSelectedSlideIndexes.length||(this.activeFocusSlideIndex=s)}(this.m_slideGridSettings.enableRevisionTrackingInfo||this.m_slideGridSettings.isDisplayPresenceIcon)&&(t.slideSelectionTrigger!==w.c.ActiveSlideChange&&t.slideSelectionTrigger!==w.c.ActiveSectionChange||t.isSelectingRange||1!==this._currentSelectedSlideIndexes.length||-1!==this.currentActiveSectionIndex?this.shouldDisplayCollabMarkersHint=!1:this.shouldDisplayCollabMarkersHint=!0),t.slideSelectionTrigger!==w.c.ActiveSectionChange&&(this.currentActiveSectionIndex=-1),e.enableSelectionBetweenSlides&&(this.insertBetweenSlidesIndex=-1,this._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:-1})),t.isSelectingRange||(this.m_shiftArrowKeyFocusIndex=-1)}),this._events.onSectionSelectionChanged.subscribe((i,t)=>{t.clickedAway?(this._sectionViewModelList.forEach(e=>{e.isSelected=!1}),this.currentActiveSectionIndex=-1):(this._sectionViewModelList.forEach(e=>{e.isSelected=e.sectionIndex===t.sectionIndex}),this.currentActiveSectionIndex=t.sectionIndex),e.enableSelectionBetweenSlides&&(t.clickedAway||(this.insertBetweenSlidesIndex=-1,this._events.onInsertBetweenSlidesPositionChanged.signal(null,{insertIndex:-1})))}),this.m_slideGridSettings.enableSelectionBetweenSlides&&this._events.onInsertBetweenSlidesPositionChanged.subscribe((e,i)=>{this.insertBetweenSlidesIndex=i.insertIndex,-1!==this.insertBetweenSlidesIndex&&(this.currentSelectedSlideIndexes=[],this.activeFocusSlideIndex=-1)}),this._view.onCurrentActiveFocusChanged.subscribe((e,i)=>{this.currentActiveFocusChangedHandler(i)}),this._view.onCtrlArrowKey.subscribe((e,i)=>{this.ctrlArrowKeyHandler(i)}),this._view.onEnterKey.subscribe(()=>{this._events.onSlideSelectionChanged.signal(null,{slideIndex:this.activeFocusSlideIndex,slideSelectionTrigger:w.c.EnterKey,copilotUXHasFocus:this.copilotUXHasFocus})}),this._view.onCtrlAkey.subscribe(()=>{this._events.onSlideSelectionChanged.signal(null,{slideIndex:this.activeFocusSlideIndex,slideSelectionTrigger:w.c.CtrlAKey,isSelectingRange:this.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:this.m_slideGridSettings.allowMultipleSelect})}),this._view.onShiftArrowKey.subscribe((e,i)=>{try{if(!i||!this.m_slideGridSettings.isUsingSlideGridInThumbnail&&(i.focusMoveType===o.Up||i.focusMoveType===o.Down))return;let e;const t=-1===this.m_shiftArrowKeyFocusIndex?this.activeFocusSlideIndex:this.m_shiftArrowKeyFocusIndex;if(i.focusMoveType===o.Left||i.focusMoveType===o.Up)e=0===t?t:t-1;else{if(!this._slideDataList)throw new Error("onShiftArrowKey called before slideDataList set");e=t===this._slideDataList.length-1?t:t+1}this._events.onSlideSelectionChanged.signal(null,{slideIndex:e,slideSelectionTrigger:w.c.ArrowKey,isSelectingRange:this.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:this.m_slideGridSettings.allowMultipleSelect}),this._events.onShiftArrowKeyScroll.signal(null,{slideIndex:e})}catch{return}}),this._view.onShiftHomeKey.subscribe(()=>{this._events.onSlideSelectionChanged.signal(null,{slideIndex:0,slideSelectionTrigger:w.c.ShiftHomeKey,isSelectingRange:this.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:this.m_slideGridSettings.allowMultipleSelect})}),this._view.onShiftEndKey.subscribe(()=>{this._events.onSlideSelectionChanged.signal(null,{slideIndex:this.slideDataList.length-1,slideSelectionTrigger:w.c.ShiftEndKey,isSelectingRange:this.m_slideGridSettings.allowMultipleSelect,isSelectingMultiple:this.m_slideGridSettings.allowMultipleSelect})}),this._view.onTabKey.subscribe((e,i)=>{const t=i.isShiftKey;if(h.ChangeGate.isChangeGateEnabled("ThumbnailPaneF6TabbingOrdering")){if(!this.m_tabManager.onTabKey(!t))return}else if(this.m_slideGridSettings.isCopilotUXEntryPointEnabled&&this.m_slideGridSettings.isUsingSlideGridInThumbnail){if(this.copilotUXHasFocus)return this.activeFocusSlideIndex=0,this.currentSelectedSlideIndexes=[0],void(this.copilotUXHasFocus=!1);if(0===this.activeFocusSlideIndex&&this.m_slideGridSettings.copilotUXTabStopId){const e=document.getElementById(this.m_slideGridSettings.copilotUXTabStopId);if(e)return e.focus(),this.copilotUXHasFocus=!0,this.activeFocusSlideIndex=-1,void(this.currentSelectedSlideIndexes=[])}return}let s;s=t?0===this.activeFocusSlideIndex?o.End:o.Up:this.activeFocusSlideIndex===this.slideDataList.length-1?o.Start:o.Down,this._view.onCurrentActiveFocusChanged.signal(null,{focusMoveType:s})}),this.m_slideGridSettings.allowMoveSlide){if(!this.m_dragDropManager)throw new Error("dragDropManager is null");this.m_dragDropManager.dragDropOperationCompletedEvent.subscribe((e,i)=>{this.dragDropOperationCompletedHandler(i)}),this.m_dragDropManager.dragDropRootContainer=this._view.container}this._events.onActiveSectionFocusChanged.subscribe((e,i)=>{const t=i.currentActiveFocusSectionIndex;if(-1!==t&&this.sectionDataList[t].slideIdList.length>0){const e=this.slideDataList.filter(e=>e.sectionIndex===t).map(e=>e.slideOrderIndex);e.length>0&&(this.currentSelectedSlideIndexes=e)}})}}class q{setFocusOnNextTab(e,i){return i?e<this.m_tabOrder.length&&(this.setFocusOnTabIndex(e)?(this.m_currentTabIndex=e,!0):this.setFocusOnNextTab(e+1,i)):e>=0&&(this.setFocusOnTabIndex(e)?(this.m_currentTabIndex=e,!0):this.setFocusOnNextTab(e-1,i))}setFocusOnTabIndex(e){const i=this.m_tabOrder[e];return this.setFocusOnTabId(i)}constructor(e,i){this.setFocusOnTabId=e,this.slideGridSettings=i,this.m_tabOrder=[z.Thumbnail,z.CoPilotUX],this.m_currentTabIndex=0,this.setFocusInView=e=>this.setFocusOnNextTab(e?0:this.m_tabOrder.length-1,e),this.onTabKey=e=>{const i=this.m_currentTabIndex+(e?1:-1);if(!this.setFocusOnNextTab(i,e)){var t,s;return(null===(t=(s=this.slideGridSettings).onTabCompleted)||void 0===t?void 0:t.call(s,e))||(this.m_currentTabIndex=e?0:this.m_tabOrder.length-1,this.setFocusOnNextTab(this.m_currentTabIndex,e)),!1}return!0}}}class Z{get onSlideSelectionChanged(){return this._onSlideSelectionChanged}get onMoveSection(){return this._onMoveSection}get onCommentCountClick(){return this._onCommentCountClick}get onCatchupEvent(){return this._onCatchupEvent}get onShiftArrowKeyScroll(){return this._onShiftArrowKeyScroll}get onSectionSelectionChanged(){return this._onSectionSelectionChanged}get onVisibleSlideRangeChanged(){return this._onVisibleSlideRangeChanged}get onSlideGridScrolled(){return this._onSlideGridScrolled}get onMoveSlide(){return this._onMoveSlide}get onSectionTitleUpdate(){return this._onSectionTitleUpdate}get onActiveSectionFocusChanged(){return this._onActiveSectionFocusChanged}get onInsertBetweenSlidesPositionChanged(){return this._onInsertBetweenSlidesPositionChanged}constructor(){this._onSlideSelectionChanged=new s,this._onMoveSection=new s,this._onCommentCountClick=new s,this._onCatchupEvent=new s,this._onShiftArrowKeyScroll=new s,this._onVisibleSlideRangeChanged=new s,this._onSlideGridScrolled=new s,this._onMoveSlide=new s,this._onSectionTitleUpdate=new s,this._onActiveSectionFocusChanged=new s,this._onSectionSelectionChanged=new s,this._onInsertBetweenSlidesPositionChanged=new s}}class ${updateSlideData(e){this._sectionListViewModel&&this._sectionListViewModel.updateSlideData(e)}show(e,i,t,s){if(null!=this._sectionListViewModel){if(null!=t&&(this._sectionListViewModel.slideDataList=t),null!=s&&(this._sectionListViewModel.sectionDataList=s,this.slideGridSettings.isUsingSlideGridInThumbnail||this._events.onVisibleSlideRangeChanged.signal(null,null)),e.length>=0&&(this._sectionListViewModel.currentSelectedSlideIndexes=e,this._sectionListViewModel.activeFocusSlideIndex=i),this.slideGridSettings.allowMoveSlide){const i=e.map(e=>new E(f.Slide,e));if(!this.m_dragDropManager)throw new Error("m_dragDropManager is null");this.m_dragDropManager.initialDragReadyElements=i}this._sectionListViewModel.shouldDisplayCollabMarkersHint=!1}}set presenceInfoList(e){this._sectionListViewModel.presenceInfoList=e}get presenceInfoList(){return this._sectionListViewModel.presenceInfoList}set selectedSectionIndex(e){this._sectionListViewModel.currentSelectedSectionIndex=e}get selectedSectionIndex(){return this._sectionListViewModel.currentSelectedSectionIndex}set editableSectionTitleIndex(e){this._sectionListViewModel.currentEditableSectionIndex=e}set shouldDisplaySections(e){this._sectionListViewModel.shouldDisplaySections=e}restoreFocusToGrid(){this._sectionListViewModel.activeFocusSlideIndex=this._sectionListViewModel.activeFocusSlideIndex}get slideDataList(){return this._sectionListViewModel.slideDataList}set slideDataList(e){this._sectionListViewModel.slideDataList=e}get sectionDataList(){return this._sectionListViewModel.sectionDataList}set sectionDataList(e){this._sectionListViewModel.sectionDataList=e}get events(){return this._events}get visibleSlideRange(){return this._sectionListViewModel.visibleSlideRange}set activeFocusSlideIndex(e){this._sectionListViewModel.activeFocusSlideIndex=e}set selectedSlideIndexes(e){this._sectionListViewModel.currentSelectedSlideIndexes=e}set insertBetweenSlideIndex(e){this._sectionListViewModel.insertBetweenSlidesIndex=e}get selectedSlideIndexes(){return this._sectionListViewModel.currentSelectedSlideIndexes}get highContrastMode(){return this._sectionListViewModel.highContrastMode}set highContrastMode(e){this._sectionListViewModel.highContrastMode=e}get selectedSlidesContentAreaRect(){return this._sectionListViewModel.selectedSlidesContentAreaRect}set disableNavigation(e){this.slideGridSettings.allowDisableNavigation&&(this._sectionListViewModel.disableNavigation=e)}get disableNavigation(){return this._sectionListViewModel.disableNavigation}constructor(e,i){if(this.setFocusInView=e=>this._sectionListViewModel.setFocusInView(e),this.parentWidthChanged=e=>{this._sectionListViewModel.parentWidthChanged(e)},e.disabledChangeGates&&h.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),_.load(e.settings?e.settings.slidegrid:{}),this._parent=i,this._events=new Z,this.slideGridSettings=e,this.slideGridSettings.allowMoveSlide){const i={scrollThresholdInPx:e.dragDropScrollThresholdInPx,scrollTimeoutInMs:e.dragDropScrollTimeoutInMs};this.m_dragDropManager=new j(i,e)}this._sectionListViewModel=new Y(this.slideGridSettings,this._parent,this._events,this.m_dragDropManager)}}},function(e,i,t){"use strict";t.r(i),function(e){t.d(i,"SlideGridFactory",(function(){return a}));var s,n=t(8);void 0===(null===(s=e)||void 0===s||null===(s=Object({NODE_ENV:"production"}))||void 0===s?void 0:s.JEST_WORKER_ID)&&t(22);class a{static CreateSlideGrid(e,i){return new n.a(e,i)}}}.call(this,t(10))},function(e,i){var t,s,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{s="function"==typeof clearTimeout?clearTimeout:r}catch(e){s=r}}();var l,d=[],c=!1,h=-1;function g(){c&&l&&(c=!1,l.length?d=l.concat(d):h=-1,d.length&&u())}function u(){if(!c){var e=o(g);c=!0;for(var i=d.length;i;){for(l=d,d=[];++h<i;)l&&l[h].run();h=-1,i=d.length}l=null,c=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===r||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(i){try{return s.call(null,e)}catch(i){return s.call(this,e)}}}(e)}}function m(e,i){this.fun=e,this.array=i}function _(){}n.nextTick=function(e){var i=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)i[t-1]=arguments[t];d.push(new m(e,i)),1!==d.length||c||o(u)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=_,n.addListener=_,n.once=_,n.off=_,n.removeListener=_,n.removeAllListeners=_,n.emit=_,n.prependListener=_,n.prependOnceListener=_,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,i,t){"use strict";t.r(i),t.d(i,"__extends",(function(){return n})),t.d(i,"__assign",(function(){return a})),t.d(i,"__rest",(function(){return r})),t.d(i,"__decorate",(function(){return o})),t.d(i,"__param",(function(){return l})),t.d(i,"__esDecorate",(function(){return d})),t.d(i,"__runInitializers",(function(){return c})),t.d(i,"__propKey",(function(){return h})),t.d(i,"__setFunctionName",(function(){return g})),t.d(i,"__metadata",(function(){return u})),t.d(i,"__awaiter",(function(){return m})),t.d(i,"__generator",(function(){return _})),t.d(i,"__createBinding",(function(){return p})),t.d(i,"__exportStar",(function(){return S})),t.d(i,"__values",(function(){return v})),t.d(i,"__read",(function(){return b})),t.d(i,"__spread",(function(){return f})),t.d(i,"__spreadArrays",(function(){return C})),t.d(i,"__spreadArray",(function(){return w})),t.d(i,"__await",(function(){return I})),t.d(i,"__asyncGenerator",(function(){return y})),t.d(i,"__asyncDelegator",(function(){return D})),t.d(i,"__asyncValues",(function(){return T})),t.d(i,"__makeTemplateObject",(function(){return x})),t.d(i,"__importStar",(function(){return M})),t.d(i,"__importDefault",(function(){return E})),t.d(i,"__classPrivateFieldGet",(function(){return O})),t.d(i,"__classPrivateFieldSet",(function(){return N})),t.d(i,"__classPrivateFieldIn",(function(){return F})),t.d(i,"__addDisposableResource",(function(){return V})),t.d(i,"__disposeResources",(function(){return k}));var s=function(e,i){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=i[t])})(e,i)};function n(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function t(){this.constructor=e}s(e,i),e.prototype=null===i?Object.create(i):(t.prototype=i.prototype,new t)}var a=function(){return(a=Object.assign||function(e){for(var i,t=1,s=arguments.length;t<s;t++)for(var n in i=arguments[t])Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n]);return e}).apply(this,arguments)};function r(e,i){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&i.indexOf(s)<0&&(t[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)i.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(t[s[n]]=e[s[n]])}return t}function o(e,i,t,s){var n,a=arguments.length,r=a<3?i:null===s?s=Object.getOwnPropertyDescriptor(i,t):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,i,t,s);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(r=(a<3?n(r):a>3?n(i,t,r):n(i,t))||r);return a>3&&r&&Object.defineProperty(i,t,r),r}function l(e,i){return function(t,s){i(t,s,e)}}function d(e,i,t,s,n,a){function r(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,l=s.kind,d="getter"===l?"get":"setter"===l?"set":"value",c=!i&&e?s.static?e:e.prototype:null,h=i||(c?Object.getOwnPropertyDescriptor(c,s.name):{}),g=!1,u=t.length-1;u>=0;u--){var m={};for(var _ in s)m[_]="access"===_?{}:s[_];for(var _ in s.access)m.access[_]=s.access[_];m.addInitializer=function(e){if(g)throw new TypeError("Cannot add initializers after decoration has completed");a.push(r(e||null))};var p=(0,t[u])("accessor"===l?{get:h.get,set:h.set}:h[d],m);if("accessor"===l){if(void 0===p)continue;if(null===p||"object"!=typeof p)throw new TypeError("Object expected");(o=r(p.get))&&(h.get=o),(o=r(p.set))&&(h.set=o),(o=r(p.init))&&n.unshift(o)}else(o=r(p))&&("field"===l?n.unshift(o):h[d]=o)}c&&Object.defineProperty(c,s.name,h),g=!0}function c(e,i,t){for(var s=arguments.length>2,n=0;n<i.length;n++)t=s?i[n].call(e,t):i[n].call(e);return s?t:void 0}function h(e){return"symbol"==typeof e?e:"".concat(e)}function g(e,i,t){return"symbol"==typeof i&&(i=i.description?"[".concat(i.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:t?"".concat(t," ",i):i})}function u(e,i){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,i)}function m(e,i,t,s){return new(t||(t=Promise))((function(n,a){function r(e){try{l(s.next(e))}catch(e){a(e)}}function o(e){try{l(s.throw(e))}catch(e){a(e)}}function l(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(r,o)}l((s=s.apply(e,i||[])).next())}))}function _(e,i){var t,s,n,a,r={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(r=0)),r;)try{if(t=1,s&&(n=2&o[0]?s.return:o[0]?s.throw||((n=s.return)&&n.call(s),0):s.next)&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,s=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!(n=r.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){r.label=o[1];break}if(6===o[0]&&r.label<n[1]){r.label=n[1],n=o;break}if(n&&r.label<n[2]){r.label=n[2],r.ops.push(o);break}n[2]&&r.ops.pop(),r.trys.pop();continue}o=i.call(e,r)}catch(e){o=[6,e],s=0}finally{t=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}var p=Object.create?function(e,i,t,s){void 0===s&&(s=t);var n=Object.getOwnPropertyDescriptor(i,t);n&&!("get"in n?!i.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return i[t]}}),Object.defineProperty(e,s,n)}:function(e,i,t,s){void 0===s&&(s=t),e[s]=i[t]};function S(e,i){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(i,t)||p(i,e,t)}function v(e){var i="function"==typeof Symbol&&Symbol.iterator,t=i&&e[i],s=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,i){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var s,n,a=t.call(e),r=[];try{for(;(void 0===i||i-- >0)&&!(s=a.next()).done;)r.push(s.value)}catch(e){n={error:e}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(n)throw n.error}}return r}function f(){for(var e=[],i=0;i<arguments.length;i++)e=e.concat(b(arguments[i]));return e}function C(){for(var e=0,i=0,t=arguments.length;i<t;i++)e+=arguments[i].length;var s=Array(e),n=0;for(i=0;i<t;i++)for(var a=arguments[i],r=0,o=a.length;r<o;r++,n++)s[n]=a[r];return s}function w(e,i,t){if(t||2===arguments.length)for(var s,n=0,a=i.length;n<a;n++)!s&&n in i||(s||(s=Array.prototype.slice.call(i,0,n)),s[n]=i[n]);return e.concat(s||Array.prototype.slice.call(i))}function I(e){return this instanceof I?(this.v=e,this):new I(e)}function y(e,i,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,n=t.apply(e,i||[]),a=[];return s={},r("next"),r("throw"),r("return"),s[Symbol.asyncIterator]=function(){return this},s;function r(e){n[e]&&(s[e]=function(i){return new Promise((function(t,s){a.push([e,i,t,s])>1||o(e,i)}))})}function o(e,i){try{(t=n[e](i)).value instanceof I?Promise.resolve(t.value.v).then(l,d):c(a[0][2],t)}catch(e){c(a[0][3],e)}var t}function l(e){o("next",e)}function d(e){o("throw",e)}function c(e,i){e(i),a.shift(),a.length&&o(a[0][0],a[0][1])}}function D(e){var i,t;return i={},s("next"),s("throw",(function(e){throw e})),s("return"),i[Symbol.iterator]=function(){return this},i;function s(s,n){i[s]=e[s]?function(i){return(t=!t)?{value:I(e[s](i)),done:!1}:n?n(i):i}:n}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,t=e[Symbol.asyncIterator];return t?t.call(e):(e=v(e),i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i);function s(t){i[t]=e[t]&&function(i){return new Promise((function(s,n){(function(e,i,t,s){Promise.resolve(s).then((function(i){e({value:i,done:t})}),i)})(s,n,(i=e[t](i)).done,i.value)}))}}}function x(e,i){return Object.defineProperty?Object.defineProperty(e,"raw",{value:i}):e.raw=i,e}var L=Object.create?function(e,i){Object.defineProperty(e,"default",{enumerable:!0,value:i})}:function(e,i){e.default=i};function M(e){if(e&&e.__esModule)return e;var i={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&p(i,e,t);return L(i,e),i}function E(e){return e&&e.__esModule?e:{default:e}}function O(e,i,t,s){if("a"===t&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof i?e!==i||!s:!i.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?s:"a"===t?s.call(e):s?s.value:i.get(e)}function N(e,i,t,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof i?e!==i||!n:!i.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,t):n?n.value=t:i.set(e,t),t}function F(e,i){if(null===i||"object"!=typeof i&&"function"!=typeof i)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?i===e:e.has(i)}function V(e,i,t){if(null!=i){if("object"!=typeof i&&"function"!=typeof i)throw new TypeError("Object expected.");var s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=i[Symbol.asyncDispose]}if(void 0===s){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=i[Symbol.dispose]}if("function"!=typeof s)throw new TypeError("Object not disposable.");e.stack.push({value:i,dispose:s,async:t})}else t&&e.stack.push({async:!0});return i}var G="function"==typeof SuppressedError?SuppressedError:function(e,i,t){var s=new Error(t);return s.name="SuppressedError",s.error=e,s.suppressed=i,s};function k(e){function i(i){e.error=e.hasError?new G(i,e.error,"An error was suppressed during disposal."):i,e.hasError=!0}return function t(){for(;e.stack.length;){var s=e.stack.pop();try{var n=s.dispose&&s.dispose.call(s.value);if(s.async)return Promise.resolve(n).then(t,(function(e){return i(e),t()}))}catch(e){i(e)}}if(e.hasError)throw e.error}()}i.default={__extends:n,__assign:a,__rest:r,__decorate:o,__param:l,__metadata:u,__awaiter:m,__generator:_,__createBinding:p,__exportStar:S,__values:v,__read:b,__spread:f,__spreadArrays:C,__spreadArray:w,__await:I,__asyncGenerator:y,__asyncDelegator:D,__asyncValues:T,__makeTemplateObject:x,__importStar:M,__importDefault:E,__classPrivateFieldGet:O,__classPrivateFieldSet:N,__classPrivateFieldIn:F,__addDisposableResource:V,__disposeResources:k}},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0})},function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.ChangeGate=void 0;var s=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();i.ChangeGate=s},function(e,i,t){var s,n,a=t(6),r=t(7),o=0,l=0;e.exports=function(e,i,t){var d=i&&t||0,c=i||[],h=(e=e||{}).node||s,g=void 0!==e.clockseq?e.clockseq:n;if(null==h||null==g){var u=a();null==h&&(h=s=[1|u[0],u[1],u[2],u[3],u[4],u[5]]),null==g&&(g=n=16383&(u[6]<<8|u[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),_=void 0!==e.nsecs?e.nsecs:l+1,p=m-o+(_-l)/1e4;if(p<0&&void 0===e.clockseq&&(g=g+1&16383),(p<0||m>o)&&void 0===e.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=m,l=_,n=g;var S=(1e4*(268435455&(m+=122192928e5))+_)%4294967296;c[d++]=S>>>24&255,c[d++]=S>>>16&255,c[d++]=S>>>8&255,c[d++]=255&S;var v=m/4294967296*1e4&268435455;c[d++]=v>>>8&255,c[d++]=255&v,c[d++]=v>>>24&15|16,c[d++]=v>>>16&255,c[d++]=g>>>8|128,c[d++]=255&g;for(var b=0;b<6;++b)c[d+b]=h[b];return i||r(c)}},function(e,i,t){var s=t(6),n=t(7);e.exports=function(e,i,t){var a=i&&t||0;"string"==typeof e&&(i="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||s)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,i)for(var o=0;o<16;++o)i[a+o]=r[o];return i||n(r)}},,,,,,,function(e,i){}]);
//# sourceMappingURL=SlideGrid.js.map