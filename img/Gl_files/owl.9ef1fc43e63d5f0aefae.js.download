var Microsoft;!function(){"use strict";var t,e,n,o,r={3045:function(t,e,n){n.d(e,{h:function(){return s}});var o=n(72379),r=n(14521),i=n(39292),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return o.C6(e,t),e.prototype.N=function(e){return this.hasError?(e.error(this.thrownError),i.y.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),i.y.EMPTY):t.prototype.N.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(r.B7)},44739:function(t,e,n){n.d(e,{t:function(){return s}});var o=n(72379),r=n(14521),i=n(46624),s=function(t){function e(e){var n=t.call(this)||this;return n.B=e,n}return o.C6(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype.N=function(e){var n=t.prototype.N.call(this,e);return n&&!n.closed&&e.next(this.B),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new i.P;return this.B},e.prototype.next=function(e){t.prototype.next.call(this,this.B=e)},e}(r.B7)},84928:function(t,e,n){n.d(e,{c:function(){return a}});var o=n(32246),r=n(12071),i=n(86365),s=n(21708),c=n(36795),a=function(){function t(t){this.tt=!1,t&&(this.N=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var o=this.operator,i=(0,r.u)(t,e,n);if(o?i.add(o.call(i,this.source)):i.add(this.source||c.$.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this.N(i):this.et(i)),c.$.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype.et=function(t){try{return this.N(t)}catch(e){c.$.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),(0,o.H)(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=u(e))((function(e,o){var r;r=n.subscribe((function(e){try{t(e)}catch(t){o(t),r&&r.unsubscribe()}}),o,e)}))},t.prototype.N=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[i.s]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:(0,s.m)(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=u(t))((function(t,n){var o;e.subscribe((function(t){return o=t}),(function(t){return n(t)}),(function(){return t(o)}))}))},t.create=function(e){return new t(e)},t}();function u(t){if(t||(t=c.$.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},32547:function(t,e,n){n.d(e,{I:function(){return i}});var o=n(36795),r=n(96120),i={closed:!0,next:function(t){},error:function(t){if(o.$.useDeprecatedSynchronousErrorHandling)throw t;(0,r.T)(t)},complete:function(){}}},14521:function(t,e,n){n.d(e,{B7:function(){return l}});var o=n(72379),r=n(84928),i=n(98899),s=n(39292),c=n(46624),a=n(68424),u=n(5656),f=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return o.C6(e,t),e}(i.v),l=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return o.C6(e,t),e.prototype[u.D]=function(){return new f(this)},e.prototype.lift=function(t){var e=new d(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new c.P;if(!this.isStopped)for(var e=this.observers,n=e.length,o=e.slice(),r=0;r<n;r++)o[r].next(t)},e.prototype.error=function(t){if(this.closed)throw new c.P;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,o=e.slice(),r=0;r<n;r++)o[r].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new c.P;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),o=0;o<e;o++)n[o].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype.et=function(e){if(this.closed)throw new c.P;return t.prototype.et.call(this,e)},e.prototype.N=function(t){if(this.closed)throw new c.P;return this.hasError?(t.error(this.thrownError),s.y.EMPTY):this.isStopped?(t.complete(),s.y.EMPTY):(this.observers.push(t),new a.Y(this,t))},e.prototype.asObservable=function(){var t=new r.c;return t.source=this,t},e.create=function(t,e){return new d(t,e)},e}(r.c),d=function(t){function e(e,n){var o=t.call(this)||this;return o.destination=e,o.source=n,o}return o.C6(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype.N=function(t){return this.source?this.source.subscribe(t):s.y.EMPTY},e}(l)},68424:function(t,e,n){n.d(e,{Y:function(){return r}});var o=n(72379),r=function(t){function e(e,n){var o=t.call(this)||this;return o.subject=e,o.subscriber=n,o.closed=!1,o}return o.C6(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(n(39292).y)},98899:function(t,e,n){n.d(e,{v:function(){return f}});var o=n(72379),r=n(87004),i=n(32547),s=n(39292),c=n(5656),a=n(36795),u=n(96120),f=function(t){function e(n,o,r){var s=t.call(this)||this;switch(s.syncErrorValue=null,s.syncErrorThrown=!1,s.syncErrorThrowable=!1,s.isStopped=!1,arguments.length){case 0:s.destination=i.I;break;case 1:if(!n){s.destination=i.I;break}if("object"==typeof n){n instanceof e?(s.syncErrorThrowable=n.syncErrorThrowable,s.destination=n,n.add(s)):(s.syncErrorThrowable=!0,s.destination=new l(s,n));break}default:s.syncErrorThrowable=!0,s.destination=new l(s,n,o,r)}return s}return o.C6(e,t),e.prototype[c.D]=function(){return this},e.create=function(t,n,o){var r=new e(t,n,o);return r.syncErrorThrowable=!1,r},e.prototype.next=function(t){this.isStopped||this.nt(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this.ot(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this.rt())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype.nt=function(t){this.destination.next(t)},e.prototype.ot=function(t){this.destination.error(t),this.unsubscribe()},e.prototype.rt=function(){this.destination.complete(),this.unsubscribe()},e.prototype.st=function(){var t=this.ct;return this.ct=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this.ct=t,this},e}(s.y),l=function(t){function e(e,n,o,s){var c,a=t.call(this)||this;a.ut=e;var u=a;return(0,r.T)(n)?c=n:n&&(c=n.next,o=n.error,s=n.complete,n!==i.I&&(u=Object.create(n),(0,r.T)(u.unsubscribe)&&a.add(u.unsubscribe.bind(u)),u.unsubscribe=a.unsubscribe.bind(a))),a.ft=u,a.nt=c,a.ot=o,a.rt=s,a}return o.C6(e,t),e.prototype.next=function(t){if(!this.isStopped&&this.nt){var e=this.ut;a.$.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this.nt,t)&&this.unsubscribe():this.__tryOrUnsub(this.nt,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this.ut,n=a.$.useDeprecatedSynchronousErrorHandling;if(this.ot)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this.ot,t),this.unsubscribe()):(this.__tryOrUnsub(this.ot,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,u.T)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,u.T)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this.ut;if(this.rt){var n=function(){return t.rt.call(t.ft)};a.$.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this.ft,e)}catch(t){if(this.unsubscribe(),a.$.useDeprecatedSynchronousErrorHandling)throw t;(0,u.T)(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!a.$.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this.ft,n)}catch(e){return a.$.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):((0,u.T)(e),!0)}return!1},e.prototype.dt=function(){var t=this.ut;this.ft=null,this.ut=null,t.unsubscribe()},e}(f)},39292:function(t,e,n){n.d(e,{y:function(){return c}});var o=n(29899),r=n(76171),i=n(87004),s=n(71106),c=function(){function t(t){this.closed=!1,this.ct=null,this.ht=null,t&&(this.wt=!0,this.dt=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this,c=n.ct,u=n.wt,f=n.dt,l=n.ht;if(this.closed=!0,this.ct=null,this.ht=null,c instanceof t)c.remove(this);else if(null!==c)for(var d=0;d<c.length;++d)c[d].remove(this);if((0,i.T)(f)){u&&(this.dt=void 0);try{f.call(this)}catch(t){e=t instanceof s.Z?a(t.errors):[t]}}if((0,o.c)(l)){d=-1;for(var h=l.length;++d<h;){var p=l[d];if((0,r.G)(p))try{p.unsubscribe()}catch(t){e=e||[],t instanceof s.Z?e=e.concat(a(t.errors)):e.push(t)}}}if(e)throw new s.Z(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var o=n;(n=new t).ht=[o]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var r=n.ct;if(null===r)n.ct=this;else if(r instanceof t){if(r===this)return n;n.ct=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}var i=this.ht;return null===i?this.ht=[n]:i.push(n),n},t.prototype.remove=function(t){var e=this.ht;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function a(t){return t.reduce((function(t,e){return t.concat(e instanceof s.Z?e.errors:e)}),[])}},36795:function(t,e,n){n.d(e,{$:function(){return r}});var o=!1,r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack,o=t},get useDeprecatedSynchronousErrorHandling(){return o}}},98169:function(t,e,n){n.d(e,{gn:function(){return a},tS:function(){return u},zA:function(){return c}});var o=n(72379),r=n(98899),i=n(84928),s=n(46067),c=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return o.C6(e,t),e.prototype.nt=function(t){this.parent.notifyNext(t)},e.prototype.ot=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype.rt=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(r.v),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o.C6(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(r.v);function u(t,e){if(!e.closed){if(t instanceof i.c)return t.subscribe(e);var n;try{n=(0,s.i)(t)(e)}catch(t){e.error(t)}return n}}},26350:function(t,e,n){n.d(e,{I:function(){return i}});var o=n(84928),r=new o.c((function(t){return t.complete()}));function i(t){return t?function(t){return new o.c((function(e){return t.schedule((function(){return e.complete()}))}))}(t):r}},97203:function(t,e,n){n.d(e,{H:function(){return s}});var o=n(84928),r=n(46067),i=n(52122);function s(t,e){return e?(0,i.c)(t,e):t instanceof o.c?t:new o.c((0,r.i)(t))}},31675:function(t,e,n){n.d(e,{R:function(){return c}});var o=n(84928),r=n(29899),i=n(87004),s=n(42365);function c(t,e,n,u){return(0,i.T)(n)&&(u=n,n=void 0),u?c(t,e,n).pipe((0,s.T)((function(t){return(0,r.c)(t)?u.apply(void 0,t):u(t)}))):new o.c((function(o){a(t,e,(function(t){arguments.length>1?o.next(Array.prototype.slice.call(arguments)):o.next(t)}),o,n)}))}function a(t,e,n,o,r){var i;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var s=t;t.addEventListener(e,n,r),i=function(){return s.removeEventListener(e,n,r)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var c=t;t.on(e,n),i=function(){return c.off(e,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var u=t;t.addListener(e,n),i=function(){return u.removeListener(e,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var f=0,l=t.length;f<l;f++)a(t[f],e,n,o,r)}o.add(i)}},34797:function(t,e,n){n.d(e,{$:function(){return r}});var o=n(84928);function r(t,e){return e?new o.c((function(n){return e.schedule(i,0,{error:t,subscriber:n})})):new o.c((function(e){return e.error(t)}))}function i(t){var e=t.error;t.subscriber.error(e)}},68965:function(t,e,n){n.d(e,{H:function(){return r}});var o=n(66369);function r(t,e){return(0,o.ZZ)(t,e,1)}},69201:function(t,e,n){n.d(e,{p:function(){return i}});var o=n(72379),r=n(98899);function i(t,e){return function(n){return n.lift(new s(t,e))}}var s=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.predicate,this.thisArg))},t}(),c=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.predicate=n,r.thisArg=o,r.count=0,r}return o.C6(e,t),e.prototype.nt=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(r.v)},42365:function(t,e,n){n.d(e,{T:function(){return i}});var o=n(72379),r=n(98899);function i(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new s(t,e))}}var s=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.project,this.thisArg))},t}(),c=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.project=n,r.count=0,r.thisArg=o||r,r}return o.C6(e,t),e.prototype.nt=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(r.v)},66369:function(t,e,n){n.d(e,{ZZ:function(){return c}});var o=n(72379),r=n(42365),i=n(97203),s=n(98169);function c(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(o){return o.pipe(c((function(n,o){return(0,i.H)(t(n,o)).pipe((0,r.T)((function(t,r){return e(n,t,o,r)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new a(t,n))})}var a=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.project,this.concurrent))},t}(),u=function(t){function e(e,n,o){void 0===o&&(o=Number.POSITIVE_INFINITY);var r=t.call(this,e)||this;return r.project=n,r.concurrent=o,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return o.C6(e,t),e.prototype.nt=function(t){this.active<this.concurrent?this.gt(t):this.buffer.push(t)},e.prototype.gt=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this.bt(e)},e.prototype.bt=function(t){var e=new s.zA(this),n=this.destination;n.add(e);var o=(0,s.tS)(t,e);o!==e&&n.add(o)},e.prototype.rt=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this.nt(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(s.gn)},46788:function(t,e,n){n.d(e,{s:function(){return c}});var o=n(72379),r=n(98899),i=n(41771),s=n(26350);function c(t){return function(e){return 0===t?(0,s.I)():e.lift(new a(t))}}var a=function(){function t(t){if(this.total=t,this.total<0)throw new i.k}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.total))},t}(),u=function(t){function e(e,n){var o=t.call(this,e)||this;return o.total=n,o.count=0,o}return o.C6(e,t),e.prototype.nt=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(r.v)},68811:function(t,e,n){n.d(e,{V:function(){return i}});var o=n(84928),r=n(39292);function i(t,e){return new o.c((function(n){var o=new r.y,i=0;return o.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||o.add(this.schedule())):n.complete()}))),o}))}},83702:function(t,e,n){n.d(e,{S:function(){return s}});var o=n(84928),r=n(39292),i=n(44350);function s(t,e){if(!t)throw new Error("Iterable cannot be null");return new o.c((function(n){var o,s=new r.y;return s.add((function(){o&&"function"==typeof o.return&&o.return()})),s.add(e.schedule((function(){o=t[i.lJ](),s.add(e.schedule((function(){if(!n.closed){var t,e;try{var r=o.next();t=r.value,e=r.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),s}))}},37301:function(t,e,n){n.d(e,{x:function(){return s}});var o=n(84928),r=n(39292),i=n(86365);function s(t,e){return new o.c((function(n){var o=new r.y;return o.add(e.schedule((function(){var r=t[i.s]();o.add(r.subscribe({next:function(t){o.add(e.schedule((function(){return n.next(t)})))},error:function(t){o.add(e.schedule((function(){return n.error(t)})))},complete:function(){o.add(e.schedule((function(){return n.complete()})))}}))}))),o}))}},46723:function(t,e,n){n.d(e,{P:function(){return i}});var o=n(84928),r=n(39292);function i(t,e){return new o.c((function(n){var o=new r.y;return o.add(e.schedule((function(){return t.then((function(t){o.add(e.schedule((function(){n.next(t),o.add(e.schedule((function(){return n.complete()})))})))}),(function(t){o.add(e.schedule((function(){return n.error(t)})))}))}))),o}))}},52122:function(t,e,n){n.d(e,{c:function(){return l}});var o=n(37301),r=n(46723),i=n(68811),s=n(83702),c=n(1218),a=n(77027),u=n(91316),f=n(75702);function l(t,e){if(null!=t){if((0,c.l)(t))return(0,o.x)(t,e);if((0,a.y)(t))return(0,r.P)(t,e);if((0,u.X)(t))return(0,i.V)(t,e);if((0,f.x)(t)||"string"==typeof t)return(0,s.S)(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}},44350:function(t,e,n){function o(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(e,{lJ:function(){return r}});var r=o()},86365:function(t,e,n){n.d(e,{s:function(){return o}});var o=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},5656:function(t,e,n){n.d(e,{D:function(){return o}});var o=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},41771:function(t,e,n){n.d(e,{k:function(){return o}});var o=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}()},46624:function(t,e,n){n.d(e,{P:function(){return o}});var o=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}()},71106:function(t,e,n){n.d(e,{Z:function(){return o}});var o=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}()},32246:function(t,e,n){n.d(e,{H:function(){return r}});var o=n(98899);function r(t){for(;t;){var e=t,n=e.closed,r=e.destination,i=e.isStopped;if(n||i)return!1;t=r&&r instanceof o.v?r:null}return!0}},96120:function(t,e,n){function o(t){setTimeout((function(){throw t}),0)}n.d(e,{T:function(){return o}})},20894:function(t,e,n){function o(t){return t}n.d(e,{D:function(){return o}})},29899:function(t,e,n){n.d(e,{c:function(){return o}});var o=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}()},91316:function(t,e,n){n.d(e,{X:function(){return o}});var o=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t}},87004:function(t,e,n){function o(t){return"function"==typeof t}n.d(e,{T:function(){return o}})},1218:function(t,e,n){n.d(e,{l:function(){return r}});var o=n(86365);function r(t){return t&&"function"==typeof t[o.s]}},75702:function(t,e,n){n.d(e,{x:function(){return r}});var o=n(44350);function r(t){return t&&"function"==typeof t[o.lJ]}},76171:function(t,e,n){function o(t){return null!==t&&"object"==typeof t}n.d(e,{G:function(){return o}})},77027:function(t,e,n){function o(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}n.d(e,{y:function(){return o}})},21708:function(t,e,n){n.d(e,{m:function(){return r}});var o=n(20894);function r(t){return 0===t.length?o.D:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}},46067:function(t,e,n){n.d(e,{i:function(){return d}});var o=n(32866),r=n(46886),i=n(94361),s=n(65822),c=n(91316),a=n(77027),u=n(76171),f=n(44350),l=n(86365),d=function(t){if(t&&"function"==typeof t[l.s])return(0,s.X)(t);if((0,c.X)(t))return(0,o.v)(t);if((0,a.y)(t))return(0,r.F)(t);if(t&&"function"==typeof t[f.lJ])return(0,i.S)(t);var e=(0,u.G)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},32866:function(t,e,n){n.d(e,{v:function(){return o}});var o=function(t){return function(e){for(var n=0,o=t.length;n<o&&!e.closed;n++)e.next(t[n]);e.complete()}}},94361:function(t,e,n){n.d(e,{S:function(){return r}});var o=n(44350),r=function(t){return function(e){for(var n=t[o.lJ]();;){var r=void 0;try{r=n.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e}}},65822:function(t,e,n){n.d(e,{X:function(){return r}});var o=n(86365),r=function(t){return function(e){var n=t[o.s]();if("function"!=typeof n.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return n.subscribe(e)}}},46886:function(t,e,n){n.d(e,{F:function(){return r}});var o=n(96120),r=function(t){return function(e){return t.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,o.T),e}}},12071:function(t,e,n){n.d(e,{u:function(){return s}});var o=n(98899),r=n(5656),i=n(32547);function s(t,e,n){if(t){if(t instanceof o.v)return t;if(t[r.D])return t[r.D]()}return t||e||n?new o.v(t,e,n):new o.v(i.I)}},72379:function(t,e,n){n.d(e,{C6:function(){return r}});var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},o(t,e)};function r(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}},74555:function(t,e,n){n.d(e,{f:function(){return r}});class o{get isCancelled(){return this.vt}get timeoutInMs(){return this.St}get reason(){return this.Ht}cancel(){this.It(!1)}subscribe(t){this.vt?t():this.Ct.push(t)}constructor(t){this.vt=!1,this.Ht="",this.Ct=[],this.It=t=>{this.vt||(this.vt=!0,this.Ht=t?"timeout":"cancelled",this.Ct.map((t=>t())),this.Ct=[])},this.St=t,window.setTimeout((()=>this.It(!0)),t)}}function r(t){return new o(t)}},21872:function(t,e,n){var o;n.d(e,{Y:function(){return o}}),function(t){t.blurFocus="blurFocus",t.boot="boot",t.completeCreateNew="completeCreateNew",t.continueAccessibilityLoop="continueAccessibilityLoop",t.createNew="createNew",t.dispose="dispose",t.grabFocus="grabFocus",t.moveToFolder="moveToFolder",t.popState="popState",t.sendChannelId="sendChannelId",t.sendConvId="sendConvId",t.teamsUsersReply="teamsUsersReply",t.teamsUserMentionReply="teamsUserMentionReply",t.backButtonPressed="backButtonPressed",t.getClientUrl="getClientUrl",t.getWebUrl="getWebUrl",t.rename="rename",t.completeSharedFilePicker="completeSharedFilePicker",t.sendAccessToken="sendAccessToken",t.sendAuthToken="sendAuthToken",t.sendCustomAuthConfig="sendCustomAuthConfig",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendFrameTrustResult="sendFrameTrustResult",t.sendHWRTelemetry="sendHWRTelemetry",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.sendDavUrl="sendDavUrl",t.switchMode="switchMode",t.signalShared="signalShared",t.postWacToken="postWacToken"}(o||(o={}))},11706:function(t,e,n){var o;n.d(e,{_:function(){return o}}),function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(o||(o={}))},77860:function(t,e,n){var o;n.d(e,{V:function(){return o}}),function(t){t.AccessibilityLoopCompleted="AccessibilityLoopCompleted",t.ActionCompleted="ActionCompleted",t.BrowserEvent="BrowserEvent",t.CAAEMessage="CAAEMessage",t.Close="Close",t.InitEnd="InitEnd",t.Conversation="Conversation",t.CopyAndEdit="CopyAndEdit",t.CreateNewDocument="CreateNewDocument",t.Download="Download",t.Edit="Edit",t.Error="Error",t.FileEmbed="FileEmbed",t.FileProperties="FileProperties",t.FileRenamed="FileRenamed",t.FileVersions="FileVersions",t.FrameStateChanged="FrameStateChanged",t.FrameTrust="FrameTrust",t.GetAccessToken="GetAccessToken",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.GetWopiInfoFromUrl="GetWopiInfoFromUrl",t.GetDavUrlFromIds="GetDavUrlFromIds",t.ModeSwitched="ModeSwitched",t.MoveToFolder="MoveToFolder",t.OpenInMobileApp="OpenInMobileApp",t.OpenInBrowser="OpenInBrowser",t.OpenInClient="OpenInClient",t.PageChanged="PageChanged",t.PushState="PushState",t.Reboot="Reboot",t.RedeemForCommenting="RedeemForCommenting",t.RefreshSessionInfo="RefreshSessionInfo",t.ReplyWithChanges="ReplyWithChanges",t.ReportAbuse="ReportAbuse",t.SharedFilePicker="SharedFilePicker",t.SaveStatus="SaveStatus",t.Share="Share",t.ShareForm="ShareForm",t.SignIn="SignIn",t.SplashScreenShown="SplashScreenShown",t.UserAccessAndPermissions="UserAccessAndPermissions",t.UserActivity="UserActivity",t.UserEditActivity="UserEditActivity",t.Workflow="Workflow",t.ZoomChanged="ZoomChanged",t.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",t.LoadingStatus="LoadingStatus",t.SwitchNotebook="SwitchNotebook",t.FailedBootCheckFileInfo="FailedBootCheckFileInfo",t.GetTeamsUsers="GetTeamsUsers",t.SendTeamsUserMention="SendTeamsUserMention",t.NavigateBackToHost="NavigateBackToHost",t.GetClientUrlComplete="GetClientUrlComplete",t.GetWebUrlComplete="GetWebUrlComplete",t.CopyLinkComplete="CopyLinkComplete",t.SendConversationId="SendConversationId",t.CloseTeamsConversation="CloseTeamsConversation",t.PageLoaded="PageLoaded",t.FrameChanged="FrameChanged",t.PrintRedirect="PrintRedirect",t.RequestFullScreen="RequestFullScreen"}(o||(o={}))},31376:function(t,e,n){n.d(e,{Jf:function(){return f}});var o=n(75234),r=n(7867),i=n(82262),s=n(6365),c=n(32173),a=n(96699);const u=6e4;function f(t){const e=new i.x(t);function n(t,n,r,i){const c=(0,a.Wv)();if((0,s.D)(t))return;const u={timestamp:(0,a.u_)(),category:n,tag:t,level:r,type:o.F.Trace,message:i,correlationId:""};e.addLoggingTime((0,a.Wv)()-c),e.handleTrace(u)}return{ULS:{sendTraceTag:(t,e,o,r)=>{n(t,e,o,r)},shipAssertTag:(t,e,o,i)=>{o&&n(t,e,r.k.Error,i)},debugAssertTag:(t,e,n,o)=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:e.flush,flushOnClose:e.flushOnClose,setCorrelationId:()=>{}},configure:t=>{e.configure(t)},settingsChangeHandler:t=>{(0,s.S)(t.yt.getValue(c.b.At,""),t.yt.getValue(c.b.Ut,"")),e.configure({uploadCadenceInMs:t.yt.getValue(c.b.Tt,u)});const n=t.yt.getValue(c.b.Pt,"").toString();""!==n&&e.flushAndSetNewEndpoint(n)},getTimeSpentLogging:()=>e.getTimeSpentLogging(),getUserSessionId:()=>e.getUserSessionId(),flushAndSetNewEndpoint:(t,n)=>{e.flushAndSetNewEndpoint(t,n)},updateEndpointAndFlush:t=>{e.updateEndpointAndFlush(t)}}}},82262:function(t,e,n){n.d(e,{x:function(){return a}});var o=n(79166),r=n(20664),i=n(7867),s=n(96699),c=n(18179);class a{getTimeSpentLogging(){return this.Et}addLoggingTime(t){this.Et+=t}configure(t){const e=(0,s.Wv)();if(t.uploadCadenceInMs&&(this.kt=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.Nt=t.uploadTriggerSize),t.sessionId&&(this.Ft=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.Dt)throw new Error("Remote ULS endpoint is already set");this.Dt=this.Wt(t.remoteUlsEndpoint),this.Ot=(0,s.u_)(),this.$t()}this.Et+=(0,s.Wv)()-e}handleTrace(t){const e=(0,s.Wv)();t.message.length>3072&&(t.message=t.message.substring(0,3059)+"... [Trimmed]"),this._t.push(t),(this._t.length>this.Nt||t.level===i.k.Error)&&this.$t(),this.Et+=(0,s.Wv)()-e}getUserSessionId(){return this.Ft}constructor(t){this.kt=3e4,this.Nt=30,this.jt=0,this._t=[],this.Ot=(0,s.u_)(),this.Bt=[],this.Ft="",this.Et=0,this.flushOnClose=()=>{this.Lt(!1,!1)},this.flush=()=>{this.$t()},this.flushAndSetNewEndpoint=(t,e)=>{const n=this.Wt(t);n.localeCompare(this.Dt??"",void 0,{sensitivity:"accent"})&&(this.Bt.push((()=>{this.Dt=n,e&&e()})),this.Lt(!0,!0))},this.updateEndpointAndFlush=t=>{this.Dt=this.Wt(t),this.Lt(!0,!0)},this.Wt=t=>t+"?usid="+this.Ft+"&officeserverversion="+(0,c.qS)(),this.$t=()=>{window.setTimeout((()=>this.Lt(!0,!0)),0)},this.Lt=(t,e)=>{const n=(0,s.Wv)();if(window.clearTimeout(this.Kt),this.Dt){if(this._t.length>0){this.jt+=1;const n=this._t.splice(0,t?this.Nt:this._t.length),i=(0,o.I)(n,this.Ft,this.jt,this.Ot);(0,r.X)(i,this.Dt,e),this.Ot=(0,s.u_)()}0===this._t.length&&this.Bt.length>0&&(this.Bt.forEach((t=>{"requestIdleCallback"in window?window.requestIdleCallback(t):window.setTimeout(t,0)})),this.Bt=[]),t&&(this.Kt=window.setTimeout((()=>{this.$t()}),this._t.length>this.Nt||this.Bt.length>0?1e3:this.kt)),this.Et+=(0,s.Wv)()-n}},t&&this.configure(t)}}},6365:function(t,e,n){n.d(e,{D:function(){return i},S:function(){return s}});let o,r=[];function i(t){return 1===r[t]}function s(t,e){o&&e===o||(r=[],o=e,t&&t.split(",").forEach((t=>{const e=parseInt(t,10);e&&(r[e]=1)})))}},32173:function(t,e,n){var o;n.d(e,{b:function(){return o}}),function(t){t.Gt="BootstrapperMaxUlsHeartbeatTime",t.Vt="BootstrapperNoCompleteWarning1Time",t.qt="BootstrapperNoCompleteWarning2Time",t.Jt="BootstrapperNoCompleteWarning3Time",t.Ut="RemoteUlsETag",t.At="RemoteUlsSuppressions",t.zt="BootstrapperSettingsFetchPeriod",t.Zt="timestamp",t.Qt="BootstrapperUlsHeartbeatIntervalMs",t.Xt="BootstrapperUlsHeartBeatIsEnabled",t.Tt="BootstrapperUlsUploadCadenceMs",t.Yt="WordConsumptionViewToEditRedirectIsEnabled",t.te="RequestedCallThrottlingDefaultToViewMinimumValue",t.Pt="BulsEndpointUrl",t.ee="EnableCommonHostDiagnosticsParams",t.ne="EnableICNForWord",t.oe="EnableModernEmbedViewForPowerPoint",t.re="EnableModernEmbedViewInOneUpForPowerPoint",t.ie="EnableModernEmbedViewForPowerPointGlobalAppUrl",t.se="EnableModernReadingViewForPowerPoint",t.ce="EnableDefaultToModernForPowerPoint",t.ae="ShouldLogJsApiKpisForWord",t.ue="WordSwitchToViewInTeamsJsapiV1Enabled",t.fe="EnableWordSessionRefreshTelemetry",t.le="PowerPointUseEssDCHint",t.de="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",t.he="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",t.pe="ModernEmbedViewForPowerPointEnabledPercentage",t.me="PowerPointESSCookieLookbackThresholdHour",t.we="PowerPointSetESSCookieLookbackExpEnabled",t.ge="ExcelForceViewOnlyInTeamsJsapiV1",t.be="EnableWordSessionRefreshLoggingCleanup",t.ve="WordRefreshTelemetryExpirationInDays"}(o||(o={}))},31625:function(t,e,n){var o;n.d(e,{VG:function(){return s}}),function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.TeamsElectron=6]="TeamsElectron",t[t.Unknown=7]="Unknown"}(o||(o={}));const r=window.navigator,i=r?r.userAgent:void 0;function s(){return!!i&&i.indexOf("iPhone")>=0||/android.+mobile/i.test(r.userAgent)}},18179:function(t,e,n){n.d(e,{qS:function(){return r}});const o={BUILD_NUMBER:"###VERSION###",BUILD_NUMBER_MINOR:-1};function r(){try{return o.BUILD_NUMBER}catch(t){return o.BUILD_NUMBER}}},16424:function(t,e,n){n.d(e,{O:function(){return r}});var o=n(59744);function r(){const t=new Uint8Array(31),e=function(t){const e={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){e.crypto=!0;try{return n.getRandomValues(t),e}catch(t){e.exceptions.push(`crypto: ${(0,o.M5)(t)}`)}}e.perfNow=!0;for(let n=0;n<t.length;n+=1){try{let t=Math.floor(100*window.performance.now())%10;(t<0||t>9)&&(t=0);for(let e=0;e<t;e+=1)Math.random()}catch(t){e.exceptions.push(`Math.random: ${(0,o.M5)(t)}`)}t[n]=Math.floor(16*Math.random())}return e}(t);let n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const o=15&t[n];return n+=1,("x"===e?o:3&o|8).toString(16)})),e]}},96699:function(t,e,n){function o(){return window.performance.now()}function r(){return Math.round(window.performance.now()+window.performance.timeOrigin)}function i(t){Array.isArray(t)?t.forEach((t=>{window.performance.mark(t)})):window.performance.mark(t)}n.d(e,{Wv:function(){return o},l8:function(){return i},u_:function(){return r}})},59744:function(t,e,n){function o(t){if(!t)return"";const e=Object.getOwnPropertyNames(t),n=Object.getOwnPropertyNames(Object.getPrototypeOf(t));return JSON.stringify(t,[...e,...n])}n.d(e,{M5:function(){return o}})},85504:function(t,e,n){function o(t){const e=t.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return e&&e[1]?e[1]:"public"}n.d(e,{dH:function(){return o}})},37506:function(t,e,n){n.d(e,{z:function(){return i}});var o=n(16896),r=n(77712);class i{logKpiUsage(t,e,n,o){const s=this.getKpiKey(t+i.USAGE_KPI,n?.extendedProperties),c=()=>this.recordKpiUsage(t,e,n,s);if(this.kpiUsageEventBlocker.isEventBlocked(s,c))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(n),c(),0!==o){const t=o??5*r.NF;this.kpiUsageEventBlocker.blockEvent(s,t)}return!0}logKpiFailure(t,e,n,o,s){const c=this.getKpiKey(t+i.FAILURE_KPI+e,n?.additionalValues?.extendedProperties);"number"==typeof n?.additionalValues?.durationMs&&this.kpiFailureEventBlocker.aggregateEventDuration(c,n.additionalValues.durationMs);const a=()=>this.recordKpiFailure(t,e,n,c);if(this.kpiFailureEventBlocker.isEventBlocked(c,a))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),a(),o&&this.recordQosError(o.errorNameOverride??e,o.name,o),0!==s){const t=s??5*r.NF;this.kpiFailureEventBlocker.blockEvent(c,t)}return!0}logKpiSuccess(t,e,n){const o=this.getKpiKey(t+i.SUCCESS_KPI,e?.additionalValues?.extendedProperties);"number"==typeof e?.additionalValues?.durationMs&&this.kpiSuccessEventBlocker.aggregateEventDuration(o,e.additionalValues.durationMs);const s=()=>this.recordKpiSuccess(t,e,o);if(this.kpiSuccessEventBlocker.isEventBlocked(o,s))return!1;if(this.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(),s(),0!==n){const t=n??5*r.NF;this.kpiSuccessEventBlocker.blockEvent(o,t)}return!0}ensureFeatureDenominatorLoggedAndVetoPillarRegistered(t){const e=this.featureConfig.topLevelKpiName,n=this.getKpiKey(this.featureConfig.topLevelKpiName,t?.extendedProperties);if(this.kpiUsageEventBlocker.isEventBlocked(n??""))return;this.recordKpiUsage(e,o.v.FailureBased,t);const s=this.featureConfig.vetoPillar??this.featureConfig.areaName;s&&i.QOS_PILLARS_LIST.includes(s)&&this.healthLogger.addQosPillar(s),this.kpiUsageEventBlocker.blockEvent(n??"",r.x8)}recordKpiUsage(t,e,n={},o){const{extendedProperties:r,isForAlertableKpi:i}=n||{},s=this.createExtendedPropertiesWithMoreFields(r,o);i?this.healthLogger.recordKpiUsageForAlertableKpi(t,this.featureConfig.crewAlias,s):this.healthLogger.recordKpiUsage(t,e,this.featureConfig.crewAlias,s)}getKpiKey(t,e){const n=this.getKpiAreaName(e),o=this.getKpiFeatureName(e),r=this.getKpiPivot(e);return`${n}.${o}.${t??""}${r&&0!==r.length?"."+r:""}`}getKpiAreaName(t){return t?.get(i.AREA_NAME_COLUMN_KEY)??this.featureConfig.areaName??this.featureConfig.vetoPillar??""}getKpiFeatureName(t){return t?.get(i.FEATURE_NAME_COLUMN_KEY)??this.featureConfig.featureName??""}getKpiPivot(t){const e=t?.get(i.PIVOT_TYPE_COLUMN_KEY),n=t?.get(i.PIVOT_VALUE_COLUMN_KEY);return e&&0!==e.length&&n&&0!==n.length?`${e}=${n}`:""}recordKpiFailure(t,e,n={},o){const{isIntentional:r,isInternal:i,additionalValues:s,hasImpliedUsage:c}=n||{},a=this.createAdditionalValuesWithMoreFields(s,o);!1===c?this.healthLogger.recordKpiFailure(t,e,r,i,a):this.healthLogger.recordKpiImpliedFailure(t,e,r,i,this.featureConfig.crewAlias,a)}recordKpiSuccess(t,e={},n){const{additionalValues:o,hasImpliedUsage:r}=e||{},i=this.createAdditionalValuesWithMoreFields(o,n);!1===r?this.healthLogger.recordKpiSuccess(t,i):this.healthLogger.recordKpiImpliedSuccess(t,this.featureConfig.crewAlias,i)}recordQosError(t,e,n={}){const{isIntentional:o,isInternal:r,alertOnPillar:i,isSessionEndingError:s,additionalValues:c}=n,a=this.createAdditionalValuesWithMoreFields(c);this.healthLogger.recordQosError(t,[e],o,r,i,s,a)}createExtendedPropertiesWithMoreFields(t,e){const n=new Map(t||new Map);if(n.get(i.FEATURE_NAME_COLUMN_KEY)||n.set(i.FEATURE_NAME_COLUMN_KEY,this.getKpiFeatureName(t)),n.set(i.AREA_NAME_COLUMN_KEY,this.getKpiAreaName(n)),n.has(i.SKIP_ARIA_COLUMN_KEY)||n.has("skipAria")||n.set(i.SKIP_ARIA_COLUMN_KEY,"true"),!this.featureConfig.doNotEmitAggregatedCount&&e){const t=this.getEventBlocker(e);if(t){const o=t.getEventHitCount(e);if(o){n.set(i.AGGREGATED_COUNT_COLUMN_KEY,o.toString());const r=t.getEventDurations(e);o>1&&r&&n.set(i.AGGREGATED_DURATION_COLUMN_KEY,r.map((t=>Math.round(100*t)/100)).toString())}}}return n}createAdditionalValuesWithMoreFields(t,e){let n={};return n={...t},n.extendedProperties=this.createExtendedPropertiesWithMoreFields(t?.extendedProperties,e),n}getEventBlocker(t){return t.includes(i.USAGE_KPI)?this.kpiUsageEventBlocker:t.includes(i.FAILURE_KPI)?this.kpiFailureEventBlocker:t.includes(i.SUCCESS_KPI)?this.kpiSuccessEventBlocker:void 0}constructor(t,e,n,o,r){this.healthLogger=t,this.featureConfig=e,this.kpiUsageEventBlocker=n,this.kpiFailureEventBlocker=o,this.kpiSuccessEventBlocker=r}}i.FEATURE_NAME_COLUMN_KEY="FeatureName",i.AREA_NAME_COLUMN_KEY="AreaName",i.AGGREGATED_COUNT_COLUMN_KEY="AggCount",i.AGGREGATED_DURATION_COLUMN_KEY="AggMs",i.SKIP_ARIA_COLUMN_KEY="SkipAria",i.PIVOT_TYPE_COLUMN_KEY="PivotType",i.PIVOT_VALUE_COLUMN_KEY="PivotValue",i.QOS_PILLARS_LIST=["Interruptions","Open","NotebookNavigation","Fidelity","AsyncCollab","Present","ContentConsumption","bSqmCompatibility","Boot"],i.USAGE_KPI=".Usage",i.SUCCESS_KPI=".Success",i.FAILURE_KPI=".Failure."},77712:function(t,e,n){n.d(e,{NF:function(){return r},TF:function(){return o},x8:function(){return i}});class o{isEventBlocked(t,e){const n=this.blockedEvents.get(t);return!!n&&(Date.now()>=n?(this.unblockEvent(t),!1):(this.aggregateEventCount(t),e&&(this.eventCallbacks.set(t,e),this.scheduleAndFlushCallbacks()),!0))}scheduleAndFlushCallbacks(){void 0===this.batchTimerId&&this.eventCallbacks.size>0&&(this.batchTimerId=window.setTimeout((()=>{const t=Date.now(),e=[];this.eventCallbacks.forEach(((n,o)=>{const r=this.blockedEvents.get(o);r&&t>=r&&(n(),e.push(o))}));for(const t of e)this.blockedEvents.delete(t),this.eventCallbacks.delete(t);this.batchTimerId=void 0,this.scheduleAndFlushCallbacks()}),1e4))}blockEvent(t,e){const n=Date.now()+e;this.blockedEvents.set(t,n),this.updateEventHitCount(t,0),this.eventDurations.delete(t),this.eventDurationsTotal.delete(t)}unblockEvent(t){this.blockedEvents.delete(t)}getEventHitCount(t){return this.eventHitCounts.get(t)}updateEventHitCount(t,e){this.eventHitCounts.set(t,e)}aggregateEventCount(t){let e=this.getEventHitCount(t);"number"==typeof e&&this.updateEventHitCount(t,++e)}getEventDurations(t){return this.eventDurations.get(t)}aggregateEventDuration(t,e){const n=(this.getEventHitCount(t)??0)+1,o=this.eventDurationsTotal.get(t),r=this.eventDurations.get(t);if(void 0!==r){const i=[...r];let s;r[0]>e&&(i[0]=e),r[1]<e&&(i[1]=e),void 0!==o&&o.length<10?(o.push(e),s=o.reduce(((t,e)=>t+e),0)/n):(s=r[2]+(e-r[2])/n,this.eventDurationsTotal.delete(t)),i[2]=s,this.eventDurations.set(t,i)}else this.eventDurations.set(t,[e,e,e]),this.eventDurationsTotal.set(t,[e])}constructor(){this.blockedEvents=new Map,this.eventCallbacks=new Map,this.eventHitCounts=new Map,this.eventDurations=new Map,this.eventDurationsTotal=new Map,this.batchTimerId=void 0}}const r=6e4,i=60*r*24},16896:function(t,e,n){n.d(e,{v:function(){return o}});var o,r=n(18227);!function(t){t[t.FailureBased=0]="FailureBased",t[t.SuccessBased=1]="SuccessBased"}(o||(o={})),new r.n},6385:function(t,e,n){n.d(e,{g:function(){return s}});var o=n(16896),r=n(37506),i=n(77712);class s{static getInstance(t,e,n,o,r){return new s(t,e,n,o,r)}logKpiUsage(t){return!(!t||!t.kpiName)&&this.featureUsageAndHealthLogger.logKpiUsage(t.kpiName,t.kpiType??o.v.FailureBased,t.optionalProperties,t.blockFutureEmissionDurationInMs)}logKpiFailure(t){return!!(t&&t.kpiName&&t.errorName)&&this.featureUsageAndHealthLogger.logKpiFailure(t.kpiName,t.errorName,t.optionalProperties,t.optionalVeto,t.blockFutureEmissionDurationInMs)}logKpiSuccess(t){return!(!t||!t.kpiName)&&this.featureUsageAndHealthLogger.logKpiSuccess(t.kpiName,t.optionalProperties,t.blockFutureEmissionDurationInMs)}ensureFeatureDenominatorLoggedAndVetoPillarRegistered(t){this.featureUsageAndHealthLogger.ensureFeatureDenominatorLoggedAndVetoPillarRegistered(t)}constructor(t,e,n,i,c){this.healthLogger=t,this.featureConfig=e,this.kpiUsageEventBlocker=n,this.kpiFailureEventBlocker=i,this.kpiSuccessEventBlocker=c,this.featureUsageAndHealthLogger=new r.z(this.healthLogger,this.featureConfig,this.kpiUsageEventBlocker??s.kpiUsageBlocker,this.kpiSuccessEventBlocker??s.kpiFailureBlocker,this.kpiFailureEventBlocker??s.kpiSuccessBlocker),this.executeCallbackWithLogging=(t,e)=>{const n=t=>"VetoFailureLoggingParams".includes(t);let r,i;e?.kpiUsageLoggingParams?(r="Usage",i=e?.kpiUsageLoggingParams):e?.kpiSuccessLoggingParams?(r="UsageWithSuccess",i=e?.kpiSuccessLoggingParams):e?.kpiFailureLoggingParams?(r="UsageWithFailure",i=e?.kpiFailureLoggingParams):(r="UsageWithVetoFailure",i=e?.vetoFailureLoggingParams);const s=i?.usageName,c=i?.usageKpiType;this.logKpiUsage({kpiName:s,kpiType:c??o.v.FailureBased});try{t?.(),"UsageWithSuccess"===r&&"KpiSuccessLoggingParams".includes(i)&&this.logKpiSuccess({kpiName:s,optionalProperties:i.successOptionalProperties})}catch(t){if("UsageWithFailure"===r&&"KpiFailureLoggingParams".includes(i)||"UsageWithVetoFailure"===r&&n(i)){let t;n(i)&&(t={name:i.vetoName??"",...i.vetoOptionalProperties}),this.logKpiFailure({kpiName:i.usageName,errorName:i.failureErrorName,optionalProperties:i.failureOptionalProperties,optionalVeto:t})}throw t}}}}s.kpiUsageBlocker=new i.TF,s.kpiFailureBlocker=new i.TF,s.kpiSuccessBlocker=new i.TF},11741:function(t,e,n){n.d(e,{Xk:function(){return l}});var o,r,i,s,c,a=n(32677),u=n(29834),f=n(16896);!function(t){t[t.BSqmError=0]="BSqmError",t[t.Kpi=1]="Kpi",t[t.QosError=2]="QosError",t[t.QosPillar=3]="QosPillar",t[t.DiagnosticLog=4]="DiagnosticLog",t[t.OfflineWorkerInit=5]="OfflineWorkerInit",t[t.OfflineWorkerFlush=6]="OfflineWorkerFlush",t[t.OfflineWorkerFailedUpload=7]="OfflineWorkerFailedUpload"}(o||(o={})),function(t){t.HealthDimensions="d",t.PartCDimensions="a",t.BSqmErrors="b",t.QosErrors="e",t.Heartbeat="h",t.QosPillars="q",t.Kpis="k",t.DiagnosticLogs="l",t.ClientSendTime="t"}(r||(r={})),function(t){t[t.AttemptToUseFunctionalityBeforeIitialization=0]="AttemptToUseFunctionalityBeforeIitialization",t[t.WorkerApiIsNotAvailable=1]="WorkerApiIsNotAvailable",t[t.InvalidWorkerUrl=2]="InvalidWorkerUrl",t[t.InstallingOfflineWorker=3]="InstallingOfflineWorker",t[t.OfflineWorkerMessage=4]="OfflineWorkerMessage",t[t.FailedToProcessMessageFromOfflineWorker=5]="FailedToProcessMessageFromOfflineWorker",t[t.FailedToInstallOfflineWorker=6]="FailedToInstallOfflineWorker",t[t.InitializedHealth=7]="InitializedHealth",t[t.BatchesOfHealthEventsInIndexedDB=8]="BatchesOfHealthEventsInIndexedDB",t[t.IndexedDbTransactionFailed=9]="IndexedDbTransactionFailed",t[t.InstalledOfflineWorker=10]="InstalledOfflineWorker",t[t.IndexedDdIsNotSupported=11]="IndexedDdIsNotSupported",t[t.GetAllKeysIsNotSupported=12]="GetAllKeysIsNotSupported",t[t.FailedToProcessMessage=13]="FailedToProcessMessage",t[t.FailedToLoadWorkerScript=14]="FailedToLoadWorkerScript",t[t.FailedToSendEventToWorker=15]="FailedToSendEventToWorker",t[t.FailedToJsonStringifyEvent=16]="FailedToJsonStringifyEvent",t[t.IndexedDbEntryIsNotAnObject=17]="IndexedDbEntryIsNotAnObject"}(i||(i={})),function(t){t[t.AttemptedToAddOrUpdatePartCDimension=0]="AttemptedToAddOrUpdatePartCDimension",t[t.AttemptedToRecordBSqmQosError=1]="AttemptedToRecordBSqmQosError",t[t.AttemptedToRecordSessionEndingQosError=2]="AttemptedToRecordSessionEndingQosError",t[t.AttemptedToSetAppOnlineStatus=3]="AttemptedToSetAppOnlineStatus",t[t.AttemptedToUpdatePartADimensions=4]="AttemptedToUpdatePartADimensions"}(s||(s={})),function(t){t[t.SendSucceeded=0]="SendSucceeded",t[t.SendFailed=1]="SendFailed",t[t.DidNotAttempt=2]="DidNotAttempt"}(c||(c={}));class l{static getInstance(t=!1){return l.Se&&!t||(l.Se=new l),this.Se}initialize(t){if(t)try{return this.He=function(t){return{Ie:t.dimensions??void 0,Ce:t.heartbeatIntervalMs??3e5,ye:t.isHealthEnabled??!1,Ae:t.isOfflineEnabled??!1,Ue:t.isErrorPartCEnabled??!1,Te:t.isFetchApiEnabled??!1,Pe:t.loggerMaxIntervalMs??3e4,Ee:t.loggerMaxQueueSize??25,ke:t.offlineWorkerUrl??"",Ne:t.absoluteRemoteTelemetryUrlForOfflineWorker??"",Fe:t.recordPillarToWarmPipelineIntervalMs??864e5,Re:t.remoteTelemetryUrl??"",De:t.maxConcurrentRetries??3,We:t.retryMaxAttempts??3,Oe:t.retryDelayMs??15e3,Me:t.disabledHealthEvents??new Set}}(t),this._e(),this.je(),this.Be(),this.Le=!0,void this.xe(i.InitializedHealth)}catch(t){}this.Le=!1}addOrUpdatePartCDimension(t,e){this.Ke(s.AttemptedToAddOrUpdatePartCDimension)&&t&&(this.Ge.hasOwnProperty(t)&&this.Ge[t]===e||(this.Ve(!0),this.Ge[t]=e,this.qe+=1,this.Je(),this.ze()))}addOrUpdateErrorPartCDimension(t,e){this.He.Ue&&t&&(this.Ze[t]=e)}addQosPillar(t){if(t){const e=0===this.Qe.length;-1===this.Qe.indexOf(t)&&(this.Qe.push(t),this.Xe(t,!1),this.Ye(e))}}recordBsqmQosError(t,e,n){if(this.Ke(s.AttemptedToRecordBSqmQosError)&&(this.tn(!1),this.ze(),t)){const r={b:t,v:e,d:n?.durationMs,p:(0,u.v6)(n?.extendedProperties),s:this.Qe,i:n?.inStaging};this.en(o.BSqmError,r,t),this.shutdown(!0)}}recordKpiFailure(t,e,n,o,r){this.nn(t,!0,a.z.Failure,r,e,o,n)}recordKpiImpliedFailure(t,e,n,o,r,i){this.nn(t,!1,a.z.ImpliedUsageFailure,i,e,o,n,f.v.FailureBased,!1,r)}recordKpiImpliedSuccess(t,e,n){this.nn(t,!1,a.z.ImpliedUsageSuccess,n,void 0,void 0,void 0,f.v.FailureBased,!1,e)}recordKpiSuccess(t,e){this.nn(t,!0,a.z.Success,e)}recordKpiUsage(t,e,n,o){this.nn(t,!1,a.z.Usage,{extendedProperties:o},void 0,void 0,void 0,e,!1,n)}recordKpiUsageForAlertableKpi(t,e,n){if(!t)return;let o=!0;const r=this.rn[t];r&&(o=r.t===f.v.FailureBased),this.nn(t,!1,a.z.Usage,{extendedProperties:n},void 0,void 0,void 0,f.v.FailureBased,!0,e),o&&this.sn()}recordQosErrorForCopilot(t,e,n,o,r,i,s,c){const a=c?{...c}:{};a.extendedProperties=a.extendedProperties?{...a.extendedProperties}:new Map,a.extendedProperties.set("Copilot.InteractionId",t),this.recordQosError(e,n,o,r,i,s,a)}recordQosError(t,e,n,r,i,c,a){if((!c||this.Ke(s.AttemptedToRecordSessionEndingQosError))&&t&&e){const s={n:t,x:n,z:r,l:i,v:e,e:c,d:a?.durationMs,p:(0,u.v6)(a?.extendedProperties),s:this.Qe,i:a?.inStaging};this.en(o.QosError,s,t),c&&(this.tn(!1),this.ze(),this.shutdown(!0))}}removeQosPillar(t){if(!t)return;const e=this.Qe.indexOf(t);e>-1&&(this.Qe.splice(e,1),this.Ye(!1)),0===this.Qe.length&&this.cn()}resumeAllHealthTimers(){if(this.un&&!this.fn&&this.ln(),0===this.dn&&0!==this.hn){const t=Date.now()-this.hn;t>=this.He.Fe||t<=0?this.pn():this.mn(this.He.Fe-t)}}setHandlerForIsAppShuttingDown(t){t&&(this.wn=t)}setIsAppOnline(t){this.Ke(s.AttemptedToSetAppOnlineStatus)&&(!this.vn&&t&&this.Sn?.postMessage({t:o.OfflineWorkerFlush,v:this.wn()}),this.vn=t)}shutdown(t=!1){this.He.ye&&(this.Hn(),this.tn(!1),this.wn=()=>!0,this.In(),(!t||t&&this.vn)&&this.Sn?.terminate())}stopAllHealthTimers(){this.tn(!0)}tn(t){this.fn=!1,this.Cn=-1,0!==this.yn&&(window.clearTimeout(this.yn),this.yn=0),this.cn(),t&&this.In()}updatePartADimensions(t){if(!t||!this.Ke(s.AttemptedToUpdatePartADimensions))return;let e=!1;Object.keys(t).forEach((n=>{void 0!==t[n]&&null!==t[n]&&""!==t[n]&&this.He.Ie[n]!==t[n]&&(this.He.Ie[n]=t[n],e=!0)})),e&&(this.Ve(),this._e(),this.qe+=1,this.Je(),this.ze())}flushAndSetNewEndpoint(t,e){t.localeCompare(this.He.Re??"",void 0,{sensitivity:"accent"})&&(this.Ve(!1),this.He.Re=t,e&&e())}constructor(){this.Ge={},this.Ze={},this.An=[],this.Ie={},this.qe=0,this.He={Ce:3e5,ye:!1,Ae:!1,Ue:!1,Pe:3e4,Ee:25,ke:"",Fe:864e5,Re:"",Ne:"",De:3,We:3,Oe:15e3,Me:new Set,Te:!1},this.un=!1,this.Cn=-1,this.fn=!1,this.yn=0,this.vn=!0,this.wn=()=>!1,this.rn={},this.Un=[],this.Tn=0,this.Pn=0,this.En=void 0,this.Nn=[],this.Fn=[],this.Rn=[],this.Dn=[],this.Wn=0,this.hn=0,this.dn=0,this.Qe=[],this.On=!1,this.$n=0,this.Le=!1,this.Hn=()=>{this.Wn&&(window.clearTimeout(this.Wn),this.Wn=0)},this._n=()=>{this.Un=[],this.Nn=[],this.Fn=[],this.En=void 0,this.Rn=[],this.Dn=[],this.Tn=0,this.Pn=0},this.In=()=>{try{if(this.Tn<=0)return;const t=this.jn();this.He.Te?this.Bn(t,this.qe,this.He.We):this.Ln(t,this.qe,this.He.We),this._n()}catch(t){}},this.jn=()=>({d:this.Ie,a:this.xn(),b:this.Un,e:this.Fn,h:this.En,q:this.Rn,k:this.Nn,l:this.Dn,type:"h_v2"}),this.xn=()=>this.He.Ue&&(this.Un&&this.Un.length>0||this.Fn&&this.Fn.length>0)&&Object.keys(this.Ze).length>0?{...this.Ge,...this.Ze}:this.Ge,this.en=(t,e,n,r=!1)=>{if(e&&!this.He.Me.has(n))if(this.vn){switch(t){case o.BSqmError:this.Un.push(e);break;case o.Kpi:this.Nn.push(e);break;case o.QosError:this.Fn.push(e);break;case o.QosPillar:-1===this.Rn.map((t=>t.n)).indexOf(e.n)&&this.Rn.push(e);break;case o.DiagnosticLog:this.Dn.push(e)}if(this.Tn+=1,t!==o.DiagnosticLog&&t!==o.QosPillar&&(this.Pn+=1),this.wn()&&!r)return void this.In();this.Tn>=this.He.Ee&&(this.Hn(),this.Ve())}else e.o=(new Date).toJSON(),this.Sn?.postMessage({t,k:`${this.Ie.w}.${this.qe}`,m:this.Ie,c:this.xn(),v:e})},this.je=()=>{this.Hn(),this.Wn=window.setTimeout((()=>{this.Ve()}),this.He.Pe)},this.Ve=(t=!1)=>{t&&this.Pn<=0||(this.In(),this.je())},this.Je=()=>{if(!this.Qe&&!this.rn)return;this.En&&-1!==this.Cn||(this.Cn=(this.Cn+1)%1e3),this.En||(this.Tn+=1);const t={p:this.En?(0,u.VY)(this.En.p,this.Qe):this.Qe,k:this.En?(0,u.VY)(this.En.k,this.An):this.An,i:this.He.Ce,o:this.Cn};this.En=t},this.nn=(t,e,n,r,i,s,c,a,f,l)=>{if(!t||e&&!this.rn[t])return;e||this.Kn(t,a,f,l);const d=this.rn[t],h={n:d.k,e:n,t:d.t,a:d.a,f:d.o,d:r?.durationMs,p:(0,u.v6)(r?.extendedProperties)};if(i){const t={n:i,x:c,z:s};h.k=t}this.en(o.Kpi,h,t)},this._e=()=>{const t=this.He.Ie;t&&(this.Ie={a:t.application??void 0,b:t.applicationLcid??void 0,c:t.applicationMode??void 0,d:t.applicationModeExtended??void 0,e:t.arrVersion??void 0,f:t.browser??void 0,g:t.browserLcid??void 0,h:t.browserMajorVersion??void 0,i:t.browserVersion??void 0,j:t.clientVersion??void 0,k:t.datacenter??void 0,l:t.dataCulture??void 0,m:t.flightsImpressionId??void 0,n:t.host??void 0,o:t.isAnonymousUser??void 0,p:t.isBusinessUser??void 0,q:t.isEduUser??void 0,r:t.isSynthetic??void 0,s:t.loggableUserId??void 0,t:t.loggableUserIdSpace??void 0,u:t.ring??void 0,v:t.serverDocId??void 0,w:t.session_id??void 0,x:t.sessionOrigin??void 0,y:t.tenantId??void 0,z:t.uiHost??void 0,aa:t.wfeVersion??void 0,ab:t.fileExtension??void 0,ac:t.uiHostIntegrationType??void 0,ad:t.osVersion??void 0,af:t.networkDownlink??void 0,ag:t.networkDownlinkMax??void 0,ah:t.networkEffectiveType??void 0,ai:t.networkRTT??void 0,aj:t.networkSaveData??void 0,ak:t.networkType??void 0,al:t.userLicenseType??void 0})},this.ln=()=>{this.Je(),this.yn=window.setTimeout((()=>{this.ln()}),this.He.Ce)},this.ze=()=>{this.Qe&&this.Qe.forEach((t=>{t&&this.Xe(t,!0)}))},this.Xe=(t,e)=>{const n={};n.n=t,this.en(o.QosPillar,n,t,e)},this.pn=()=>{this.Qe&&(this.hn=Date.now(),this.ze()),this.mn()},this.mn=(t=this.He.Fe)=>{this.dn=window.setTimeout((()=>{this.pn()}),t)},this.sn=()=>{this.un||(this.un=!0,this.fn=!0,this.ln())},this.cn=()=>{0!==this.dn&&(window.clearTimeout(this.dn),this.dn=0)},this.Be=()=>{if(this.He.ye&&this.He.Ae&&this.He.Ne&&""!==this.He.Ne&&this.He.ke&&""!==this.He.ke)try{if("undefined"==typeof Worker)return void this.xe(i.WorkerApiIsNotAvailable);if(!this.He.ke)return void this.xe(i.InvalidWorkerUrl);this.xe(i.InstallingOfflineWorker);const t=new Blob([`try{importScripts('${encodeURI(this.He.ke)}');}catch(e){self.postMessage({i:14,l:'W',r:e.toString()})}`],{type:"application/javascript"});this.Sn=new Worker(URL.createObjectURL(t)),this.Sn.onmessage=t=>{try{const e=t.data;this.xe(e.i,e.r)}catch(t){this.xe(i.FailedToProcessMessageFromOfflineWorker,t.toString())}},this.Sn.postMessage({t:o.OfflineWorkerInit,v:this.He.Ne}),this.Sn.postMessage({t:o.OfflineWorkerFlush})}catch(t){this.xe(i.FailedToInstallOfflineWorker,t.toString())}},this.Gn=(t,e)=>{if(t.b.length>0||t.e.length>0||t.q.length>0||t.k.length>0||t.l.length>0)try{return this.Sn?.postMessage({t:o.OfflineWorkerFailedUpload,k:`${t.d.w}.${e}`,v:t}),c.SendSucceeded}catch(t){const e=this.Vn(t);return this.xe(i.FailedToSendEventToWorker,e),c.SendFailed}return c.DidNotAttempt},this.Kn=(t,e,n,o)=>{t&&void 0!==e&&(this.rn[t]||(this.rn[t]={k:t,t:e,a:!0===n,o:o??void 0},n&&(this.An.push(t),this.Je())))},this.Ye=t=>{this.Cn=-1,t?(this.hn=Date.now(),this.mn(),this.sn()):this.Je()},this.Ke=t=>!!this.Le||(this.xe(i.AttemptToUseFunctionalityBeforeIitialization,t?.toString()),!1),this.Ln=(t,e,n)=>{if(!t)return;const o=this.He.Re;if(""===o)return;if(this.On&&(n<=0||!this.vn)&&this.Gn(t,e)!==c.SendFailed)return;if(n<=0)return;const r=this.qn(t,!1);if(null===r)return;if(this.wn())try{if(void 0!==navigator.sendBeacon){if(r.length>=65536&&this.He.Ue){const e={...t,a:this.Ge},n=this.qn(e,!0);if(null===n)return;navigator.sendBeacon(o,n)}else navigator.sendBeacon(o,r);return}}catch(t){}const i=new XMLHttpRequest;i.open("POST",o,!0),i.onreadystatechange=()=>{i.readyState===XMLHttpRequest.DONE&&(200===i.status?this.On||(this.On=!0):this.$n<this.He.De?(this.$n+=1,window.setTimeout((()=>{this.$n-=1,this.Ln(t,e,n-1)}),this.He.Oe)):this.On&&this.Gn(t,e))},i.send(r)},this.xe=(t,e)=>{const n={i:t,r:e};this.en(o.DiagnosticLog,n,t.toString())},this.Vn=t=>{let e;return"string"==typeof t?e=t:t instanceof Error&&(e=t.name+" "+t.message,t.stack&&(e+=" "+t.stack)),e},this.qn=(t,e)=>{try{return(0,u.sX)(t)}catch(t){let n=this.Vn(t);return n="ModifiedPayload: "+e+" | "+n,this.xe(i.FailedToJsonStringifyEvent,n),null}},this.Bn=(t,e,n)=>{if(!t)return;const o=this.He.Re;if(""===o)return;if(this.On&&(n<=0||!this.vn)){if(this.Gn(t,e)!==c.SendFailed)return;if(n<=0)return}const r=this.qn(t,!1);if(null!==r){if(this.wn())try{if(r.length>=65536&&this.He.Ue){const e={...t,a:this.Ge},n=this.qn(e,!0);if(null===n)return;fetch(new Request(o,{method:"POST",body:n,keepalive:!0})).catch((()=>{}))}else fetch(new Request(o,{method:"POST",body:r,keepalive:!0})).catch((()=>{}));return}catch(t){}fetch(new Request(o,{method:"POST",body:r})).then((o=>{o.ok?this.On||(this.On=!0):this.$n<this.He.De?(this.$n+=1,globalThis.setTimeout((async()=>{this.$n-=1,this.Bn(t,e,n-1)}),this.He.Oe)):this.On&&this.Gn(t,e)})).catch((t=>{}))}}}}},18227:function(t,e,n){n.d(e,{n:function(){return i}});var o=n(11741),r=n(6385);class i{getHealthInstance(t){if(t)return o.Xk.getInstance().initialize(t),o.Xk.getInstance()}getExtendedHealthInstance(t,e){if(t&&e)return r.g.getInstance(t,e)}}},32677:function(t,e,n){var o;n.d(e,{z:function(){return o}}),function(t){t[t.Failure=0]="Failure",t[t.ImpliedUsageFailure=1]="ImpliedUsageFailure",t[t.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",t[t.Success=3]="Success",t[t.Usage=4]="Usage"}(o||(o={}))},29834:function(t,e,n){function o(t){if(!t)return;const e={};return t.forEach(((t,n)=>{n&&(e[n]=t)})),e}function r(t){return JSON.stringify(t)}function i(t,e){const n=[],o=new Set;return t.concat(e).forEach((t=>o.add(t))),o.forEach((t=>n.push(t))),n}n.d(e,{VY:function(){return i},sX:function(){return r},v6:function(){return o}})},97326:function(t,e,n){var o;n.d(e,{n:function(){return o}}),function(t){t[t.Jn=0]="msoulscat_ES_EWAJS",t[t.zn=1]="msoulscat_ES_EWAJSGrid",t[t.Zn=6]="msoulscat_ES_EWAJSChart",t[t.Qn=202]="msoulscat_MSOSP_FileMenuCommands",t[t.Xn=220]="msoulscat_MSOSP_AddInCommands",t[t.Yn=225]="msoulscat_MSOSP_OTelJS",t[t.eo=227]="msoulscat_MSOSP_OTelJSInWebWoker",t[t.no=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",t[t.oo=301]="msoulscat_Wac_WordViewer",t[t.ro=306]="msoulscat_Wac_BrowserGeneral",t[t.io=320]="msoulscat_Wac_TaskPane",t[t.so=339]="msoulscat_Wac_OneNoteGeneral",t[t.co=340]="msoulscat_Wac_Ribbon",t[t.ao=356]="msoulscat_Wac_WacFeedback",t[t.uo=379]="msoulscat_Wac_WopiPendingApplication",t[t.fo=383]="msoulscat_Wac_Telemetry",t[t.lo=391]="msoulscat_Wac_WacCatchUpActivities",t[t.do=394]="msoulscat_Wac_Dictation",t[t.ho=395]="msoulscat_Wac_OneNoteSync",t[t.po=700]="msoulscat_Wac_VisioApp",t[t.mo=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.wo=800]="msoulscat_Wac_PptAnimation",t[t.bo=833]="msoulscat_Wac_PptLive",t[t.vo=834]="msoulscat_Wac_PptMWeb",t[t.So=835]="msoulscat_Wac_PptGc2General",t[t.Ho=836]="msoulscat_Wac_PptGc2GraphicHost",t[t.Io=837]="msoulscat_Wac_PptGc2Operation",t[t.Co=852]="msoulscat_Wac_PptGc2EditCanvas",t[t.yo=844]="msoulscat_Wac_PptDataSync",t[t.Ao=848]="msoulscat_Wac_PptFluidRuntime",t[t.Uo=815]="msoulscat_Wac_PptShape",t[t.To=817]="msoulscat_Wac_PptSession",t[t.Po=830]="msoulscat_Wac_PptSlideshow",t[t.Eo=822]="msoulscat_Wac_PptView",t[t.ko=846]="msoulscat_Wac_PptVideos",t[t.No=1303]="msoulscat_Uci_Insights",t[t.Fo=2300]="msoulscat_Wac_VersionHistory",t[t.Do=302]="msoulscat_Wac_WordPresence",t[t.Wo=3e3]="msoulscat_Wac_OAuth",t[t.Oo=3005]="msoulscat_Wac_WordVersionHistory",t[t.Mo=3006]="msoulscat_Wac_LivePersonaCard",t[t.$o=3012]="msoulscat_Wac_CatchUpFlyout",t[t._o=3016]="msoulscat_Wac_WordDesigner",t[t.jo=3021]="msoulscat_Wac_ModernFontPicker",t[t.Bo=3027]="msoulscat_Wac_UnifiedUiHost",t[t.Lo=3033]="msoulscat_Wac_EquationTools",t[t.xo=1401]="msoulscat_Osf_Latency",t[t.Ko=1402]="msoulscat_Osf_Notification",t[t.Go=1403]="msoulscat_Osf_Runtime",t[t.Vo=3041]="msoulscat_Wac_AiMaker",t[t.qo=3043]="msoulscat_Wac_AiRewrite",t[t.Jo=3044]="msoulscat_Wac_AiInsert",t[t.zo=3047]="msoulscat_Wac_AiSummarize",t[t.Zo=3048]="msoulscat_Wac_CopilotCompose",t[t.Qo=3049]="msoulscat_Wac_Skittles",t[t.Xo=3050]="msoulscat_Wac_CopilotChat",t[t.Yo=3051]="msoulscat_Wac_Syntex",t[t.tr=3052]="msoulscat_Wac_WireGraph",t[t.er=3053]="msoulscat_Wac_CshCopilot",t[t.nr=3055]="msoulscat_Wac_CopilotProactiveSummary",t[t.rr=3056]="msoulscat_Wac_CopilotProactiveShared",t[t.ir=3057]="msoulscat_Wac_CopilotCursor",t[t.sr=3059]="msoulscat_Wac_WasmGeneral",t[t.cr=3060]="msoulscat_Wac_WasmTextLayout",t[t.ar=3061]="msoulscat_Wac_WasmSmartArt",t[t.ur=3062]="msoulscat_Wac_WasmClient",t[t.lr=3063]="msoulscat_Wac_WasmNative",t[t.dr=4e3]="msoulscat_AIHub_CreateModuleTelemetry"}(o||(o={}))},75234:function(t,e,n){var o;n.d(e,{F:function(){return o}}),function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(o||(o={}))},7867:function(t,e,n){var o;n.d(e,{k:function(){return o}}),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Important=20]="Important",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(o||(o={}))},79166:function(t,e,n){function o(t,e,n,o){const i=[],s=t.map((t=>function(t,e,n){const o={};if(o.G=t.tag,o.T=t.timestamp-e,o.M=t.message,o.C=t.category,t.correlationId){let e=n.findIndex((e=>e===t.correlationId));e<0&&(e=n.push(t.correlationId)-1),o.I=e}const i=t.type*r+t.level;return o.D=i,o}(t,o,i))),c=function(t,e,n,o,r){const i={};return i.T=t,i.L=e,i.S=n,i.I=o,r&&r.length>0&&(i.W=r),i.V=1,i}(o,s,e,n,i);return JSON.stringify(c)}n.d(e,{I:function(){return o}});const r=1e3},20664:function(t,e,n){function o(t,e,n){if(!e)return;const o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(e,t)}catch{}!function(t,e,n){const o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",e,n),o.send(t))}(t,e,n)}n.d(e,{X:function(){return o}})},64383:function(t,e,n){n.d(e,{hr:function(){return v}});var o=n(97326),r=n(7867),i=n(96699),s=n(84928),c=n(44739),a=n(27474),u=n(6439),f=n(34624),l=n(82743),d=n(35587),h=n(5840),p=n(77045),m=n(17935),w=n(99602),g=n(97887),b=n(83754);function v(t,e,n,v,S,H,I,C,y){const{loadFunctionSubject:A,documentBootInfo:U,correlationId:T,wopiFetchData:P={wopiHostData:void 0,fetchDiagnostics:void 0}}=t,{fileType:E,wdOrigin:k,puid:N,uiCulture:F,dataCulture:R,clickTime:D,rebootOverrideData:W}=U,{wopiHostData:O,fetchDiagnostics:M}=P,$=n?.logger,_=n?.health;if(!(O&&O.wac&&O.wac.bootstrapperUrl&&O.wac.applicationUrl)){const t=new Map([["WopiHostDataPresent",`${!!O}`],["WopiWacDataPresent",`${!!O?.wac}`]]),e=JSON.stringify(Array.from(t.entries())),n={wacErrorName:a.R7.pr,qosErrorName:a.by.QosError_VroomWopiFailure,errorMessage:e};return $?.ULS.sendTraceTag(554964098,o.n.Bo,r.k.Info,`${a.R7.pr}: Failed to get wopi data for the item, ${e}`),void(v&&v(n))}const j=C||O.wac.bootstrapperUrl,B=y,L=O.wac.applicationUrl;O.wac.userId&&_?.updatePartADimensions({loggableUserId:O.wac.userId});const x=new Promise(((t,e)=>{setTimeout((()=>e("jsApi timed out after 60 seconds")),6e4)})),K=new Promise((async(t,C)=>{A.subscribe((()=>t("jsApi successfully loaded")));const y=(t,w)=>{let v;const C=(0,b.Mt)(O,L,e?.uiHostName??"UUIH",U,e?.uiEmbed),y=(0,g.Tf)(C,$),P=(0,b.PS)(E,e?.featureGates,$),B=(0,f.SI)(f.dT.FeatureGate_EnableSingleOwlJsapiLogger,e?.featureGates);n?.bootDiagnostics&&(n.bootDiagnostics.perfJsapiTiming=n.bootDiagnostics.perfJsapiTiming||(0,u.Rt)(E)),P?(_?.addOrUpdatePartCDimension("JsApiVersion","V2"),v=({container:u,flushTime:g})=>new s.c((s=>{const v=(0,l.I)(U,j,e,n,O),A=d.W.isCreateNewFlowExecuting&&d.W.application?d.W.application:t.createApplication(v),P={hostSessionId:T,logger:B?$:void 0},E=d.W.isCreateNewFlowExecuting&&d.W.session?d.W.session:A.createSession(P);H&&H(A,O,U,E),!(0,f.SI)("UseNewEuplReporting",e?.featureGates)&&S&&S();const N={appUrl:C,file:{name:O.fileName,getUrl:O.wac?.fileGetUrl||O.downloadUrl,urlNoAuth:O.wac?.fileUrlNoAuth??"",size:O.fileSize,downloadCode:O.downloadCode,eTag:O.eTag,...U.docId&&{uniqueId:U.docId,immutableReason:n?.fileImmutableReason},supportsZipIt:n?.supportsZipIt},customFontCatalogUrl:O.wac.customFontCatalogUrl,contentBundle:{majorVersion:O.bundleVersion?Number(O.bundleVersion):0,url:O.bundleUrl??"",bundleUrlNoAuth:O.bundleUrlNoAuth??"",bundleCode:O.bundleCode,staleness:O.bundleStaleness||0},newFileTemplate:U.newFileTemplate,container:u,wopi:{source:O.wac.wopiSrc,accessToken:O.wac.accessToken,expiry:parseInt(O.wac.accessTokenExpiry,10),wacToken:n?.wacToken},bootParams:{readOnly:O.readOnly,irmEnabled:O.irmEnabled,supportsDecryptedContentDownload:O.protectionEnabled,viewOnly:O.blocksDownload,disableChat:!0,openViewByDefault:"view"===U.intent,dataLanguage:R},diagnostics:n?.bootDiagnostics?.legacyPerformanceData?{...(0,b.ch)(n?.bootDiagnostics?.legacyPerformanceData.host),...(0,b.wh)(D,g,k,M,w.performance,n,U.isNewFile,e?.featureGates),legacyPerformanceData:n?.bootDiagnostics?.legacyPerformanceData}:(0,b.VS)(D,g,k,M,w.performance,n,U.isNewFile,e?.featureGates),sessionContext:y||(0,b.uU)(),preseededSession:{key:O.preSeededSessionKey,id:O.preSeededWacSessionId},wdParams:{...U.templateId&&{wdTpl:U.templateId},...W&&W.lcid&&{wdlcid:W.lcid}||U.uiCulture&&{wdlcid:U.uiCulture},...(0,b.aT)(U.wdValue),...n?.previousSession&&{wdPreviousSession:n?.previousSession},...n?.previousSessionSrc&&{wdPreviousSessionSrc:n?.previousSessionSrc}},hostGeneratedSessionId:n?.sessionId,meeting:n?.meeting,rebootOverride:W,throttling:{protection:O.wac?.clientThrottlingProtection,request:O.wac?.requestedCallThrottling}};(0,i.l8)(h.ls.OwlWacBootStart);const F=(0,f.SI)(f.dT.FeatureGate_OwlPostWacTokenForTeamsHosts,e?.featureGates);F&&((0,p.iz)(!!N.wopi.wacToken),N.wopi.wacToken&&(_?.recordKpiSuccess(a.ex.KPI_OwlPostWacTokenForTeams,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV2"]])}),$?.ULS.sendTraceTag(507347489,o.n.Bo,r.k.Important,"WAC token has been fetched before calling jsapi boot"))),(d.W.isCreateNewFlowExecuting?d.W.completeCreateNewPromise:E.boot(N,I)).then((t=>{if("success"===t.completion)s.next({wopiHostData:O,officeApplication:A,bootedDocumentInfo:new c.t(U),officeDocumentSession:E,wacBootDiagnostics:E?.diagnostics?.appInitDiagnostics}),s.complete();else if("cancelled"===t.completion)F&&_?.recordKpiFailure(a.ex.KPI_OwlPostWacTokenForTeams,t.completion,!0,!1,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV2"],["status","cancelled"]])}),$?.ULS.sendTraceTag(509646293,o.n.Bo,r.k.Info,"User cancelled document session boot");else{let e,n=t.completion;if(F&&_?.recordKpiFailure(a.ex.KPI_OwlPostWacTokenForTeams,t.completion,!1,!1,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV2"],["status","failed"]])}),"timeout"===t.completion)e=a.R7.mr,t.timeoutStage&&(n+="_"+t.timeoutStage);else switch(t.errorSource){case"app":e=a.R7.wr;break;case"jsapi":e=a.R7.gr;break;default:e=a.R7.br}const i={wacErrorName:e,qosErrorName:a.by.QosError_EncounteredJsApiError,errorMessage:n,error:t.error,documentLoadedWithTabSwitch:!!t.documentLoadedWithTabSwitch},c=(0,m.C)(i),u=JSON.stringify(Array.from(c.entries()));$?.ULS.sendTraceTag(575419404,o.n.Bo,r.k.Error,u),s.error(i)}})).catch((t=>$?.ULS.sendTraceTag(512337547,o.n.Bo,r.k.Error,`officeDocumentSession.boot threw error: ${t}`)))}))):(_?.addOrUpdatePartCDimension("JsApiVersion","V1"),v=({container:u,flushTime:l})=>new s.c((s=>{const d=(0,b.Xl)(O?O.wac.userId:N,T,F,R,e,n,(0,b.aT)(U.wdValue),y),h=(0,b.TB)(U,O),g=(0,b.VS)(D,l,k,M,w.performance,n,U.isNewFile,e?.featureGates),v=e?.uiHostName,H=(0,b.K7)({...O.wac,wacToken:n?.wacToken}),I=(0,b.ND)(u,w,H,d,h,g,((t,e)=>{s.next({wopiHostData:O,officeApplication:t,bootedDocumentInfo:new c.t(U),wopiPendingApp:P,wacBootDiagnostics:e}),s.complete()}),(t=>{const e=t.errorObject.message,n={wacErrorName:a.R7.vr,qosErrorName:a.by.QosError_EncounteredJsApiError,errorName:t.errorType,errorMessage:e,error:t},i=(0,m.C)(n),c=JSON.stringify(Array.from(i.entries()));$?.ULS.sendTraceTag(575419405,o.n.Bo,r.k.Error,c),s.error(n)}),v,U,O,e?.showCloseButton,e?.supportsShare,e?.openInBrowserEnabled,e?.ellipsisDownloadACopyButtonEnabled,e?.copyLinkEnabled,e?.uiEmbed,e?.supportsHostUiControls,e?.conversationButtonEnabled,n?.additionalApplicationParameters),C=(0,i.u_)();$?.ULS.sendTraceTag(576578583,o.n.Bo,r.k.Info,"BootStrapFile: About to call InitializeWopiPending");const A=(0,f.SI)(f.dT.FeatureGate_OwlPostWacTokenForTeamsHosts,e?.featureGates);A&&((0,p.iz)(!!H.WacToken),H.WacToken&&(_?.recordKpiSuccess(a.ex.KPI_OwlPostWacTokenForTeams,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV1"]])}),$?.ULS.sendTraceTag(507347488,o.n.Bo,r.k.Important,"WAC token has been fetched before calling jsapi initializeWopiPending")));const P=t.Application.InitializeWopiPending(I,void 0,n?.sessionId),E=(0,i.u_)()-C;$?.ULS.sendTraceTag(570775769,o.n.Bo,r.k.Info,`BootStrapFile: InitializeWopiPending returned. [IsValidWopiPendingApp: ${!!P}][TimeElapsed: ${E}]`);const W=(0,i.u_)();if(P){S&&S(),P.Complete(H);const t=(0,i.u_)(),e=t-W,n=t-C;$?.ULS.sendTraceTag(570775770,o.n.Bo,r.k.Info,`BootStrapFile: Complete returned.[TimeElapsedInComplete: ${e}][TimeElapsedSinceInitializeWopiPending: ${n}]`)}else{const t={wacErrorName:a.R7.Sr,qosErrorName:a.by.QosError_EncounteredJsApiError,errorMessage:"WOPI pending failed"};A&&_?.recordKpiFailure(a.ex.KPI_OwlPostWacTokenForTeams,t.errorMessage,!1,!1,{extendedProperties:new Map([["scenario","postWacTokenBeforeBootJsapiV1"],["status","failed"]])});const e=(0,m.C)(t),n=JSON.stringify(Array.from(e.entries()));s.error(t),$?.ULS.sendTraceTag(575419406,o.n.Bo,r.k.Error,n)}}))),A.next(v),A.complete()};if(d.W.isTwoStepCreateNew&&d.W.bootstrapperLoadPromise)d.W.bootstrapperLoadPromise.then((t=>{t?y(d.W.bootstrapper,d.W.bootstrapperInfo):$?.ULS.sendTraceTag(507778322,o.n.Bo,r.k.Warning,"Office bootstrapper failed to load for 2-step create new, check previous logs for more details")})).catch((t=>$?.ULS.sendTraceTag(507778321,o.n.Bo,r.k.Error,`Encountered error loading Office bootstrapper for 2-step create new: ${t}`)));else{const t=(0,f.SI)(f.dT.FeatureGate_EnableJsapiTags,e?.featureGates);(0,f.lO)(f.dT.FeatureGate_EnableJsapiTags,t,$),(0,w.k)(j,O.wac.applicationUrl,E,!0,n?.wiseEnvironment,$,B,n?.owlRollout?.includes("LOCALHOST"),t).then((t=>{const[e,n]=(0,w.K)(E);if(!n&&e)y(e,t);else{const t=n??`Error message undefined. BootStrapped not loaded: ${!e}`;$?.ULS.sendTraceTag(575419403,o.n.Bo,r.k.Error,t);const i={wacErrorName:a.R7.Hr,qosErrorName:a.by.QosError_OfficeBootstrapperNotLoaded,errorMessage:t,error:n,inStaging:!1};v&&v(i)}})).catch((t=>{C(t)}))}}));Promise.race([x,K]).catch((t=>{const e=(t??"Failed to load the document")+`, bootstrapperUrl: ${j.replace(/^https?:\/\//,"")}`,n={wacErrorName:a.R7.Sr,qosErrorName:a.by.QosError_FailedToLoadDocument,errorMessage:e,error:t,inStaging:!1};$?.ULS.sendTraceTag(575419407,o.n.Bo,r.k.Error,`${a.R7.Sr}: ${e}`),v&&v(n)}))}},72470:function(t,e,n){n.d(e,{e:function(){return c}});var o=n(96699),r=n(97326),i=n(7867),s=n(97887);function c(t,e,n,a=!1,u=!1,f=1,l=!1,d=!1,h=!1){const p=(0,o.u_)();return(0,o.l8)("wopiDataStartTime"),e(t,a,u,n,d,h).then((e=>{if(!e){const t="Graph call failed";return n?.ULS.sendTraceTag(553726284,r.n.Bo,i.k.Error,`GetWopiData: Failed to get the driveItem. [ErrorMessage: ${t}]`),Promise.reject(t)}const c={docUrl:e.webDavUrl??t.docUrl,driveId:e?.parentReference?.driveId??t.driveId,docId:e?.id??t.docId,fileName:e.name};n?.ULS.sendTraceTag(553726285,r.n.Bo,i.k.Info,`GetWopiData: Fetched documentIdentifier. [IsValid: ${!!c}]`);const a=(0,s.Z1)(e,n);n?.ULS.sendTraceTag(553726287,r.n.Bo,i.k.Info,`GetWopiData: Getting WopiHostData from drive item. [IsValid: ${!!a}]`);const u={startTime:p,endTime:(0,o.u_)()};return(0,o.l8)("wopiDataEndTime"),{documentIdentifier:c,wopiHostData:a,fetchDiagnostics:u}})).catch((o=>(n?.ULS.sendTraceTag(520729472,r.n.Bo,i.k.Warning,`GetWopiData: General getWopiData error. [Message: ${o?.message}][FailureReason: ${o?.failure}][Status: ${o?.status}]`),f>0&&o?.retry?(n?.ULS.sendTraceTag(544306772,r.n.Bo,i.k.Error,`GetWopiData: Retrying getWopiData. [Message: ${o?.message}][FailureReason: ${o?.failure}][Status: ${o?.status}]`),new Promise((t=>{const e=function(t){if(0===t)throw new Error("Retry count should not be 0");return 1===t?window.crypto.getRandomValues(new Uint32Array(1))[0]%291+10:10}(f);setTimeout(t,e),n?.ULS.sendTraceTag(508035599,r.n.Bo,i.k.Warning,`GetWopiData: Retrying getWopiData with ${f} retries left. Delaying retry for ${e}ms.`)})).then((()=>c(t,e,n,a,u,f-1,l,d))).catch((t=>(n?.ULS.sendTraceTag(508035598,r.n.Bo,i.k.Error,`GetWopiData: Failed to delay retry getWopiData. [Error: ${t.message}]`),Promise.reject(t))))):f>0&&l&&"accessDenied"===o?.errorCode?new Promise((t=>{setTimeout(t,3e3),n?.ULS.sendTraceTag(523269073,r.n.Bo,i.k.Warning,`GetWopiData: Retrying getWopiData after retryIntervalForWopiDataRequest: 3000ms. [Error: ${JSON.stringify(o)}][FailureReason: ${o?.failure}]`)})).then((()=>c(t,e,n,a,u,0,l,d))):(n?.ULS.sendTraceTag(544306773,r.n.Bo,i.k.Error,`GetWopiData: Not retrying getWopiData. [ShouldRetry: ${f>0}][FailureReason: ${o?.failure??o?.message}]`),Promise.reject(o)))))}},99602:function(t,e,n){n.d(e,{K:function(){return f},k:function(){return u}});var o=n(96699),r=n(97326),i=n(7867),s=n(96793),c=n(86804);let a;async function u(t,e,n,l=!0,d,h,p,m,w){a||(a=new Map);const g=a.get(n);if(g)return g;const b=new Promise((async(g,b)=>{const v=(0,o.u_)(),S=document.getElementById(`${n}_bootstrapper`);if(S){const[c,a]=f(n);!a&&c||await new Promise(((t,e)=>{S.onload=()=>{t()},S.onerror=()=>{e("JSAPI script failed to load in parallel with OWL")}})).catch((()=>{h?.ULS.sendTraceTag(507531682,r.n.Bo,i.k.Error,`JSAPI failed to load ${s.p[n]} bootstrapper in parallel with OWL`),b("JSAPI script failed to load in parallel with OWL")}));const u=(0,o.u_)();return h?.ULS.sendTraceTag(507531681,r.n.Bo,i.k.Important,`JSAPI script successfully loaded for ${s.p[n]} with OWL`),g({bootstrapperUrl:t,applicationUrl:e,performance:{startTime:v,endTime:u}})}(0,c.b)(t,(()=>{const c=(0,o.u_)();h?.ULS.sendTraceTag(507834582,r.n.Bo,i.k.Important,`JSAPI fetch succeeded for ${s.p[n]} bootstrapper. OnRetry: false`),g({bootstrapperUrl:t,applicationUrl:e,performance:{startTime:v,endTime:c}})}),(async()=>{if(l)try{await function(t,e,n,o,r,i,s){if(a?.delete(n),o&&"PRODUCTION"===o){const c=new URL(t);return c.hostname="wise-backup.public.onecdn.static.microsoft",u(c.toString(),e,n,!1,o,void 0,r,i,s)}return u(t,e,n,!1,o,void 0,r,i,s)}(t,e,n,d,p,m);const c=(0,o.u_)();h?.ULS.sendTraceTag(507834581,r.n.Bo,i.k.Important,`JSAPI fetch succeeded for ${s.p[n]} bootstrapper. OnRetry: true`),g({bootstrapperUrl:t,applicationUrl:e,performance:{startTime:v,endTime:c}})}catch{h?.ULS.sendTraceTag(507834580,r.n.Bo,i.k.Error,`JSAPI fetch failed for ${s.p[n]} bootstrapper. OnRetry: true`),b("Load bootstrapper script failed")}else h?.ULS.sendTraceTag(507834579,r.n.Bo,i.k.Error,`JSAPI fetch failed for ${s.p[n]} bootstrapper. OnRetry: false`),b("Load bootstrapper script failed")}),!1,`${s.p[n]}_bootstrapper`,w,l,p,m,w)}));return a.set(n,b),b}function f(t){const e=window.Microsoft;if(void 0===e)return[void 0,"Microsoft is undefined"];const n=e.Office,o=s.p[t];return n&&n[o]?[n[o],void 0]:[void 0,`Failed to find bootstrapper for app: ${o}`]}},66366:function(t,e,n){n.d(e,{Az:function(){return m},d$:function(){return p}});var o=n(21872),r=n(3045),i=n(34797),s=n(27474),c=n(35587),a=n(29819),u=n(62940),f=n(64383),l=n(72470),d=n(97887);let h;function p(t){return h?`${t}.${h.size}`:t}function m(t,e,n,m,w,g,b=!1,v,S,H,I,C){if(h||(h=new Map),!t.isNewFile||!t.createNewInfo&&!t.isTwoStepCreateNew){const n=(0,d.x9)(t);if(!n)return{correlationId:e,bootstrapperObservable:(0,i.$)("Not enough document information was provided"),fileNamePromise:Promise.reject("No name was provided"),applicationUrlPromise:Promise.reject("No applicationUrl")};const o=h.get(n);if(o)return o}return function(t,e,n,i,h,m,w=!1,g,b,v,S,H){const I=p(e),C=h?.logger,y=new r.h,A=H??f.hr;if(!c.W.isTwoStepCreateNew||!c.W.hostSessionId||!h?.createNewParams){const e=(0,l.e)(t,n,C,w,!(!t.isNewFile&&!t.templateId),1,!!h?.meeting,!0);e.then((e=>{A({documentBootInfo:{...t,...e.documentIdentifier},correlationId:I,loadFunctionSubject:y,wopiFetchData:e},i,h,m,g,b,v,S?.get(t.fileType)?.jsApiUrl,S?.get(t.fileType)?.jsApiSri)})).catch((e=>{if(c.W.isTwoStepCreateNew&&c.W.session&&c.W.session.run(o.Y.completeCreateNew,{state:"failure",reason:"wopiFetchFailed"},v),m){const n=JSON.stringify(e),o={wacErrorName:s.R7.Ir,qosErrorName:s.by.QosError_VroomWopiFailure,errorMessage:n,error:e,httpErrorCode:e.status,networkError:(0,a.TX)(e)};m(o,t)}}));const r={correlationId:I,bootstrapperObservable:y.asObservable(),fileNamePromise:t.fileName?Promise.resolve(t.fileName):e.then((t=>t.wopiHostData.fileName)),applicationUrlPromise:new Promise(((t,n)=>{e.then((e=>t(e?.wopiHostData?.wac?.applicationUrl))).catch((t=>{n(t)}))}))};return h&&h.wiseEnvironment&&(0,u.t)(r.applicationUrlPromise,h.wiseEnvironment,C,h.health,h.sessionId),r}A({documentBootInfo:t,correlationId:I,loadFunctionSubject:y,wopiFetchData:(0,d.Rk)(h.createNewParams,t)},i,h,m,g,b,v,S?.get(t.fileType)?.jsApiUrl);const U={correlationId:c.W.hostSessionId,bootstrapperObservable:y.asObservable(),fileNamePromise:Promise.resolve(t.fileName),applicationUrlPromise:Promise.resolve(h?.createNewParams?.appUrl)};return h&&h.wiseEnvironment&&(0,u.t)(U.applicationUrlPromise,h.wiseEnvironment,C,h.health,h.sessionId),U}(t,e,n,m,w,g,b,v,S,H,I,C)}},97887:function(t,e,n){n.d(e,{Rk:function(){return l},Tf:function(){return d},Z1:function(){return u},lW:function(){return f},x9:function(){return a}});var o=n(97326),r=n(7867),i=n(96793),s=n(35587),c=n(83754);function a(t){return t.shareUrl?t.shareUrl:t.docId&&t.driveId?`${t.driveId}_${t.docId}`:t.docUrl?t.docUrl:t.isNewFile&&t.fileName?`${t.fileName}_${i.p[t.fileType]}`:t.baseUrl&&t.fileId?`${t.baseUrl}_${t.fileId}`:void 0}function u(t,e){const n=!!t?.openWith,i=!!t?.openWith?.wac;return e?.ULS.sendTraceTag(553916429,o.n.Bo,r.k.Info,`GetWopiHostDataFromItem: [ValidOpenWith: ${n}][ValidWac: ${i}]`),{bundleStaleness:t.officeBundle?t.officeBundle.bundleStaleness:0,bundleUrl:t.officeBundle?t.officeBundle.url:"",bundleCode:t.officeBundle?t.officeBundle.bundleCode:"",bundleUrlNoAuth:t.officeBundle?t.officeBundle.bundleUrlNoAuth:"",bundleVersion:t.officeBundle?t.officeBundle.version:"",sharepointSiteUrl:t.sharepointIds?t.sharepointIds.siteUrl:"",downloadUrl:t["@content.downloadUrl"]||t["@microsoft.graph.downloadUrl"],downloadCode:t["@content.downloadCode"],eTag:t.eTag,fileName:t.name,fileSize:t.size,irmEnabled:t.file?.contentSensitivityLabelProtected||t.file?.irmEffectivelyEnabled||t.sensitivityLabel?.protectionEnabled||t.file?.irmEnabled,protectionEnabled:t.sensitivityLabel?.protectionEnabled||t.file?.contentSensitivityLabelProtected,isNewFile:!1,readOnly:t.currentUserRole&&t.currentUserRole.readOnly,blocksDownload:t.currentUserRole&&t.currentUserRole.blocksDownload,wac:t.openWith.wac,sharePointInfo:{...t.sharepointIds},webUrl:t.webUrl,preSeededSessionKey:t?.wacSession?.preSeededSessionKey,preSeededWacSessionId:t?.wacSession?.preSeededWacSessionId,webDavUrl:t.webDavUrl,restUrl:t.openWith.wopi?.editUrl||t.openWith.wac?.applicationUrl}}function f(t,e,n,o,r){if(!t.appUrl)throw new Error("appUrl must be provided in CreateNewParams");return{appUrl:(0,c.Mt)(void 0,t.appUrl,o?.uiHostName||"OWL-2-step-create-new",e,o?.uiEmbed),file:{name:t.file?.name,getUrl:t.file?.getUrl,size:t.file?.size,eTag:t.file?.eTag,...e.docId&&{uniqueId:e.docId,immutableReason:r?.fileImmutableReason}},customFontCatalogUrl:t.customFontCatalogUrl,contentBundle:{majorVersion:t.contentBundle?.majorVersion?Number(t.contentBundle?.majorVersion):0,url:t.contentBundle?.url??"",staleness:t.contentBundle?.staleness||0},newFileTemplate:e.newFileTemplate,container:n,bootParams:{readOnly:t.bootParams?.readOnly,irmEnabled:t.bootParams?.irmEnabled,supportsDecryptedContentDownload:t.bootParams?.supportsDecryptedContentDownload,viewOnly:t.bootParams?.viewOnly,disableChat:!0,openViewByDefault:"view"===e.intent,dataLanguage:e.dataCulture,isNewFile:e.isNewFile},diagnostics:r?.bootDiagnostics?.legacyPerformanceData?{...(0,c.ch)(r?.bootDiagnostics?.legacyPerformanceData.host),...(0,c.wh)(e.clickTime,0,e.wdOrigin,void 0,s.W.bootstrapperInfo?.performance,r,e.isNewFile,o?.featureGates),legacyPerformanceData:r?.bootDiagnostics?.legacyPerformanceData}:(0,c.VS)(e.clickTime,0,e.wdOrigin,void 0,s.W.bootstrapperInfo?.performance,r,e.isNewFile,o?.featureGates),sessionContext:d(t.appUrl)||(0,c.uU)(),preseededSession:{key:t.preseededSession?.key,id:t.preseededSession?.id},wdParams:{...e.templateId&&{wdTpl:e.templateId},...e.uiCulture&&{wdlcid:e.uiCulture},...(0,c.aT)(e.wdValue)},hostGeneratedSessionId:r?.sessionId,meeting:r?.meeting,throttling:{protection:t.throttling?.protection,request:t.throttling?.request}}}function l(t,e){return{documentIdentifier:{docUrl:e.docUrl,driveId:e.driveId,docId:e.docId,fileName:t.file?.name},wopiHostData:{bundleStaleness:t.contentBundle?.staleness,bundleUrl:t.contentBundle?.url,bundleVersion:t.contentBundle?.majorVersion.toString(),downloadUrl:t.file?.getUrl,eTag:t.file?.eTag,fileName:t.file?.name,fileSize:t.file?.size,irmEnabled:t.bootParams?.irmEnabled,protectionEnabled:t.bootParams?.supportsDecryptedContentDownload,isNewFile:!!e.isNewFile,readOnly:!!t.bootParams?.readOnly,blocksDownload:!!t.bootParams?.viewOnly,sharePointInfo:{},wac:{bootstrapperUrl:s.W.bootstrapperUrl,applicationUrl:t.appUrl,userId:e.puid}},fetchDiagnostics:{}}}function d(t,e){let n;try{n=new URLSearchParams(new URL(t).search).get("sc")||void 0}catch(t){e?.ULS.sendTraceTag(520135565,o.n.Bo,r.k.Info,`Error trying to get session context from app URL: ${JSON.stringify(t)}`)}return n}},83754:function(t,e,n){n.d(e,{$e:function(){return C},Im:function(){return b},K7:function(){return g},Mt:function(){return A},ND:function(){return T},PS:function(){return y},Q9:function(){return h},TB:function(){return w},VS:function(){return v},Xl:function(){return m},aT:function(){return U},ch:function(){return H},uU:function(){return p},wh:function(){return S}});var o=n(96699),r=n(97326),i=n(7867),s=n(96793),c=n(27474),a=n(1563),u=n(38794),f=n(86739),l=n(34624),d=n(67053);const h="officecom";function p(){return JSON.stringify({pmo:window.location.origin,pmshare:!0,surl:void 0,curl:void 0,vurl:void 0,eurl:void 0})}function m(t,e,n,o,r,i,s,c){return{HostName:"office.com",HostSessionId:e,UserId:t,OwnerId:void 0,UiLocale:n,DataLocale:o,DisableChat:!0,CookieCompliant:!0,WdParams:s,DisableFocusOnBoot:!1,SessionContext:c||p(),HighContrastMode:i?.highContrastMode,HideHeader:r?.hideHeader,HideAppLauncherInHeader:r?.hideAppLauncherInHeader,HideSearchInHeader:r?.hideSearchInHeader,HideMeInHeader:r?.hideMeInHeader,HideChatInHeader:r?.hideChatInHeader,HideWorkflowInHeader:r?.hideWorkflowInHeader,HideSettingsInHeader:r?.hideSettingsInHeader,ShowAppIconInHeader:r?.showAppIconInHeader,UseNeutralColorInHeader:r?.useNeutralColorInHeader,SupportsDocReboot:r?.supportsDocumentReboot,SupportsCreateNewDocument:r?.supportsCreateNewDocument,SupportsAuthToken:r?.supportsAuthToken,AuthTokenStrategy:r?.authTokenStrategy,SupportsAtMentions:r?.supportsAtMentions,SupportsMoveToFolder:r?.supportsMoveToFolder,SupportsCommonFilePicker:r?.supportsCommonFilePicker,SupportsDirectPrint:r?.supportsDirectPrint,SupportsDirectDownload:r?.supportsDirectDownload,MetaUiHostVersion:i?.metaUiHostVersion,SupportsAccessibilityLoop:r?.supportsAccessibilityLoop,SupportsExcelExternalLinks:r?.supportsExcelExternalLinks,UiHostIntegrationType:r?.uiHostIntegrationType,OpenLinksInNewWindow:r?.openLinksInNewWindow,UiHostTabId:i?.uiHostTabId,Upn:i?.upn,TenantId:i?.tenantId,Meeting:i?.meeting,SupportsCustomAuthConfig:r?.supportsCustomAuthConfig,ContentAssemblyMode:r?.contentAssemblyMode,SupportsRefreshAccessToken:r?.supportsRefreshAccessToken,IsSynthetic:i?.isSynthetic,OwlVersion:i?.owlVersion,OwlRollout:i?.owlRollout,SupportsZipIt:i?.supportsZipIt,DisableOfficeAddins:r?.disableOfficeAddins,SupportsInPlaceCreateNew:r?.supportsInPlaceCreateNew,DisableEmbedViewCodeSnippet:r?.disableEmbedViewCodeSnippet,DisableCoEditInTeams:r?.disableCoEditInTeams}}function w({docId:t,isNewFile:e,fileName:n,intent:o},r){return r?{FileName:r.fileName,FileGetUrl:r.wac?.fileGetUrl||r.downloadUrl,CustomFontCatalogUrl:r.wac.customFontCatalogUrl,FileSize:r.fileSize,BundleInfo:{Url:r.bundleUrl,MajorVersion:r.bundleVersion,BundleStaleness:r.bundleStaleness},ReadOnly:r.readOnly,IrmEnabled:r.irmEnabled,ViewOnly:r.blocksDownload,ETag:r.eTag,ClientThrottlingProtection:r.wac?.clientThrottlingProtection,RequestedCallThrottling:r.wac?.requestedCallThrottling,IsNewFile:!!e||r.isNewFile,...t&&{DocUniqueId:t},OpenViewByDefault:"view"===o}:{FileName:n,IsNewFile:!0,...t&&{DocUniqueId:t}}}function g(t){return{WopiSrc:t.wopiSrc,AccessToken:t.accessToken,AccessTokenExpiry:new Date(parseInt(t.accessTokenExpiry,10)),WacToken:t.wacToken}}function b(t){switch((0,a.rA)(t)){case a._Q.OneDrive:return"OneDrive";case a._Q.SharePoint:return"SharePoint Online";default:return"Unknown"}}function v(t,e,n,o={startTime:0,endTime:0},r={startTime:0,endTime:0},i,s,c){const a=window.performance.timing,u=window.performance.navigation,f=u.redirectCount||0,l=a.navigationStart||0,d=a.fetchStart||0,h=a.responseEnd||0,p=a.requestStart||0,m=a.responseStart||0,w=a.responseEnd||0,g=a.domComplete||0;let b="UNKNOWN";switch(u.type){case 0:b="NAVIGATE";break;case 1:b="RELOAD";break;case 2:b="BACK_FORWARD";break;case 255:b="RESERVED"}return{...S(t,e,n,o,r,i,s,c),hostPageNavigationStartTime:l,hostPageFetchStartTime:d,hostPageFetchEndTime:h,hostPageRequestStartTime:p,hostPageResponseStartTime:m,hostPageResponseEndTime:w,hostPageDomCompleteTime:g,hostPageRedirectCount:f,hostPageNavigationType:b}}function S(t,e,n,s={startTime:0,endTime:0},a={startTime:0,endTime:0},l,d,h){const p=a.startTime||0,m=a.endTime||0,w=(0,o.u_)();(0,o.l8)("officeInitializationTime");const g=l?.logger,b=l?.bootDiagnostics||{},v=b.tabsCacheHit,S=b.packageEntryTime,H=b.isTestMode,I=b.ringId;let C,y;t&&(C=w-t),S&&(y=w-S);const A={owlVersion:l?.owlVersion,...b,...c.pP,bootStrapStartTime:a?.startTime||0,bootStrapEndTime:a?.endTime||0,wopiDataStartTime:s?.startTime||0,wopiDataEndTime:s?.endTime||0,isCookieBlocked:!u.L,isCreateNew:d,createNewEndTime:b.createNewStartTime?(0,o.u_)():void 0,owlFeatureGates:h?(0,f.c)(h):void 0};return c.pP.accessTokenStartTime=void 0,c.pP.accessTokenEndTime=void 0,c.pP.driveItemStartTime=void 0,c.pP.driveItemEndTime=void 0,c.pP.driveItemFromWacStartTime=void 0,c.pP.driveItemFromWacEndTime=void 0,c.pP.spRequestGuid=void 0,c.pP.createNewStartTime=void 0,c.pP.createNewEndTime=void 0,c.pP.loadManifestStartTime=void 0,c.pP.loadManifestEndTime=void 0,c.pP.getManifestFromRemoteTimeElapsed=void 0,c.pP.loadManifestServerTimeElapsed=void 0,c.pP.loadOwlStartTime=void 0,c.pP.loadOwlEndTime=void 0,c.pP.isVroom21=!1,g?.ULS.sendTraceTag(556613895,r.n.Bo,i.k.Info,`getDiagnostics: [SessionOrigin: ${n}][TabsCacheHit: ${v}][IsTestMode: ${H}][RingId: ${I}][TimeElapsedSinceUserClick:${C}][TimeElapsedSincePackageEntry: ${y}]`),{entryPoint:n,hostPageFirstFlushTime:e,userClickTime:t,officeBootstrapperStartTime:p,officeBootstrapperEndTime:m,officeInitializationTime:w,unifiedUiHostDiagnostics:A}}function H(t){let e="UNKNOWN";switch(t?.navigation.type){case 0:e="NAVIGATE";break;case 1:e="RELOAD";break;case 2:e="BACK_FORWARD";break;case 255:e="RESERVED"}return{hostPageNavigationStartTime:t?.timing.navigationStart||0,hostPageFetchStartTime:t?.timing.fetchStart||0,hostPageFetchEndTime:t?.timing.responseEnd||0,hostPageRequestStartTime:t?.timing.responseEnd||0,hostPageResponseStartTime:t?.timing.responseStart||0,hostPageResponseEndTime:t?.timing.responseEnd||0,hostPageDomCompleteTime:t?.timing.domComplete||0,hostPageRedirectCount:t?.navigation.redirectCount||0,hostPageNavigationType:e}}const I=t=>{const e=new URL(t);return e.searchParams.delete("wopisrc"),e.href};function C(t){const e=Array.isArray(t&&t.experiments)&&t&&t.experiments||[];return(0,d.G)({ODB:61959},e)&&(window.docAspxMsalEnabled=!0),e=>{if("DocAspxMsal"===e)return window.docAspxMsalEnabled;let n=e;switch(e){case"OfficeComWordJsApiV2":case"OfficeComExcelJsApiV2":case"OfficeComPptJsApiV2":return!0;case"OfficeUnifiedUiHostTeams":n="unifiedUiHostInTeams"}return t?.experiments&&n in t?.experiments?function(t){switch(t){case 0:return!1;case 1:return!0;default:return}}(t?.experiments[n]):void 0}}function y(t,e,n){switch(t){case s.p.Word:case s.p.PowerPoint:case s.p.Excel:case s.p.Visio:return!0;case s.p.OneNote:const t=(0,l.SI)(l.dT.FeatureGate_OneNoteJsApiV2Gate,e);return(0,l.lO)(l.dT.FeatureGate_OneNoteJsApiV2Gate,t,n),t;default:return!1}}function A(t,e,n,o,r){const i=t?t.wac?.applicationUrl||t.wac?.editUrl:I(e);return i?function(t,e,n,o,r,i){let s=`${t}&uih=${e}`;return(i??1)&&(s=`${s}&uiEmbed=1`),o&&(s=`${s}&wdTpl=${o}`),r&&(s=`${s}&wdlcid=${r}`),n&&(s=`${s}&actNavId=${n}`),s}(i,n,o.navId,o.templateId,o.rebootOverrideData?o.rebootOverrideData.lcid:o.uiCulture,r):""}function U(t){return t?{wd:encodeURIComponent(t)}:{}}function T(t,{applicationUrl:e,bootstrapperUrl:n},o,r,i,s,c,a,u="officecom",f,l,d,h,p,m,w,g,b,v,S={}){const H={HostUIControls:b?[{id:"close",visibility:d?1:0},{id:"share",visibility:h?1:0},{id:"ellipsisOpenInBrowser",visibility:p?1:0},{id:"ellipsisDownload",visibility:m?1:0},{id:"copyLink",visibility:w?1:0},{id:"conversation",visibility:v?1:0}]:void 0,additionalApplicationParameters:S};return{BootstrapperUrl:n,Container:t,SessionInformation:r,ApplicationUrl:A(l,e,u,f,g),WopiPrecheckInfo:i,ApplicationCustomSettings:H,Diagnostics:s,FnOnInitializeSuccess:c,FnOnInitializeFailure:a,FnIsFeatureEnabled:C(),RebootOverrideData:f.rebootOverrideData,...o?{WopiInfo:o}:{}}}},13533:function(t,e,n){function o({onAcquireOAuthTokenTeams:t}){return async e=>{console.log("AcquireOAuthTokenTeamsHandler"),t&&t(e.AuthUrl)}}n.d(e,{T:function(){return o}})},13384:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).accessibilityLoopCompleteHandler(t,e)}}n.d(e,{m:function(){return o}})},84708:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).actionCompleteHandler(t,e)}}n.d(e,{m:function(){return o}})},22748:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).caaeMessageHandler(t,e)}}n.d(e,{C:function(){return o}})},45796:function(t,e,n){function o(t){return async()=>{(await n.e(6720).then(n.bind(n,14074))).closeTeamsConversationHandler(t)}}n.d(e,{s:function(){return o}})},49638:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.commonPickerHandler(t,e)}}n.d(e,{m:function(){return o}})},6442:function(t,e,n){function o(t){return async()=>{const e=await n.e(6720).then(n.bind(n,14074));await e.consumerFileEmbedHandler(t)}}n.d(e,{Y:function(){return o}})},41037:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.createNewHandler(t,e)}}n.d(e,{J:function(){return o}})},33999:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.documentRebootHandler(t,e)}}n.d(e,{l:function(){return o}})},87590:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).frameChangedHandler(t,e)}}n.d(e,{c:function(){return o}})},64146:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.getAuthTokenHandler(t,e)}}n.d(e,{W:function(){return o}})},83958:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.getClientUrlCompleteHandler(t,e)}}n.d(e,{g:function(){return o}})},55950:function(t,e,n){function o(t){return async()=>{const e=await n.e(6720).then(n.bind(n,14074));await e.getCustomAuthConfigHandler(t)}}n.d(e,{u:function(){return o}})},38315:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.getWebUrlCompleteHandler(t,e)}}n.d(e,{h:function(){return o}})},53121:function(t,e,n){function o(t){return async()=>{const e=await n.e(6720).then(n.bind(n,14074));await e.loadingStatusHandler(t)}}n.d(e,{t:function(){return o}})},86407:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.moveToFolderFilePickerHandler(t,e)}}n.d(e,{P:function(){return o}})},26258:function(t,e,n){function o(t){return async()=>{(await n.e(6720).then(n.bind(n,14074))).navigateBackToHostHandler(t)}}n.d(e,{m:function(){return o}})},75304:function(t,e,n){function o(t){return async()=>{(await n.e(6720).then(n.bind(n,14074))).openInBrowserHandler(t)}}n.d(e,{e:function(){return o}})},41867:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).openInMobileAppHandler(t,e)}}n.d(e,{P:function(){return o}})},86467:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).popStateCallback(t,e)}}function r({onPopState:t,supportsPopAndPushState:e}){e&&window.addEventListener("popstate",t)}n.d(e,{S:function(){return o},h:function(){return r}})},28026:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).printRedirectHandler(t,e)}}n.d(e,{k:function(){return o}})},83324:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).pushStateHandler(t,e)}}n.d(e,{C:function(){return o}})},59941:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.renameHandler(t,e)}}n.d(e,{X:function(){return o}})},45187:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).sendConversationIdHandler(t,e)}}n.d(e,{v:function(){return o}})},1238:function(t,e,n){function o(t){const e={...t,popupMetadata:{retry:0,dialogInvoked:!1,popupOpen:!1}};return async t=>{const o=await n.e(6720).then(n.bind(n,14074));await o.sessionRefreshInfoHandler(e,t)}}n.d(e,{g:function(){return o}})},11350:function(t,e,n){function o(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.shareHandler(t,e)}}n.d(e,{A:function(){return o}})},19228:function(t,e,n){function o(t){return async e=>{(await n.e(6720).then(n.bind(n,14074))).userAccessHandler(t,e)}}n.d(e,{Q:function(){return o}})},84389:function(t,e,n){function o(t){return async()=>{(await n.e(6720).then(n.bind(n,14074))).userActivityHandler(t)}}n.d(e,{x:function(){return o}})},63524:function(t,e,n){n.d(e,{RC:function(){return s},SM:function(){return o},Cr:function(){return i},bn:function(){return c},j0:function(){return r}});let o=[];var r;function i(){o=[]}function s(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.wopiInfoFromUrlHandler(t,e)}}function c(t){return async e=>{const o=await n.e(6720).then(n.bind(n,14074));await o.davUrlFromIdsHandler(t,e)}}!function(t){t[t.GetWopiInfoFromUrl=0]="GetWopiInfoFromUrl",t[t.GetDavUrlFromIds=1]="GetDavUrlFromIds"}(r||(r={}))},89418:function(t,e,n){n.d(e,{Q:function(){return c}});var o=n(97326),r=n(7867),i=n(87290),s=n(21872);function c(t,e,n,c,a){if(c){const n=function(t){switch(t){case i.Ph.PostMessage_RefreshSessionInfo:return s.Y.sendSessionInfo;case i.Ph.PostMessage_GrantPermissions:return s.Y.sendUserAccessAndPermissions;case i.Ph.PostMessage_SetAuthToken:return s.Y.sendAuthToken;case i.Ph.PostMessage_HostAccessibilityLoopComplete:return s.Y.continueAccessibilityLoop;case i.Ph.PostMessage_SetHostWopiInfoFromUrl:return s.Y.sendWopiInfo;case i.Ph.PostMessage_MoveToFolderCompleted:return s.Y.moveToFolder;case i.Ph.PostMessage_CompleteFilePicker:return s.Y.completeSharedFilePicker;case i.Ph.PostMessage_SendCustomAuthConfig:return s.Y.sendCustomAuthConfig;case i.Ph.PostMessage_SetDavUrlFromIds:return s.Y.sendDavUrl;case i.Ph.PostMessage_BlurFocus:return s.Y.blurFocus;case i.Ph.PostMessage_PopState:return s.Y.popState;case i.Ph.PostMessage_GrabFocus:return s.Y.grabFocus;case i.Ph.PostMessage_HostGetClientUrl:return s.Y.getClientUrl;case i.Ph.PostMessage_HostGetWebUrl:return s.Y.getWebUrl;case i.Ph.PostMessage_HostBackButtonPressed:return s.Y.backButtonPressed;case i.Ph.PostMessage_HostSendChannelId:return s.Y.sendChannelId;case i.Ph.PostMessage_HostSendConversationId:return s.Y.sendConvId;case i.Ph.PostMessage_PostWacToken:return s.Y.postWacToken;case i.Ph.PostMessage_CanEmbed:return s.Y.sendEmbeddedViewUrl;default:return}}(t);if(n){const t=n;c.run(t,e).catch((t=>a?.ULS.sendTraceTag(512337544,o.n.Bo,r.k.Warning,`Failed to send post message. officeDocumentSession.run returned error: ${t}`)))}}else n?n.then((n=>{n?function(t,e,n,i){let s=null;try{s=new URL(t)}catch(e){return void i?.ULS.sendTraceTag(541180047,o.n.Bo,r.k.Warning,`Failed to send post message. could not create url from ${t} with error: ${e}`)}const c=s.origin,a={MessageId:e,SendTime:(new Date).getTime(),Values:n},u=JSON.stringify(a),f=document.getElementById("WebApplicationFrame");f?f?.contentWindow?.postMessage(u,c):i?.ULS.sendTraceTag(541180048,o.n.Bo,r.k.Warning,"Failed to send post message. Could not find iframe")}(n,t,e,a):a?.ULS.sendTraceTag(541180045,o.n.Bo,r.k.Warning,"Failed to send post message. appUrl is null")})).catch((t=>a?.ULS.sendTraceTag(512337543,o.n.Bo,r.k.Warning,`Failed to send post message. appUrlPromise failed to resolve with error: ${t}`))):a?.ULS.sendTraceTag(541180046,o.n.Bo,r.k.Warning,"Failed to send post message. Both documentSession and appUrlPromise are null")}},57033:function(t,e,n){n.d(e,{$2:function(){return w.$2},BI:function(){return v.BI},BK:function(){return g.BK},C:function(){return T},C4:function(){return g.C4},C6:function(){return w.C6},DU:function(){return g.DU},Dp:function(){return g.Dp},FJ:function(){return I.F},Gi:function(){return b.Gi},HR:function(){return h.HR},Lr:function(){return H.L},Oy:function(){return i.O},PN:function(){return U.PN},R4:function(){return f.R4},R7:function(){return p.R7},Ro:function(){return g.Ro},SI:function(){return b.SI},TX:function(){return v.TX},UT:function(){return S.U},VG:function(){return s.VG},Xk:function(){return c.Xk},_E:function(){return d._},_G:function(){return g._G},_I:function(){return f._I},yr:function(){return A._},b6:function(){return f.b6},by:function(){return h.by},cL:function(){return g.cL},cv:function(){return g.cv},dT:function(){return b.dT},eK:function(){return g.eK},es:function(){return m.e},gv:function(){return g.gv},gz:function(){return C.g},hK:function(){return p.hK},h_:function(){return g.h_},it:function(){return h.R7},kp:function(){return r.k},lO:function(){return b.lO},lX:function(){return v.lX},nS:function(){return l.n},nh:function(){return o.n},pP:function(){return h.pP},pp:function(){return f.pp},pt:function(){return u.p},ub:function(){return y.u},v7:function(){return a.v},xt:function(){return g.xt},yC:function(){return v.yC},yI:function(){return g.yI},yO:function(){return l.y},yc:function(){return w.yc}});var o=n(97326),r=n(7867),i=n(16424),s=n(31625),c=n(11741),a=n(16896),u=n(96793),f=n(2639),l=n(51445),d=n(11706),h=n(27474),p=n(6439),m=n(59842),w=n(91581),g=n(41779),b=n(34624),v=n(29819),S=n(42625),H=n(38794),I=n(42831),C=n(75607),y=n(71664),A=n(61891),U=n(26662);function T(){return""}},2639:function(t,e,n){n.d(e,{R4:function(){return v},_I:function(){return g},b6:function(){return b},pp:function(){return S}});var o=n(96699),r=n(31376),i=n(97326),s=n(7867),c=n(16424),a=n(16896),u=n(97887),f=n(72470),l=n(83754),d=n(6439),h=n(27474),p=n(38794),m=n(42625),w=n(1563);function g(t,e,n){const m=(0,o.Wv)(),g=(0,r.Jf)(),b=(0,u.x9)(t);if(!b)return void g?.ULS.sendTraceTag(558158862,i.n.Bo,s.k.Verbose,"prebootDocument: Not enough document information was provided. Cannot get unique identifier.");if(!p.L)return void g?.ULS.sendTraceTag(527471828,i.n.Bo,s.k.Warning,"prebootDocument: 3rd Party Cookie is blocked! Cannot perform preboot. Bail out.");const v=p.L.getItem(b);if(v)return void g?.ULS.sendTraceTag(545036514,i.n.Bo,s.k.Verbose,"prebootDocument: Session is already prebooted with sessionid: "+v);const S=(0,c.O)()[0];p.L.setItem(b,S);const H=new d.R7(S,t.fileType,n,void 0,void 0,void 0,t.uiCulture,t.puid,void 0,void 0,void 0,t.wdOrigin).health;H?.addQosPillar("Open"),H?.addOrUpdatePartCDimension("IsNewFile",(!!t.isNewFile).toString());const I=new Map;I.set("StartTime",(new Date).toUTCString()),H?.recordKpiUsage(h.ex.KPI_PrebootDocument,a.v.FailureBased,h.S2.FC_Owl,I),I.delete("StartTime"),(0,f.e)(t,e,g,!1,!1,0,!1,!0).then((t=>{g?.ULS.sendTraceTag(558158863,i.n.Bo,s.k.Info,"prebootDocument: Attempting to preboot document with sessionid: "+S),function(t,e){if(!t||!e)return!1;const n="access_token="+encodeURIComponent(e.wac.accessToken)+"&access_token_ttl="+encodeURIComponent(e.wac.accessTokenExpiry)+"&bundleSrc="+encodeURIComponent(e.bundleUrl??"")+"&user_id="+encodeURIComponent(e.wac.userId),o=function(t){if(!t)return null;const e=(0,w.g$)(t);if(!e)return null;const n=e.path.substring(0,e.path.lastIndexOf("/"))+"/preboot.ashx";return e.protocol+"//"+e.hostname+n}(e.wac.applicationUrl);if(!o)return!1;const r=encodeURIComponent(e.wac.wopiSrc),i=(0,l.uU)(),s=new XMLHttpRequest;return s.open("POST",o+"?op=preboot&usid="+encodeURI(t)+"&wopisrc="+r+"&sc="+i),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(n),!0}(S,t.wopiHostData)?g.ULS.sendTraceTag(558158864,i.n.Bo,s.k.Info,"prebootDocument: Preboot request sent successfully with sessionid: "+S):(p.L?.removeItem(b),g.ULS.sendTraceTag(545036515,i.n.Bo,s.k.Info,"prebootDocument: Preboot request cannot be made with sessionid: "+S),I.set("FailureTime",(new Date).toUTCString()),H?.recordKpiFailure(h.ex.KPI_PrebootDocument,"PrebootRequestFailed",!1,!0,{durationMs:(0,o.Wv)()-m,extendedProperties:I}))})).catch((t=>{g.ULS.sendTraceTag(558158865,i.n.Bo,s.k.Warning,"prebootDocument: Failed to send Preboot request with WacDocumentVroomError:"+JSON.stringify(t)),I.set("DriveItemError",JSON.stringify(t)),I.set("FailureTime",(new Date).toUTCString()),H?.recordKpiFailure(h.ex.KPI_PrebootDocument,"PrebootDriveItemRequestFailed",!1,!1,{durationMs:(0,o.Wv)()-m,extendedProperties:I}),p.L?.removeItem(b)}))}function b(t,e,n){g(t,e,(0,m.U)(n))}function v(t){const e=(0,u.x9)(t);return e&&p.L?p.L.getItem(e):null}function S(t,e){if(e){const e=(0,u.x9)(t);if(e)return p.L?.removeItem(e),!0}return!1}},53875:function(t,e,n){n.d(e,{$:function(){return r}});var o=n(96699);function r(t,e,n,r,s){if(!(r&&r.wopiHostData&&r.wopiHostData.wac&&r.wopiHostData.wac.accessToken&&r.wopiHostData.wac.accessTokenExpiry))throw new Error("Invalid wopiFetchData object");const c=document.createElement("form");return c.id=`owl_${e}_form`,c.action=t.toString(),c.method="post",c.target=n,c.onerror=()=>{s?.((0,o.u_)(),`Error occurred while submitting form. Redirect Scenario: ${e}, Service Endpoint: ${t.origin+t.pathname}`)},c.appendChild(i("access_token",r.wopiHostData.wac.accessToken)),c.appendChild(i("access_token_ttl",r.wopiHostData.wac.accessTokenExpiry)),c}function i(t,e){const n=document.createElement("input");return n.type="hidden",n.name=t,n.value=e,n}},60254:function(t,e,n){n.d(e,{HM:function(){return f},wZ:function(){return l}});var o=n(97326),r=n(7867),i=n(59744),s=n(27474),c=n(30177),a=n(29808),u=n(75212);function f(t,e,n,f,l,d,h,p,m){try{if(!(e&&e.wopiHostData&&e.wopiHostData.wac&&e.wopiHostData.wac.wopiSrc&&e.wopiHostData.wac.applicationUrl))throw new Error("Invalid wopiFetchData object in print flow");let{decodedServiceEndpointUrl:i,parameters:w}=(0,u.kn)(n,[a.zW.ServiceEndpoint,a.zW.RedirectUserClickTime,a.zW.RedirectToBrowserTimestamp]);(0,u.$C)(i,e.wopiHostData.wac.applicationUrl),l.set(a.d1.UserClickTime,(0,u.ng)(w,a.zW.RedirectUserClickTime)),l.set(a.d1.ToBrowserTimestamp,(0,u.ng)(w,a.zW.RedirectToBrowserTimestamp)),l.set("CorrelationId",f),i.searchParams.append("WOPIsrc",e.wopiHostData.wac.wopiSrc);const g=(t,e,n)=>{m&&(l.set(a.d1.FormSubmitTimestamp,`${t}`),l.set(a.d1.OnErrorTimestamp,`${e}`),l.set("ErrorName",s.by.QosError_PrintInBrowserFailedToOpenPdf),p?.ULS.sendTraceTag(506566347,o.n.Bo,r.k.Error,`Error occurred while submitting form. Redirect Scenario: PrintPDF, Service Endpoint: ${i.origin+i.pathname}`),(0,c.f)(m,s.by.QosError_PrintInBrowserFailedToOpenPdf,s.zJ.QosVeto_PrintInBrowserFailed,s.ex.KPI_PrintInBrowser,l)),h?.(n)},b=(t,e)=>{l.set(a.d1.FormSubmitTimestamp,`${t}`),l.set(a.d1.OnLoadTimestamp,`${e}`),m?.recordKpiSuccess(s.ex.KPI_PrintInBrowser,{inStaging:!0,extendedProperties:l}),d?.()};(0,c.o)(i,a.jy.PrintPDF,e,t,l,p,g,b)}catch(t){p&&m&&function(t,e,n,a){const u=`Unknown error occurred during print redirect execution. Error: ${(0,i.M5)(t)}`;e.set("ErrorName",s.by.QosError_PrintInBrowserUnknownFailure),e.set("ErrorMessage",`${t}`),n?.ULS.sendTraceTag(506566346,o.n.Bo,r.k.Error,u),(0,c.f)(a,s.by.QosError_PrintInBrowserUnknownFailure,s.zJ.QosVeto_PrintInBrowserFailed,s.ex.KPI_PrintInBrowser,e)}(t,l,p,m)}}function l(){return(0,u.Pq)(a.jy.PrintPDF)}},30177:function(t,e,n){n.d(e,{f:function(){return u},o:function(){return a}});var o=n(53875),r=n(97326),i=n(7867),s=n(96699),c=n(29808);function a(t,e,n,a,u,f,l,d){const h=`owl_${e}_iframe`,p=(0,o.$)(t,e,h,n,((t,e)=>{l?.(w,t,e)})),m=document.createElement("iframe");m.name=h,m.id=h,m.style.width="100%",m.style.height="100%",m.style.border="none",a.container.appendChild(p),a.container.appendChild(m),m.onload=()=>{f?.ULS.sendTraceTag(506566348,r.n.Bo,i.k.Info,`Iframe Loaded. Redirect Scenario: ${e}, Service Endpoint: ${t.origin+t.pathname}, Original Redirect Session Id: ${u.get(c.d1.OriginalRedirectSessionId)??""}`),d?.(w,(0,s.u_)())},a.container.style.width="100%",a.container.style.height="100%",a.container.style.inset="0px";const w=(0,s.u_)();try{p.submit()}catch(t){l?.(w,w,t.message)}}function u(t,e,n,o,r){const i={inStaging:!0,extendedProperties:r};t.recordQosError(e,[n],!1,!0,!1,!1,i),t.recordKpiFailure(o,e,!1,!1,i)}},29808:function(t,e,n){var o,r,i;n.d(e,{d1:function(){return r},jy:function(){return i},zW:function(){return o}}),function(t){t.ServiceEndpoint="sE",t.RedirectScenario="rS",t.RedirectUserClickTime="rUCT",t.RedirectToBrowserTimestamp="rTBT",t.RedirectSessionIdentifier="rOSI"}(o||(o={})),function(t){t.UserClickTime="UserClickTime",t.ToBrowserTimestamp="ToBrowserTimestamp",t.FormSubmitTimestamp="FormSubmitTimestamp",t.OnLoadTimestamp="OnLoadTimestamp",t.OnErrorTimestamp="OnErrorTimestamp",t.OriginalRedirectSessionId="OriginalRedirectSessionId"}(r||(r={})),function(t){t.PrintPDF="PrintPDF",t.Other="Other"}(i||(i={}))},75212:function(t,e,n){n.d(e,{$C:function(){return a},Pq:function(){return s},eD:function(){return c},kn:function(){return r},ng:function(){return i}});var o=n(29808);function r(t,e){const n=function(t,e){const n=[];if(e.forEach((e=>{try{i(t.searchParams,e)}catch{n.push(e)}})),n.length>0)throw new Error(`${n.join(", ")} is/are not present in the URL`);return t.searchParams}(t,e),r=i(n,o.zW.ServiceEndpoint);return{decodedServiceEndpointUrl:new URL(decodeURIComponent(r)),parameters:n}}function i(t,e){if(!t.has(e))throw new Error(`${e} is not present in the URL`);return t.get(e)}function s(t){const e=new URL(window.location.href);return t?u(e,t):Object.values(o.jy).some((t=>u(e,t)))}function c(t){return i(t.searchParams,o.zW.RedirectSessionIdentifier)}function a(t,e){const n=new URL(e);t.hostname=n.hostname,t.protocol=n.protocol}function u(t,e){try{return i(t.searchParams,o.zW.RedirectScenario)===e}catch{return!1}}},97605:function(t,e,n){n.d(e,{Q7:function(){return vt},an:function(){return bt},h1:function(){return wt},k3:function(){return St},qO:function(){return gt}});var o,r=n(96699),i=n(97326),s=n(7867),c=n(74555),a=n(31376),u=n(21872),f=n(16896),l=n(96793),d=n(44739),h=n(14521),p=n(31675),m=n(68965),w=n(69201),g=n(42365),b=n(46788),v=n(83754),S=n(66366),H=n(63524),I=n(89418),C=n(33999),y=n(59941),A=n(1238),U=n(11350),T=n(28026),P=n(19228),E=n(84389),k=n(41037),N=n(64146),F=n(45187),R=n(45796),D=n(26258),W=n(13384),O=n(83958),M=n(53121),$=n(38315),_=n(84708),j=n(75304),B=n(41867),L=n(86407),x=n(49638),K=n(55950),G=n(83324),V=n(22748),q=n(13533),J=n(86467),z=n(87590),Z=n(6442),Q=n(87290),X=n(27474),Y=n(77860),tt=n(41779),et=n(39095),nt=n(34624),ot=n(35587),rt=n(77045),it=n(5840),st=n(86739),ct=n(61885);!function(t){t[t.Completed=0]="Completed",t[t.Unloaded=1]="Unloaded",t[t.Timeout=2]="Timeout"}(o||(o={}));const at="officeapps.live.com",ut=2e3,ft=9e3,lt=9500,dt=6e5,ht=15e4,pt=[],mt=new et.Z;let wt={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1},gt={};function bt(){wt={BootAttempted:!1,BootSucceeded:!1,PostWacTokenAttempted:!1}}function vt(t){const e=Promise.all([tt.jW,mt]).then((t=>t[1])),n=new Promise((t=>window.addEventListener("beforeunload",(e=>t(o.Unloaded))))),c=new Promise((t=>setTimeout((()=>t(o.Timeout)),ht)));Promise.race([e,n,c]).then((e=>{const n=e===o.Unloaded;gt.PostWacTokenLoggerFlushTime=(0,r.u_)(),gt.Unloaded=n,gt.flush&&delete gt.flush,t&&(t.ULS.sendTraceTag(507540257,i.n.Bo,s.k.Important,JSON.stringify(gt)),n?t.ULS.flushOnClose():t.ULS.flush()),gt={}})).catch((()=>{t&&t.ULS.sendTraceTag(507540256,i.n.Bo,s.k.Warning,"Failed to log PostWacTokenTelemetry")}))}function St(t){const e=t.sessionConfig.bootDiagnostics?.hostPageFirstFlushTime||(0,r.u_)(),{documentBootInfo:n,fetchItemFromNetwork:b,fetchAccessToken:ht,sessionConfig:bt,container:vt,setTitle:St,onBootComplete:It,onBootFailure:Ct,onReturnFocus:yt,onConversationClose:At,onNavigateBack:Ut,onOpenPageLevelConversation:Tt,onDocumentClose:Pt,onSuccessNotification:Et,onDismissHostSpinner:kt,uiHostConfig:Nt,createDocument:Ft,openShareControl:Rt,onOpenInMobileApp:Dt,sharingLinkTokenProvider:Wt,onUserActivity:Ot,onCAAEMessage:Mt,onAcquireOAuthTokenTeams:$t,onUserAccess:_t,onMoveToFolder:jt,onSharedFilePicker:Bt,onRename:Lt,initPackageParams:xt,onFrameChange:Kt,invokeSessionRefreshInfoPopupBlockedDialog:Gt,onFileEmbed:Vt,bootstrapFile:qt}=t,Jt=Nt?.supportsExplicitUnload;bt.logger||(bt.logger=(0,a.Jf)());const{hostCorrelationId:zt,isMsa:Zt,tenantId:Qt,shareApiEndpoint:Xt,organizationName:Yt,logger:te,hostClientType:ee,channelId:ne,health:oe}=bt,re=(0,v.PS)(n.fileType,Nt?.featureGates,te);te?.ULS.sendTraceTag(576578584,i.n.Bo,s.k.Info,"Lean Ui Host: bootApp");const ie=(0,c.f)(dt);let se,ce=[];const ae=t=>new Promise((e=>{re&&!ie&&e("No active session to close. Return from here."),pt&&pt.forEach((t=>{clearInterval(t),clearTimeout(t)}));const o=t=>{te?.ULS.sendTraceTag(575411776,i.n.Bo,s.k.Info,"Dispose the WAC frame. And reboot: "+(t?"true":"false")),Ie.next(t),Ie.complete(),e("WAC frame disposed")},r=()=>{n.fileType===l.p.Excel&&(0,H.Cr)(),be?.unsubscribe(),ve?.unsubscribe()};if(!me)return te?.ULS.sendTraceTag(529093076,i.n.Bo,s.k.Warning,"No active session exists, when endSession is called!! Bail out endSession"),void o(t);if(re){me?.removeEventListener(se),ie?.cancel();const e=function(t){if(t===l.p.OneNote)return(0,c.f)(ft)}(n.fileType);me?.dispose(e).catch((t=>{te?.ULS.sendTraceTag(527257879,i.n.Bo,s.k.Error,`Error waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ${Ce}, Error: ${t}`)})).finally((()=>{r(),o(t)})),e?.cancel()}else if(ce.forEach((([t,e])=>{me.RemoveEventHandler(t,e)})),me?.Dispose(Jt,function(t){if(t===l.p.OneNote)return ft}(n.fileType)),r(),Jt){const e=()=>{te?.ULS.sendTraceTag(575411777,i.n.Bo,s.k.Info,"Receive Unloaded Event from WAC"),Ce=!0,clearTimeout(r),o(t)};me.RegisterEventHandler(Q.O5.Event_Unloaded,e);const r=window.setTimeout((()=>{te?.ULS.sendTraceTag(575411778,i.n.Bo,s.k.Info,`Time out on waiting for Unloaded event from WAC. Force to dispose session if app is not unloaded. appUnloaded: ${Ce}`),Ce||o(t)}),n.fileType===l.p.OneNote?lt:ut)}else te?.ULS.sendTraceTag(575271647,i.n.Bo,s.k.Info,"No Explicit Unload. Tear down the WAC frame to end session."),o(t)})),ue=(t,e,o)=>{const r=Promise.resolve(t?.wac?.applicationUrl),c=()=>Ht(e),a=Nt?.sessionOriginPrefix??"TEAMS.UNIFIEDUIHOST.",u=(0,C.l)({getCurrentDocumentInfo:c,health:oe,getWdOrigin:t=>`${a}${t}`,reboot:(t,e)=>{ae({documentBootInfo:t,navigationRequired:!e}).catch((()=>{te?.ULS.sendTraceTag(512296464,i.n.Bo,s.k.Error,"endSession: endSession error in DocumentReboot")}))}}),f=(0,y.X)({bootedDocumentInfo:e,getCurrentDocumentInfo:c,hostRenameCallback:Lt,health:oe}),l=(0,A.g)({hostUrl:bt?.hostUrl,supportsRefreshTokenReauthPopUp:Nt?.supportsRefreshTokenReauthPopUp,getCurrentDocumentInfo:c,documentBootInfo:n,fetchItemFromNetwork:b,officeDocumentSession:o,appUrlPromise:r,invokePopupBlockedDialog:Gt,logger:te,health:oe}),d=(0,U.A)({getCurrentDocumentInfo:c,sharePointInfo:t.sharePointInfo,shareApiEndPointBase:Xt,fetchAccessToken:ht,openShareControl:Rt,correlationId:le,isMsa:Zt,tenantId:Qt,organizationName:Yt,onOpen:()=>{(0,I.Q)(Q.Ph.PostMessage_BlurFocus,void 0,pe,we,te)},onClose:()=>{(0,I.Q)(Q.Ph.PostMessage_GrabFocus,void 0,pe,we,te)},health:oe,featureGates:Nt?.featureGates,logger:te,uiHost:Nt?.uiHostName}),h=(0,T.k)({webUrl:t.webUrl??"",logger:te,health:oe,correlationId:le,sessionId:bt?.sessionId??""}),p=_t??(0,P.Q)({getCurrentDocumentInfo:c,shareHandler:d,officeDocumentSession:o,appUrlPromise:r,logger:te,health:oe}),m=(0,E.x)({getCurrentDocumentInfo:c,onUserActivity:Ot,health:oe}),w=(0,k.J)({getCurrentDocumentInfo:c,createDocument:Ft,getWdOrigin:t=>`${a}${t}`,reboot:(t,e)=>{ae({documentBootInfo:t,navigationRequired:!e}).catch((t=>{const e=(0,nt.SI)(nt.dT.FeatureGate_CommandingAshaVetoes,Nt?.featureGates);(0,nt.lO)(nt.dT.FeatureGate_CommandingAshaVetoes,e,te),e&&oe?.recordQosError(X.by.QosError_CreateNewHandlerEndSessionFailure,[X.zJ.QosVeto_CreateNewExperienceDegraded],!1,!0,!1,!1,{inStaging:!0,extendedProperties:new Map([["ErrorName",X.by.QosError_CreateNewHandlerEndSessionFailure],["CorrelationId",`${le}`],["Reason",t]])}),te?.ULS.sendTraceTag(512296463,i.n.Bo,s.k.Error,"endSession: endSession error in DocumentCreate")}))},logger:te,health:oe,correlationId:le}),g=(0,N.W)({getCurrentDocumentInfo:c,fetchAccessToken:ht,officeDocumentSession:o,appUrlPromise:r,logger:te,health:oe}),v=(0,F.v)({getCurrentDocumentInfo:c,onOpenPageLevelConversation:Tt,hostSendConversationId:ye,health:oe}),S=(0,R.s)({getCurrentDocumentInfo:c,onConversationClose:At,health:oe}),Y=(0,D.m)({getCurrentDocumentInfo:c,onNavigateBack:Ut,health:oe}),tt=(0,W.m)({getCurrentDocumentInfo:c,onReturnFocus:yt,health:oe}),et=(0,O.g)({getCurrentDocumentInfo:c,hostClientType:ee,logger:te,openInMobileAppCallback:Dt,health:oe}),ot=(0,M.t)({getCurrentDocumentInfo:c,channelId:ne,officeDocumentSession:o,appUrlPromise:r,health:oe}),rt=(0,$.h)({getCurrentDocumentInfo:c,hostClientType:ee,logger:te,health:oe}),it=(0,H.RC)({getCurrentDocumentInfo:c,fetchItemFromNetwork:b,officeDocumentSession:o,appUrlPromise:r,logger:te,health:oe}),st=(0,H.bn)({getCurrentDocumentInfo:c,fetchItemFromNetwork:b,officeDocumentSession:o,appUrlPromise:r,logger:te,health:oe}),ct=(0,_.m)({getCurrentDocumentInfo:c,logger:te,webUrl:t.webUrl??"",health:oe}),at=(0,j.e)({getCurrentDocumentInfo:c,logger:te,webUrl:t.webUrl??"",health:oe,correlationId:le}),ut=(0,B.P)({getCurrentDocumentInfo:c,logger:te,openInMobileAppCallback:Dt,health:oe,correlationId:le}),ft={appUrlPromise:r,container:vt,fetchAccessToken:ht,fetchItemFromNetwork:b,getCurrentDocumentInfo:c,host:Nt?.uiHostName,health:oe,logger:te,officeDocumentSession:o,wopiHostData:t,sessionConfig:bt,uiHostConfig:Nt,initPackageParams:xt},lt=jt??(0,L.P)(ft),dt=Bt??(0,x.m)(ft),pt=(0,K.u)({customAuthConfigValue:bt?.customAuthConfigValue,getCurrentDocumentInfo:c,officeDocumentSession:o,appUrlPromise:r,logger:te,health:oe}),mt=(0,G.C)({getCurrentDocumentInfo:c,supportsPopAndPushState:Nt?.supportsPopAndPushState,logger:te,sharingLinkTokenProvider:Wt,health:oe}),wt=(0,V.C)({getCurrentDocumentInfo:c,onCAAEMessage:Mt,health:oe}),gt=(0,q.T)({getCurrentDocumentInfo:c,onAcquireOAuthTokenTeams:$t,health:oe}),St=(0,J.S)({getCurrentDocumentInfo:c,appUrlPromise:r,logger:te,officeDocumentSession:o,health:oe});(0,J.h)({getCurrentDocumentInfo:c,onPopState:St,supportsPopAndPushState:Nt?.supportsPopAndPushState,health:oe});return{documentRebootHandler:u,renameHandler:f,sessionRefreshInfoHandler:l,shareHandler:d,printRedirectHandler:h,userAccessHandler:p,userActivityHandler:m,createNewHandler:w,getAuthTokenHandler:g,sendConversationIdHandler:v,closeTeamsConversationHandler:S,navigateBackToHostHandler:Y,accessibilityLoopCompleteHandler:tt,getClientUrlCompleteHandler:et,getWebUrlCompleteHandler:rt,loadingStatusHandler:ot,wopiInfoFromUrlHandler:it,davUrlFromIdsHandler:st,onCloseHandler:()=>{te?.ULS.sendTraceTag(575545427,i.n.Bo,s.k.Info,"Handle UI_Close post message from WAC. onCloseHandler exist: "+(Pt?"true":"false")),Pt&&Pt()},actionCompleteHandler:ct,openInBrowserHandler:at,openInMobileAppHandler:ut,moveToFolderPickerHandler:lt,commonFilePickerHandler:dt,getCustomAuthConfigHandler:pt,pushStateHandler:mt,caaeMessageHandler:wt,frameChangedHandler:(0,z.c)({getCurrentDocumentInfo:c,onFrameChange:Kt,health:oe}),fileEmbedHandler:function(){const t=(0,nt.SI)(nt.dT.FeatureGate_EnableUseConsumerFileEmbedHandler,Nt?.featureGates);return bt?.isMsa&&t&&Nt?.useConsumerFileEmbedHandler?(0,Z.Y)({getCurrentDocumentInfo:c,fetchAccessToken:ht,appUrlPromise:r,officeDocumentSession:o,logger:te}):()=>{Vt&&Vt()}}(),dismissSplashScreenHandler:()=>{const t=document.getElementById("splashscreen-container");t&&(t.style.display="none")},acquireOAuthTokenTeamsHandler:gt,requestFullScreenHandler:t=>{const e=window.top?.document;var n;e?.body&&"requestFullScreen"===t.command?(n=e?.body,n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.requestFullscreen?n.requestFullscreen():te?.ULS.sendTraceTag(506471698,i.n.Bo,s.k.Info,"RequestFullscreen got invoked in unknown browser")):e&&"exitFullScreen"===t.command&&(t=>{t.exitFullscreen?t.exitFullscreen():t.webkitCancelFullscreen?t.webkitCancelFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():te?.ULS.sendTraceTag(506471697,i.n.Bo,s.k.Info,"ExitFullscreen got invoked in unknown browser")})(e)}}},fe=xt?.jsApiUrlInfos?xt?.jsApiUrlInfos:new Map;0===fe.size&&fe.set(l.p.Word,{jsApiUrl:xt?.wordBootstrapperUrlInfo?.url,jsApiSri:xt?.wordBootstrapperUrlInfo?.sri,jsApiBackupUrl:xt?.wordBootstrapperUrlInfo?.url,PreloadedInBootStrapper:xt?.wordBootstrapperUrlInfo?.wordJsApiPreloadedInBootStrapper});const{correlationId:le,bootstrapperObservable:de,fileNamePromise:he,applicationUrlPromise:pe}=(0,S.Az)(n,zt,b,Nt,bt,Ct,!1,Et,((t,e,n,o)=>{me=t;const r=new d.t(n),{documentRebootHandler:i,renameHandler:s,sessionRefreshInfoHandler:c,shareHandler:a,printRedirectHandler:u,userAccessHandler:f,userActivityHandler:l,createNewHandler:h,getAuthTokenHandler:p,sendConversationIdHandler:m,closeTeamsConversationHandler:w,navigateBackToHostHandler:g,accessibilityLoopCompleteHandler:b,getClientUrlCompleteHandler:v,getWebUrlCompleteHandler:S,loadingStatusHandler:H,wopiInfoFromUrlHandler:I,davUrlFromIdsHandler:C,onCloseHandler:y,actionCompleteHandler:A,openInBrowserHandler:U,openInMobileAppHandler:T,moveToFolderPickerHandler:P,commonFilePickerHandler:E,getCustomAuthConfigHandler:k,pushStateHandler:N,caaeMessageHandler:F,frameChangedHandler:R,fileEmbedHandler:D,dismissSplashScreenHandler:W,acquireOAuthTokenTeamsHandler:O,requestFullScreenHandler:M}=ue(e,r,o),$=(0,nt.SI)(nt.dT.FeatureGate_UseNewEuplReporting,Nt?.featureGates);se=t=>{const e=t.data;switch(t.type){case Y.V.Reboot:i(e);break;case Y.V.FileRenamed:s(e);break;case Y.V.UserAccessAndPermissions:f(e);break;case Y.V.Share:a(e);break;case Y.V.PrintRedirect:u(e);break;case Y.V.UserActivity:l(e);break;case Y.V.CreateNewDocument:h(e);break;case Y.V.RefreshSessionInfo:c(e);break;case Y.V.GetAuthToken:p(e);break;case Y.V.AccessibilityLoopCompleted:b(e);break;case Y.V.AcquireOAuthTokenTeams:O(e);break;case Y.V.GetClientUrlComplete:v(e);break;case Y.V.LoadingStatus:H(e);break;case Y.V.GetWebUrlComplete:S(e);break;case Y.V.NavigateBackToHost:g(e);break;case Y.V.SendConversationId:m(e);break;case Y.V.CloseTeamsConversation:w(e);break;case Y.V.GetWopiInfoFromUrl:I(e);break;case Y.V.Close:y();break;case Y.V.ActionCompleted:A(e);break;case Y.V.OpenInBrowser:U(e);break;case Y.V.OpenInMobileApp:T(e);break;case Y.V.MoveToFolder:P(e);break;case Y.V.SharedFilePicker:E(e);break;case Y.V.GetCustomAuthConfig:k(e);break;case Y.V.GetDavUrlFromIds:C(e);break;case Y.V.PushState:N(e);break;case Y.V.CAAEMessage:F(e);break;case Y.V.FrameChanged:R(e);break;case Y.V.FileEmbed:D();break;case Y.V.InitEnd:$&&Et?.($);break;case Y.V.SplashScreenShown:$&&kt?.(),W();break;case Y.V.RequestFullScreen:M(e)}},me.addEventListener(se)}),ie,fe,qt);let me,we,ge,be,ve;te?.ULS.sendTraceTag(546182048,i.n.Bo,s.k.Info,"BootApp: Load document returned"),he.then((t=>St?.(t))).catch((()=>"obligatory catch"));const Se=new et.Z(te),He=new et.Z(te),Ie=new h.B7;let Ce;const ye=t=>{(0,I.Q)(Q.Ph.PostMessage_HostSendConversationId,{conversationId:t},pe,we,te)},Ae=t=>{const e=(0,r.u_)(),n=(0,r.Wv)();wt.PostWacTokenStartTime=gt.PostWacTokenStartTime=e,wt.PostWacTokenAttempted=gt.PostWacTokenAttempted=!0,oe?.recordKpiUsage(X.ex.KPI_PostWacToken,f.v.SuccessBased,X.S2.FC_Owl,void 0),te?.ULS.sendTraceTag(507597022,i.n.Bo,s.k.Important,"postWacToken flow initiated"),tt.gp&&te?.ULS.sendTraceTag(507377673,i.n.Bo,s.k.Warning,"Calling postWacToken after usage telemetry has been logged"),Promise.race([Se,He]).then((c=>{c.run?(te?.ULS.sendTraceTag(507597021,i.n.Bo,s.k.Info,`officeDocSession created after ${(0,r.u_)()-e} ms`),c.run(u.Y.postWacToken,{wacToken:t,postWacTokenStart:n}).then((t=>{gt.PostWacTokenResult=t.completion,gt.PostWacTokenEndTime=(0,r.u_)(),t.data&&void 0!==t.data.TokenAlreadySet&&(gt.TokenAlreadySet=t.data.TokenAlreadySet),mt.resolve(o.Completed)})).catch((t=>{gt.PostWacTokenResult="Unexpected JSAPI V2 error",gt.PostWacTokenEndTime=(0,r.u_)(),te?.ULS.sendTraceTag(507852515,i.n.Bo,s.k.Warning,`Caught error running postWacToken flow: ${t}`),mt.resolve(o.Completed)}))):c.PostWacToken?(te?.ULS.sendTraceTag(507597020,i.n.Bo,s.k.Info,`wopiPending created after ${(0,r.u_)()-e} ms`),gt.flush=()=>{mt.resolve(o.Completed)},c.PostWacToken(t,n,gt)):(gt.PostWacTokenResult="Unexpected OWL error",gt.PostWacTokenEndTime=(0,r.u_)(),te?.ULS.sendTraceTag(507852514,i.n.Bo,s.k.Warning,"postWacToken: WopiPending or OfficeDocumentSession is not defined. This should never happen, the catch callback should be hit instead."),mt.resolve(o.Completed))})).catch((()=>{gt.PostWacTokenResult="Error occurred instantiating JSAPI session in OWL",gt.PostWacTokenEndTime=(0,r.u_)(),te?.ULS.sendTraceTag(507852513,i.n.Bo,s.k.Warning,"Neither JSAPI v1 or v2 applications were created"),mt.resolve(o.Completed)}))};return be=function(t,e,n){return t.pipe((0,m.H)((t=>t({container:e,flushTime:n}))))}(de,vt,e).subscribe((({officeApplication:t,bootedDocumentInfo:e,wopiHostData:o,wopiPendingApp:c,officeDocumentSession:a,wacBootDiagnostics:u})=>{if(me=t,we=a,ge=c,we)Se.resolve(we);else if(ge)He.resolve(ge);else{const t="No session found";Se.reject(t),He.reject(t)}const f=(0,nt.SI)(nt.dT.FeatureGate_OwlPostWacTokenForTeamsHosts,Nt?.featureGates);f&&!rt.Q5&&tt.Y3&&(te.ULS.sendTraceTag(507347490,i.n.Bo,s.k.Important,"WAC token posted after jsapi boot use postWacToken method"),oe?.recordKpiSuccess(X.ex.KPI_OwlPostWacTokenForTeams,{extendedProperties:new Map([["scenario","postWacTokenAfterBoot"]])}),tt.Y3?.then((t=>{Ae(t)})).catch((t=>{te.ULS.sendTraceTag(507347290,i.n.Bo,s.k.Error,`WAC token atempted to be posted after jsapi boot using postWacToken method, but failed: ${t}`)}))),f&&(0,rt.r$)();const d=(0,p.R)(window,"message").pipe((0,w.p)((t=>!!t.data&&!!t.origin&&t.origin.endsWith(at))),(0,g.T)((t=>JSON.parse(t.data))),(0,w.p)((t=>!(!t||!t.MessageId))));if(!re){const{documentRebootHandler:r,renameHandler:i,sessionRefreshInfoHandler:s,shareHandler:c,userAccessHandler:u,userActivityHandler:f,createNewHandler:h,getAuthTokenHandler:p,sendConversationIdHandler:m,closeTeamsConversationHandler:w,navigateBackToHostHandler:g,accessibilityLoopCompleteHandler:b,getClientUrlCompleteHandler:v,getWebUrlCompleteHandler:S,loadingStatusHandler:H,wopiInfoFromUrlHandler:I,davUrlFromIdsHandler:C,onCloseHandler:y,actionCompleteHandler:A,openInBrowserHandler:U,moveToFolderPickerHandler:T,commonFilePickerHandler:P,getCustomAuthConfigHandler:E,pushStateHandler:k,caaeMessageHandler:N,fileEmbedHandler:F,acquireOAuthTokenTeamsHandler:R}=ue(o,e,a);ce=[[Q.bi.PostMessage_SendConversationId,m],[Q.bi.PostMessage_CloseTeamsConversation,w],[Q.bi.PostMessage_NavigateBackToHost,g],[Q.bi.PostMessage_AccessibilityLoopComplete,b],[Q.bi.PostMessage_GetClientUrlComplete,v],[Q.bi.PostMessage_GetWebUrlComplete,S],[Q.bi.PostMessage_LoadingStatus,H],[Q.O5.Event_DocumentReboot,r],[Q.bi.PostMessage_FileRenamed,i],[Q.bi.PostMessage_CheckUserAccess,u],[Q.bi.PostMessage_Share,c],[Q.bi.PostMessage_UserActivity,f],[Q.bi.PostMessage_AppCreateNewDocument,h],[Q.bi.PostMessage_OpenInBrowser,U],[Q.O5.Event_MoveToFolder,T],[Q.O5.Event_SharedFilePicker,P],[Q.O5.Event_GetCustomAuthConfig,E],[Q.bi.PostMessage_CAAEMessage,N],[Q.bi.PostMessage_AcquireOAuthTokenTeams,R]],n.fileType===l.p.Excel&&(ce.push([Q.O5.Event_GetWopiInfoFromUrl,I]),ce.push([Q.O5.Event_GetDavUrlFromIds,C])),ce.forEach((([e,n])=>{t.RegisterEventHandler(e,n)})),ve=d.subscribe((t=>{switch(t.MessageId){case Q.bi.PostMessage_AppRefreshSessionInfo:s(t.Values);break;case Q.bi.PostMessage_GetAuthToken:p(t.Values);break;case Q.bi.PostMessage_Close:y();break;case Q.bi.PostMessage_ActionComplete:A(t.Values);break;case Q.bi.PostMessage_AppPushState:k(t.Values);break;case Q.bi.PostMessage_FileEmbed:F()}}))}if(It){te?.ULS.sendTraceTag(546182049,i.n.Bo,s.k.Info,"BootApp: About to execute OnBootComplete"),(0,r.l8)(it.ls.OwlOnBootComplete);const t=(0,it.nC)((0,it.nu)("owl"));if(te?.ULS.sendTraceTag(508568928,i.n.Bo,s.k.Important,`FileType: ${n.fileType}, Environment: ${bt.wiseEnvironment}, Feature Gates: ${Nt?.featureGates?(0,st.c)(Nt?.featureGates):"{}"}, UiHost: ${Nt?.uiHostName}, Integration Type: ${Nt?.uiHostIntegrationType}, OwlTraditional Telemetry Data: ${JSON.stringify(t)}`),"PRODUCTION"===bt.wiseEnvironment){const t=(0,nt.SI)(nt.dT.FeatureGate_EnableJsapiTags,Nt?.featureGates);setTimeout((async()=>{const e=document.createElement("div");document.body.appendChild(e),(0,ct.J)(e,n.fileType,te,t);const o=setInterval((()=>{(0,ct.J)(e,n.fileType,te,t)}),18e5);pt.push(o)}),3e4)}oe?.recordKpiSuccess(X.ex.KPI_OwlBoot),Ht(e).then((t=>{It(n,u,t)})).catch((t=>{It(n,u)}))}}),(t=>{Ct&&(te?.ULS.sendTraceTag(546182050,i.n.Bo,s.k.Info,"BootApp: About to execute OnBootFailure"),oe?.recordKpiFailure(X.ex.KPI_OwlBoot,t.errorName,!0,!1,{extendedProperties:new Map([["errorMessage",t.errorMessage],["wacErrorName",t.wacErrorName],["qosErrorName",t.qosErrorName]])}),Ct(t)),be?.unsubscribe(),ve?.unsubscribe()})),{endSession:ae,sessionEndObservable:Ie.asObservable(),hostAccessibilityLoopComplete:t=>((0,I.Q)(Q.Ph.PostMessage_HostAccessibilityLoopComplete,{Direction:t?"forward":"backward"},pe,we,te),!0),hostGetClientUrl:()=>{(0,I.Q)(Q.Ph.PostMessage_HostGetClientUrl,{},pe,we,te)},hostGetWebUrl:()=>{(0,I.Q)(Q.Ph.PostMessage_HostGetWebUrl,{},pe,we,te)},hostBackButtonPressed:()=>((0,I.Q)(Q.Ph.PostMessage_HostBackButtonPressed,{},pe,we,te),!0),hostSendConversationId:ye,postWacToken:Ae,completeCreateNew:t=>{"success"===t.state&&t.newFile&&t.newFile.title&&(ot.W.fileName=t.newFile.title),ot.W.sessionPromise.then((e=>{e?e.run(u.Y.completeCreateNew,t).then((t=>ot.W.completeCreateNew(t))).catch((t=>{te.ULS.sendTraceTag(507778315,i.n.Bo,s.k.Warning,`Caught error running completeCreateNew flow: ${t}`),ot.W.failCreateNew(t)})):(te.ULS.sendTraceTag(507778314,i.n.Bo,s.k.Warning,"Attempting to run completeCreateNew flow without an OfficeDocumentSession."),ot.W.failCreateNew(new Error("session is undefined")))})).catch((t=>{te.ULS.sendTraceTag(507331607,i.n.Bo,s.k.Error,`Encountered error in completeCreateNew: ${t}`)}))}}}function Ht(t){return(e=t,e.asObservable().pipe((0,b.s)(1)).toPromise()).then((t=>(!t.fileName&&ot.W.fileName&&(t.fileName=ot.W.fileName),t)));var e}},71888:function(t,e,n){var o;n.d(e,{e:function(){return r}}),function(t){t.RPSCompact="RPSCompact",t.RPSDelegation="RPSDelegation",t.JWT="JWT"}(o||(o={}));const r="e03a13ee-9730-4cae-8525-47559c8cf18a"},59842:function(t,e,n){n.d(e,{e:function(){return o}});const o=["id","openWith","officebundle","currentUserRole","eTag","name","size","content.downloadUrl","file","sharepointIds","sensitivityLabel","webUrl","webDavUrl","parentReference","content.downloadCode"]},51445:function(t,e,n){var o;function r(t){const e=t.toUpperCase();return"CHC"===e||"DEC"===e||"EUC"===e||"EURPPC"===e||"FRC"===e||"SEC"===e||"NOC"===e?o.EuropeanUnion:o.RestOfWorld}n.d(e,{n:function(){return o},y:function(){return r}}),function(t){t[t.RestOfWorld=0]="RestOfWorld",t[t.EuropeanUnion=1]="EuropeanUnion"}(o||(o={}))},91581:function(t,e,n){n.d(e,{$2:function(){return a},C6:function(){return s},ob:function(){return c},yc:function(){return i}});var o=n(51445);function r(t,e){switch(t){case"FASTFOOD":return"https://ffc-common.online.office.com/suite/";case"MSIT":return"https://ppc-common.online.office.com/suite/";case"PRODUCTION":default:return e===o.n.EuropeanUnion?"https://euc-common.online.office.com/suite/":"https://common.online.office.com/suite/";case"GALLATIN":return"https://common.partner.officewebapps.cn/suite/";case"USGOV":return"https://gbc-common.online.office.com/suite/";case"TRAILBLAZER":return"https://common.gov.online.office365.us/suite/";case"PATHFINDER":return"https://common.dod.online.office365.us/suite/";case"AIRGAP08":return"https://common.wac.online.office.eaglex.ic.gov/suite/";case"AIRGAP09":return"https://common.wac.online.office.microsoft.scloud/suite/"}}function i(t,e){return r(t,e)+"RemoteUls.ashx"}function s(t,e,n){let o=r(t,n)+"RemoteTelemetry.ashx";return e&&(o+="?usid="+e),o}function c(t){switch(t){case"GALLATIN":return"https://microsoftgraph.chinacloudapi.cn";case"TRAILBLAZER":return"https://graph.microsoft.us";case"PATHFINDER":return"https://dod-graph.microsoft.us";case"AIRGAP08":return"https://graph.eaglex.ic.gov";case"AIRGAP09":return"https://graph.microsoft.scloud";default:return"https://graph.microsoft.com"}}function a(t){switch(t){case"TRAILBLAZER":return"https://admin.onedrive.us/share";case"PATHFINDER":return"https://od.apps.mil/share";case"AIRGAP08":return"https://odweba.svc.ms.eaglex.ic.gov/share";case"AIRGAP09":return"https://odweba.svc.ms.microsoft.scloud/share";default:return"https://www.odwebp.svc.ms/share"}}},22404:function(t,e,n){n.d(e,{U$:function(){return i}});var o=n(97326),r=n(7867);class i{static toFeatureGateConfig(t,e){if(null==t||""===t||"null"===t)return[];try{return function(t,e,n){return u(t,e,c,n)}(JSON.parse(t),f(l("FeatureGateConfig")),e)}catch(n){return e?.ULS.sendTraceTag(521413921,o.n.Bo,r.k.Error,`Unable to parse JSON string: "${t}", due to expection: ${n}`),[]}}static featureGateConfigToJson(t,e){return JSON.stringify(function(t,e,n){return u(t,e,a,n)}(t,f(l("FeatureGateConfig")),e),null,2)}}function s(t,e,n,i=""){if(i?n?.ULS.sendTraceTag(521414033,o.n.Bo,r.k.Error,`Invalid value for key "${i}". Expected type ${JSON.stringify(t)} but got ${JSON.stringify(e)}`):n?.ULS.sendTraceTag(521414034,o.n.Bo,r.k.Error,`Invalid value ${JSON.stringify(e)} for type ${JSON.stringify(t)}`),"boolean"==typeof t){if("string"==typeof e){const t=function(t){try{const e=JSON.parse(t.toLowerCase());return"boolean"==typeof e&&e}catch(t){return!1}}(e);if("boolean"==typeof t)return t}return!1}return"string"==typeof t?"":"number"==typeof t?0:typeof t==typeof[]?[]:"Date"===t?new Date:"array"===t?[]:"object"===t?{}:void 0}function c(t){if(void 0===t.jsonToJS){const e={};t.props.forEach((t=>e[t.json]={key:t.js,typ:t.typ})),t.jsonToJS=e}return t.jsonToJS}function a(t){if(void 0===t.jsToJSON){const e={};t.props.forEach((t=>e[t.js]={key:t.json,typ:t.typ})),t.jsToJSON=e}return t.jsToJSON}function u(t,e,n,o,r=""){let i=e;if("any"===i)return t;if(null===i)return null===t?t:s(i,t,o);if(!1===i)return s(i,t,o);for(;"object"==typeof i&&void 0!==i.ref;)i=d[i.ref];return Array.isArray(i)?function(t,e){return-1!==t.indexOf(e)?e:s(t,e,o)}(i,t):"object"==typeof i?i.hasOwnProperty("unionMembers")?function(t,e){const r=t.length;for(let i=0;i<r;i++){const r=t[i];try{return u(e,r,n,o)}catch(t){}}return s(t,e,o)}(i.unionMembers,t):i.hasOwnProperty("arrayItems")?function(t,e){return Array.isArray(e)?e.map((e=>u(e,t,n,o))):s("array",e,o)}(i.arrayItems,t):i.hasOwnProperty("props")?function(t,e,r){if(null===r||"object"!=typeof r||Array.isArray(r))return s("object",r,o);const i={};return Object.getOwnPropertyNames(t).forEach((e=>{const s=t[e],c=Object.prototype.hasOwnProperty.call(r,e)?r[e]:void 0;i[s.key]=u(c,s.typ,n,o,s.key)})),Object.getOwnPropertyNames(r).forEach((s=>{Object.prototype.hasOwnProperty.call(t,s)||(i[s]=u(r[s],e,n,o,s))})),i}(n(i),i.additional,t):s(i,t,o):i===Date&&"number"!=typeof t?function(t){if(null===t)return null;const e=new Date(t);return isNaN(e.valueOf())?s("Date",t,o):e}(t):function(t,e){return typeof t==typeof e?e:s(t,e,o,r)}(i,t)}function f(t){return{arrayItems:t}}function l(t){return{ref:t}}const d={FeatureGateConfig:(h=[{json:"ConfigId",js:"ConfigId",typ:""},{json:"IsEnabled",js:"IsEnabled",typ:!0},{json:"SettingsRings",js:"SettingsRings",typ:""}],!1,{props:h,additional:false})};var h},87290:function(t,e,n){var o,r,i,s,c,a;n.d(e,{O5:function(){return o},Ph:function(){return s},bi:function(){return r},n_:function(){return c}}),function(t){t.Event_DocumentReboot="DocReboot",t.Event_SetOverlayContent="SetOverlayContent",t.Event_GetWopiInfoFromUrl="WopiInfoFromUrl",t.Event_Unloaded="Unloaded",t.Event_MoveToFolder="MoveToFolder",t.Event_SharedFilePicker="FilePicker",t.Event_GetCustomAuthConfig="GetCustomAuthConfig",t.Event_GetDavUrlFromIds="DavUrlFromIds"}(o||(o={})),function(t){t.PostMessage_FileRenamed="File_Rename",t.PostMessage_Close="UI_Close",t.PostMessage_EditModeSwitch="UI_Edit",t.PostMessage_FileVersion="UI_FileVersions",t.PostMessage_SaveStatus="UI_SaveStatus",t.PostMessage_Share="UI_Sharing",t.PostMessage_Workflow="UI_Workflow",t.PostMessage_UserActivity="User_Activity",t.PostMessage_EditNotification="Edit_Notification",t.PostMessage_CheckUserAccess="UI_CheckUserAccessAndGrantPermissions",t.PostMessage_PostMessageDocReboot="App_DocReboot",t.PostMessage_AppRefreshSessionInfo="App_RefreshSessionInfo",t.PostMessage_AppCreateNewDocument="App_CreateNewDocument",t.PostMessage_GetAuthToken="App_GetAuthToken",t.PostMessage_NavigateBackToHost="NavigateBackToHost",t.PostMessage_SendConversationId="App_SendConversationId",t.PostMessage_CloseTeamsConversation="CloseTeamsConversation",t.PostMessage_AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.PostMessage_GetClientUrlComplete="App_GetClientUrlComplete",t.PostMessage_GetWebUrlComplete="App_GetWebUrlComplete",t.PostMessage_LoadingStatus="App_LoadingStatus",t.PostMessage_ActionComplete="Wac_ActionComplete",t.PostMessage_OpenInBrowser="UI_OpenInBrowser",t.PostMessage_AppGetCustomAuthConfig="App_GetCustomAuthConfig",t.PostMessage_AppPushState="App_PushState",t.PostMessage_CAAEMessage="CAAEMessage",t.PostMessage_FileEmbed="UI_FileEmbed",t.PostMessage_AcquireOAuthTokenTeams="AcquireOAuthTokenTeams"}(r||(r={})),function(t){t.Nav="actnavid"}(i||(i={})),function(t){t.PostMessage_RefreshSessionInfo="Host_RefreshSessionInfo",t.PostMessage_GrantPermissions="CheckUserAccessAndGrantPermissions_Result",t.PostMessage_SetOverlayContent="SetOverlayContent",t.PostMessage_SetAuthToken="Host_SetAuthToken",t.PostMessage_SetHostWopiInfoFromUrl="Host_WopiInfoFromUrl",t.PostMessage_HostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",t.PostMessage_HostGetClientUrl="Host_GetClientUrl",t.PostMessage_HostGetWebUrl="Host_GetWebUrl",t.PostMessage_MoveToFolderCompleted="Host_MoveToFolder",t.PostMessage_CompleteFilePicker="Host_FilePicker",t.PostMessage_SendCustomAuthConfig="Host_SetCustomAuthConfig",t.PostMessage_SetDavUrlFromIds="Host_DavUrlFromIds",t.PostMessage_BlurFocus="Blur_Focus",t.PostMessage_PopState="App_PopState",t.PostMessage_GrabFocus="Grab_Focus",t.PostMessage_HostSendChannelId="Host_SendChannelId",t.PostMessage_HostBackButtonPressed="Host_BackButtonPressed",t.PostMessage_HostSendConversationId="Host_SendConversationId",t.PostMessage_PostWacToken="Host_PostWacToken",t.PostMessage_CanEmbed="CanEmbed"}(s||(s={})),function(t){t.SameDocument="0",t.NewDocument="1"}(c||(c={})),function(t){t.AccessToken="AccessToken",t.FileGetUrl="FileGetUrl"}(a||(a={}))},6439:function(t,e,n){n.d(e,{Ip:function(){return u},R7:function(){return a},Rt:function(){return d},hK:function(){return c},wR:function(){return l}});var o=n(31376),r=n(11741),i=n(91581),s=n(96793);class c{setUlsLogger(t){const e=(0,i.yc)(this.environment);return(0,o.Jf)({remoteUlsEndpoint:e,sessionId:t})}constructor(t,e){"string"==typeof t?this.sessionId=t:[this.sessionId]=t,this.environment=e,this.logger=this.setUlsLogger(this.sessionId)}}class a{constructor(t,e,n,o,s,c,a,u,f,l,d,h){const p=(0,i.C6)(n,t),m={application:e.toString(),applicationMode:"UnifiedUiHost",applicationModeExtended:"UNIFIEDUIHOST",session_id:t,clientVersion:o??"n/a",isSynthetic:c,applicationLcid:a,loggableUserId:u,tenantId:f,uiHost:l,uiHostIntegrationType:d,sessionOrigin:h};this.health=r.Xk.getInstance(),this.health.initialize({isHealthEnabled:!0,isOfflineEnabled:!1,remoteTelemetryUrl:p,dimensions:m}),this.health.addOrUpdatePartCDimension("UUIHTargetApp",e.toString()),this.health.addOrUpdatePartCDimension("HealthSourceComponent","UnifiedUiHost"),this.health.addOrUpdatePartCDimension("WiseEnvironment",n.toString()),this.health.addOrUpdatePartCDimension("Exposure",s?.toString()??"n/a")}}function u(){const t=performance.getEntriesByType("navigation"),e=t[0]?.toJSON();if(e)return{connectEnd:e.connectEnd,connectStart:e.connectStart,decodedBodySize:e.decodedBodySize,domainLookupEnd:e.domainLookupEnd,domainLookupStart:e.domainLookupStart,domComplete:e.domComplete,domContentLoadedEventEnd:e.domContentLoadedEventEnd,domContentLoadedEventStart:e.domContentLoadedEventStart,domInteractive:e.domInteractive,duration:e.duration,encodedBodySize:e.encodedBodySize,entryType:e.entryType,fetchStart:e.fetchStart,initiatorType:e.initiatorType,loadEventEnd:e.loadEventEnd,loadEventStart:e.loadEventStart,nextHopProtocol:e.nextHopProtocol,redirectCount:e.redirectCount,redirectEnd:e.redirectEnd,redirectStart:e.redirectStart,requestStart:e.requestStart,responseEnd:e.responseEnd,responseStart:e.responseStart,secureConnectionStart:e.secureConnectionStart,serverTiming:e.serverTiming,startTime:e.startTime,transferSize:e.transferSize,type:e.type,unloadEventEnd:e.unloadEventEnd,unloadEventStart:e.unloadEventStart,workerStart:e.workerStart}}function f(t,e){const n=window.performance.getEntriesByType("resource").filter((n=>n.name.includes(t)&&n.name.endsWith(e))),o=n[0]?.toJSON();var r;if(o)return{connectStart:o.connectStart,secureConnectionStart:o.secureConnectionStart,connectEnd:o.connectEnd,domainLookupStart:o.domainLookupStart,domainLookupEnd:o.domainLookupEnd,redirectStart:o.redirectStart,redirectEnd:o.redirectEnd,requestStart:o.requestStart,responseStart:o.responseStart,responseEnd:o.responseEnd,fetchStart:o.fetchStart,workerStart:o.workerStart,duration:o.duration,decodedBodySize:o.decodedBodySize,encodedBodySize:o.encodedBodySize,transferSize:o.transferSize,entryType:o.entryType,initiatorType:o.initiatorType,nextHopProtocol:o.nextHopProtocol,serverTiming:o.serverTiming,startTime:o.startTime,isCached:(r=o,r.transferSize>=0?0===r.transferSize:r.responseEnd-r.fetchStart<100)}}function l(){return f("owl.slim",".js")}function d(t){let e;switch(t){case s.p.Word:e="word.boot";break;case s.p.Excel:e="excel-boot";break;case s.p.PowerPoint:e="powerpoint.app.boot";break;case s.p.OneNote:e="onenote-boot";break;case s.p.Visio:e="visio.boot";break;default:return}return f(e,".js")}},27474:function(t,e,n){var o,r,i,s,c,a,u;n.d(e,{HR:function(){return u},R7:function(){return a},S2:function(){return i},SQ:function(){return l},by:function(){return c},ex:function(){return r},pP:function(){return f},zJ:function(){return s}}),function(t){t.DriveId="drive",t.ItemId="item",t.DocUrl="file",t.ContentUri="contenturi",t.Nav="nav"}(o||(o={})),function(t){t.KPI_DavUrlFromIds="DavUrlFromIds",t.KPI_FilePicker="FilePicker",t.KPI_OwlBoot="OwlBoot",t.KPI_OwlPostWacTokenForTeams="OwlPostWacTokenForTeams",t.KPI_PostWacToken="PostWacToken",t.KPI_PrebootDocument="PrebootDocument",t.KPI_PrebootDocumentOpen="PrebootDocumentOpen",t.KPI_WopiAuthRefresh="WopiAuthRefresh",t.KPI_WopiAuthFetch="WopiAuthFetch",t.KPI_WopiInfoFromUrl="WopiInfoFromUrl",t.KPI_PrintRedirect="PrintRedirect",t.KPI_PrintInBrowser="PrintInBrowser"}(r||(r={})),function(t){t.FC_Owl="owlfc"}(i||(i={})),function(t){t.QosVeto_ShareDialogExperienceDegraded="ShareDialogExperienceDegraded",t.QosVeto_CreateNewExperienceDegraded="CreateNewExperienceDegraded",t.QosVeto_ExternalLinksExperienceDegraded="ExternalLinksExperienceDegraded",t.QosVeto_WopiAuthExperienceDegraded="WopiAuthExperienceDegraded",t.QosVeto_FilePickerFailed="FilePickerFailed",t.QosVeto_OpenInExperienceFailed="OpenInExperienceFailed",t.QosVeto_PrintRedirectFailed="PrintRedirectFailed",t.QosVeto_PrintInBrowserFailed="PrintInBrowserFailed"}(s||(s={})),function(t){t.QosError_VroomWopiFailure="VroomWopiFailure",t.QosError_OfficeBootstrapperNotLoaded="OfficeBootstrapperNotLoaded",t.QosError_EncounteredJsApiError="EncounteredJsApiError",t.QosError_FailedToLoadDocument="FailedToLoadDocument",t.QosError_AttemptingToBootDocumentFailed="AttemptingToBootDocumentFailed",t.QosError_DavUrlFromIdsFailure="DavUrlFromIdsFailure",t.QosError_ShareDialogHandlerInitFailure="ShareDialogHandlerInitFailure",t.QosError_ShareDialogHandlerHostReportedFailure="ShareDialogHandlerHostReportedFailure",t.QosError_ShareDialogHandlerGenericFailure="ShareDialogHandlerGenericFailure",t.QosError_ShareDialogHandlerPerfFailure="ShareDialogHandlerPerfFailure",t.QosError_CreateNewHandlerRebootSessionFailure="CreateNewHandlerRebootSessionFailure",t.QosError_CreateNewHandlerCreateDocumentFailure="CreateNewHandlerCreateDocumentFailure",t.QosError_CreateNewHandlerEndSessionFailure="CreateNewHandlerEndSessionFailure",t.QosError_CreateNewHandlerGenericFailure="CreateNewHandlerGenericFailure",t.QosError_WopiRefreshAuthTokenFailure="WopiRefreshAuthTokenFailure",t.QosError_WopiFetchAuthTokenFailure="WopiFetchAuthTokenFailure",t.QosError_WopiInfoFromUrlFailure="WopiInfoFromUrlFailure",t.QosError_FilePickerBootFailed="FilePickerBootFailed",t.QosError_RetrievingWopiHostDataFailed="RetrievingWopiHostDataFailed",t.QosError_SelectedItemNotReturned="SelectedItemNotReturned",t.QosError_SelectedItemMissingProperties="SelectedItemMissingProperties",t.QosError_UrlNotProvided="UrlNotProvided",t.QosError_CallbackNotDefined="CallbackNotDefined",t.QosError_PrintRedirectFailedToOpenBrowser="PrintRedirectFailedToOpenBrowser",t.QosError_PrintRedirectUnknownFailure="PrintRedirectUnknownFailure",t.QosError_PrintRedirectMissingWebUrl="PrintRedirectMissingWebUrl",t.QosError_PrintRedirectFailedToOpenPdf="PrintRedirectFailedToOpenPdf",t.QosError_PrintInBrowserFailedToOpenPdf="PrintInBrowserFailedToOpenPdf",t.QosError_PrintInBrowserUnknownFailure="PrintInBrowserUnknownFailure",t.QosError_PrintInBrowserWopiFailed="PrintInBrowserWopiFailed"}(c||(c={})),function(t){t.pr="Bootstrapfile_WacDocumentVroomError",t.Ir="LoadDocument_WacDocumentVroomError",t.Hr="WacDocumentBootstrapperLoadError",t.Sr="WacInitializeWopiPendingError",t.Ar="WacDocumentGenericBootError",t.vr="WacDocumentJsApiV1Error",t.br="WacDocumentJsApiV2Error",t.wr="WacDocumentJsApiV2Error_App",t.gr="WacDocumentJsApiV2Error_JsApi",t.mr="WacDocumentJsApiV2Error_Timeout",t.Ur="OwlPrintError"}(a||(a={})),function(t){t.PermissionError="PermissionError",t.NotFound="NotFound",t.Throttling="Throttling",t.Offline="Offline",t.Other="Other"}(u||(u={}));const f={};var l;!function(t){t.New="NEW",t.BackstageMru="BACKSTAGE-MRU",t.Reboot="REBOOT"}(l||(l={}))},41779:function(t,e,n){n.d(e,{BK:function(){return nt},C4:function(){return wt},DU:function(){return at},Dp:function(){return rt},Ro:function(){return it},Y3:function(){return W},_G:function(){return gt},cL:function(){return dt},cv:function(){return ht},eK:function(){return pt},gp:function(){return et},gv:function(){return mt},h_:function(){return ft},jW:function(){return O},xt:function(){return ut},yI:function(){return lt}});var o=n(97326),r=n(7867),i=n(96699),s=n(16424),c=n(16896),a=n(96793),u=n(2639),f=n(97605),l=n(91581),d=n(6439),h=n(27474),p=n(71888),m=n(59842),w=n(39095),g=n(8169),b=n(5840),v=n(66711),S=n(34624),H=n(75607),I=n(77045),C=n(42831),y=n(29819),A=n(17935),U=n(35587),T=n(61891),P=n(43780),E=n(69790),k=n(72470),N=n(60254),F=n(75212),R=n(29808);let D,W;const O=new w.Z;let M,$,_,j,B,L,x,K,G,V,q,J,z,Z=!1,Q=!1,X=!1;const Y="owl-container",tt=new w.Z;let et=!1;function nt(t){if(!t?.clientVersion?.trim())throw new Error("invalid clientVersion");if(!t.exposure||t.exposure<=0||t.exposure>100)throw new Error("invalid exposure ("+(t.exposure??"undefined")+")");t.wiseEnvironment=t.wiseEnvironment?.toLocaleUpperCase(),D=t}function ot(t){return document.getElementById(Y)??ct(t,Y)}function rt(){if(D)return D.clientVersion;x?.ULS.sendTraceTag(508060617,o.n.Bo,r.k.Error,"You must call initPackage before calling getOwlVersion")}function it(t,e){if("Graph"===t)return(0,l.ob)(z);{const n=x??e;return n?.ULS.sendTraceTag(507318481,o.n.Bo,r.k.Warning,`Unknown token consumer: ${t}`),""}}function st(t){if(!t)return;let e;try{e=new URL(t)}catch(t){return}return new URLSearchParams(e.search).get("nav")??void 0}function ct(t,e){const n=document.createElement("div");return n.id=e,t.appendChild(n)}function at(t){return M?M(t):Promise.reject("endSession not defined")}function ut(t){return $?$(t):(x?.ULS.sendTraceTag(555872272,o.n.Bo,r.k.Error,"hostAccessibilityLoopComplete no defined"),!1)}function ft(){return B?B():(x?.ULS.sendTraceTag(508127040,o.n.Bo,r.k.Error,"hostBackButtonPressed no defined"),!1)}function lt(){if(_)return x?.ULS.sendTraceTag(508355844,o.n.Bo,r.k.Info,"Trying to get hostGetClientUrl."),void _();x?.ULS.sendTraceTag(526152082,o.n.Bo,r.k.Error,"hostGetClientUrl not defined")}function dt(){if(j)return x?.ULS.sendTraceTag(508352272,o.n.Bo,r.k.Info,"Trying to get WebUrl"),void j();x?.ULS.sendTraceTag(508352271,o.n.Bo,r.k.Error,"hostGetWebUrl not defined")}function ht(t){L?L(t):tt.then((e=>e(t))).catch((t=>x?.ULS.sendTraceTag(507331606,o.n.Bo,r.k.Error,`createNewComplete encountered error: ${t}`)))}function pt(t){const e=(0,i.u_)();(0,g.H)(),(0,i.l8)([b.ls.OwlStart,"packageEntryTime"]);const{documentIdentifier:f,sessionConfig:m,uiHostConfig:w,getAuthToken:y,eventHandlers:A,container:U}=t;z=D?.wiseEnvironment??m.wiseEnvironment;const T={...f,fileType:m.fileType,wdOrigin:m.sessionOrigin??"TEAMS.UNIFIEDUIHOST.OPEN",wdValue:m.wdValue,uiCulture:m.uiCulture,dataCulture:m.dataCulture,puid:m.puid,clickTime:m.clickTime,isNewFile:m.isNewFile,isTwoStepCreateNew:m.isTwoStepCreateNew,navId:st(f.shareUrl??f.docUrl),templateId:f.templateId,intent:m.intent??"open"},P=(0,u.R4)(T),E=m.sessionId||P||(0,s.O)()[0];m.bootDiagnostics=m.bootDiagnostics||{};const k=m.bootDiagnostics.ringId;m.bootDiagnostics.packageEntryTime=m.bootDiagnostics.packageEntryTime||e,x=new d.hK(E,z).logger,m.logger=x;const N=E===P,F=m?.isNewFile;m.bootDiagnostics.isPrebooted=N,(0,v.NM)(m,E,w,k,F,D,z,x),K=m.health;const R=new Map;if(R.set("StartTime",(new Date).toUTCString()),K?.recordKpiUsage(h.ex.KPI_OwlBoot,c.v.SuccessBased,h.S2.FC_Owl,R),V=function(t,e){switch(t){case a.p.PowerPoint:return(0,S.SI)(S.dT.FeatureGate_Vroom21SupportGate,e.featureGates);case a.p.Word:return(0,S.SI)(S.dT.FeatureGate_Vroom21ForWord,e.featureGates);case a.p.Excel:return(0,S.SI)(S.dT.FeatureGate_Vroom21ForExcel,e.featureGates);default:return!1}}(m.fileType,w),Q=(0,S.SI)(S.dT.FeatureGate_DeprecatePreAuthUrl,w.featureGates),Z=(0,S.SI)(S.dT.FeatureGate_OwlPostWacTokenForTeamsHosts,w.featureGates),N){const t=new Map;t.set("StartTime",(new Date).toUTCString()),(0,u.pp)(T,E),K?.recordKpiUsage(h.ex.KPI_PrebootDocumentOpen,c.v.FailureBased,h.S2.FC_Owl,t)}if(G=ot(U),!(f.docUrl||f.driveId&&f.docId||f.shareUrl||f.baseUrl&&f.fileId))return void x?.ULS.sendTraceTag(576217559,o.n.Bo,r.k.Error,"No document url is found. Exit");J=(0,S.SI)(S.dT.FeatureGate_UseSeparateVroomAccessTokenFn,w.featureGates);const O=wt(y,f.docTenantId);let M;M=J?wt(y):wt(y,f.docTenantId);const $={correlationId:m.hostCorrelationId,officeHomeApiRoot:"",getAccessToken:J?O:M};(0,S.SI)(S.dT.FeatureGate_UseConvergedConsumerVroomEndpointForMsa,w.featureGates)&&m.isMsa&&($.isConsumer=!0,$.oneDriveConsumerApi="https://my.microsoftpersonalcontent.com/_api/v2.0",$.oneDriveResourceId="https://my.microsoftpersonalcontent.com");const _={...m,shareApiEndpoint:(0,l.$2)(z),metaUiHostVersion:H.g.version,logger:x,sessionId:E};Z&&["teams","assignments"].includes(t.uiHostConfig.uiHostName??"")&&(I.GE.set("StartTime",(new Date).toUTCString()),K?.recordKpiUsage(h.ex.KPI_OwlPostWacTokenForTeams,c.v.SuccessBased,h.S2.FC_Owl,I.GE),x?.ULS.sendTraceTag(507249563,o.n.Bo,r.k.Important,`Fetching token for Teams host: ${t.uiHostConfig.uiHostName}: ${t.uiHostConfig.uiHostIntegrationType}`),W=M("None",!1,p.e).then((t=>(I.GE.set("EndTime",(new Date).toUTCString()),_.wacToken=t.token,t.token))).catch((t=>(x?.ULS.sendTraceTag(507347487,o.n.Bo,r.k.Error,`Error posting WAC token: ${t}`),K?.recordKpiFailure(h.ex.KPI_OwlPostWacTokenForTeams,`Access Token Fetch Failure ${t}`,!1,!0,{extendedProperties:I.GE}),""))));const j={isESSEnabled:_.isESSEnabled,wacDataCenter:_.isESSEnabled?(0,C.m)(m.fileType):void 0,sessionId:_.sessionId,hostCorrelationId:_.hostCorrelationId};q=(0,S.SI)(S.dT.FeatureGate_UseWacParamsCopy,w.featureGates),X=(0,S.SI)(S.dT.FeatureGate_OmitParamsOnSessionRefresh,w.featureGates);const B={documentBootInfo:T,fetchItemFromNetwork:gt($,z,j,V,q,X),fetchAccessToken:M,openShareControl:async t=>(await n.e(6720).then(n.bind(n,36617))).openVanillaJsShareControl(t,{},G),sessionConfig:_,onBootComplete:A.onBootComplete,onBootFailure:A.onBootFailure,onReturnFocus:A.onReturnFocus,onConversationClose:A.onConversationClose,onAcquireOAuthTokenTeams:A.onAcquireOAuthTokenTeams,onNavigateBack:A.onNavigateBack,onOpenPageLevelConversation:A.onOpenPageLevelConversation,onDocumentClose:()=>{A.onDocumentClose&&A.onDocumentClose(),K?.shutdown()},onSuccessNotification:A.onSuccessNotification,onDismissHostSpinner:A.onDismissHostSpinner,onOpenInMobileApp:A.onOpenInMobileApp,onRename:A.onRename,initializeTwoStepCreateNew:A.initializeTwoStepCreateNew,bootstrapFile:A.bootstrapFile,uiHostConfig:w,createDocument:async t=>{const e=await n.e(6720).then(n.bind(n,17967)),o={fileType:t.fileType,wdOrigin:"TEAMS.UNIFIEDUIHOST.NEW",uiCulture:m.uiCulture,dataCulture:m.dataCulture,puid:m.puid,clickTime:t.clickTime,isNewFile:!0};return e.createNewDocument($,o,t,z,x)},container:U};return mt(B)}function mt(t){const e=(0,i.u_)();(0,i.l8)(b.ls.OwlWithCustomFunctionsStart),(0,g.H)(),z=z??D?.wiseEnvironment??t.sessionConfig.wiseEnvironment,t.sessionConfig.sessionId=t.sessionConfig.sessionId??(0,s.O)()[0],t.sessionConfig.owlRollout=`${z}.${D?.exposure}`,t.sessionConfig.owlVersion=D?.clientVersion;const n="IsTwoStepCreateNewEnabled",a=!!t.documentBootInfo.isTwoStepCreateNew;t.uiHostConfig?t.uiHostConfig.featureGates?t.uiHostConfig.featureGates.set(n,a):t.uiHostConfig.featureGates=new Map([[n,a]]):t.uiHostConfig={featureGates:new Map([[n,a]])};const l=!!t.sessionConfig.health;if((0,v.C$)(t,D,z,t.sessionConfig.sessionId),l||(K=t.sessionConfig.health),x||(x=t.sessionConfig.logger),(0,N.wZ)()){const e=new URL(window.location.href),n=(0,F.eD)(e);x?.ULS.sendTraceTag(506566345,o.n.Bo,r.k.Info,`Redirecting to the print PDF experience from Original Redirect Session Id: ${n}`);const i=new Map([[R.d1.OriginalRedirectSessionId,n]]);return K?.recordKpiUsage(h.ex.KPI_PrintInBrowser,c.v.SuccessBased,h.S2.FC_Owl,i),(0,k.e)(t.documentBootInfo,t.fetchItemFromNetwork,x,!1,!1,1,!1,!0).then((n=>{const s=()=>{t.onBootComplete&&t.onBootComplete(t.documentBootInfo)},c=e=>{t.onBootFailure&&t.onBootFailure({errorMessage:e,wacErrorName:h.R7.Ur,qosErrorName:h.by.QosError_PrintInBrowserFailedToOpenPdf},t.documentBootInfo)};try{(0,N.HM)(t,n,e,t.sessionConfig.hostCorrelationId,i,s,c,x,K)}catch(t){x?.ULS.sendTraceTag(506566344,o.n.Bo,r.k.Error,t.message)}})).catch((t=>{x?.ULS.sendTraceTag(506566343,o.n.Bo,r.k.Error,`Error fetching WOPI data: ${t}`),K?.recordKpiFailure(h.ex.KPI_PrintInBrowser,h.by.QosError_PrintInBrowserWopiFailed,!1,!1,{inStaging:!0,extendedProperties:i})})),{postWacToken(t){}}}window._spPageContextInfo;const p=()=>({Hidden:document.hidden,VisibilityState:document.visibilityState,HasFocus:document.hasFocus(),Timestamp:(0,i.u_)()}),m=[p()];window.addEventListener("visibilitychange",(()=>m.push(p()))),window.addEventListener("focus",(()=>m.push(p()))),window.addEventListener("blur",(()=>m.push(p()))),f.h1.BootAttempted=!0,f.h1.Environment=f.qO.Environment=z,f.h1.Application=f.qO.Application=t.documentBootInfo.fileType,f.h1.BootStartTime=f.qO.BootStartTime=(0,i.u_)(),f.h1.StateEvents=f.qO.StateEvents=m,t.uiHostConfig&&(t.uiHostConfig.uiHostName&&(f.h1.UiHost=f.qO.UiHost=t.uiHostConfig.uiHostName),t.uiHostConfig.uiHostIntegrationType&&(f.h1.UiHostIntegrationType=f.qO.UiHostIntegrationType=t.uiHostConfig.uiHostIntegrationType)),t.sessionConfig&&(t.sessionConfig.hostCorrelationId&&(f.h1.HostCorrelationId=f.qO.HostCorrelationId=t.sessionConfig.hostCorrelationId),f.h1.IsAnonymous=f.qO.IsAnonymous=!!t.sessionConfig.isAnonymous,f.h1.IsSynthetic=f.qO.IsSynthetic=!!t.sessionConfig.isSynthetic),function(t,e){const n=t.onBootComplete,i=t.onBootFailure,s=t=>{et?e?.ULS.sendTraceTag(507540254,o.n.Bo,r.k.Warning,`Calling success or failure callback after another callback has already been called. Calling ${t}`):(e?.ULS.sendTraceTag(507540255,o.n.Bo,r.k.Important,JSON.stringify(f.h1)),et=!0,(0,f.an)())};t.onBootComplete=(t,e,o)=>{f.h1.BootSucceeded=f.qO.BootSucceeded=!0,s("onBootComplete"),O.resolve(!0),n&&n(t,e,o)},t.onBootFailure=(t,e)=>{f.qO.BootSucceeded=!1,s("onBootFailure"),O.resolve(!1),i&&i(t,e)}}(t,x),(0,f.Q7)(x),function(t,e){t.sessionConfig.bootDiagnostics=t.sessionConfig.bootDiagnostics||{},t.sessionConfig.bootDiagnostics.packageEntryTime=t.sessionConfig.bootDiagnostics.packageEntryTime||e,t.sessionConfig.bootDiagnostics.perfNavigationTiming=t.sessionConfig.bootDiagnostics.perfNavigationTiming||(0,d.Ip)(),t.sessionConfig.bootDiagnostics.perfOwlTiming=t.sessionConfig.bootDiagnostics.perfOwlTiming||(0,d.wR)(),t.sessionConfig.bootDiagnostics.loadManifestStartTime=t.sessionConfig.bootDiagnostics.loadManifestStartTime||D?.owlBootstrapperDiagnostics?.loadManifestStartTime||0,t.sessionConfig.bootDiagnostics.loadManifestEndTime=t.sessionConfig.bootDiagnostics.loadManifestEndTime||D?.owlBootstrapperDiagnostics?.loadManifestEndTime||D?.owlBootstrapperDiagnostics?.getManifestFromRemoteTimeElapsed,t.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed=t.sessionConfig.bootDiagnostics.getManifestFromRemoteTimeElapsed||D?.owlBootstrapperDiagnostics?.getManifestFromRemoteTimeElapsed,t.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed=t.sessionConfig.bootDiagnostics.loadManifestServerTimeElapsed||D?.owlBootstrapperDiagnostics?.loadManifestServerTimeElapsed,t.sessionConfig.bootDiagnostics.loadOwlStartTime=t.sessionConfig.bootDiagnostics.loadOwlStartTime||D?.owlBootstrapperDiagnostics?.loadOwlStartTime,t.sessionConfig.bootDiagnostics.loadOwlEndTime=t.sessionConfig.bootDiagnostics.loadOwlEndTime||D?.owlBootstrapperDiagnostics?.loadOwlEndTime}(t,e),t.sessionConfig.bootDiagnostics.isMsalV3DownloadEnabled=!1;const w=t.container;G=ot(t.container),t.container=G;const S=(0,u.R4)(t.documentBootInfo),H=t.sessionConfig.sessionId===S,I=t.onBootComplete;t.onBootComplete=(t,e,n)=>{I&&I(t,e,n)};const C=t.onBootFailure;t.onBootFailure=(n,o)=>{if(K?.recordQosError(n.qosErrorName,["UnifiedUiHostBootstrappingFailed"],(0,y.yC)(n),(0,y.wA)(n.wacErrorName),!0,!0,{inStaging:n.inStaging??!0,extendedProperties:(0,A.C)(n)}),H){const r=new Map;r.set("FailureTime",(new Date).toUTCString()),r.set("Error",n.error),o&&r.set("DocumentBootInfo",JSON.stringify(o)),n.httpErrorCode&&r.set("HttpErrorCode",n.httpErrorCode),K?.recordKpiFailure(h.ex.KPI_PrebootDocumentOpen,"PrebootDocumentOpenFailed",!1,!0,{durationMs:(0,i.u_)()-(t.sessionConfig.bootDiagnostics?.packageEntryTime||e),extendedProperties:r})}C&&C(n,o),K?.shutdown()};const T={...t,initPackageParams:D};(T.initializeTwoStepCreateNew??U.d)(T,x);const P=(0,f.k3)(T);M=P.endSession,$=P.hostAccessibilityLoopComplete,_=P.hostGetClientUrl,j=P.hostGetWebUrl,B=P.hostBackButtonPressed,L=P.completeCreateNew,tt.resolve(L);const E=e=>{const n=e.subscribe((e=>{if(e&&t.uiHostConfig?.supportsInternalReboot){const[r]=(0,s.O)(),c=new d.hK(r,z);t.sessionConfig.sessionId=c.sessionId,t.sessionConfig.logger=c.logger,t.sessionConfig.bootDiagnostics=(o=t.sessionConfig.bootDiagnostics,{tabsCacheHit:!0,packageEntryTime:(0,i.u_)(),isTestMode:o?.isTestMode,isPrebooted:!1,ringId:o?.ringId,teamsContextStartTime:0,teamsContextEndTime:0,perfNavigationTiming:(0,d.Ip)(),meetingLiveDiagnostics:void 0,perfOwlTiming:(0,d.wR)()}),t.sessionConfig.highContrastMode=e.theme,w&&G&&G.parentNode===w&&w.removeChild(G),G=ct(w,Y);const a=(0,f.k3)({...t,container:G,documentBootInfo:e.documentBootInfo,initPackageParams:D});M=a.endSession,$=a.hostAccessibilityLoopComplete,_=a.hostGetClientUrl,j=a.hostGetWebUrl,B=a.hostBackButtonPressed,L=a.completeCreateNew,tt.resolve(L),n.unsubscribe(),E(a.sessionEndObservable)}else w&&G&&G.parentNode===w&&w.removeChild(G),n.unsubscribe();var o;K?.shutdown()}))};return E(P.sessionEndObservable),(0,i.l8)([b.ls.OwlEnd,b.ls.OwlWithCustomFunctionsEnd]),P}function wt(t,e){return(n,s,c,a,u,f)=>(x?.ULS.sendTraceTag(546182046,o.n.Bo,r.k.Info,"FetchAccessToken: Start"),u&&(h.pP.accessTokenStartTime=(0,i.u_)(),(0,i.l8)("accessTokenStartTime")),t(c||it(n),f,e).then((t=>({success:!0,token:t,format:"JWT",source:"OfficeHome"}))).catch((t=>Promise.reject({api:"getAuthToken",failure:t,message:"Failed to retrieve auth token"}))).finally((()=>{x?.ULS.sendTraceTag(546182047,o.n.Bo,r.k.Info,"FetchAccessToken: End"),u&&(h.pP.accessTokenEndTime=(0,i.u_)(),(0,i.l8)("accessTokenEndTime"))})))}function gt(t,e,n,i,s,c){return async(a,u=!0,f=!1,l,d,h)=>{const p=!0;let w;w=f?"editnew":"view"===a.intent?"view":"edit"===a.intent?"edit":"open";let g=["openWith"],b=n;return!c||c&&d?(g=[...m.e],!h&&n?.isESSEnabled&&n.wacDataCenter&&!m.e.includes("wacSession")&&m.e.push("wacSession")):b=void 0,a.shareUrl?(l?.ULS.sendTraceTag(572634827,o.n.Bo,r.k.Info,"Item to be fetched using shareUrl"),(0,T.X)(a.shareUrl,s?g:m.e,t,p,w,!1,l,b,Q,!1,s).catch((e=>{if(e&&404===e.status&&"The site has been moved to a new location."===e.message&&e.redirectLocation)return l?.ULS.sendTraceTag(546120988,o.n.Bo,r.k.Info,"Get item failed due to site move. Retry with the redirect location"),(0,T.X)(e.redirectLocation,s?g:m.e,t,p,w,!1,l,b,Q,!0,s);throw e}))):a.driveId&&a.docId?(l?.ULS.sendTraceTag(572634828,o.n.Bo,r.k.Info,"Item to be fetched using driveId and docId"),(0,P.a)(a,s?g:m.e,t,p,w,e,l,b)):a.fileId&&a.baseUrl?(l?.ULS.sendTraceTag(572343521,o.n.Bo,r.k.Info,"Item to be fetched using fileId and baseUrl"),(0,E.A)(a.fileId,a.baseUrl,s?g:m.e,t,p,w,l,b,i).catch((e=>{if(e&&404===e.status&&e.redirectLocation){if(l?.ULS.sendTraceTag(508380358,o.n.Bo,r.k.Important,"Get item failed due to site move. Retry with the redirect location"),a.baseUrl){const t=new URL(a.baseUrl),n=new URL(e.redirectLocation);a.baseUrl=a.baseUrl.replace(t.hostname,n.hostname)}return(0,E.A)(a.fileId||"",a.baseUrl||"",s?g:m.e,t,p,w,l,b,i)}throw e}))):(l?.ULS.sendTraceTag(572634829,o.n.Bo,r.k.Info,"Item to be fetched using docUrl"),(0,T.X)(a.docUrl??"",s?g:m.e,t,p,w,!1,l,b,Q,!1,s).catch((t=>{throw t})))}}},42831:function(t,e,n){n.d(e,{F:function(){return c},m:function(){return s}});var o=n(96793);const r="WacDataCenter";function i(t){switch(t){case o.p.Word:case o.p.PowerPoint:case o.p.Excel:case o.p.OneNote:case o.p.Visio:return`${t.toString()}${r}`;default:return}}function s(t){const e=i(t);return(e?localStorage?.getItem(e):void 0)??localStorage?.getItem(r)??void 0}function c(t,e){if(e){localStorage?.setItem(r,e);const n=i(t);n&&localStorage?.setItem(n,e)}}},27310:function(t,e,n){function o(t,e){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()+e,t.getMinutes(),t.getSeconds(),t.getMilliseconds())}n.d(e,{L:function(){return o}})},86804:function(t,e,n){function o(t,e,n,o=!1,r,i=!1,s=!1,c,a,u){if(!document)return null;if(r){const t=document.getElementById(r);if(null!=t)return e&&e(),t}const f=document.createElement("script");if(f.src=t,r&&(f.id=r),e&&(f.onload=e),n&&(f.onerror=()=>{s&&f.parentNode?.removeChild(f),n()}),i&&(f.crossOrigin="anonymous"),u&&c&&!a&&(f.integrity=c),o){const t=document.getElementsByTagName("script")[0];if(t&&t.parentNode)return t.parentNode.insertBefore(f,t)}return document.body.appendChild(f)}n.d(e,{b:function(){return o}})},35587:function(t,e,n){n.d(e,{W:function(){return h},d:function(){return p}});var o=n(97326),r=n(7867),i=n(83754),s=n(66366),c=n(99602),a=n(97887),u=n(21872),f=n(82743),l=n(39095),d=n(34624);class h{static get isCreateNewFlowExecuting(){return!!(h.isTwoStepCreateNew&&h.createNewFlowExecuting&&h.hostSessionId&&h.bootstrapper&&h.bootstrapperLoadPromise&&h.bootstrapperUrl&&h.bootstrapperInfo&&h.application&&h.session)}static get isCreateNewFlowExecutingForJsApiBundledWithOwl(){return!!(h.isTwoStepCreateNew&&h.createNewFlowExecuting&&h.hostSessionId&&h.bootstrapperUrl&&h.application&&h.session)}static get completeCreateNewPromise(){return h.Tr}static completeCreateNew(t){this.Pr.resolve&&this.Pr.resolve(t)}static failCreateNew(t){this.Pr.reject&&this.Pr.reject(t)}}function p(t,e){if(h.isTwoStepCreateNew=!!(t.documentBootInfo.isNewFile&&t.documentBootInfo.isTwoStepCreateNew&&t.sessionConfig.createNewParams&&t.sessionConfig.createNewParams.appUrl&&(0,i.PS)(t.documentBootInfo.fileType,t.uiHostConfig?.featureGates,e)&&t.initPackageParams?.jsApiUrlInfos&&t.initPackageParams?.jsApiUrlInfos.get(t.documentBootInfo.fileType)),h.isTwoStepCreateNew){const n=t.initPackageParams.jsApiUrlInfos.get(t.documentBootInfo.fileType);if(n){h.bootstrapperUrl=n.jsApiUrl,h.hostSessionId=(0,s.d$)(t.sessionConfig.hostCorrelationId);const i=(0,d.SI)(d.dT.FeatureGate_EnableJsapiTags,t.uiHostConfig?.featureGates);(0,d.lO)(d.dT.FeatureGate_EnableJsapiTags,i,e),h.bootstrapperLoadPromise=(0,c.k)(n.jsApiUrl,t.sessionConfig.createNewParams.appUrl,t.documentBootInfo.fileType,!0,t.sessionConfig.wiseEnvironment,e,n.jsApiSri,t.sessionConfig?.owlRollout?.includes("LOCALHOST"),i).then((n=>{const[i,s]=(0,c.K)(t.documentBootInfo.fileType);if(s||!i||!h.hostSessionId)return e?.ULS.sendTraceTag(507778318,o.n.Bo,r.k.Warning,`Failed to load bootstrapper for ${t.documentBootInfo.fileType} in 2-step create new flow. Error: ${s}`),!1;h.bootstrapper=i,h.bootstrapperInfo=n,h.application=i.createApplication((0,f.I)(t.documentBootInfo,h.bootstrapperInfo.bootstrapperUrl,t.uiHostConfig,t.sessionConfig));const l=(0,d.SI)(d.dT.FeatureGate_EnableSingleOwlJsapiLogger,t.uiHostConfig?.featureGates);h.session=h.application.createSession({hostSessionId:h.hostSessionId,logger:l?e:void 0}),h.sessionPromise.resolve(h.session),h.createNewFlowExecuting=!0;const p=(0,a.lW)(t.sessionConfig.createNewParams,t.documentBootInfo,t.container,t.uiHostConfig,t.sessionConfig);return h.session.run(u.Y.createNew,p).catch((t=>{e?.ULS.sendTraceTag(507778317,o.n.Bo,r.k.Warning,`Caught error running create new flow: ${t}`),h.createNewFlowExecuting=!1})),!0})).catch((n=>(e?.ULS.sendTraceTag(507778316,o.n.Bo,r.k.Warning,`Failed to load bootstrapper for ${t.documentBootInfo.fileType} in 2-step create new flow. Error: ${n}`),!1)))}else e?.ULS.sendTraceTag(507778319,o.n.Bo,r.k.Warning,`jsapiBootstrapperUrl for ${t.documentBootInfo.fileType} is undefined in ${t.uiHostConfig?.uiHostName}`)}}h.isTwoStepCreateNew=!1,h.createNewFlowExecuting=!1,h.sessionPromise=new l.Z,h.Pr={},h.Tr=new Promise(((t,e)=>{h.Pr.resolve=t,h.Pr.reject=e}))},29819:function(t,e,n){n.d(e,{BI:function(){return s},TX:function(){return r},lX:function(){return a},wA:function(){return i},yC:function(){return c}});var o=n(27474);function r(t){return!(!t||!t.failure)&&"TypeError: Failed to fetch"===t.failure}function i(t){switch(t){case o.R7.pr:case o.R7.Ir:return!1;default:return!0}}function s(t,e){if(e)return!0;if(!t)return!1;switch(t){case 401:case 403:case 404:case 429:return!0;default:return!1}}function c(t){const{httpErrorCode:e,networkError:n,qosErrorName:r,errorMessage:i,error:s,documentLoadedWithTabSwitch:c}=t,a=r===o.by.QosError_EncounteredJsApiError&&"timeout"===i&&c;return n||a||[401,403,404,429].includes(e)||function(t){if(!t)return!1;try{const e=[JSON.parse(t)];for(;e.length>0;){const t=e.pop();if("string"==typeof t){if(u.has(t))return!0}else if("object"==typeof t&&null!==t)for(const n of Object.values(t))e.push(n)}}catch(e){for(const e of f)if(-1!==t.indexOf(e))return!0}return!1}(JSON.stringify(s))}function a(t,e){if(e)return o.HR.Offline;switch(t){case 401:case 403:return o.HR.PermissionError;case 404:return o.HR.NotFound;case 429:return o.HR.Throttling;default:return o.HR.Other}}const u=new Set(["DocumentIsIRMProtected","5373959","5243086","5243055","5374037","5373972","5373968","5373967","5373965","5373961","5243101","29"]),f=Array.from(u)},34624:function(t,e,n){n.d(e,{Gi:function(){return f},SI:function(){return u},dT:function(){return o},lO:function(){return a}});var o,r=n(97326),i=n(7867),s=n(22404),c=n(86739);function a(t,e,n){n?.ULS.sendTraceTag(521164238,r.n.Bo,i.k.Info,`${t}: ${e?"Enabled":"Disabled"}`)}function u(t,e){if(!e)return!1;if(!e.has(t))return!1;const n=e.get(t);return null!=n&&"boolean"==typeof n&&n}function f(t,e,n){let o=[];e?.ULS.sendTraceTag(522299220,r.n.Bo,i.k.Verbose,`Attempting to parse Feature Gate Config String: "${t}"`);try{o=s.U$.toFeatureGateConfig(t,e)??[]}catch(n){return e?.ULS.sendTraceTag(524814532,r.n.Bo,i.k.Error,`Unable to parse Feature Gate Config string: "${t}", due to Exception: ${n}`),new Map}e?.ULS.sendTraceTag(522299221,r.n.Bo,i.k.Verbose,`Successfully parsed Feature Gate Config String to JSON: ${JSON.stringify(o)}`);const a=new Map;let u=n;return u=u?n?.toLocaleLowerCase():"",o.forEach((t=>{const e=(t.SettingsRings??"").replace(/\s+/g,"").toLocaleLowerCase().split(",");u&&e.includes(u)&&a.set(t.ConfigId,t.IsEnabled)})),e?.ULS.sendTraceTag(522299222,r.n.Bo,i.k.Info,`Successfully filtered Feature Gate Config JSON: ${JSON.stringify(o)}, to ring id: ${u}, with result map: ${(0,c.c)(a)}`),a}!function(t){t.FeatureGate_OneNoteJsApiV2Gate="OneNoteJsApiV2Gate",t.FeatureGate_StartPageUseOWLGate="StartPageUseOWLGate",t.FeatureGate_GrabFocusOnFilePickerCloseGate="GrabFocusOnFilePickerCloseGate",t.FeatureGate_Vroom21SupportGate="Vroom21SupportGate",t.FeatureGate_CommandingAshaVetoes="CommandingAshaVetoes",t.FeatureGate_ESSForXLGate="ESSForXL",t.FeatureGate_Vroom21ForWord="Vroom21ForWord",t.FeatureGate_Vroom21ForExcel="Vroom21ForExcel",t.FeatureGate_PrefetchWacToken="PrefetchWacToken",t.FeatureGate_UseNewEuplReporting="UseNewEuplReporting",t.FeatureGate_PostWacTokenAsync="PostWacTokenAsync",t.FeatureGate_DeprecatePreAuthUrl="DeprecatePreAuthUrl",t.FeatureGate_UseUnifiedBundling="UseUnifiedBundling",t.FeatureGate_OwlPostWacTokenForTeamsHosts="OwlPostWacTokenForTeamsHosts",t.FeatureGate_EnableSingleOwlJsapiLogger="EnableSingleOwlJsapiLogger",t.FeatureGate_EnableJsapiTags="IsOwlAdditionalJsapiTagsEnabled",t.FeatureGate_ShowHeaderOneNote="ShowHeaderOneNote",t.FeatureGate_OneNoteTeamsClaimsHandling="OneNoteTeamsClaimsHandling",t.FeatureGate_UseWacParamsCopy="UseWacParamsCopy",t.FeatureGate_OneNotePersonalAppRedirectToLegacyMyNotebookPage="OneNotePersonalAppRedirectToLegacyMyNotebookPage",t.FeatureGate_EnableAriaLoggingForShareDialogLaunch="enableAriaLoggingForShareDialogLaunch",t.FeatureGate_UseLoadJSApiWithOWLEnabled="UseLoadJSApiWithOWLEnabled",t.FeatureGate_UseSeparateVroomAccessTokenFn="UseSeparateVroomAccessTokenFn",t.FeatureGate_OmitParamsOnSessionRefresh="OmitParamsOnSessionRefresh",t.FeatureGate_UseConvergedConsumerVroomEndpointForMsa="UseConvergedConsumerVroomEndpointForMsa",t.FeatureGate_SkipFilePickerSiteUrlValidationForMsa="SkipFilePickerSiteUrlValidationForMsa",t.FeatureGate_UseConvergedConsumerShareEndpointForMsa="UseConvergedConsumerShareEndpointForMsa",t.FeatureGate_EnableUseConsumerFileEmbedHandler="EnableUseConsumerFileEmbedHandler",t.FeatureGate_PassShareDialogAccessTokenPostParamForMsa="PassShareDialogAccessTokenPostParamForMsa",t.FeatureGate_DisablePassShareDialogHostSessionId="DisablePassShareDialogHostSessionId"}(o||(o={}))},38794:function(t,e,n){n.d(e,{L:function(){return o}}),n(97326),n(7867);const o=function(){let t;try{t=window.localStorage}catch(t){}return t}()},17935:function(t,e,n){function o(t){return new Map([["ErrorName",`${t.wacErrorName}`+(t.errorName?`_${t.errorName}`:"")],["ErrorMessage",t.errorMessage?t.errorMessage:""],["HttpErrorCode",`${t.httpErrorCode}`],["NetworkError",`${t.networkError}`],["DocumentLoadedWithTabSwitch",`${t.documentLoadedWithTabSwitch}`]])}n.d(e,{C:function(){return o}})},42625:function(t,e,n){function o(t){switch(t){case"ring0":case"ring1":case"ring2":return"FASTFOOD";case"ring3_9":return"MSIT";case"general_gcc":return"USGOV";case"gcchigh":return"TRAILBLAZER";case"dod":return"PATHFINDER";case"ag08":return"AIRGAP08";case"ag09":return"AIRGAP09";case"gallatin":return"GALLATIN";default:return"PRODUCTION"}}n.d(e,{U:function(){return o}})},66711:function(t,e,n){n.d(e,{C$:function(){return u},NM:function(){return a}});var o=n(97326),r=n(7867),i=n(6439),s=n(75212);function c(t,e,n,c,a,u,f,l,d,h,p,m,w,g,b,v,S){const H=new i.R7(t,n,e,d,l,h,c,a,u,p,m,w).health;if(H)return H.addOrUpdatePartCDimension("HostCorrelationId",f),H.addOrUpdatePartCDimension("AppSessionId",t),H.addOrUpdatePartCDimension("HostRingId",g??"n/a"),H.addOrUpdatePartCDimension("IsNewFile",(!!b).toString()),H.addOrUpdatePartCDimension("isOdcMigrated",(!!v).toString()),H.addOrUpdatePartCDimension("IsTestMode",window.location.pathname.endsWith("/test").toString()),(0,s.Pq)()?H.addQosPillar("Interruptions"):H.addQosPillar("Open"),H;S?.ULS.sendTraceTag(507340064,o.n.Bo,r.k.Warning,"Failed to initialize health logger.")}function a(t,e,n,o,r,i,s,a){t.health=t.health??c(e,s,t.fileType,t.uiCulture,t.puid,t.tenantId,t.hostCorrelationId,i?.exposure,i?.clientVersion,t.isSynthetic,n.uiHostName,n.uiHostIntegrationType,t.sessionOrigin,o,r,void 0,a),t.health&&(t.hostClientType&&t.health.addOrUpdatePartCDimension("HostClientType",t.hostClientType),t.teamType&&t.health.addOrUpdatePartCDimension("TeamType",t.teamType),t.isPopOut&&t.health.addOrUpdatePartCDimension("IsPopOut",(!!t.isPopOut).toString()))}function u(t,e,n,o){if(t.sessionConfig.logger||(t.sessionConfig.logger=new i.hK(o,n).logger),!t.sessionConfig.health){const{exposure:r,clientVersion:i}=e??{},{ringId:s,isOdcMigrated:a}=t.sessionConfig.bootDiagnostics??{},{uiHostName:u,uiHostIntegrationType:f}=t.uiHostConfig??{};t.sessionConfig.health=c(o,n,t.documentBootInfo.fileType,t.documentBootInfo.uiCulture,t.documentBootInfo.puid,t.sessionConfig.tenantId,t.sessionConfig.hostCorrelationId,r,i,t.sessionConfig.isSynthetic,u,f,t.documentBootInfo.wdOrigin,s,t.documentBootInfo.isNewFile,a,t.sessionConfig.logger)}}},82743:function(t,e,n){n.d(e,{I:function(){return r}});var o=n(83754);function r(t,e,n,r,i){return{host:{storageHostName:(0,o.Im)(t.docUrl??""),capabilities:{isFeatureEnabledCallback:(0,o.$e)(r),moveToFolder:n?.supportsMoveToFolder,commonFilePicker:n?.supportsCommonFilePicker,rebootDoc:n?.supportsDocumentReboot,createNewDoc:n?.supportsCreateNewDocument,authToken:n?.supportsAuthToken,authTokenStrategy:n?.authTokenStrategy,excelExternalLinks:n?.supportsExcelExternalLinks,refreshAccessToken:n?.supportsRefreshAccessToken,atMentions:n?.supportsAtMentions,accessibilityLoop:n?.supportsAccessibilityLoop,customAuthConfig:n?.supportsCustomAuthConfig,directPrint:n?.supportsDirectPrint??!0,directDownload:n?.supportsDirectDownload,disableOfficeAddins:n?.disableOfficeAddins,supportsInPlaceCreateNew:n?.supportsInPlaceCreateNew,disableEmbedViewCodeSnippet:n?.disableEmbedViewCodeSnippet,disableCoEditInTeams:n?.disableCoEditInTeams},uiHostName:n?.uiHostName||o.Q9,requireExplicitUnload:n?.supportsExplicitUnload,metaUiHostVersion:r?.metaUiHostVersion,uiHostIntegrationType:n?.uiHostIntegrationType,uiHostScenarioType:r?.additionalApplicationParameters?.uiHostScenarioType,owlVersion:r?.owlVersion,owlRollout:r?.owlRollout,origin:r?.origin},user:{id:i&&i.wac&&i.wac.userId||t.puid||"",isSynthetic:r?.isSynthetic},bootstrapperUrl:e,ui:{uiEmbed:n?.uiEmbed??!0,controls:n?.supportsHostUiControls?[{id:"close",visibility:n?.showCloseButton?1:0},{id:"share",visibility:n?.supportsShare?1:0},{id:"ellipsisOpenInBrowser",visibility:n?.openInBrowserEnabled?1:0},{id:"ellipsisDownload",visibility:n?.ellipsisDownloadACopyButtonEnabled?1:0},{id:"copyLink",visibility:n?.copyLinkEnabled?1:0},{id:"conversation",visibility:n?.conversationButtonEnabled?1:0}]:void 0,language:t.uiCulture,hideHeader:n?.hideHeader,hideAppLauncherInHeader:n?.hideAppLauncherInHeader,hideSearchInHeader:n?.hideSearchInHeader,hideMeInHeader:n?.hideMeInHeader,hideChatInHeader:n?.hideChatInHeader,hideWorkflowInHeader:n?.hideWorkflowInHeader,hideSettingsInHeader:n?.hideSettingsInHeader,showAppIconInHeader:n?.showAppIconInHeader,useNeutralColorInHeader:n?.useNeutralColorInHeader,highContrast:"invert"===r?.highContrastMode?"invert":void 0,openLinksInNewWindow:n?.openLinksInNewWindow,contentAssemblyMode:n?.contentAssemblyMode,showNotebookList:"1"===r?.additionalApplicationParameters?.shownotebooklist,enableMobileViewer:"1"===r?.additionalApplicationParameters?.wdMobileEmbedOneNoteViewer,mobileEmbedView:"1"===r?.additionalApplicationParameters?.wdMobileEmbedOneNoteViewer,showBreadcrumbInMobileView:"1"===r?.additionalApplicationParameters?.wdMobileEmbedOneNoteViewer,showInternalFeedback:"1"===r?.additionalApplicationParameters?.wdNotesInternalFeedbackEnabled,embed:"1"===r?.additionalApplicationParameters?.embed,embedded:"1"===r?.additionalApplicationParameters?.embedded,hidesections:"1"===r?.additionalApplicationParameters?.hidesections}}}},61885:function(t,e,n){n.d(e,{J:function(){return h}});var o=n(97326),r=n(7867);const i="https://wise-m.public.cdn.office.net/wise-m/owl",s="https://wise.public.cdn.office.net/wise/owl",c=new Set,a=[10,100],u=[1,10,50,100],f=2e3;let l,d;function h(t,e,n,o){l=n,d=t,p(e,"MSIT",a,0,o),p(e,"PRODUCTION",u,3e4,o)}function p(t,e,n,o,r){let i=o;n.forEach((async n=>{setTimeout((async()=>{await m(t,e,n,1,r)}),i+=f)}))}async function m(t,e,n,a=0,u){let h=0;await fetch(`${i}/5mttl/${e.toLowerCase()}/${n}/manifest.json`,{cache:"no-cache"}).then((i=>(l?.ULS.sendTraceTag(507326861,o.n.Bo,r.k.Info,`Fetching manifest from CDN was successful for ${t} in ${e} with exposure ${n} with remaining retry count ${a}.`),i.text()))).then((async i=>{if(l?.ULS.sendTraceTag(507326860,o.n.Bo,r.k.Info,`Parsing manifest from CDN was successful for ${t} in ${e} with exposure ${n} with remaining retry count ${a}.`),i.includes("<Code>BlobNotFound</Code>"))a>0?setTimeout((async()=>{await m(t,e,n,a-1)}),29e3):l?.ULS.sendTraceTag(507107014,o.n.Bo,r.k.Warning,`Fetching manifest from CDN failed for ${t} in ${e} with exposure ${n} with remaining retry count ${a}. Error: BlobNotFound`);else{const a=JSON.parse(i);if(!a.clientVersion)return void l?.ULS.sendTraceTag(507326859,o.n.Bo,r.k.Warning,`Manifest from CDN does not have clientVersion for ${t} in ${e} with exposure ${n}. Manifest: ${a}`);if(!a.files)return void l?.ULS.sendTraceTag(507326858,o.n.Bo,r.k.Warning,`Manifest from CDN does not have files for ${t} in ${e} with exposure ${n}. Manifest: ${a}`);c.has(a.clientVersion)||(c.add(a.clientVersion),Object.keys(a.files).filter((e=>e.includes(t.toLowerCase()+".boot.js")||e.includes(t.toLowerCase()+".app.boot.js")||e.includes(t.toLowerCase()+"-boot.js")||e.includes("owl."+t.toLowerCase()+".js")||e.includes("owl.js")||e.includes("owl."+t.toLowerCase()+".slim.js")||e.includes("owl.slim.js"))).forEach((t=>{const e=a.files[t];if(e&&2===e.length){const n=function(t,e,n,i){const s=document.createElement("link");return s.rel="prefetch",s.href=t,s.as="script",(n.includes("owl")||i)&&(s.crossOrigin="anonymous",s.integrity=e),s.id=n,s.onerror=()=>{l?.ULS.sendTraceTag(507326856,o.n.Bo,r.k.Warning,`Failed to prefetch ${n} from ${t}`),s.remove()},s}(`${s}/${e[0]}`,e[1],t,u);!function(t,e,n){setTimeout((()=>{t.appendChild(e)}),n)}(d,n,h+=f)}})))}})).catch((i=>{a>0?setTimeout((async()=>{await m(t,e,n,a-1)}),29e3):l?.ULS.sendTraceTag(507326857,o.n.Bo,r.k.Warning,`Fetching manifest from CDN failed for ${t} in ${e} with exposure ${n} with remaining retry count ${a}. Error: ${i}`)}))}},16206:function(t,e,n){function o(t){const e=document.getElementById(t),n=e&&e.textContent;if(n)return JSON.parse(n)}n.d(e,{L:function(){return o}})},5840:function(t,e,n){var o;function r(t=""){const e=window.performance.getEntriesByName(o.OwlHostTimeOrigin)[0]?.detail;return window.performance.getEntriesByType("mark").filter((e=>e.name.startsWith(t))).reduce(((t,n)=>(n.name!==o.OwlHostTimeOrigin?t[n.name]=e+n.startTime:t[n.name]=e,t)),{})}function i(t){const e=t[o.OwlStart]||t[o.OwlWithCustomFunctionsStart],n=t[o.OwlOnBootComplete];return{totalTime:n-e,owlPerformanceTimeline:{...t,[o.OwlStart]:e,[o.OwlEnd]:n}}}n.d(e,{ls:function(){return o},nC:function(){return i},nu:function(){return r}}),function(t){t.OwlBootAppMessageSend="owlBootAppMessageSend",t.OwlBootAppMessageReceive="owlBootAppMessageReceive",t.OwlLoadedMessageSend="owlLoadedMessageSend",t.OwlLoadedMessageReceive="owlLoadedMessageReceive",t.OwlBootAppWithCustomFunctionsMessageSend="owlBootAppWithCustomFunctionsMessageSend",t.OwlBootAppWithCustomFunctionsMessageReceive="owlBootAppWithCustomFunctionsMessageReceive",t.OwlWithCustomFunctionsStart="owlWithCustomFunctionsStart",t.OwlWithCustomFunctionsEnd="owlWithCustomFunctionsEnd",t.OwlStart="owlStart",t.OwlEnd="owlEnd",t.OwlHostTimeOrigin="owlHostTimeOrigin",t.OwlWacBootStart="owlWacBootStart",t.OwlOnBootComplete="owlOnBootComplete"}(o||(o={}))},39095:function(t,e,n){n.d(e,{Z:function(){return i}});var o=n(97326),r=n(7867);class i{then(t,e){return this.Er.then(t,e)}catch(t){return this.Er.catch(t)}finally(t){return this.Er.finally(t)}constructor(t){this.resolve=()=>{t?.ULS.sendTraceTag(507586270,o.n.Bo,r.k.Warning,"DeferredPromise.resolve() called before resolve function was set")},this.reject=e=>t?.ULS.sendTraceTag(507586269,o.n.Bo,r.k.Error,`DeferredPromise.reject() called before reject function was set. Error: ${e}`),this.Er=new Promise(((t,e)=>{this.resolve=t,this.reject=e})),this.Er.finally}}},8169:function(t,e,n){n.d(e,{H:function(){return r}});var o=n(5840);function r(){!(window.performance.getEntriesByName(o.ls.OwlHostTimeOrigin)?.length>0)&&window.performance.mark(o.ls.OwlHostTimeOrigin,{startTime:0,detail:window.performance.timeOrigin})}},67053:function(t,e,n){function o(t,e){let n=!!t.Fallback;const o=t.ODB;let r,i;if("boolean"==typeof o)n=o;else if(o>0){if(o>=6e4){const t=o-6e4+2e3+1;r=Math.floor(t/32),i=1<<t%32}else{if(!(o<=2e3))return!1;r=Math.floor(o/32),i=1<<o%32}n=r<e.length&&0!=(e[r]&i)}return n}n.d(e,{G:function(){return o}})},86739:function(t,e,n){function o(t){return JSON.stringify(Object.fromEntries(t))}n.d(e,{c:function(){return o}})},75607:function(t,e,n){n.d(e,{g:function(){return r}});const o=(0,n(16206).L)("unified-ui-host-config"),r={version:"v1",genericFeatureGates:o?.genericFeatureGates??null,deploymentEnvironment:o?.deploymentEnvironment??"Not_specified"}},62940:function(t,e,n){n.d(e,{t:function(){return a}});var o=n(97326),r=n(7867),i=n(85504),s=n(91581),c=n(51445);function a(t,e,n,a,u){(n||a)&&t.then((t=>{if(t){const f=function(t){const e=(0,i.dH)(t);return{region:e,dataBoundary:(0,c.y)(e)}}(t);if(n)try{const t=(0,s.yc)(e,f.dataBoundary);n.flushAndSetNewEndpoint(t,(()=>{n?.ULS.sendTraceTag(509612803,o.n.Bo,r.k.Info,`Updated ULS endpoint. Environment: ${e}, DataBoundary: ${f.dataBoundary}, Region: ${f.region}`)}))}catch(t){n.ULS.sendTraceTag(509875042,o.n.Bo,r.k.Warning,`Failed to identify data boundary-aware bULS endpoint. Error: ${t.message}`)}if(a)try{const t=(0,s.C6)(e,u,f.dataBoundary);a.flushAndSetNewEndpoint(t,(()=>{n?.ULS.sendTraceTag(509612802,o.n.Bo,r.k.Info,`Updated Health endpoint. Environment: ${e}, DataBoundary: ${f.dataBoundary}, Region: ${f.region}`)}))}catch(t){n?.ULS.sendTraceTag(509875041,o.n.Bo,r.k.Warning,`Failed to identify data boundary-aware Health endpoint. Error: ${t.message}`)}}})).catch((t=>{n?.ULS.sendTraceTag(509875042,o.n.Bo,r.k.Warning,`Failed to resolve app url promise. Error: ${t.message}`)}))}},1563:function(t,e,n){n.d(e,{Bp:function(){return p},Mn:function(){return w},PE:function(){return s},_Q:function(){return u},g$:function(){return d},lt:function(){return l},rA:function(){return m},sH:function(){return f},vi:function(){return h}});const o=/http[s]?:\/\/[\S]*?\.sharepoint[\S]*?\.com/,r=/http[s]?:\/\/[\S]*?-my\.sharepoint[\S]*?\.com/,i=/http[s]?:\/\/d\.docs\.live\.net/,s=/https:\/\/[\S]*?graph\.[\S]/,c="https://graph.microsoft.com",a=new RegExp(["^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)","(/{0,1}[^?#]*)","(\\?[^#]*|)","(#.*|)$"].join(""));var u;function f(t){if(!t)return"";try{return decodeURIComponent(t)}catch(t){return""}}function l(t){return t?t.substring(0,t.lastIndexOf("/")):""}function d(t){if(t&&t.length){const e=t.match(a);if(e)return{href:t,protocol:e[1],host:e[2],hostname:e[3],port:e[4],path:e[5],search:e[6],hash:e[7]}}}function h(t){if(t&&t.length&&t.startsWith(c))return"Graph"}function p(t,e,n){let o=t,r="",i=!0;e&&(o={...e,...o});for(const t in o){const e=o[t];if(!n||"object"!=typeof e&&e||"object"==typeof e&&e&&e.uriValue||"number"==typeof e||"boolean"==typeof e){let n;i?i=!1:r+="&",n="object"==typeof e&&e&&e.uriValue?e.uriValue:encodeURIComponent(`${e}`),r+=`${t}=${n}`}}return r}function m(t){if(t&&t.length){if(t.match(r)||t.match(i))return u.OneDrive;if(t.match(o))return u.SharePoint}}function w(t,e){const n=t.toLowerCase(),o=function(t){const e=d(t);return e&&e.hostname||""}(e),r=function(t){const e=t.toLowerCase();return!e||e.startsWith("http:")||e.startsWith("https:")||e.startsWith("mailto:")||e.startsWith("sip:")||e.startsWith("tel:")||e.startsWith("im:")?e:"https://"+e}(o),i=l(e);let s;return s=0===n.indexOf("https://")||0===n.indexOf("http://")?n:"/"===n.charAt(0)?`${r}${n}`:`${i}/${n}`,s}!function(t){t.OneDrive="Documents",t.SharePoint="Sites"}(u||(u={}))},77045:function(t,e,n){n.d(e,{GE:function(){return s},Q5:function(){return o},iz:function(){return r},r$:function(){return i}});let o=!1;function r(t){o=t}function i(){o=!1}const s=new Map},71664:function(t,e,n){n.d(e,{u:function(){return l}});var o=n(96699),r=n(97326),i=n(7867),s=n(16424),c=n(27474),a=n(27310),u=n(314);let f;function l(t,e,n=!1,l,h,p=!1){c.pP.driveItemStartTime=(0,o.u_)(),(0,o.l8)("driveItemStartTime"),f||(f=new Map);const m=f.get(t);if(!n&&m&&m.promise&&(!m.expiryTime||m.expiryTime>new Date))return c.pP.driveItemEndTime=(0,o.u_)(),(0,o.l8)("driveItemEndTime"),l?.ULS.sendTraceTag(553726288,r.n.Bo,i.k.Info,"GetDriveItem: Returning drive item from the cache"),m.promise;l?.ULS.sendTraceTag(553726289,r.n.Bo,i.k.Info,"GetDriveItem: Invalidating the cache"),f.delete(t),l?.ULS.sendTraceTag(546182045,r.n.Bo,i.k.Info,"GetDriveItem: About to make the fetch call to get drive item");let w=t,g={method:u.D.Get,headers:e.headers};if(!p){h||(w=t.concat("&ump=1"));const{body:n,headers:o}=function(t){const[e]=(0,s.O)(),n=[];n.push(`--${e}`),void 0!==t&&Object.entries(t).forEach((([t,e])=>{void 0!==e&&n.push(`${t}: ${e}`)})),n.push("X-HTTP-Method-Override: GET"),n.push(`\r\n--${e}--`);return{body:n.join("\r\n"),headers:{"Content-Type":`multipart/form-data;boundary=${e}`}}}(e.headers);g={method:u.D.Post,headers:o,body:n},l?.ULS.sendTraceTag(508961629,r.n.Bo,i.k.Info,`GetDriveItem: POST request to get drive item: content-length : ${n.length}`)}const b=fetch(w,g).catch((t=>Promise.reject({api:"getItem",failure:t,message:"Fetch call failed",retry:!0}))).then((async e=>{if(200===e.status){const n=e.json().then((t=>t||Promise.reject({api:"getItem",status:e.status,message:"Ok httpStatus, invalid response"}))),o=new Map,s=e?.headers?.get("SPRequestGuid");return c.pP.spRequestGuid=s??void 0,o.set("SPRequestGuid",s),l?.ULS.sendTraceTag(554964099,r.n.Bo,i.k.Info,`GetDriveItem:  [VroomResponseHeaders: ${JSON.stringify(o)}]`),f.set(t,{promise:b,expiryTime:(0,a.L)(new Date,24)}),n}try{const t=await e.json(),n=e?.headers?.get("SPRequestGuid");return c.pP.spRequestGuid=n??void 0,Promise.reject({api:"getItem",SPRequestGuid:n,status:e.status,errorCode:t?.error?.code,innerErrorCode:t?.error?.innerError?.code,message:t?.error?.message,redirectLocation:t?.error?t?.error["@error.redirectLocation"]:void 0,...d(e),retry:429===e.status||e.status>=500})}catch(t){return Promise.reject({api:"getItem",status:e.status,message:"request failed, could not retrieve error object."})}})).finally((()=>{c.pP.driveItemEndTime=(0,o.u_)(),(0,o.l8)("driveItemEndTime")}));return b}function d(t){const e=t?.headers?.get("www-authenticate");let n,o;if(e){const t=e.split(",");if(t)for(const e of t){const t=e&&e.trim();t&&t.startsWith("error=")?n=t.split('"')[1]:t&&t.startsWith("claims=")&&(o=[t.split('"')[1]])}}return{claimsError:n,claims:o}}},43780:function(t,e,n){n.d(e,{a:function(){return a}});var o=n(97326),r=n(7867),i=n(91581),s=n(53027),c=n(26662);function a(t,e,n,a=!1,u="open",f,l,d){const{driveId:h,docId:p,baseUrl:m,docUrl:w}=t;if(!h||!p)return Promise.reject("Not enough document information was given to retrieve the item");const g=[(0,c.PN)(e),(0,c.a4)(u),...(0,c.TE)(d)].filter((t=>!!t)).join("&"),b=function(t){if(!t)return null;const e=new URL(t);return e.protocol+"//"+e.host}(m??w);let v,S,H=!1;b?(S=b,v=`${m||b}/_api/v2.0`,l?.ULS.sendTraceTag(543958855,o.n.Bo,r.k.Info,"making vroom service call with driveId+docId")):(S=(0,i.ob)(f),v=`${S}/v1.0`,H=!0,l?.ULS.sendTraceTag(543958856,o.n.Bo,r.k.Info,"making graph service call with driveId+docId"));const I=`${v}/drives/${encodeURIComponent(h)}/items/${encodeURIComponent(p)}/?${g}`,C=(0,c.vi)(S)??"None";return(0,s.$)(I,n.getAccessToken,C,S,a,l,void 0,!1,H)}},69790:function(t,e,n){n.d(e,{A:function(){return a}});var o=n(27474),r=n(34624),i=n(53027),s=n(26662);function c(t,e){const n={accept:"application/json",prefer:"allow-zerobyte,manualRedirect"};return(0,s.wZ)(t,n,void 0,e),n}function a(t,e,n,a,u=!1,f="open",l,d,h){if(!t||!e)return Promise.reject("Not enough document information was given to retrieve the item");const p=new URL(e),m=`${p.protocol}//${p.host}`;if((0,r.lO)(r.dT.FeatureGate_Vroom21SupportGate,h,l),o.pP.isVroom21=h,h){const t=n.indexOf("openWith");-1!==t&&(n[t]="openWith($select=wac)")}const w=[(0,s.PN)(n),(0,s.a4)(f),...(0,s.TE)(d)].filter((t=>!!t)).join("&");let g="";g=h?`${e}/_api/v2.1/sites/root/items/${encodeURIComponent(t)}/driveItem?${w}`:`${e}/_api/v2.0/sites/root/items/${encodeURIComponent(t)}/driveItem?${w}`;const b=(0,s.vi)(e)??"None";return(0,i.$)(g,a.getAccessToken,b,m,u,l,c)}},53027:function(t,e,n){n.d(e,{$:function(){return c}});var o=n(97326),r=n(7867),i=n(71664),s=n(26662);async function c(t,e,n,c,a=!1,u,f=s.dJ,l,d=!1){return t?e(n,a,c,void 0,!0).then((t=>f(t,u))).then((e=>{const n={headers:e};return(0,i.u)(t,n,a,u,l,d)})).catch((s=>(u?.ULS.sendTraceTag(512255580,o.n.Bo,r.k.Warning,`GetDriveItemWithUrl: error when trying to getDriveItem: ${s}`),s&&401===s.status&&"insufficient_claims"===s.claimsError&&s.claims?(u?.ULS.sendTraceTag(523076960,o.n.Bo,r.k.Warning,"GetDriveItemWithUrl: vroom call failed with claims challenge. Retry with claims"),e(n,a,c,void 0,!0,s.claims).then((t=>f(t,u))).then((e=>{const n={headers:e};return(0,i.u)(t,n,a,u)}))):Promise.reject(s)))):Promise.reject("No api endpoint given")}},61891:function(t,e,n){n.d(e,{X:function(){return l},_:function(){return c}});var o=n(97326),r=n(7867),i=n(53027),s=n(26662);function c(t,e){try{e?.ULS.sendTraceTag(541870043,o.n.Bo,r.k.Info,"getSharesUrl: Start constructing shares Url");const n=t.replace(/[,@+$#]/g,(t=>encodeURIComponent(t))),i=window.btoa(function(t){let e=t;return e&&(e=e.replace(/#/g,"%23")),e}(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,((t,e)=>String.fromCharCode(parseInt(e,16))))));let s=i.length-1;for(;"="===i.charAt(s);)--s;return`shares/u!${i.slice(0,s+1).replace(/\+/g,"-").replace(/\//g,"_")}/driveItem`}catch(t){return void e?.ULS.sendTraceTag(541872152,o.n.Bo,r.k.Error,`getSharesUrl: Failed to get Share Url. ${t}`)}}function a(t,e){const n={accept:"application/json",prefer:"redeemSharingLink,allow-zerobyte,manualRedirect"};return(0,s.wZ)(t,n,void 0,e),n}function u(t,e){const n={accept:"application/json",prefer:'redeemSharingLink,allow-zerobyte,manualRedirect,pacToken=Y,pacTokenAppIds="e03a13ee-9730-4cae-8525-47559c8cf18a"'};return(0,s.wZ)(t,n,void 0,e),n}const f=t=>t?"expand=thumbnails":"";function l(t,e,n,o=!1,r="open",l=!1,d,h,p,m,w){const{inMockMode:g,getAccessToken:b}=n,v=(0,s.Zg)(t,n,d);if(!v)return Promise.reject("No apiInfo");if(!w&&"editnew"===r){const t=e.indexOf("openWith($select=wac)");-1!==t&&(e[t]="openWith")}if(m)return(0,i.$)(t,b,v.tokenType,v.resourceUrl,o,d,p?u:a,m);const S=c(t,d);if(!S)return Promise.reject("No shareUrl");const H=new Date;H.setSeconds(0,0);const I=[(0,s.PN)(e),(0,s.a4)(r),f(l),...(0,s.TE)(h)].filter((t=>!!t)).join("&"),C=g?`shares?itemUrl=${encodeURIComponent(S)}&currentDate=${H.toISOString()}`:`${S}?${I}`,y=`${v.baseUrl}/${C}`;return(0,i.$)(y,b,v.tokenType,v.resourceUrl,o,d,p?u:a)}},314:function(t,e,n){var o,r;n.d(e,{D:function(){return r}}),function(t){t.Json="json",t.Text="text",t.ArrayBuffer="arraybuffer",t.Blob="blob"}(o||(o={})),function(t){t.Delete="DELETE",t.Get="GET",t.Head="HEAD",t.Options="OPTIONS",t.Post="POST",t.Put="PUT",t.Patch="PATCH"}(r||(r={}))},26662:function(t,e,n){n.d(e,{PN:function(){return d},TE:function(){return a},Zg:function(){return m},a4:function(){return c},dJ:function(){return h},vi:function(){return s},wZ:function(){return p}});var o=n(97326),r=n(7867),i=n(1563);function s(t){if(t&&t.length&&t.match(i.PE))return"Graph"}const c=t=>`action=${t}`,a=t=>t?.isESSEnabled&&t?.wacDataCenter?[u(t?.wacDataCenter),f(t?.sessionId),l(t?.hostCorrelationId)]:[],u=t=>t?`WacDataCenter=${t}`:void 0,f=t=>t?`usid=${t}`:void 0,l=t=>t?`hid=${t}`:void 0,d=t=>t&&t.length?"$select="+t.join(","):void 0;function h(t,e){return p(t,{accept:"application/json",prefer:"allow-zerobyte"},void 0,e)}function p(t,e,n,i){let s=e;if(!t||!t.success)return s??{};s||(s={}),i?.ULS.sendTraceTag(507588634,o.n.Bo,r.k.Important,`Format: ${t.format}`);const c="RPSCompact"===t.format?n||"":"Bearer ";return s.Authorization=`${c}${t.token}`.trim(),s}function m(t,e,n){const{isConsumer:i,oneDriveResourceId:c}=e,a=new URL(t);if(!a||!a.protocol||!a.host)return void n?.ULS.sendTraceTag(542492315,o.n.Bo,r.k.Error,`GetApiInfo failed. [InvalidParsedUrl: ${!a}][InvalidProtocol: ${!a?.protocol}][Invalidhost: ${!a?.host}]`);const u=i?c:`${a.protocol}//${a.host}`,f=i?function(t){return t.inMockMode?t.officeHomeApiRoot:t.oneDriveConsumerApi}(e):function(t,e,n=!1,o=!1){const r=e.inMockMode?e.officeHomeApiRoot:t;return n?`${r}/_api`:o?`${r}/_api/v2.1`:`${r}/_api/v2.0`}(u||"",e),l=i?"None":s(u||"")??"None";if(u&&f&&l)return{baseUrl:f,tokenType:l,resourceUrl:u,hostname:a.hostname};n?.ULS.sendTraceTag(542492316,o.n.Bo,r.k.Error,`GetApiInfo failed. [InvalidResourceUrl: ${!u}][InvalidBaseUrl: ${!f}][InvalidTokenType: ${!l}]`)}},96793:function(t,e,n){var o;n.d(e,{p:function(){return o}}),function(t){t.Excel="Excel",t.None="None",t.OneNote="OneNote",t.PowerPoint="PowerPoint",t.Visio="Visio",t.Word="Word"}(o||(o={}))}},i={};function s(t){var e=i[t];if(void 0!==e)return e.exports;var n=i[t]={id:t,exports:{}};return r[t](n,n.exports,s),n.exports}s.m=r,s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,{a:e}),e},e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__},s.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var r=Object.create(null);s.r(r);var i={};t=t||[null,e({}),e([]),e(e)];for(var c=2&o&&n;"object"==typeof c&&!~t.indexOf(c);c=e(c))Object.getOwnPropertyNames(c).forEach((function(t){i[t]=function(){return n[t]}}));return i.default=function(){return n},s.d(r,i),r},s.d=function(t,e){for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.f={},s.e=function(t){return Promise.all(Object.keys(s.f).reduce((function(e,n){return s.f[n](t,e),e}),[]))},s.u=function(t){return"owl."+{103:"tr-tr-owl-strings-json",104:"bn-in-owl-strings-json",164:"nn-no-owl-strings-json",319:"ca-es-valencia-owl-strings-json",324:"as-in-owl-strings-json",360:"am-et-owl-strings-json",465:"te-in-owl-strings-json",484:"sv-se-owl-strings-json",501:"bs-latn-ba-owl-strings-json",535:"es-es-owl-strings-json",551:"uz-latn-uz-owl-strings-json",681:"eu-es-owl-strings-json",683:"tk-tm-owl-strings-json",825:"ru-ru-owl-strings-json",941:"mn-mn-owl-strings-json",949:"be-by-owl-strings-json",1120:"cs-cz-owl-strings-json",1200:"sr-cyrl-rs-owl-strings-json",1217:"ms-my-owl-strings-json",1250:"sq-al-owl-strings-json",1325:"de-de-owl-strings-json",1363:"fr-ca-owl-strings-json",1494:"lb-lu-owl-strings-json",1495:"pt-pt-owl-strings-json",1568:"zh-cn-owl-strings-json",1713:"ky-kg-owl-strings-json",1827:"da-dk-owl-strings-json",1836:"vi-vn-owl-strings-json",2077:"bg-bg-owl-strings-json",2094:"sd-arab-pk-owl-strings-json",2152:"nb-no-owl-strings-json",2178:"tt-ru-owl-strings-json",2217:"fi-fi-owl-strings-json",2253:"mr-in-owl-strings-json",2368:"hy-am-owl-strings-json",2443:"nl-nl-owl-strings-json",2527:"ml-in-owl-strings-json",2575:"fa-ir-owl-strings-json",2583:"or-in-owl-strings-json",2591:"az-latn-az-owl-strings-json",2624:"km-kh-owl-strings-json",3257:"qps-ploc-owl-strings-json",3264:"gu-in-owl-strings-json",3330:"mi-nz-owl-strings-json",3349:"ta-in-owl-strings-json",3508:"ko-kr-owl-strings-json",3589:"el-gr-owl-strings-json",3983:"prs-af-owl-strings-json",4061:"it-it-owl-strings-json",4111:"lv-lv-owl-strings-json",4139:"ka-ge-owl-strings-json",4290:"sl-si-owl-strings-json",4334:"et-ee-owl-strings-json",4423:"pl-pl-owl-strings-json",4650:"en-us-owl-strings-json",4722:"quz-pe-owl-strings-json",4890:"si-lk-owl-strings-json",5047:"mk-mk-owl-strings-json",5365:"mt-mt-owl-strings-json",5537:"uk-ua-owl-strings-json",5583:"is-is-owl-strings-json",5775:"kn-in-owl-strings-json",5807:"gd-gb-owl-strings-json",5850:"ar-sa-owl-strings-json",5953:"sw-ke-owl-strings-json",5994:"qps-plocm-owl-strings-json",6072:"kk-kz-owl-strings-json",6109:"id-id-owl-strings-json",6201:"pa-in-owl-strings-json",6281:"sr-latn-rs-owl-strings-json",6479:"kok-in-owl-strings-json",6599:"af-za-owl-strings-json",6720:"handlers",6895:"pt-br-owl-strings-json",6914:"es-mx-owl-strings-json",7063:"ca-es-owl-strings-json",7171:"fr-fr-owl-strings-json",7207:"th-th-owl-strings-json",7234:"cy-gb-owl-strings-json",7291:"lo-la-owl-strings-json",7479:"ur-pk-owl-strings-json",7717:"ga-ie-owl-strings-json",7761:"chr-cher-us-owl-strings-json",7923:"en-gb-owl-strings-json",8016:"zh-tw-owl-strings-json",8041:"hi-in-owl-strings-json",8234:"ja-jp-owl-strings-json",8303:"lt-lt-owl-strings-json",8375:"hr-hr-owl-strings-json",8461:"ro-ro-owl-strings-json",8664:"fil-ph-owl-strings-json",9015:"sk-sk-owl-strings-json",9059:"he-il-owl-strings-json",9094:"ug-cn-owl-strings-json",9134:"ne-np-owl-strings-json",9445:"bn-bd-owl-strings-json",9452:"msal",9770:"sr-cyrl-ba-owl-strings-json",9790:"gl-es-owl-strings-json",9894:"qps-ploca-owl-strings-json",9917:"hu-hu-owl-strings-json",9971:"ha-latn-ng-owl-strings-json"}[t]+"."+{103:"b7b3114533409d867e36",104:"355d38101dd3f26f74f0",164:"4ac432f3d4ff9030fa58",319:"c025f1bbdb60b6e5a345",324:"4a88e92fe80a36f4b7f4",360:"0309beef2e6fb137109e",465:"1b303922e55eff59c354",484:"da56b2e9bc5146d8888c",501:"567c094ce2a348b1b5ef",535:"816acb9ccf1d9a22278c",551:"5db9b4bfe945386c111f",681:"8c04e64754d1a3f7af2b",683:"10befc853b9d5d9f26c3",825:"e329ae4829fe8fe5d5d0",941:"a37ebc03fe3a53d0bf0b",949:"790375aa4fc23062da46",1120:"9de0a80720119d5ef7f4",1200:"42a320e670c883ae9885",1217:"ffe5f26a4e807c0111e9",1250:"ba08fe78cfdc0d9c7041",1325:"85b69b29f79a5ea5cff7",1363:"50b1e399476746518eaa",1494:"c88fffd67e7642208747",1495:"c5127f78b56a3bec814c",1568:"cde065d187e8dd85084a",1713:"49b3fab7fed32570a86b",1827:"383cc7ddff9393695a1a",1836:"43b5f6f756877b6ed18c",2077:"84f8e44c573028508eae",2094:"5106d9795b0fd16fa7c7",2152:"63453237298a5e8eb125",2178:"242cf7aaa4ab0fcaee86",2217:"2052a7cae5019ffb2413",2253:"24c292272c54629c2668",2368:"f620b41968c54e83bec1",2443:"a6f0ff81544f07d9a809",2527:"f9fce1aff58202101c85",2575:"33642632b2a8d1221440",2583:"cde08e7dcddf4907b3bb",2591:"b53073921688406eca32",2624:"a26afea060715fb9a79c",3257:"a6432a393706a13ed01a",3264:"cb4c34c11477eee0b584",3330:"c3da5f2726762019c68a",3349:"7455d55a54edb1c6886c",3508:"7be1daa2a0630d87c284",3589:"95735b366ca524ae40fd",3983:"312cb9e98d130bc8b334",4061:"c4f2f6057a0ac19b5f70",4111:"2758d02d81d1f5fc2e5a",4139:"37250ce63241e3e43541",4290:"963ecc8b9b48811a2e24",4334:"a2a1fd9a0cb567d49e14",4423:"f813f9b493d268b00e7f",4650:"bbeff9ed4ffddcb1ac32",4722:"60a678989cc82cb9b869",4890:"70299c15925f7d9debff",5047:"80c209c5675e18eddc33",5365:"fa098e9c2552444021a4",5537:"a205ea6743dd89a34e54",5583:"1e6758af914e97584c39",5775:"5c0eba738acb87108c5b",5807:"e4cde1716bf41cd7ac53",5850:"7f82422f7c564d99e9b1",5953:"286bb2cf24b00a41bb3f",5994:"5b61471e7c86c222f936",6072:"30392e9d2721feeaa662",6109:"8b927d5c44f3cb23ce29",6201:"6f96b60e6b2d577cdb2c",6281:"957e4fadab24f2107dd3",6479:"c6b65bac2fbc917154af",6599:"d7719f2c8cd4727d3e98",6720:"e96947ef4f672dde0ea8",6895:"0fc31595fa32450772a5",6914:"fc5aa7ba21de64b5e394",7063:"15125a05a2abdc51c38e",7171:"1313deaa5644dfd6b201",7207:"e60e0d5ce299d15c880f",7234:"2a1ba92ee32769d49b9a",7291:"1335955b5be36d930a3b",7479:"0d6272bee811c2a0956f",7717:"2c555445450cfc443b16",7761:"5ea0d659249fbc6e8f04",7923:"bc451322d0697a83f6e6",8016:"9294e21e4f9f7bb8c1a4",8041:"ba891b73e23ad7f4fc81",8234:"ed1ced9360daff616715",8303:"715ea191e64430d7686b",8375:"6cd3d00d53775bfa5bca",8461:"53f3b9e695ab910f23f1",8664:"e7627f77c0449117b2f8",9015:"313fdf66d46c39d1c419",9059:"e4349ac437ae1e153682",9094:"481c71a45f01f2521050",9134:"ae9c3b51eabe966c892d",9445:"2dcc55c0aa00b18b985b",9452:"3f09ffd4f042cb01d382",9770:"aa4b92c235689db76d75",9790:"8c986a204c8bc29b3cbe",9894:"cc4b5cae5a619a5f4b9e",9917:"e1e8418144c6382a3a94",9971:"c3851dd4b049c4f0b8ec"}[t]+".js"},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n={},o="Microsoft.Office.OWL:",s.l=function(t,e,r,i){if(n[t])n[t].push(e);else{var c,a;if(void 0!==r)for(var u=document.getElementsByTagName("script"),f=0;f<u.length;f++){var l=u[f];if(l.getAttribute("src")==t||l.getAttribute("data-webpack")==o+r){c=l;break}}c||(a=!0,(c=document.createElement("script")).charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.setAttribute("data-webpack",o+r),c.src=t,0!==c.src.indexOf(window.location.origin+"/")&&(c.crossOrigin="anonymous"),c.integrity=s.sriHashes[i],c.crossOrigin="anonymous"),n[t]=[e];var d=function(e,o){c.onerror=c.onload=null,clearTimeout(h);var r=n[t];if(delete n[t],c.parentNode&&c.parentNode.removeChild(c),r&&r.forEach((function(t){return t(o)})),e)return e(o)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=d.bind(null,c.onerror),c.onload=d.bind(null,c.onload),a&&document.head.appendChild(c)}},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t}(),s.sriHashes={103:"sha384-YU7iW5mNX7PlkPorc/0E0yhrro6e0WGSwR3AXyLysQlqtkVs5vaMwmK0mWCYLBjc",104:"sha384-PQtpA1gCCbclxBSeqOPcAtlevUCA9N3EHAB5NbvB59Ptu4dnN8TepxhcTzm5/QfK",164:"sha384-IxolYV2m/Rbf5IhzLK+tL8t+m1f5Tqkf6/MKIGPlwXXmGWw/d7LJrZBQvdoGxYM9",319:"sha384-2Rcghwqn2YIZ9A0LREOEPWAPF23lfKdxWEQxgoLSMdOf9l5GTaSLbrP/ZyVIMng/",324:"sha384-itXFoOk1Cj3Ikp6fOaxTQnnBltQF+F5gg99zAApIw+HCZt9K3y4JnuQ8E0oVU0so",360:"sha384-GyAwt/FVmdDr6UnVCL+IFlDWkWi/Ie7Og9dkr/F5hXva56LOrI8zv8uUPWIlk6rp",465:"sha384-NVDmSW8TDpq0rnOFDaBDvLy5liSVwNfHhcSH3Si5Nor59e0FobQk4iKzvWb9lC+V",484:"sha384-tcFgLDG/UaJ4AOT3AvefjD/hvaWwK5GIkMvLnWMkzmvBnP6u9CyUjUYm1wnZUj8h",501:"sha384-L7mG7PSeEvOiEObgmY3zFt1z2vmM5esyb/UXKSmblBW0iwf5W5tf2oYch3mqsuR9",535:"sha384-GJCI32bwwOJ5NPrds6NwnCY42lLkFFUT91DmgZ/lqKFAqWlgJ8aHr/3FqDPagRyz",551:"sha384-HDDRwAGN6PsmKz6TCRjKPvpdPG+y6H1VZflovD5kbMGHd9i5tfVt5bWrnnbhoID8",681:"sha384-fcu2j2Kkc6yGCCQaCQVw4S+YL/PIhgmzwxLGqMiiTa/2brCzAS1TWNq+P7Fnps0L",683:"sha384-jq0UTDfivqP1xXf8I28imafnq5yE6ewprXu/dr8GhVbxLLympPxvx2sMu1Pfw4rP",825:"sha384-Wi2TovT+xPj6dDY8dg3sdxjYfxz3HRx1UaTQX4l/OodeVMhwh72u76JZcEky+shs",941:"sha384-xt+BamQis6IU+FCUjEmwpDAF+BKYMJPV8rCIuLAL5wgoxxzm/2/kbTYB9lmyrhMM",949:"sha384-w6MHkIDfOMyq2riYp8oof4zApTwIdLrdyUn//Mx51iErF2Ktm3i923Has5b88IHz",1120:"sha384-9R2EYZJ0no9dmuztmF9bInsqGb3rUQRtd1LP/sGtNu4dTEmMwQCmWAeT0Y2Vp+ib",1200:"sha384-aKxbVsqA7Dq1rg6mG6FjKPLRJotVCr0YGJS4fdsX9HUtgH3H1sSmOolNG9iN62T8",1217:"sha384-pqY9GO6mQpMGbxCE+4Wvi7ab6b8qaD3NRXLUkKQT1I9hz8Rr19OG38UPYd/ijalW",1250:"sha384-C78c8gzlqZkn3MiHenj1PS4BDR570EeafNmW0ZwGt81qB4JGTXm1E4AJSW0fIpJ6",1325:"sha384-VaUzDNHfI+cbEp9y33STl0H3ykIIxiyBxUAdhiTIkGcfyYVAci8yPOOeUv+9OpbN",1363:"sha384-doe9RSNxCTJ5t85b/wnntM6IHdFmsGZax+a+lO1DxNeUBWcBX4aEFkOnKDNKG7GF",1494:"sha384-CvmG48+f96yujvQQew6rBFIsfTIWALsLAsPxozDZRmnJhtaSapUXINd8vbNdfF2/",1495:"sha384-tBox8/hfD7n+6pNM/zcfGHYg9unRcyOTlT2uit2zu7+Ts8uTyfr+JP7lup8boBHn",1568:"sha384-kWEXeWntoC8juwax8ElJs4tW7JPeGwPnnlRRa+snTWl073cbc3POoO0ZdKBCntTG",1713:"sha384-LMW9TszDhLuDgYrFx+hMB30Wxr4wfkb9JYOckZJREWcP4sR5/Q/erxCeAq660D1a",1827:"sha384-bCMJvwCIAMblPyMDJSUJq190f6yaqBafCIIjZrG0Go++YZMAHvYrEd9OA9l8s2z/",1836:"sha384-F0xLAxBkT0Zpx15c8jMAAIATZHQ9CsjkmLCLO+M8sWZGCdQ5OsD3GIOOOehBE3m0",2077:"sha384-Nx0L4G78wTqBIi8CI0Mb0g7wZ1QQHs+8c+n/zSRWkhpUrQ/9XUfo8zGUfXrn6WYr",2094:"sha384-66zBdjoavtd//jph1tB+bfg3JwRDDf1tQ54PIu00y5H5q1HRvF9mYKcC95Ff2Xsi",2152:"sha384-S32DuYEy8J9sjMEMYViVxqKsjkusARBDbR1y36f76zamgrwNGULyblYVm7kqkuu2",2178:"sha384-y5YGIttUW02QW0BifEwTICQEPRL2rxVJItrok8dL+le60eNlxGJ4N11ZNTq3F4Sa",2217:"sha384-c/7yAvFCAHYdBii/Y5QCfdsIAOvCHm8petVidGuR3pZOpw8hpFWqg3AzkNVlytHl",2253:"sha384-vMl8y0hIkZc+Gj5ufr35myU74xRySbjGm0/Z2axJ9HvBmzo6D8DtnHeN/sCrBtYO",2368:"sha384-SH9G1hlMXxt8PYOR2vgdHOZi0O+3N9uVJR3ocpodhvk84sxTjwozaBHLR3eivl7s",2443:"sha384-Y7elz2mI9zx9KowSpDwzQqG1DiZkVMLRV/Vj5y1h5FoAUqTyj0ZE4B0rBfoaEoVY",2527:"sha384-lb7m7QZQF7M+X4RsPs6ue30w9+1AwuIPRDnrBm3o1aXYrSbziWk+nf1wXHTBQdyF",2575:"sha384-c7OXraNOCiLkM3vRAq1CPfERoGsxRMXcs20r3j0+C3deuUxLcpOi0g0Vfl6YpfCX",2583:"sha384-ofnvvi4zJzA9GEA3nu6drHw4KgfUE8EuysSnmdb2Cu0xrl+7im8/Oc6PnGK7jIk7",2591:"sha384-V17Noe3qTKFudO+rZ/KAciv8CrVll8M72RFma7DQTQyfD6C0WkE2N6yrZ2hka3WS",2624:"sha384-H7QTDEc3g6YGqc15+dqpF43zq96Z645jPsUGKufmJpj2BgOedoYuV24ev7Nq1drD",3257:"sha384-/KqHcweEdhoS7SFgDFssSwjQ8fR36abZ+MQKXIutxnn3nYWJai8dWMj3OpXDl2XC",3264:"sha384-SXVx2yCo3YiK0l83EDslhBeGJGBtyUpY/hfrAny2fGpBEvxWTeVbZjuOX6QiKqsA",3330:"sha384-xA96/UOF3gSyb2hS3eYpAIeaez3Sd8CYkWODJNME8A3afko5wpookaRXjVnQCnaa",3349:"sha384-b2XW139OVO4g71JoExEGfrAUbK7h+eTp/OTZ2IO7K60Cerctt8dDJYCkBPK67KxZ",3508:"sha384-2nWQFJJw95dIUL/HxhTltajXMgfCDG4/dNImj9Xzc4DyAEHoXWoXaJiilNiTrIVA",3589:"sha384-re8v32QXj2ucc64BPJ6tCmlRUkEn68pfx/nRc0fZ0nc2aC9QM6DZ3FtMV5kTkefS",3983:"sha384-ybGo5+F7+fd0t/iByxKLwVXo6mpbu0ILyaR2kU/mLxfRl/qwv4Jsw/uuzRG4WQZg",4061:"sha384-uuqzNZieabiYH57OkBNryIavGk8stZ+l0ddu0WgbzlHq4/dzS0TKoHEzcNEAmgHR",4111:"sha384-pMJC/FDrefVcllpKvm7OqU9MfdizBm7Sy3cAQavJQ/sPdM4mck4911yo6NTZhtqr",4139:"sha384-/9R10SSWxz6mmfyHDZtKx9WS0c9QS2VJIPqCut+gkJHyuGUG8OeGzOght+lJOsU+",4290:"sha384-9k5F9UrEQ/sL77J00iRDNKM97v/hMXZszDjqUT+3QyAdeb/rlcGT9Km0kQcm0znh",4334:"sha384-OnW0gts8Qu60ZzmC4Sj5lFLishNQx+bBr4gbn1nBRr7JYdeVei1SfWostJzia//8",4423:"sha384-+pP+3VKqD+LCuUfjogipthLQekpXMqfPxhQu1170889j9CBbvSUgJOWsLSYUd9XO",4650:"sha384-UFfJpHUxGhuzAcBbCt4tDJKxIxDSmwWITrvHwwkpj/SF5X/MZYShqTcK5H+vg4F2",4722:"sha384-IvOFbmF85jhXc8O+wJT+hQWiULoYmC1AjYRn/Tqp06lz2P+SW3fAnN6HuvJ9dFfn",4890:"sha384-2X8Sr/vX+sWOVMbfKhPltiwXAff0j35OZOlODsI7c4/nnEUMMikVMy2jwAW4Ylu9",5047:"sha384-Wa4PkCQT5pZherbOCm7GvJrDVtgv/8dmnGCtnW2TKKRKkLK9SZ6UDFVeLHDLa69i",5365:"sha384-3uoYdip4h+W8Hx6FiQejnHh1RCFoxwabk6QnZTwhUcwFepSobom6Lcn0pHhFOQBi",5537:"sha384-ENVZT+U2n/Zz+yDVcS3504Oil77gNmwJjulWvMPz39vMJcOQV1hUGCz5rCi3lOZx",5583:"sha384-krSeyR0R1Vmz5/cnG7DnM6eYtlFPezPZ9A0MQvv8Ax/1LGIFNfu6cN8L/WGh2Imj",5775:"sha384-HKieI9kv97galCrFw1bsKS48MN5B5v1nm/DkJexMw6oOuqd4vgI9RXabaRfC6ayC",5807:"sha384-GKCP12ZiQsNSd1tGRKf2h/NuYXJAHrAd/vMqpcqXX2Ara7bRKilY6/lkRQyVAL6n",5850:"sha384-qx1cXByOXnucNT/yVpoRfbKJTYKPK0lEAwiQQJh8wp/8vz+TqrQuC1xPc3qZQEuf",5953:"sha384-8Yur9mfgaaZTPVzGBLrsP3TpsF4DisxBFQONJOQo+wv0MhOxbv/yDzYcJ3Q/M/c0",5994:"sha384-M/O6qdFE9OwNQAg+osQxxNpx+rue2JD7HVUmtnU0Rg/tMCI+42xfHU4rySSDz5oq",6072:"sha384-XwBcSxj5T4hLUGLR/NgyF3xRUVVBx6yV9Dq5bZii9NdMPOjgPKo44647LVdmeDGB",6109:"sha384-6XZqAAKCQTOgNRMUkZ0Yb2GwJalaQTG9Ry48musv/rtVmMs/tzq7gPOJCSTQ12SK",6201:"sha384-O1AEIkB4n36PICft86zp0PykeZmOCYotMkxaeVpi+LwwsiErUJj1uGfHpHceV5Mo",6281:"sha384-q13XRgZW1gY4hVRVIqV2INV4mAWS87EOWIZigBLVKzbJVbWZ69ZXD6BwNghJuxmI",6479:"sha384-Hlj8BGbIceUNTj/mmrwUct1M3zz1XFHsaehKVJ9+l3YB+RydwFgoHe5CJ5KvCMWa",6599:"sha384-tCbbYHPZxcqC06/5qXGXtHmB15AjbKavfybJLQxgy+nvj0PinrhB5axn4kISwvlV",6720:"sha384-Z9CpBKoqEZ5J4BBh/Qb6dFByjdVnt37hPgmQi1dA5C4OOhBg1y0wf/Zkggyh47n2",6895:"sha384-/chXN4npyaae4tzGN9av4wgrJGk/kDMvZKMmD26+13JUpLuXbHmsitGn1KIYljtm",6914:"sha384-CNFxtBoTavQ8g75XdTJoKLgRRxDv/2bg8E+cUvvV4FcfgbDq9vbJqvzT/8ZLHpoV",7063:"sha384-IZuzDyABHZHEEsTx6kn+6d6h/Rkjp4Z8pmaPTYLxIo3MQtCLuL1d9Y0nW5R45rFb",7171:"sha384-mw/FOMibu/LoXOaiIY7udqnWUSiI3VlluJtSYpgrGQ0h+tYIsRV3Qw5dohL/mKaf",7207:"sha384-ZJ5ywtIbLnobk0UAk+EnVCMZWjv4BRruAg00sZNVMMC/0A5mpvKiAkolihjUdkiY",7234:"sha384-fc7KT6YUqPDAgRJ3Ic2HKHur1tmvlp1AfYdOuWKSdsJB9eW8L/iD+67mqH4Frboq",7291:"sha384-3OIzfwkwD7qhgAj34O+LhO47sjSCCPfiXJ71Ybr9l8rSlR9ugcre+kWmShofE+8a",7479:"sha384-pJwYngM8pm+UgNMK74NJq4xXr1B3ekgWavPwjUfk6qxXBM3TZ3IYEFwwY0q6boWr",7717:"sha384-Lv+/eKOTEZyv+G0QJfwWRr7eob5aBJ6HoLFxsJkORu3e5U1PUKnbjQobUPJVnUD2",7761:"sha384-EvJ0bo/6FZ49D0VvXlS6YDfDRwxp4uDR+odfP45bxdEAvqOqp6YO3APplsuTfOIf",7923:"sha384-PQO106BxSU4Wvm4ChrlK9IvgR4WKyIKzk7uw9U3+0vu4CYm1GjKq4VjiV1nhz+qQ",8016:"sha384-6f9lMKrQKxotf+f1PmNZqDZLwLaDod0g7/5fLiyLBwfLh8bdbWU5Ig/v7Vw4L+9E",8041:"sha384-xYtMqjpV8BtwAY2z3IuTa9fwiCiQNp5Vz3N5VMnszz2CNXwyMNV0h0LOKMOiUVge",8234:"sha384-d07l8mNBCrR8j5osjJn0W51HB6qosy61+2Nezc/RALhuwyw1fSXxD6VV7209NWhS",8303:"sha384-kP+MDiWpJA7pTnW7eccVGH1t4ZffUyoXZzof5FQZbB4P9YTbSoBOXgySkF2rG8zf",8375:"sha384-UqGWF3d9NGDBePVxlNA/omKRpCXw90ZXWdqLx+x2sBkZy/S0SuhuKG5A+8gERv2/",8461:"sha384-2VZUp4kdfBnKKpOpYlrinVxecP0D4WOtW3BmS7gqJbbM4sSqMATvMBvnjpf+c3P7",8664:"sha384-CD9hIo4TwICp6rR4xhPvnvkTtH39NfUMt9FDJel17L1iUlyslUst7AMucdyfm0iJ",9015:"sha384-C7u1dMCvGk4JchHXrFykN9iTAvyyXLvymmJ5n9N6uof1+rqa3rE948RpXSqZ3+t3",9059:"sha384-6RXK+a8XeCSE4xSEjdT9jls08YFmJx+7ACQWRd0n/JkH/uwgD7Xkd/vBgjoDBGTs",9094:"sha384-YehtMetuuKAJ9wkXdtFqdZuFjavj6FVzfwpB68Vy1v577e7TI6+5sYmPYDAaXYhj",9134:"sha384-rtb9Bxo6FHvEAuTiw6Jtac4s0Gyev1U1k7q+sJLDoT0ZSsZhC8Jt7GPPSpyrvxYA",9445:"sha384-WwGsPPQHdVX/kSknk3VqfnehPBgQNsL6Q2qp89KZ5POBce8PK0iMtMA7duG+Pu7i",9452:"sha384-pzM+1t83e7exA3tKeQ21LPAiOwA5VVPJJpiDNNYozWsg7l7MfewcNskTxjVgZ3nM",9770:"sha384-+qmcNpe6ae4YsnDGud+0iR3WFPmycu5eS9+MZQP9IXOVP1W7HAVYC4v+pIrMUvRN",9790:"sha384-zNflMZT9zcNQbx82yg7lddnQoSY3qbmgdSYOfrMvRGaT6oInHVciP/dQMUI2sJ6J",9894:"sha384-JGP4whMgtinz9BeVF2aQKDZgBmeqLV8l/0soywcpqgEQQUSmHvdYuEy5EZJ5u6sR",9917:"sha384-JfIxilnQy8FrM+V06FLvdeiThcG+B+z0Jj97RaxBuUN4JZ8Y/0Pu7SefSTjjzBlX",9971:"sha384-mqAIjJQPhmIkhi+CFGqSJNqu/eB6sjReLV6heTnwHmPhgrZYFMQMKs2KWMeeNMT4"},function(){if(void 0!==s){var t=s.u,e=s.e,n={},o={};s.u=function(e){return t(e)+(n.hasOwnProperty(e)?"?"+n[e]:"")},s.e=function(r){return e(r).catch((function(e){var i=o.hasOwnProperty(r)?o[r]:5;if(i<1){var c=t(r);throw e.message="Loading chunk "+r+" failed after 5 retries.\n("+c+")",e.request=c,e}return new Promise((function(t){var e=5-i+1;setTimeout((function(){var c="cache-bust=true&retry-attempt="+e;n[r]=c,o[r]=i-1,t(s.e(r))}),0)}))}))}}}(),function(){var t={9439:0};s.f.j=function(e,n){var o=s.o(t,e)?t[e]:void 0;if(0!==o)if(o)n.push(o[2]);else{var r=new Promise((function(n,r){o=t[e]=[n,r]}));n.push(o[2]=r);var i=s.p+s.u(e),c=new Error;s.l(i,(function(n){if(s.o(t,e)&&(0!==(o=t[e])&&(t[e]=void 0),o)){var r=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",c.name="ChunkLoadError",c.type=r,c.request=i,o[1](c)}}),"chunk-"+e,e)}};var e=function(e,n){var o,r,[i,c,a]=n,u=0;if(i.some((function(e){return 0!==t[e]}))){for(o in c)s.o(c,o)&&(s.m[o]=c[o]);a&&a(s)}for(e&&e(n);u<i.length;u++)r=i[u],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0},n=globalThis.webpackChunkMicrosoft_Office_OWL=globalThis.webpackChunkMicrosoft_Office_OWL||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}(),s.nc=void 0;var c={};s.r(c),s.d(c,{DataBoundary:function(){return a.nS},DocRebootSupportMode:function(){return a._E},ExpectedFailureReason:function(){return a.HR},FeatureGateConstants:function(){return a.dT},FileType:function(){return a.pt},Health:function(){return a.Xk},HealthLogger:function(){return a.R7},KpiType:function(){return a.v7},LogCategory:function(){return a.nh},QosErrorName:function(){return a.by},TraceLevel:function(){return a.kp},UlsLogger:function(){return a.hK},WacErrorName:function(){return a.it},WacParams:function(){return a.es},bootDiagnostics:function(){return a.pP},bootDocument:function(){return a.eK},bootDocumentWithCustomFunctions:function(){return a.gv},completeCreateNew:function(){return a.cv},createNewGuid:function(){return a.Oy},forceEndSession:function(){return a.DU},getClientUrlForOpenInMobileApp:function(){return a.yI},getDataBoundaryForRegion:function(){return a.yO},getDefaultResourceString:function(){return a.Ro},getDriveItem:function(){return a.ub},getExpectedFailureReason:function(){return a.lX},getFeatureGateConfigByName:function(){return a.SI},getFeatureGatesFromString:function(){return a.Gi},getFetchAccessToken:function(){return a.C4},getFetchItemFromNetwork:function(){return a._G},getHealthEndpoint:function(){return a.C6},getHootEndpoint:function(){return a.C},getOwlVersion:function(){return a.Dp},getParamStatement:function(){return a.PN},getPrebootSessionId:function(){return a.R4},getRemoteUlsEndpoint:function(){return a.yc},getShareEndpoint:function(){return a.$2},getSharesUrl:function(){return a.yr},getWebUrlForCopyLinkToPage:function(){return a.cL},getWiseEnvironmentFromTeamsRing:function(){return a.UT},initPackage:function(){return a.BK},isExpectedError:function(){return a.BI},isExpectedErrorByInfo:function(){return a.yC},isMobilePhone:function(){return a.VG},isNetworkError:function(){return a.TX},localStorage:function(){return a.Lr},logFeatureGateUsage:function(){return a.lO},notifyHostAccessibilityLoopComplete:function(){return a.xt},notifyHostBackButtonPressed:function(){return a.h_},prebootApplication:function(){return a._I},prebootDocument:function(){return a.b6},removePrebootSessionId:function(){return a.pp},setWacDataCenterValueToCache:function(){return a.FJ},unifiedUiHostConfigs:function(){return a.gz}});var a=s(57033);s.nc=window.nonce,((Microsoft=void 0===Microsoft?{}:Microsoft).Office=Microsoft.Office||{}).OWL=c}();