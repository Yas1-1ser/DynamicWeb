var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.PowerPoint=function(e){var t={};function i(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=17)}({17:function(e,t,i){"use strict";i.r(t),i.d(t,"DocRebootSupportMode",(function(){return lo})),i.d(t,"CommandIds",(function(){return z})),i.d(t,"EventIds",(function(){return K})),i.d(t,"createCancellationToken",(function(){return et})),i.d(t,"Application",(function(){return ho})),i.d(t,"createApplication",(function(){return uo}));const o=[[/!/g,"%21"],[/'/g,"%27"],[/\(/g,"%28"],[/\)/g,"%29"],[/\*/g,"%2A"]],n=["eurppc"];function s(e){return 8===e.toLowerCase().indexOf("ffc")}function r(e){return 8===e.toLowerCase().indexOf("ppc")}function a(e){const t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function c(e,t){if(!t||-1===n.indexOf(t.toLowerCase()))return e;const i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?`${i[1]}${t}-${i[3]}`:e}function d(e){const t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function l(e,t){const i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");const o=i[2];if(void 0===t)return o;if(t<0)throw new Error("subDomainParts should be at least 1");return o.split(".").slice(-(t+1)).join(".")}function h(e){return e+"RemoteUls.ashx"}function u(e,t,i){i&&(e[t.toLowerCase()]=i)}function p(e,t){e[t.toLowerCase()]=""}function f(e,t){const i=e.toLowerCase(),o=t.toLowerCase();let n=i.indexOf("&"+o+"=");if(-1===n&&(n=i.indexOf("?"+o+"=")),-1===n)return"";const s=n+(t.length+2),r=e.indexOf("&",s);return e.substring(s,-1===r?void 0:r)}function m(e,t,i,o){if(!i)return e;let n=e;const s=n.indexOf("?");let r="&";s===n.length-1||"&"===n.slice(-1)||"&>"===n.slice(-2)?r="":-1===s&&(r="?");const a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(n);if("?"!==r&&c){if(o){const e=c.index+1,t=n.indexOf("&",e);n=n.substring(0,e)+a+i+(-1===t?"":n.substring(t))}return n}return n.concat(r,a,i)}function w(e){const t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach(e=>{if(e){const i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}}),t}function g(e,t){if(!e)return e;let i=e;const o=i.indexOf("?"),n=t.toLowerCase()+"=",s=i.toLowerCase().indexOf(n,o);if(s>=0){const e=i.indexOf("&",s);return i=i.substring(0,s)+(-1===e?"":i.substring(e+1)),"&"===i.slice(-1)&&(i=i.slice(0,-1)),i}return e}function v(e){const t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function S(e,t,i){const o=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),n=e.match(o);return!(!n||i&&n[1]!==i)}function I(e,t){const i=f(e,t);return i?decodeURI(i):i}function _(e){return f(window.location.href,e)}function b(e){let t=encodeURIComponent(e);return o.forEach(e=>{t=t.replace(e[0],e[1])}),t}function C(e){let t=(e+"===").substring(0,e.length+(4-e.length%4)%4);return t=t.replace(/-/g,"+"),t=t.replace(/_/g,"/"),atob(t)}function T(e){const t=document.createElement("a");t.href=e;const i=t.port||80,o=window.location.port||80;return t.hostname===window.location.hostname&&i===o}function P(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function y(e=!1,t){return{shouldPreconnect:e=>A&&(!t||t(e)),preconnect:t=>function(e){const t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}(e?v(t):t)}}const A=!0;var U,E,F;function O(e,t,i){if(!t)return;const o=window.navigator;if(o&&o.sendBeacon)try{return void o.sendBeacon(t,e)}catch{}!function(e,t,i){const o=new XMLHttpRequest;o.readyState!==XMLHttpRequest.UNSENT&&o.readyState!==XMLHttpRequest.DONE||(o.open("POST",t,i),o.send(e))}(e,t,i)}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(U||(U={})),function(e){e[e.h=0]="msoulscat_ES_EWAJS",e[e.u=1]="msoulscat_ES_EWAJSGrid",e[e.g=6]="msoulscat_ES_EWAJSChart",e[e.v=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=220]="msoulscat_MSOSP_AddInCommands",e[e.P=225]="msoulscat_MSOSP_OTelJS",e[e.A=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.U=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.F=301]="msoulscat_Wac_WordViewer",e[e.O=306]="msoulscat_Wac_BrowserGeneral",e[e.k=320]="msoulscat_Wac_TaskPane",e[e.R=339]="msoulscat_Wac_OneNoteGeneral",e[e.N=340]="msoulscat_Wac_Ribbon",e[e.H=356]="msoulscat_Wac_WacFeedback",e[e.B=379]="msoulscat_Wac_WopiPendingApplication",e[e.J=383]="msoulscat_Wac_Telemetry",e[e.$=391]="msoulscat_Wac_WacCatchUpActivities",e[e.j=394]="msoulscat_Wac_Dictation",e[e.q=395]="msoulscat_Wac_OneNoteSync",e[e.K=700]="msoulscat_Wac_VisioApp",e[e.Z=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.X=800]="msoulscat_Wac_PptAnimation",e[e.Y=833]="msoulscat_Wac_PptLive",e[e.ee=834]="msoulscat_Wac_PptMWeb",e[e.te=835]="msoulscat_Wac_PptGc2General",e[e.ie=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.oe=837]="msoulscat_Wac_PptGc2Operation",e[e.ne=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.se=844]="msoulscat_Wac_PptDataSync",e[e.re=848]="msoulscat_Wac_PptFluidRuntime",e[e.ae=815]="msoulscat_Wac_PptShape",e[e.ce=817]="msoulscat_Wac_PptSession",e[e.de=830]="msoulscat_Wac_PptSlideshow",e[e.le=822]="msoulscat_Wac_PptView",e[e.he=846]="msoulscat_Wac_PptVideos",e[e.ue=1303]="msoulscat_Uci_Insights",e[e.pe=2300]="msoulscat_Wac_VersionHistory",e[e.fe=302]="msoulscat_Wac_WordPresence",e[e.me=3e3]="msoulscat_Wac_OAuth",e[e.we=3005]="msoulscat_Wac_WordVersionHistory",e[e.ge=3006]="msoulscat_Wac_LivePersonaCard",e[e.ve=3012]="msoulscat_Wac_CatchUpFlyout",e[e.Se=3016]="msoulscat_Wac_WordDesigner",e[e.Ie=3021]="msoulscat_Wac_ModernFontPicker",e[e._e=3027]="msoulscat_Wac_UnifiedUiHost",e[e.be=3033]="msoulscat_Wac_EquationTools",e[e.Ce=1401]="msoulscat_Osf_Latency",e[e.Te=1402]="msoulscat_Osf_Notification",e[e.Pe=1403]="msoulscat_Osf_Runtime",e[e.ye=3041]="msoulscat_Wac_AiMaker",e[e.Ae=3043]="msoulscat_Wac_AiRewrite",e[e.Ue=3044]="msoulscat_Wac_AiInsert",e[e.Ee=3047]="msoulscat_Wac_AiSummarize",e[e.Fe=3048]="msoulscat_Wac_CopilotCompose",e[e.Oe=3049]="msoulscat_Wac_Skittles",e[e.We=3050]="msoulscat_Wac_CopilotChat",e[e.ke=3051]="msoulscat_Wac_Syntex",e[e.Re=3052]="msoulscat_Wac_WireGraph",e[e.Ne=3053]="msoulscat_Wac_CshCopilot",e[e.Me=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.xe=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.De=3057]="msoulscat_Wac_CopilotCursor",e[e.He=3059]="msoulscat_Wac_WasmGeneral",e[e.Be=3060]="msoulscat_Wac_WasmTextLayout",e[e.Le=3061]="msoulscat_Wac_WasmSmartArt",e[e.Ve=3062]="msoulscat_Wac_WasmClient",e[e.Je=3063]="msoulscat_Wac_WasmNative",e[e.$e=4e3]="msoulscat_AIHub_CreateModuleTelemetry"}(E||(E={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(F||(F={}));const W={BUILD_NUMBER:"###VERSION###",BUILD_NUMBER_MINOR:-1};function k(){try{return W.BUILD_NUMBER}catch(e){return W.BUILD_NUMBER}}function R(){return W.BUILD_NUMBER_MINOR}var N,M;function x(e,t,i){!function(e,t,i,o=!0){const n={type:t.toString(),payloadJson:JSON.stringify(i)};O(JSON.stringify(n),e,o)}(e,N.JSAPI_STATE,{application:t,build:k(),state:i})}function D(){return window.performance.now()}function H(){return Math.round(window.performance.now()+window.performance.timeOrigin)}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(N||(N={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(M||(M={}));class B{getTimeSpentLogging(){return this.Ge}addLoggingTime(e){this.Ge+=e}configure(e){const t=D();if(e.uploadCadenceInMs&&(this.ze=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.je=e.uploadTriggerSize),e.sessionId&&(this.qe=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.Ke)throw new Error("Remote ULS endpoint is already set");this.Ke=this.Ze(e.remoteUlsEndpoint),this.Xe=H(),this.Qe()}this.Ge+=D()-t}handleTrace(e){const t=D();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Ye.push(e),(this.Ye.length>this.je||e.level===F.Error)&&this.Qe(),this.Ge+=D()-t}getUserSessionId(){return this.qe}constructor(e){this.ze=3e4,this.je=30,this.et=0,this.Ye=[],this.Xe=H(),this.tt=[],this.qe="",this.Ge=0,this.flushOnClose=()=>{this.it(!1,!1)},this.flush=()=>{this.Qe()},this.flushAndSetNewEndpoint=(e,t)=>{var i;const o=this.Ze(e);o.localeCompare(null!==(i=this.Ke)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(this.tt.push(()=>{this.Ke=o,t&&t()}),this.it(!0,!0))},this.updateEndpointAndFlush=e=>{this.Ke=this.Ze(e),this.it(!0,!0)},this.Ze=e=>e+"?usid="+this.qe+"&officeserverversion="+k(),this.Qe=()=>{window.setTimeout(()=>this.it(!0,!0),0)},this.it=(e,t)=>{const i=D();window.clearTimeout(this.ot),this.Ke&&(this.Ye.length>0&&(this.et+=1,O(function(e,t,i,o){const n=[],s=e.map(e=>function(e,t,i){const o={};if(o.G=e.tag,o.T=e.timestamp-t,o.M=e.message,o.C=e.category,e.correlationId){let t=i.findIndex(t=>t===e.correlationId);t<0&&(t=i.push(e.correlationId)-1),o.I=t}const n=1e3*e.type+e.level;return o.D=n,o}(e,o,n)),r=function(e,t,i,o,n){const s={};return s.T=e,s.L=t,s.S=i,s.I=o,n&&n.length>0&&(s.W=n),s.V=1,s}(o,s,t,i,n);return JSON.stringify(r)}(this.Ye.splice(0,e?this.je:this.Ye.length),this.qe,this.et,this.Xe),this.Ke,t),this.Xe=H()),0===this.Ye.length&&this.tt.length>0&&(this.tt.forEach(e=>{"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)}),this.tt=[]),e&&(this.ot=window.setTimeout(()=>{this.Qe()},this.Ye.length>this.je||this.tt.length>0?1e3:this.ze)),this.Ge+=D()-i)},e&&this.configure(e)}}let L,V=[];var J,$,G,z,j,q,K;function Z(e){const t=new B(e);function i(e,i,o,n){const s=D();if(function(e){return 1===V[e]}(e))return;const r={timestamp:H(),category:i,tag:e,level:o,type:M.Trace,message:n,correlationId:""};t.addLoggingTime(D()-s),t.handleTrace(r)}return{ULS:{nt:(e,t,o,n)=>{i(e,t,o,n)},shipAssertTag:(e,t,o,n)=>{o&&i(e,t,F.Error,n)},debugAssertTag:(e,t,i,o)=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:()=>{}},configure:e=>{t.configure(e)},settingsChangeHandler:e=>{var i,o;i=e.st.getValue(J.rt,""),o=e.st.getValue(J.ct,""),L&&o===L||(V=[],L=o,i&&i.split(",").forEach(e=>{const t=parseInt(e,10);t&&(V[t]=1)})),t.configure({uploadCadenceInMs:e.st.getValue(J.dt,6e4)});const n=e.st.getValue(J.lt,"").toString();""!==n&&t.flushAndSetNewEndpoint(n)},getTimeSpentLogging:()=>t.getTimeSpentLogging(),getUserSessionId:()=>t.getUserSessionId(),flushAndSetNewEndpoint:(e,i)=>{t.flushAndSetNewEndpoint(e,i)},updateEndpointAndFlush:e=>{t.updateEndpointAndFlush(e)}}}function X(e){if(e){const t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function Q(e,t){return void 0===t?null:t}function Y(e){if(!e)return"";const t=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,[...t,...i])}function ee(e,t){return{isFeatureEnabled:i=>function(e,t,i){if(t)try{return t(e)}catch(e){i&&i.ULS.nt(594883024,E.B,F.Error,"IsFeatureEnabled callback error: "+Y(e))}}(i,e,t)}}function te(e,t){const i={};if(Object.keys($).forEach(t=>{const o=e.isFeatureEnabled($[t]);void 0!==o&&(i[$[t]]=o?"1":"0")}),t&&t.wdFlights){const e=t.wdFlights.toLowerCase();for(const t of e.split(","))"et-treatment"!==t&&"et-control"!==t||(i[$.ht]="et-treatment"===t?"1":"0")}return JSON.stringify(i)}!function(e){e.ut="BootstrapperMaxUlsHeartbeatTime",e.pt="BootstrapperNoCompleteWarning1Time",e.ft="BootstrapperNoCompleteWarning2Time",e.wt="BootstrapperNoCompleteWarning3Time",e.ct="RemoteUlsETag",e.rt="RemoteUlsSuppressions",e.gt="BootstrapperSettingsFetchPeriod",e.vt="timestamp",e.St="BootstrapperUlsHeartbeatIntervalMs",e.It="BootstrapperUlsHeartBeatIsEnabled",e.dt="BootstrapperUlsUploadCadenceMs",e._t="WordConsumptionViewToEditRedirectIsEnabled",e.bt="RequestedCallThrottlingDefaultToViewMinimumValue",e.lt="BulsEndpointUrl",e.Ct="EnableCommonHostDiagnosticsParams",e.Tt="EnableICNForWord",e.Pt="EnableModernEmbedViewForPowerPoint",e.yt="EnableModernEmbedViewInOneUpForPowerPoint",e.At="EnableModernEmbedViewForPowerPointGlobalAppUrl",e.Ut="EnableModernReadingViewForPowerPoint",e.Et="EnableDefaultToModernForPowerPoint",e.Ft="ShouldLogJsApiKpisForWord",e.Ot="WordSwitchToViewInTeamsJsapiV1Enabled",e.Wt="EnableWordSessionRefreshTelemetry",e.kt="PowerPointUseEssDCHint",e.Rt="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",e.Nt="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",e.Mt="ModernEmbedViewForPowerPointEnabledPercentage",e.xt="PowerPointESSCookieLookbackThresholdHour",e.Dt="PowerPointSetESSCookieLookbackExpEnabled",e.Ht="ExcelForceViewOnlyInTeamsJsapiV1",e.Bt="EnableWordSessionRefreshLoggingCleanup",e.Lt="WordRefreshTelemetryExpirationInDays"}(J||(J={})),function(e){e.ht="EnterpriseTemplates",e.Vt="ExcelAdaptiveLayoutDownload",e.Jt="ExcelLandingPageOfflineTelemetry",e.$t="ExcelLandingPageObserverRetry",e.Gt="H2StaticContent",e.zt="HashedUrl",e.jt="ODCShareLinkPreload",e.qt="OfficeComExcelJsApiV2",e.Kt="OfficeComPptJsApiV2",e.Zt="OfficeComUiHost",e.Xt="OfficeComWordJsApiV2",e.Qt="OfficeHwaUiHost",e.Yt="OfficeUnifiedUiHostTeams",e.ei="WordViewToUnifiedRead",e.ti="DocAspxMsal"}($||($={}));class ie{add(e){e&&this.ii.push(e)}remove(e){if(!e)return;const t=this.ii.indexOf(e);t>-1&&this.ii.splice(t,1)}removeAll(){this.ii=[]}dispatch(e,t){this.ii.forEach(i=>{try{i(e)}catch(e){t&&t(e)}})}constructor(){this.ii=[]}}class oe{updateEnvironment(e){this.oi=(s(e)?"FF":"Prod")+this.ni+"Settings",this.si()}initializePeriodicFetch(e,t){this.oi=(s(e)?"FF":"Prod")+this.ni+"Settings",this.si(),this.ri=e+"AppSettingsHandler.ashx?app="+this.ni+"&usid="+t+"&build="+k(),this.ai||(this.ai=window.setTimeout(this.ci,3e4))}getValue(e,t){if(this.di||this.si(),!this.di||!this.di.hasOwnProperty(e))return t;const i=this.di[e],o=typeof t;if(typeof i===o)return i;if("string"==typeof i){if("number"===o)return parseInt(i,10);if("boolean"===o)return"true"===i}return t}addSettingsChangeListener(e){this.li.add(e)}removeSettingsChangeListener(e){this.li.remove(e)}dispose(){this.ai&&window.clearTimeout(this.ai),this.hi&&self.cancelIdleCallback(this.hi),this.ai=void 0,this.hi=void 0,this.di=void 0,this.li.removeAll()}constructor(e,t){this.pi=0,this.si=()=>{try{if(!window||!window.localStorage)return;const e=window.localStorage.getItem(this.oi);if(!e)return;const t=JSON.parse(e);this.fi(t)}catch(e){this.mi.ULS.nt(592836768,E.B,F.Warning,"Failed to get settings from localStorage: "+Y(e))}},this.fi=e=>!!this.wi(e)&&(this.di=e,this.li.dispatch({st:this},e=>{this.mi.ULS.nt(592836769,E.B,F.Error,"Settings listener error: "+Y(e))}),!0),this.wi=e=>{if(e&&"object"==typeof e){if(e.hasOwnProperty(J.vt)&&!isNaN(e.timestamp))return!0;this.mi.ULS.nt(592836770,E.B,F.Error,"Received invalid settings")}return!1},this.ci=()=>{if(!this.ri)return;const e=new XMLHttpRequest;window.location.href.indexOf("wdnetcorerouting=true")>-1?e.setRequestHeader("X-NetCoreRouting","true"):window.location.href.indexOf("wdnetcorerouting=false")>-1&&e.setRequestHeader("X-NetCoreRouting","false"),e.open("GET",this.ri),e.responseType="json",e.timeout=5e3,e.send(),e.onload=()=>{if(200===e.status&&e.response?(this.gi(e.response),this.pi=0):(this.mi.ULS.nt(592836771,E.B,F.Error,`Fetch settings error. Status: ${e.status}, curErrors: ${this.pi}`),this.pi+=1),this.pi>7)return;let t=this.getValue(J.gt,3e5);this.pi>3&&(t+=(this.pi-3+1)*(t/2)),this.ai=window.setTimeout(this.ci,t)}},this.gi=e=>{"requestIdleCallback"in window?(this.hi&&self.cancelIdleCallback(this.hi),this.hi=window.requestIdleCallback(()=>this.vi(e),{timeout:1e4})):window.setTimeout(()=>this.vi(e),0)},this.vi=e=>{if(!this.fi(e)||!window||!window.localStorage)return;const t=JSON.stringify(e);try{window.localStorage.setItem(this.oi,t)}catch(e){this.mi.ULS.nt(592836800,E.B,F.Warning,"Failed to set localStorage: "+Y(e))}},this.ni=e,this.oi="Prod"+e+"Settings",this.mi=t,this.li=new ie,this.si()}}!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete",e.setWacFlightValue="setWacFlightValue"}(G||(G={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(z||(z={})),function(e){e.Si="App_AccessibilityLoopComplete",e.Ii="Wac_ActionComplete",e._i="WacInitialize_Ready",e.bi="Wac_AppFailed",e.Ci="Wac_AppBootState",e.Ti="Wac_AppCompleted",e.Pi="BrowserEvent",e.yi="UI_Close",e.Ai="App_CloseTab",e.Ui="UI_Conversation",e.Ei="UI_CopyAndEdit",e.Fi="App_CreateNewDocument",e.Oi="Wac_AppDataSavedStatus",e.Wi="UI_Download",e.ki="UI_Edit",e.Ri="Error",e.Ni="UI_FileEmbed",e.Mi="UI_FileProperties",e.xi="File_Rename",e.Di="File_RenameFailed",e.Hi="UI_FileVersions",e.Bi="StateChanged",e.Li="App_IsFrameTrusted",e.Vi="GetAccessToken",e.Ji="App_GetAuthToken",e.$i="App_GetCustomAuthConfig",e.Gi="App_GetHostKeyValue",e.zi="App_WopiInfoFromUrl",e.ji="App_DavUrlFromIds",e.qi="App_LoadingStatus",e.Ki="App_SwitchMode",e.Zi="App_MoveToFolder",e.Xi="UI_OpenInMobileApp",e.Qi="UI_OpenInBrowser",e.Yi="UI_OpenInClient",e.eo="PageChanged",e.to="App_PushCommentContext",e.io="App_PushState",e.oo="App_DocReboot",e.no="UI_RedeemForCommenting",e.so="App_RefreshSessionInfo",e.ro="UI_ReplyWithChanges",e.ao="UI_ReportAbuse",e.co="App_FilePicker",e.do="UI_SaveStatus",e.lo="WopiSession_Complete_Ack",e.ho="SetOverlayContent",e.uo="UI_Sharing",e.po="UI_ShareForm",e.fo="UI_SignIn",e.mo="App_StoreHostKeyValue",e.wo="App_Unloaded",e.vo="App_UlsLog",e.So="Wac_UnloadingApp",e.Io="App_UpdateBootComplete",e._o="PageCount",e.bo="UI_CheckUserAccessAndGrantPermissions",e.Co="User_Activity",e.To="Edit_Notification",e.Po="UI_Workflow",e.yo="ZoomChanged",e.Ao="CAAEMessage",e.Uo="Excel_HostFrameCacheSave",e.Eo="Excel_HostFrameCacheEvict",e.Fo="Excel_RegenerateFileBundle",e.Oo="App_SwitchToWacFrame",e.Wo="App_SaveSSRData",e.ko="App_PurgeDataInHostCache",e.Ro="App_SaveHostRenderingV2Data",e.No="App_SaveHostUtilsData",e.Mo="AcquireOAuthTokenTeams",e.xo="App_SwitchNotebook",e.Do="FailedBoot_CheckFileInfo",e.Ho="GetTeamsUsers",e.Bo="SendTeamsUserMention",e.Lo="NavigateBackToHost",e.Vo="App_GetClientUrlComplete",e.Jo="App_GetWebUrlComplete",e.$o="App_CopyLinkComplete",e.Go="App_SendConversationId",e.zo="CloseTeamsConversation",e.jo="PageLoaded",e.qo="Visio_BRS",e.Ko="Visio_SendLicenseInfo",e.Zo="Visio_Consumption_CLTComplete",e.Xo="Visio_SwitchMode_FromViewFrame",e.Qo="Visio_ModeSwitch_ToHost_Ack",e.Yo="Visio_UpdateEditUrl",e.en="Visio_PageViewLoaded",e.tn="Visio_ActiveAppFrameLoadFailed",e.in="Visio_DisposeBkgFrame",e.on="Visio_ReadyToReceiveDocData",e.nn="Visio_DocReboot_HostNav",e.sn="Visio_SwitchToVisioFrame",e.rn="WacAppPerfMetric",e.an="App_ModifyURLState",e.cn="App_WacTokenAck",e.dn="App_InitEnd",e.ln="App_SplashScreenShown",e.hn="App_SetWacFlightValue",e.un="App_PrintRedirect",e.pn="App_RequestFullScreen"}(j||(j={})),function(e){e.fn="Ack",e.mn="WacInitialize_Ready_Ack",e.wn="Wac_BeforeUnloadApp",e.gn="Blur_Focus",e.vn="Wac_AppFailed_Ack",e.Sn="Wac_AppCompleted_Ack",e.In="WopiStartSession_Complete",e._n="WopiPendingSession_Complete",e.bn="Host_AccessibilityLoopComplete",e.Li="Host_IsFrameTrusted",e.Cn="Grab_Focus",e.Tn="HostCacheDiagnostic",e.Pn="Host_KeyValue",e.yn="JsApiDiagnostics",e.Zi="Host_MoveToFolder",e.An="PageChanged_Ack",e.Un="App_PopState",e.En="Host_SendChannelId",e.Fn="Host_SendConversationId",e.On="GetTeamsUsers_Reply",e.Wn="SendTeamsUserMention_Reply",e.kn="Host_BackButtonPressed",e.Rn="Host_GetClientUrl",e.Nn="Host_GetWebUrl",e.Mn="File_Rename",e.co="Host_FilePicker",e.xn="PostAccessToken",e.Dn="Host_SetAuthToken",e.Hn="Host_SetCustomAuthConfig",e.Bn="App_PushCommentContext",e.Ln="CanEmbed",e.Vn="Host_RefreshSessionInfo",e.Jn="CheckUserAccessAndGrantPermissions_Result",e.$n="Host_WopiInfoFromUrl",e.Gn="Host_DavUrlFromIds",e.zn="SetCurrentPage",e.jn="SetZoomLevel",e.qn="WopiPendingSession_Fail",e.Kn="SetOverlayContent",e.Zn="WopiPendingApplicationComplete_Received",e.Xn="Host_SwitchMode",e.Qn="Host_Unload",e.Yn="PageCount_Ack",e.es="ZoomChanged_Ack",e.ts="Host_ShareUI",e.os="Host_Telemetry",e.ns="Visio_ConsumptionCLTComplete_Ack",e.ss="Visio_SwitchMode_FromHF_Ack",e.rs="Visio_SwitchMode_FromHostFrame",e.as="Visio_FallbackToLegacySwitch",e.cs="Visio_DocumentData",e.ds="Host_PostWacToken"}(q||(q={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.InitEnd="InitEnd",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged",e.PrintRedirect="PrintRedirect",e.RequestFullScreen="RequestFullScreen"}(K||(K={}));const ne={[z.boot]:{ls:G.boot},[z.createNew]:{ls:G.createNew},[z.dispose]:{ls:G.dispose},[z.postWacToken]:{ls:G.postWacToken},[z.rename]:{ls:G.rename},[z.switchMode]:{ls:G.switchMode},[j.Ci]:{ls:G.handleBootState},[j.Ai]:{ls:G.closeTab},[j.Li]:{ls:G.frameTrust},[j.Ji]:{ls:G.getAuthToken},[j.Gi]:{ls:G.getHostKeyValue},[j.oo]:{ls:G.appReboot},[j.hn]:{ls:G.setWacFlightValue},[j.ho]:{ls:G.setOverlayContent},[j.mo]:{ls:G.storeHostKeyValue},[j.Io]:{ls:G.updateBootComplete},[z.blurFocus]:{hs:q.gn},[z.continueAccessibilityLoop]:{hs:q.bn},[z.grabFocus]:{hs:q.Cn},[z.moveToFolder]:{hs:q.Zi},[z.popState]:{hs:q.Un},[z.sendChannelId]:{hs:q.En},[z.sendConvId]:{hs:q.Fn},[z.teamsUsersReply]:{hs:q.On},[z.teamsUserMentionReply]:{hs:q.Wn},[z.backButtonPressed]:{hs:q.kn},[z.getClientUrl]:{hs:q.Rn},[z.getWebUrl]:{hs:q.Nn},[z.sendAccessToken]:{hs:q.xn},[z.sendAuthToken]:{hs:q.Dn},[z.sendHWRTelemetry]:{hs:q.os},[z.sendCustomAuthConfig]:{hs:q.Hn},[z.sendDavUrl]:{hs:q.Gn},[z.sendEmbeddedViewUrl]:{hs:q.Ln},[z.sendFrameTrustResult]:{hs:q.Li},[z.sendSessionInfo]:{hs:q.Vn},[z.sendUserAccessAndPermissions]:{hs:q.Jn},[z.sendWopiInfo]:{hs:q.$n},[z.signalShared]:{hs:q.ts},[z.completeSharedFilePicker]:{hs:q.co},[j.Si]:{us:K.AccessibilityLoopCompleted},[j.Ii]:{us:K.ActionCompleted},[j.Pi]:{us:K.BrowserEvent},[j.Ao]:{us:K.CAAEMessage},[j.yi]:{us:K.Close},[j.Ui]:{us:K.Conversation},[j.Ei]:{us:K.CopyAndEdit},[j.Fi]:{us:K.CreateNewDocument},[j.Wi]:{us:K.Download},[j.ki]:{us:K.Edit},[j.Ri]:{us:K.Error},[j.Ni]:{us:K.FileEmbed},[j.Mi]:{us:K.FileProperties},[j.xi]:{us:K.FileRenamed},[j.Hi]:{us:K.FileVersions},[j.Vi]:{us:K.GetAccessToken},[j.ji]:{us:K.GetDavUrlFromIds},[j.$i]:{us:K.GetCustomAuthConfig},[j.zi]:{us:K.GetWopiInfoFromUrl},[j.Bi]:{us:K.FrameStateChanged},[j.Ki]:{us:K.ModeSwitched},[j.Zi]:{us:K.MoveToFolder},[j.Xi]:{us:K.OpenInMobileApp},[j.Qi]:{us:K.OpenInBrowser},[j.Yi]:{us:K.OpenInClient},[j.eo]:{us:K.PageChanged},[j.io]:{us:K.PushState},[j.no]:{us:K.RedeemForCommenting},[j.so]:{us:K.RefreshSessionInfo},[j.ro]:{us:K.ReplyWithChanges},[j.co]:{us:K.SharedFilePicker},[j.ao]:{us:K.ReportAbuse},[j.do]:{us:K.SaveStatus},[j.uo]:{us:K.Share},[j.po]:{us:K.ShareForm},[j.fo]:{us:K.SignIn},[j.bo]:{us:K.UserAccessAndPermissions},[j.Co]:{us:K.UserActivity},[j.To]:{us:K.UserEditActivity},[j.Po]:{us:K.Workflow},[j.yo]:{us:K.ZoomChanged},[j.Mo]:{us:K.AcquireOAuthTokenTeams},[j.qi]:{us:K.LoadingStatus},[j.xo]:{us:K.SwitchNotebook},[j.Do]:{us:K.FailedBootCheckFileInfo},[j.Ho]:{us:K.GetTeamsUsers},[j.Bo]:{us:K.SendTeamsUserMention},[j.Lo]:{us:K.NavigateBackToHost},[j.Vo]:{us:K.GetClientUrlComplete},[j.Jo]:{us:K.GetWebUrlComplete},[j.$o]:{us:K.CopyLinkComplete},[j.Go]:{us:K.SendConversationId},[j.zo]:{us:K.CloseTeamsConversation},[j.jo]:{us:K.PageLoaded},[j.dn]:{us:K.InitEnd},[j.ln]:{us:K.SplashScreenShown},[j.un]:{us:K.PrintRedirect},[j.pn]:{us:K.RequestFullScreen}};function se(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+Y(e))}}t.perfNow=!0;for(let i=0;i<e.length;i+=1){try{let e=Math.floor(100*window.performance.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}catch(e){t.exceptions.push("Math.random: "+Y(e))}e[i]=Math.floor(16*Math.random())}return t}(e);let i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const o=15&e[i];return i+=1,("x"===t?o:3&o|8).toString(16)}),t]}function re(){return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[x]/g,ae)}function ae(){const e=new Uint8Array(1);return window.self.crypto&&window.self.crypto.getRandomValues?(window.self.crypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):window.msCrypto&&window.msCrypto.getRandomValues?(window.msCrypto.getRandomValues(e),Math.floor(e[0]/16).toString(16)):Math.floor(16*Math.random()).toString(16)}var ce;!function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(ce||(ce={}));const de=window.navigator,le=de?de.userAgent:void 0;function he(){if(le){if(le.indexOf("Firefox")>-1)return ce.Firefox;if(le.indexOf("Opera")>-1||le.indexOf("OPR")>-1)return ce.Opera;if(le.indexOf("Trident")>-1)return ce.IE;if(le.indexOf("Electron")>-1&&le.indexOf("Teams")>-1)return ce.TeamsElectron;if(le.indexOf("Edg")>-1)return ce.Edge;if(le.indexOf("Chrome")>-1)return ce.Chrome;if(le.indexOf("Safari")>-1)return ce.Safari}return ce.Unknown}function ue(){try{return!!le&&le.indexOf("iPad")>=0||!!le&&le.indexOf("Macintosh")>=0&&ve()&&!me()||!!le&&le.indexOf("Android")>=0||ve()}catch{return!1}}function pe(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}function fe(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function me(){return!!le&&le.indexOf("iPhone")>=0}function we(){return me()||/android.+mobile/i.test(de.userAgent)}function ge(){return window.devicePixelRatio||(window.screen?window.screen.deviceXDPI/window.screen.logicalXDPI:1)||1}function ve(){return!!de&&de.maxTouchPoints>0}function Se(e,t){t&&Object.keys(t).forEach(i=>{e[i]=t[i]})}function Ie(e,t){try{if(void 0===window.performance)return void t.ULS.nt(595948609,E.B,F.Info,"Performance not supported");const i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.nt(595948610,E.B,F.Info,"No resources under performance");const o=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i");for(let e=i.length-1;e>=0;e-=1){const n=i[e],s=n.name.match(o);if(s){let e=JSON.stringify(n);return e=e.replace(new RegExp(n.name,"g"),s[0]),void t.ULS.nt(595948616,E.B,F.Info,e)}}t.ULS.nt(595948484,E.B,F.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.nt(595948617,E.B,F.Info,"Could not trace the resource timing: "+Y(e))}}function _e(e){var t,i;const o={...e.host,sessionId:e.hostSessionId,domain:location?location.host:void 0};delete o.siteId,delete o.webId,delete o.uiHostTabId;const n={};if(e.wdParams){const t=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach(e=>{t[e]&&(n[e]=t[e])});const i=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;n.wdprevioussession&&!i.test(n.wdprevioussession)&&delete n.wdprevioussession,n.wdpreviouscorrelation&&!i.test(n.wdpreviouscorrelation)&&delete n.wdpreviouscorrelation}const s={...e.rebootOverride};delete s.ackExpected,delete s["ui-language"],delete s.wdUserSession,delete s.rebootMode,delete s.documentUrl;const r=e.wopi;return{accessToken:r?{length:r.accessToken.length,expiry:r.expiry}:"N/A",wacToken:r&&r.wacToken?{length:r.wacToken.length}:void 0,bootParams:e.bootParams,build:k(),host:o,intent:e.intent,jsApiVersion:"v2",rebootOverride:s,region:a(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:n}}function be(){const e={perfNowSupported:!0,browser:ce[he()],touchMode:ue(),highContrast:pe(),windows10x:fe()};try{const t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netOnline=t.onLine,e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch{}return e}function Ce(e){try{const t=e.hostInitDiagnostics;e.logger.ULS.nt(558155803,E.B,F.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.nt(596444237,E.B,F.Important,JSON.stringify({session:_e(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.nt(558155804,E.B,F.Error,"Failed to log init info: "+Y(t))}}function Te(){try{return localStorage.setItem("Test","Test"),localStorage.removeItem("Test"),!0}catch{return!1}}function Pe(e,t){try{const i=parseInt(e,10);if(!i)return;if(i<=H()-6e4)t.ULS.nt(558155805,E.B,F.Warning,"Bad userClickTime or host took 60+s to kick off the session from click");else if(Te()){const e=i.toString(),o=localStorage.getItem("lastUserClickTime");if(o){const n=parseInt(o,10);n&&i<=n?t.ULS.nt(558155806,E.B,F.Warning,"Bad userClickTime: less than or equal to lastUserClickTime, delta: "+(n-i)):localStorage.setItem("lastUserClickTime",e)}else localStorage.setItem("lastUserClickTime",e)}}catch(e){t.ULS.nt(558155807,E.B,F.Error,"Error when tracking userClickTime: "+Y(e))}}var ye;function Ae(e){const t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));const i=window.performance.navigation;if(i&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount),!e.hostPageNavigationType)){let t="UNKNOWN";switch(i.type){case 0:t="NAVIGATE";break;case 1:t="RELOAD";break;case 2:t="BACK_FORWARD";break;case 255:t="RESERVED"}e.hostPageNavigationType=t}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(ye||(ye={}));class Ue{dispose(){window.removeEventListener("beforeunload",this.ps,{capture:!0}),window.removeEventListener("pagehide",this.fs,{capture:!0}),window.removeEventListener("visibilitychange",this.ms,{capture:!0}),window.removeEventListener("unload",this.ws,{capture:!0})}constructor(e,t){this.ps=()=>Ee(e,"OnBeforeUnload",t),this.fs=()=>Ee(e,"OnPageHide",t),this.ms=()=>Ee(e,"VisibilityChange_"+document.visibilityState,t),this.ws=()=>Ee(e,"OnUnload",t),window.addEventListener("beforeunload",this.ps,{capture:!0,once:!0}),window.addEventListener("pagehide",this.fs,{capture:!0}),window.addEventListener("visibilitychange",this.ms,{capture:!0}),window.addEventListener("unload",this.ws,{capture:!0,once:!0})}}function Ee(e,t,i){e.ULS.nt(595957843,E.B,F.Important,`Page lifecycle: ${t} fired`+(i?", flushing logger":"")),i&&e.ULS.flush()}const Fe=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000"];class Oe{async isResourceTrustedForMessage(e){if(!e||!e.Resource)return!1;const t=e.Resource,i=e.AddinTrustId,o=function(e){if(!e)return!1;const t=e.toLowerCase();for(const e of Fe)if(e===t||e+"/"===t)return!0;return!1}(t);if(o||!i)return o;if(this.gs[i])return We(t,this.gs[i]);let n;const s=new Promise(e=>{n=(o,n)=>{i===o&&e(We(t,n))},this.vs.push(n)});let r=-1;const a=new Promise(e=>{r=window.setTimeout(()=>{this.mi.ULS.nt(560754786,E.B,F.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: "+i),e(!1)},2e3)}),c=await Promise.race([s,a]);return this.vs=this.vs.filter(e=>e!==n),window.clearTimeout(r),c}dispose(){this.gs={},this.vs=[],window.removeEventListener("message",this.Ss)}constructor(e){this.gs={},this.vs=[],this.Ss=e=>{if(e&&e.origin)try{const t=e.data;if("string"==typeof t&&t.includes("AddinTrustedOrigin")){const i=JSON.parse(t),o=i.AddinTrustId;o&&"AddinTrustedOrigin"===i.MessageId&&(this.mi.ULS.nt(560754784,E.B,F.Info,"didReceiveMessage addinTrustId "+o),this.gs[o]=e.origin,this.vs.forEach(t=>{t(o,e.origin)}))}}catch(e){this.mi.ULS.nt(560754785,E.B,F.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.mi=e,window.addEventListener("message",this.Ss)}}function We(e,t){try{if(!e||!t)return!1;const i=33,o=126,n=/[?&#%\\]/;for(let t=0;t<e.length;t+=1){const s=e.charCodeAt(t);if(s<i||s>o)return!1;const r=e.charAt(t);if(n.test(r))return!1}const s="api:",r="https:";let a=e;a.substring(0,s.length).toLowerCase()===s&&(a=`${r}${a.substring(s.length)}`);const c=new URL(a);return c.protocol===r&&t.toLowerCase()===c.origin.toLowerCase()}catch{return!1}}class ke{get diagnostics(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}}raiseEvent(e,t){this.logger.ULS.nt(574654541,E.B,F.Info,"Raising event: "+e);try{this.Is(e,t)}catch(e){this.logger.ULS.nt(593506838,E.B,F.Error,"Event handler error: "+Y(e))}}addActionHandler(e,t){this._s[e]||(this._s[e]=[]),this._s[e].push(t)}removeActionHandler(e,t){const i=this._s[e];if(i&&i.length>0){const e=i.indexOf(t);e>-1&&i.splice(e,1)}}run(e,t,i){if(this.state===U.Disposed&&this.backgroundSession)return this.logger.ULS.nt(525203609,E.B,F.Info,"Redirecting to background session: "+e),this.backgroundSession.run(e,t,i);const o=[],n=this._s[e];if(n&&n.length>0)o.push(this.bs(e,t));else{const n=ne[e];if(n){const s=n.ls,r=n.hs;if(s){this.logger.ULS.nt(574654542,E.B,F.Info,"Running flow: "+s);const n=this.Cs[s](e,t,this,this.Ts[s],i).catch(e=>(this.Ps(s,e),{completion:"failure",errorSource:"jsapi",error:e}));o.push(n)}else r&&(this.container&&this.container.postMessage(r,t),o.push(Promise.resolve({completion:"success"})))}else o.push(Promise.resolve({completion:"failure"})),this.logger.ULS.nt(593500189,E.B,F.Warning,"Unhandled command: "+e)}return Promise.race(o)}dispose(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.st.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this._s={},!this.pendingReboot){const e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}}constructor(e,t,i,o,n,s,r){var a;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.appBootState="Unknown",this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this._s={},this.onMessage=e=>{const t=e.MessageId,i=e.Values||{},o=this._s[t];if(o&&o.length>0)this.bs(t,i);else{const o=ne[t];if(o){const n=o.ls,s=o.us;n?(this.logger.ULS.nt(574654543,E.B,F.Info,"Running flow: "+n),this.Cs[n](t,i,this,this.Ts[n]).catch(e=>{this.Ps(n,e)})):s&&(s===K.Share&&(i.sendTimeAsClickTime=e.SendTime),this.raiseEvent(s,i))}}},this.Ps=(e,t)=>{this.logger.ULS.nt(596459925,E.B,F.Error,`${e} flow error: ${Y(t)}`),this.remoteTelemetryUrl&&x(this.remoteTelemetryUrl,this.appInfo.name,"flowException")},this.bs=(e,t)=>{this.logger.ULS.nt(574654544,E.B,F.Info,"Dispatching action: "+e);const i=this._s[e].slice().reverse();for(let o=i.length-1;o>-1;o-=1)try{i[o](e,t)}catch(t){this.logger.ULS.nt(596444186,E.B,F.Error,`${e} action handler error: ${Y(t)}`)}return Promise.resolve({completion:"success"})},this.state=U.Unknown;const[c,d]=se();this.isLoggerFromOwl=!!i.logger,this.logger=null!==(a=i.logger)&&void 0!==a?a:Z(),this.logger.ULS.nt(593506837,E.B,F.Info,JSON.stringify(d)),this.sessionId=c,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=o,this.appInfo=t,this.session=n,this.featureManager=ee(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.st=new oe(t.name,this.logger),this.preloader=t.preloader,[this.Cs,this.Ts]=s(this.featureManager),this.Is=r,this.clientDiagnostics=be(),this.pageStateObserver=new Ue(this.logger,!0),this.authTokenTrustValidator=new Oe(this.logger)}}class Re{get id(){return this.ys.sessionId}get diagnostics(){return this.ys.diagnostics}run(e,t,i){return this.ys.run(e,t,i)}boot(e,t){return this.ys.run(z.boot,e,t)}dispose(e){return this.ys.run(z.dispose,void 0,e)}constructor(e,t,i,o,n,s){!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i),this.ys=new ke(e,t,i,o,this,s,(e,t)=>n({type:e,data:t,session:this})),this.ys.state=U.Initialized}}function Ne(e){if(!e)return"";const t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),o=t.match(i);return!o||o.length<2?"":o[1]}function Me(e,t,i,o=xe.none,n){const s=e+"="+t;let r="";const a=new Date;a.setTime(a.getTime()+31536e6);let c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(r=";expires="+c.toUTCString());const d=s+r+";SameSite="+xe[o];return document.cookie=n?d+"; Secure":d,!(!document.cookie||-1===document.cookie.indexOf(s))||o===xe.none&&Me(e,t,i,xe.doNotSet,n)}var xe,De;!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(xe||(xe={}));class He{setTargetOrigin(e){const t=d(e).toLowerCase();this.As&&this.As!==t&&this.mi.ULS.nt(593232847,E.B,F.Warning,`Updating origin: [${P(this.As)}]->[${P(t)}]`),this.As=t,this.Us=l(t,2),this.Es=s(t),this.Fs=r(t)}setTargetFrame(e,t){this.Os=e,this.Ws=!!t}setMessageHandler(e){this.ks=e}removeMessageHandler(){this.ks=void 0}postMessage(e,t,i){if(!this.Os||!this.Os.contentWindow)return void this.mi.ULS.nt(593232848,E.B,F.Error,"Missing target to send message: "+e);this.mi.ULS.nt(593232849,E.B,F.Info,"Sending message: "+e);const o={MessageId:e,SendTime:H(),CorrelationId:i,Values:t};this.Os.contentWindow.postMessage(JSON.stringify(o),this.As)}dispose(){window.removeEventListener("message",this.Rs,!1),this.ks=void 0}constructor(e,t,i,o){var n;this.As="",this.Us="",this.Es=!1,this.Fs=!1,this.Ws=!1,this.Ns=!1,this.Rs=e=>{let t,i=!1,o=!0,n="",s=!1;if(this.Os&&this.Os.contentWindow&&(i=!0,o=e.source===this.Os.contentWindow),e.origin&&(n=l(e.origin,2).toLowerCase(),s=n===this.Us,!s&&this.Ms&&(n=l(e.origin).toLowerCase(),s=this.Ms.includes(n))),!this.Es&&(!this.Fs||s&&o)||this.mi.ULS.nt(593232850,E.B,F.Info,"Window: available["+i+"] valid["+o+"]; Origin: valid["+s+"] expected["+this.Us+"] actual["+n+"]"),!s||this.Ws&&!o)return;try{t=JSON.parse(e.data)}catch(e){return void this.mi.ULS.nt(593232851,E.B,F.Info,"Failed to parse event data: "+Y(e))}const r=t.MessageId;if(r){var a;if(this.mi.ULS.nt(593232854,E.B,F.Info,`Received message: ${r}, correlation: ${t.CorrelationId}`),r!==j.Ti&&r!==j.qi||this.setTargetOrigin(e.origin),t.Values&&t.Values.ackExpected&&this.postMessage(q.fn,void 0,t.CorrelationId),this.Ns&&r===j.rn)return window._pageTimings=null!==(a=window._pageTimings)&&void 0!==a?a:{},void(window._pageTimings[t.Values.name]=t.Values.time);if(this.ks)try{this.ks(t)}catch(e){this.mi.ULS.nt(594556386,E.B,F.Error,"Message handler error: "+Y(e))}else this.mi.ULS.nt(591933923,E.B,F.Error,"No message handler")}else(this.Es||this.Fs)&&this.mi.ULS.nt(593232853,E.B,F.Info,"Missing message id")},this.mi=t,this.setTargetOrigin(e),this.Ms=o,i&&this.setMessageHandler(i),this.Ns=!(null===(n=window.location)||void 0===n||null===(n=n.search)||void 0===n||!n.match(/wdpa=1/gi))||"1"===Ne("EnableMetricLogging"),window.addEventListener("message",this.Rs,!1)}}function Be(e,t){he()===ce.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function Le(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.nt(591525084,E.B,F.Info,"Trust check error: "+Y(t)),!1}}function Ve(e){return!(!e||!e.parentNode)&&(e.id?!!document.getElementById(e.id):void 0!==e.isConnected?e.isConnected:document.body.contains(e))}!function(e){e.xs="access_token",e.Ds="access_token_ttl",e.Hs="wac_token",e.Bs="bundleSrc",e.Ls="bundleStaleness",e.Vs="DocID",e.Js="SiteID",e.$s="WebID",e.Gs="ETag",e.zs="feature_status",e.js="fileExtension",e.qs="fileGetUrl",e.Ks="customFontCatalogUrl",e.Zs="fileName",e.Xs="fileSize",e.Qs="forceSLR",e.Ys="frameHeightPx",e.er="frameWidthtPx",e.tr="highContrast",e.ir="highDpi",e.or="host_diagnostics",e.nr="hostName",e.sr="huictrls",e.rr="owner_id",e.ar="sc",e.cr="softBlockedBrowser",e.dr="templateUrl",e.lr="touchMode",e.hr="user_id",e.ur="hfck",e.pr="hfcv",e.mr="timeZoneId",e.wr="darkCssMedia",e.gr="forcedColors",e.vr="prefersContrast",e.Sr="caae",e.Ir="meetingId",e._r="meetingTitle",e.br="meetingType",e.Cr="scheduledStartTime",e.Tr="scheduledEndTime",e.Pr="isPresenter",e.yr="meetingOrganizerId",e.Ar="meetingJoinUrl",e.Ur="isMeetingTeamsRoom",e.Er="jsapibuild",e.Fr="owlver",e.Or="owlro",e.Wr="caaemode",e.kr="traceparent",e.Rr="tracestate",e.Nr="supports_zipit",e.Mr="sipcn",e.xr="devcs",e.Dr="dceit",e.Hr="frameInnerHeightPx",e.Br="frameInnerWidthPx"}(De||(De={}));class Je{get element(){return this.Lr}get frameId(){return this.Vr}get formId(){return this.Jr}get isTopFrameTrusted(){return this.$r}boot(e,t,i,o,n,s,r){this.mi=i,this.Gr=new He(e,i,this.ks,o.additionalReceivingDomainList);const a=o.useAdditionalDiv,c=o.permissionsPolicy;this.zr&&!a?(this.zr.setAttribute("allow",c),this.mi.ULS.nt(588793045,E.B,F.Info,"Wac frame reused")):(this.zr=function(e,t,i,o,n,s,r,a,c,d){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";const l=e.ownerDocument,h=l.createElement("iframe");if(h.id=t,h.name=t,h.src="",h.title="Office on the web Frame",h.marginWidth="0",h.marginHeight="0",h.style.top="0",h.style.bottom="0",h.style.left="0",h.style.right="0",h.style.height="100%",h.style.width="100%",h.style.display="block",h.style.position="absolute",h.style.backgroundColor="transparent",h.style.border="none",h.frameBorder="0",h.setAttribute("allowfullscreen","true"),h.setAttribute("allowTransparency","true"),h.setAttribute("allow",i),Be(h,r),o&&(e.style.minHeight=o,h.style.minHeight=o),n&&(e.style.minWidth=n,h.style.minWidth=n),a&&h.setAttribute("role","none"),s){const t=l.createElement("div");t.style.top="0",t.style.bottom="0",t.style.left="0",t.style.right="0",t.style.height="100%",t.style.width="100%",t.style.backgroundColor="#393a3d",t.style.backfaceVisibility="hidden",o&&(t.style.minHeight=o),n&&(t.style.minWidth=n),t.appendChild(h),e.appendChild(t)}else e.appendChild(h);return c&&h.addEventListener("load",c,{once:!0}),d&&h.addEventListener("error",d,{once:!0}),h}(this.Lr,this.Vr,c,o.minHeight,o.minWidth,a,o.isInvisible,o.setNoneRole,s,r),this.mi.ULS.nt(588793046,E.B,F.Info,"Wac frame created")),n(),this.Gr.setTargetFrame(this.zr,o.enforceSameWindow),a&&(this.jr=this.zr.parentElement),o.useFrameFixForTeams&&i.ULS.nt(509143245,E.B,F.Info,"Frame fix enabled for teams uiHost"),function(e,t,i){u(t,De.Ys,String(i?window.outerHeight:e.offsetHeight)),u(t,De.er,String(i?window.outerWidth:e.offsetWidth)),u(t,De.lr,String(ue())),u(t,De.tr,String(pe())),u(t,De.Qs,String(fe())),u(t,De.wr,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch{return!1}}())),u(t,De.vr,String(function(){try{return window.matchMedia("(prefers-contrast: more)").matches}catch{return!1}}())),u(t,De.gr,String(function(){try{return window.matchMedia("(forced-colors: active)").matches||window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}())),u(t,De.Hr,String(window.innerHeight)),u(t,De.Br,String(window.innerWidth))}(this.zr,t,o.useFrameFixForTeams),this.qr=function(e,t,i,o,n){const s=e.ownerDocument,r=s.createElement("form");r.id=i,r.name=i,r.action=o,r.target=t,r.method="POST";for(const e in n){const t=s.createElement("input");t.type="hidden",t.name=e,t.value=n[e],r.appendChild(t)}return e.appendChild(r),r}(this.Lr,this.Vr,this.Jr,e,t),this.qr.submit()}setVisibility(e){this.zr&&Be(this.zr,e)}setMessageHandler(e){this.ks=e,this.Gr&&this.Gr.setMessageHandler(e)}setWrapperPostMessage(e){this.Kr=e}removeMessageHandler(){this.ks=void 0,this.Gr&&this.Gr.removeMessageHandler()}postMessage(e,t){this.Kr?this.Kr(e,t):this.Gr&&this.Gr.postMessage(e,t)}dispose(e,t){return new Promise(i=>{if(this.qr&&(this.Lr.removeChild(this.qr),this.qr=void 0),this.Gr&&(this.Gr.dispose(),this.Gr=void 0,this.ks=void 0),this.Kr&&(this.Kr=void 0),this.mi=void 0,!this.zr||!this.jr&&e)i();else{const e=()=>{this.jr?(this.jr.removeChild(this.zr),this.Lr.removeChild(this.jr)):this.Lr.removeChild(this.zr),this.zr=void 0,this.jr=void 0,i()};t?e():(this.zr.src="about:blank",window.setTimeout(e,0))}})}constructor(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.Lr=e,this.Vr=t,this.Jr=t+"_Form",this.$r=Le()}}class $e{get name(){return this.Zr.name}get version(){return k()}addEventListener(e){this.Xr.add(e)}removeEventListener(e){this.Xr.remove(e)}createContainer(e){const t=`WacFrame_${this.Zr.name}_${this.containers.length}`,i=new Je(e,t);return this.containers.push(i),i}createSession(e){const t=new Re(this.Qr,this.Zr,e,this,this.Yr,this.ea);return this.sessions.push(t),t}dispose(e){const t=this.sessions.map(t=>t.dispose(e).catch(e=>{}));return Promise.all(t).then(e=>(this.Xr.removeAll(),this.sessions=[],this.containers=[],{completion:"success"}))}constructor(e,t,i){this.sessions=[],this.containers=[],this.Yr=e=>{this.Xr.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");const t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");const i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.Qr=e,this.Zr=t,this.ea=i,this.Xr=new ie,function(e){if(e&&(W.BUILD_NUMBER=e,e.includes("."))){const t=e.split(".");W.BUILD_NUMBER_MINOR=parseInt((t[0]||"").concat((t[1]||"").padStart(3,"0")),10)}}(e.host.owlVersion)}}const Ge=(e,t,i)=>new Promise(t=>{i.logger.ULS.nt(590111070,E.B,F.Error,"Unsupported flow: "+e),t({completion:"failure"})});function ze(e){return!(!(e&&e.source&&e.accessToken)||!e.expiry&&0!==e.expiry)}function je(e){return function(e,t){const i={};return t&&Object.keys(t).forEach(e=>{i[e.toLowerCase()]=t[e]}),e.split("&").forEach(e=>{if(/^wd\w+=.+/i.test(e)){const t=e.split("=");i[t[0].toLowerCase()]=t[1]}}),i}(window.location.search.substring(1),e)}function qe(e){const t={};u(t,"jsapi","1"),u(t,"jsapiver","v2"),u(t,"corrid",e.sessionId),u(t,"usid",e.sessionId),u(t,"newsession","1"),u(t,"sftc","1"),e.hostSessionId&&u(t,"hid",encodeURIComponent(e.hostSessionId));const i=e.host;i.uiHostName&&u(t,"uih",i.uiHostName),i.uiHostIntegrationType&&u(t,"uihit",encodeURIComponent(i.uiHostIntegrationType)),i.metaUiHostVersion&&u(t,"muv",encodeURIComponent(i.metaUiHostVersion));const o=i.capabilities;o&&(o.accessibilityLoop&&u(t,"accloop","1"),o.rebootDoc&&u(t,"sdr",o.rebootDoc.toString()),o.createNewDoc&&u(t,"scnd","1"),o.authToken&&u(t,"sat","1"),window.docAspxMsalEnabled&&(o.authTokenStrategy="PairwiseBroker"),o.authTokenStrategy&&u(t,"ats",o.authTokenStrategy),o.customAuthConfig&&u(t,"cac","1"),o.refreshAccessToken&&u(t,"rat","1"),o.atMentions&&u(t,"sams","1"),o.moveToFolder&&u(t,"mtf","1"),o.noBrowserModalDialogs&&u(t,"nbmd","1"),o.commonFilePicker&&u(t,"sfp","1"),o.directDownload&&u(t,"sdd","1"),o.directPrint&&u(t,"sdp","1"),o.disableOfficeAddins&&u(t,"doa","1"));const n=e.ui;n.language&&u(t,"ui",encodeURIComponent(n.language)),n.uiEmbed&&u(t,"uiembed","1"),(n.hideHeader||"DocGen"===n.contentAssemblyMode||"Templatization"===n.contentAssemblyMode||"ContentAssemblyEdit"===n.contentAssemblyMode||"ContentAssemblyView"===n.contentAssemblyMode)&&u(t,"hhdr","1"),n.highContrast&&u(t,"hcm",encodeURIComponent(n.highContrast)),n.hideFileLocationPicker&&u(t,"hodflp","1"),n.hideAppLauncherInHeader&&u(t,"halh","1"),n.hideChatInHeader&&u(t,"hch","1"),n.hideMeInHeader&&u(t,"hmh","1"),n.hideSearchInHeader&&u(t,"hsh","1"),n.hideWorkflowInHeader&&u(t,"hwfh","1"),n.hideSettingsInHeader&&u(t,"hsth","1"),n.showAppIconInHeader&&u(t,"sih","1"),n.useNeutralColorInHeader&&u(t,"unh","1"),n.openLinksInNewWindow&&u(t,"onw","1"),n.useDarkTheme&&u(t,"udt","1"),"DocGen"!==n.contentAssemblyMode&&"ContentAssemblyView"!==n.contentAssemblyMode||u(t,"readOnly","1");const s=e.wopi;s&&s.source&&u(t,"wopisrc",encodeURIComponent(s.source));const r=e.bootParams;r&&(r.dataLanguage&&u(t,"rs",encodeURIComponent(r.dataLanguage)),r.readOnly&&u(t,"readonly","1"),r.disableChat&&u(t,"dchat","1"),r.cookieCompliant&&u(t,"mscc","1"),r.isNewFile&&(u(t,"new","1"),r.isFromHostTemplate&&u(t,"wdtpl","fromhost"))),e.user.isLicensed&&u(t,"islicenseduser","1"),e.user.isSynthetic&&u(t,"syn","1"),e.actNavId&&u(t,"actnavid",e.actNavId),e.sessionContext&&u(t,"sc",encodeURIComponent(e.sessionContext));const a=e.wdParams;if(a)for(const e in a)u(t,e,a[e]);const c=e.preseededSession;c&&(c.key&&u(t,"preseededsessionkey",encodeURIComponent(c.key)),c.id&&u(t,"preseededwacsessionid",encodeURIComponent(c.id)));const d=e.throttling;d&&(d.protection&&u(t,"ctp",d.protection),d.request&&u(t,"rct",d.request));const l=e.hostInitDiagnostics;l&&(l.entryPoint&&u(t,"wdorigin",encodeURI(l.entryPoint)),l.userClickTime&&u(t,"wdhostclicktime",l.userClickTime.toString()));const h=e.rebootOverride;return h&&h.previousSessionId&&u(t,"wdprevioussession",h.previousSessionId),p(t,"region"),t}function Ke(e,t,i){let o={...w(e.appUrl),...qe(e),...i};const n=e.rebootOverride;return n&&n.queryOverrides&&(o={...o,...n.queryOverrides}),function(e,t,i){const o=[];for(const e in i)i[e]&&o.push(e+"="+i[e]);return e+t+(o.length>0?"?"+o.join("&"):"")}(e.appBasePath,t,o)}function Ze(e,t){const i=function(e){const t={};u(t,"highdpi",String(window.devicePixelRatio>1.24)),u(t,"softblockedbrowser",String(he()===ce.IE&&!(he()===ce.IE&&null!=document.documentMode&&void 0!==document.documentMode&&document.documentMode>=11))),u(t,"hostname",e.hostName),u(t,"feature_status",te(e.featureManager,e.wdParams)),u(t,"jsapibuild",k());const i=e.wopi;i&&(u(t,"access_token",i.accessToken),u(t,"access_token_ttl",i.expiry.toString()),i.wacToken&&u(t,"wac_token",i.wacToken));const o=e.customFontCatalogUrl;o&&u(t,"customfontcatalogurl",o);const n=e.contentBundle;if(n){if(n.url){u(t,"bundlesrc",n.url);const i=n.staleness,o=null!=i;o&&u(t,De.Ls,i.toString()),e.logger.ULS.nt(577783775,E.B,F.Info,"Content bundle staleness: "+(o?i:"N/A"))}n.bundleUrlNoAuth&&u(t,"bundleurlnoauth",n.bundleUrlNoAuth),n.bundleCode&&u(t,"bundlecode",n.bundleCode)}const s=e.file,r=s.name;if(r){u(t,"filename",r);const e=X(r);e&&u(t,"fileextension",e)}s.getUrl&&u(t,"filegeturl",s.getUrl),s.downloadCode&&u(t,"filedownloadcode",s.downloadCode),s.urlNoAuth&&u(t,"fileurlnoauth",s.urlNoAuth),s.size&&u(t,"filesize",s.size.toString()),s.eTag&&u(t,"etag",s.eTag),s.cTag&&u(t,"revid",s.cTag),s.uniqueId&&u(t,"docid",s.uniqueId),void 0!==s.immutableReason&&u(t,"immutableReason",s.immutableReason.toString()),void 0!==s.supportsZipIt&&u(t,"supports_zipit",s.supportsZipIt.toString());const a=e.newFileTemplate;a&&(a.getUrl&&u(t,"templateurl",a.getUrl),a.size&&u(t,"filesize",a.size.toString()),a.eTag&&u(t,"etag",a.eTag),a.uniqueId&&u(t,"docid",a.uniqueId)),e.user.id&&u(t,"user_id",e.user.id),e.ownerId&&u(t,"owner_id",e.ownerId),e.sessionContext&&u(t,"sc",e.sessionContext);const c=e.ui;c.controls&&u(t,"huictrls",JSON.stringify(c.controls)),"Templatization"!==c.contentAssemblyMode&&"DocGen"!==c.contentAssemblyMode&&"ContentAssemblyEdit"!==c.contentAssemblyMode&&"ContentAssemblyView"!==c.contentAssemblyMode||u(t,"caae","1"),c.contentAssemblyMode&&u(t,"caaemode",c.contentAssemblyMode);const d=e.meeting;d&&(d.id&&u(t,"meetingId",d.id),d.title&&u(t,"meetingTitle",d.title),d.type&&u(t,"meetingType",d.type),d.scheduledStartTime&&u(t,"scheduledStartTime",d.scheduledStartTime),d.scheduledEndTime&&u(t,"scheduledEndTime",d.scheduledEndTime),d.isPresenter&&u(t,"isPresenter",d.isPresenter.toString()),d.organizerId&&u(t,"meetingOrganizerId",d.organizerId),d.joinUrl&&u(t,"meetingJoinUrl",encodeURIComponent(d.joinUrl)),d.isMeetingTeamsRoom&&u(t,"isMeetingTeamsRoom",d.isMeetingTeamsRoom.toString()));const l=e.host;l.owlVersion&&u(t,"owlver",l.owlVersion),l.owlRollout&&u(t,"owlro",l.owlRollout);const h=l.capabilities;return h&&(h.supportsInPlaceCreateNew&&u(t,"sipcn",h.supportsInPlaceCreateNew.toString()),h.disableEmbedViewCodeSnippet&&u(t,"devcs","1"),h.disableCoEditInTeams&&u(t,"dceit","1")),t}(e);return Object.keys(t).forEach(e=>{t[e]?i[e]=t[e]:delete i[e]}),i}const Xe=(e,t,i,o,n)=>e!==z.createNew?Promise.reject("Wrong flow"):new Promise(s=>{const r={wopiPendingInitializeTime:H()},a=!!(o&&o.parallelizeStartSessionRequest&&o.buildStartSessionRequestParams)&&o.parallelizeStartSessionRequest(i);let c=!1,d=!1,l=!1,h=!1,u=void 0,p=void 0,f=!1,m=!1;if(he()===ce.IE||o&&o.fallBackToSingleStepBootFlow&&o.fallBackToSingleStepBootFlow(i,t))return void function(){i.logger.ULS.nt(578074079,E.B,F.Info,"Waiting for WOPI info to start boot");const e=(e,s)=>{if(c)i.logger.ULS.nt(578074080,E.B,F.Warning,"completeCreateNew already called");else{if(c=!0,r.wopiPendingCompleteTime=H(),"failure"===s.state)return A(s.reason),i.state=U.Failed,void o({completion:"failure"});Qe(s.newFile),i.run(z.boot,{...t,wopi:s.wopi},n).then(e=>{o(e)})}};i.addActionHandler(z.completeCreateNew,e);const o=t=>{i.removeActionHandler(z.completeCreateNew,e),s(t)};n&&n.subscribe(()=>{o({completion:"cancelled"})})}();const w=(e,t)=>{c?i.logger.ULS.nt(587236372,E.B,F.Warning,"completeCreateNew already called"):(c=!0,r.wopiPendingCompleteTime=H(),"failure"!==t.state?(u=t.wopi,ze(u)?(i.wopi=u,i.logger.ULS.nt(587286030,E.B,F.Info,"WOPI info received. Access token: "+JSON.stringify({length:u.accessToken.length,expiry:u.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:a,wacFrameLoaded:d,wacCanAcceptStartSessionResponse:l})),!a||d&&!l?d&&b():v(),d&&i.container&&i.container.postMessage(q.Zn,void 0),Qe(t.newFile)):g("InvalidWopiInfo")):g(t.reason))},g=e=>{A(e),d&&i.container&&i.container.postMessage(q.qn,void 0)},v=()=>{i.logger.ULS.nt(587233056,E.B,F.Info,"Making parallelized StartSession request");const t=o.buildStartSessionRequestParams(i,e,u),n=Ke(i,t.appPageName,t.queryParamsOverrides),s="access_token="+encodeURIComponent(u.accessToken)+"&access_token_ttl="+encodeURIComponent(u.expiry.toString());r.startSessionStartTime=H(),function(e,t,i,o){const n=new XMLHttpRequest;n.onreadystatechange=()=>{if(n&&4===n.readyState){if(void 0===n.status||0===n.status)return;try{o&&o(n)}finally{null!=n&&(n.onreadystatechange=()=>{})}}},n.open("POST",e);for(const e in i)n.setRequestHeader(e,i[e]);n.send(t)}(n,s,{"Content-Type":"application/x-www-form-urlencoded"},S)},S=e=>{const t=H();r.startSessionCompleteTime=t,i.logger.ULS.nt(587233057,E.B,F.Info,`StartSession request completed. Status code: ${e.status}, time: ${t}`),p={RequestStatus:e.status,ResponseText:e.responseText},d&&l?_():i.logger.ULS.nt(587233058,E.B,F.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:d,wacCanAcceptStartSessionResponse:l,wopiInfoSent:f,startSessionResponseSent:m}))},I=(e,t)=>{r.readyMessageReceiveTime=H(),i.container&&i.container.postMessage(q.mn,void 0),d||(d=!0,l=t.CanAcceptStartSessionComplete,i.logger.ULS.nt(587321567,E.B,F.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:a,wacCanAcceptStartSessionResponse:l,startSessionResponseAvailable:!!p,wopiInfoAvailable:!!u})),c&&i.container&&i.container.postMessage(u?q.Zn:q.qn,void 0),a&&l?_():b(),Se(i.appInitDiagnostics,t.Diagnostics))},_=()=>{m||f||!p||(200===p.RequestStatus?(m=!0,r.completeMessageCreateTime=H(),C(q.In,{StartSessionResponse:p,Diagnostics:r},3)):b())},b=()=>{m||f||!u||(f=!0,r.completeMessageCreateTime=H(),o&&o.sendCreateNewWopiInfo?o.sendCreateNewWopiInfo(i):C(q._n,{WopiDetails:{WopiSrc:u.source,AccessToken:u.accessToken,AccessTokenTtl:u.expiry.toString()},Diagnostics:r},3))},C=(e,t,o)=>{const n=H();o<=0?i.logger.ULS.nt(587233165,E.B,F.Error,"Attempted to complete but no ack. Time: "+n):(i.logger.ULS.nt(587233166,E.B,F.Info,`Sending complete message. Retries left: ${o-1}, Time: ${n}`),r.completeMessageSendTime=n,i.container&&i.container.postMessage(e,t),window.setTimeout(T,1e3,e,t,o-1))},T=(e,t,o)=>{h||(i.logger.ULS.nt(587233167,E.B,F.Info,"Timeout session complete ack. Retries left: "+o),C(e,t,o))},P=(e,t)=>{h=!0},y=e=>{i.removeActionHandler(z.completeCreateNew,w),i.removeActionHandler(j._i,I),i.removeActionHandler(j.lo,P),s(e)};function A(e){i.logger.ULS.nt(596444188,E.B,F.Warning,"Fail with reason: "+(e?JSON.stringify(e):"N/A"))}i.addActionHandler(z.completeCreateNew,w),i.addActionHandler(j._i,I),i.addActionHandler(j.lo,P),n&&n.subscribe(()=>{y({completion:"cancelled"})}),i.skipWopiValidation=!0,i.skipFileNameCheck=!0,i.wopi=void 0,i.run(z.boot,t,n).then(e=>{i.skipWopiValidation=!1,i.wopi=u,y(e)})});function Qe(e){e&&(e.path&&history.replaceState({},"",e.path),e.title&&(document.title=e.title))}class Ye{get isCancelled(){return this.ta}get timeoutInMs(){return this.ia}get reason(){return this.oa}cancel(){this.na(!1)}subscribe(e){this.ta?e():this.sa.push(e)}constructor(e){this.ta=!1,this.oa="",this.sa=[],this.na=e=>{this.ta||(this.ta=!0,this.oa=e?"timeout":"cancelled",this.sa.map(e=>e()),this.sa=[])},this.ia=e,window.setTimeout(()=>this.na(!0),e)}}function et(e){return new Ye(e)}const tt=(e,t,i,o,n)=>e!==z.dispose?Promise.reject("Wrong flow"):new Promise(e=>{i.logger.ULS.nt(595714433,E.B,F.Important,"start disposing the application");const s=i.host.requireExplicitUnload,r={disposeStartTime:H(),forceAppUnload:s};i.state=U.Disposing;const a=()=>{i.state=U.Disposed,e({completion:"success"})},c=e=>{o&&o.disposeAppSpecificResources&&o.disposeAppSpecificResources(i,t),i.dispose(),r.disposeEndTime=H(),function(e,t,i){if(i){const e=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(e)&&(t.hostToAppPostMessageLatency=e-t.appUnloadStartTime);const o=Number(i.appMessageSent);!isNaN(o)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-o);const n=Number(i.appUnloadStart),s=Number(i.appUnloadEnd);if(isNaN(n)||isNaN(s)||(t.appUnloadLatency=s-n),i.serverTimings){const e=i.serverTimings;for(const i in e)t["st-"+i.toString()]=e[i]}}e.logger.ULS.nt(592524822,E.B,F.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,r,e),i.container?i.container.dispose(i.pendingReboot,s).then(a):a()};if(s){r.appUnloadStartTime=H();const e=(e,t)=>{r.appUnloadEndTime=H(),c(t)};i.addActionHandler(j.wo,e),(n||new Ye(5e3)).subscribe(()=>{i.state===U.Disposing&&(r.appUnloadTimedOut=!0,c())}),i.container&&i.container.postMessage(q.Qn,void 0)}else c()}),it=(e,t,i,o,n)=>e!==j.Li?Promise.reject("Wrong flow"):new Promise(e=>{if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(K.FrameTrust,t);else{const e=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.nt(592445957,E.B,F.Info,"Top frame is trusted: "+e),i.container&&i.container.postMessage(q.Li,{isTopFrameTrusted:e})}e({completion:"success"})}),ot=(e,t,i,o,n)=>e!==j.Ji?Promise.reject("Wrong flow"):new Promise(e=>{i.authTokenTrustValidator.isResourceTrustedForMessage(t).then(o=>{o?i.raiseEvent(K.GetAuthToken,t):(i.container.postMessage(q.Dn,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))},o=>{i.container.postMessage(q.Dn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:o})})}),nt=(e,t,i,o,n)=>e!==j.Ci?Promise.reject("Wrong flow"):new Promise(e=>{const n=t&&t.state?t.state:"Unknown";i.logger.ULS.nt(592839750,E.B,F.Info,`Boot state: [${n}]`),n!==i.appBootState&&(i.appBootState=n,i.bootHeartBeat&&i.bootHeartBeat.setTimeoutStage(n)),o&&o.beforeComplete&&o.beforeComplete(n),e({completion:"success"})}),st=(e,t,i,o,n)=>{if(e!==z.postWacToken)return Promise.reject("Wrong flow");const s=D();return i.logger.ULS.nt(507774685,E.B,F.Important,"postWacToken flow initiated"),new Promise(e=>{const o=(e,t)=>{i.logger.ULS.nt(507597017,E.B,F.Info,`postWacToken flow completed in ${D()-s} ms`),window.clearInterval(a),window.clearTimeout(c);const o={completion:"success"};t&&void 0!==t.TokenAlreadySet&&(o.data={TokenAlreadySet:t.TokenAlreadySet}),n(o)},n=t=>{i.removeActionHandler(j.cn,o),e(t)},r=()=>{var e;return null===(e=i.container)||void 0===e?void 0:e.postMessage(q.ds,t)};i.addActionHandler(j.cn,o),r();const a=window.setInterval(r,100),c=window.setTimeout(()=>{window.clearInterval(a),i.logger.ULS.nt(507844190,E.B,F.Warning,"postWacToken flow timed out after 60000 milliseconds"),n({completion:"timeout"})},6e4)})},rt=(e,t,i,o,n)=>e!==z.rename?Promise.reject("Wrong flow"):new Promise(e=>{const o=(e,i)=>{const o={completion:i.NewName===t.NewName?"success":"failure"};r(o)},s=(e,t)=>{r({completion:"failure"})},r=t=>{i.removeActionHandler(j.xi,o),i.removeActionHandler(j.Di,s),e(t)};i.addActionHandler(j.xi,o),i.addActionHandler(j.Di,s),(n||new Ye(5e3)).subscribe(()=>{r({completion:"cancelled"})}),i.container&&i.container.postMessage(q.Mn,t)}),at=(e,t,i,o,n)=>e!==j.ho?Promise.reject("Wrong flow"):new Promise(e=>{!function(e){const t=window.navigator;t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top&&(t.virtualKeyboard.overlaysContent=e)}(t.overlayContent),i.container&&i.container.postMessage(q.Kn,void 0),e({completion:"success"})}),ct=(e,t,i,o,n)=>e!==j.hn?Promise.reject("Wrong flow"):new Promise(e=>{const o=t.flightKey,n=t.flightValue;var s;i.logger.ULS.nt(507343134,E._e,F.Info,`setWacFlightValue ${o}: ${n}`),s=t,localStorage.setItem(s.flightKey,s.flightValue.toString()),e({completion:"success"})});var dt;!function(e){e[e.NotCreateNew=0]="NotCreateNew",e[e.UnifiedCreateNew=1]="UnifiedCreateNew",e[e.LegacyCreateNew=2]="LegacyCreateNew"}(dt||(dt={}));const lt="powerpoint.officeapps.live.com",ht="https://ffc-"+lt,ut="https://ppc-"+lt,pt="https://eurppc-"+lt,ft="https://usc-"+lt,mt="https://euc-"+lt,wt="https://cac-"+lt,gt="https://ukc-"+lt,vt="https://auc-"+lt,St="https://jpc-"+lt,It="https://inc-"+lt,_t="https://krc-"+lt,bt="https://frc-"+lt,Ct="https://sgc-"+lt,Tt="https://zac-"+lt,Pt="https://aec-"+lt,yt="https://gbc-"+lt,At="https://dec-"+lt,Ut="https://chc-"+lt,Et="https://noc-"+lt,Ft="https://brc-"+lt,Ot="https://sec-"+lt,Wt="https://qtc-"+lt,kt="https://plc-"+lt,Rt="https://"+lt,Nt="https://cnc-powerpoint.partner.officewebapps.cn",Mt="https://powerpoint.gov.online.office365.us",xt="https://powerpoint.dod.online.office365.us",Dt="https://powerpoint.wac.online.office.eaglex.ic.gov",Ht="https://powerpoint.wac.online.office.microsoft.scloud",Bt="https://devpr.officeapps.live-int.com",Lt="https://c4-powerpoint-15.cdn.office.net/pods/s/",Vt="https://c1-powerpoint-15.cdn.office.net/pods/s/",Jt=function(){const e={};return e[ht]=Gt(ht,"https://c5-powerpoint-15.cdn.office.net/pods/s/"),e[ut]=Gt(ut,Lt),e[pt]=Gt(pt,Lt),e[Rt]=Gt(Rt),e[ft]=Gt(ft),e[mt]=Gt(mt),e[wt]=Gt(wt),e[gt]=Gt(gt),e[vt]=Gt(vt),e[St]=Gt(St),e[It]=Gt(It),e[_t]=Gt(_t),e[bt]=Gt(bt),e[Ct]=Gt(Ct),e[Tt]=Gt(Tt),e[Pt]=Gt(Pt),e[At]=Gt(At),e[Ut]=Gt(Ut),e[Et]=Gt(Et),e[Ft]=Gt(Ft),e[Ot]=Gt(Ot),e[Wt]=Gt(Wt),e[kt]=Gt(kt),e["https://powerpoint.online.office.de"]=Gt("https://powerpoint.online.office.de","https://powerpoint.cdn.office.de/pods/s/"),e[Nt]=Gt(Nt,"https://cdn.partner.officewebapps.cn/pods/s/"),e[Mt]=Gt(Mt,"https://powerpoint.cdn.office365.us/pods/s/"),e[yt]=Gt(yt,"https://powerpoint.cdn.office365.us/pods/s/"),e[xt]=Gt(xt,"https://powerpoint.dod.cdn.office365.us/pods/s/"),e[Dt]=Gt(Dt,"https://powerpoint.cdn.wac.online.office.eaglex.ic.gov/pods/s/"),e[Ht]=Gt(Ht,"https://powerpoint.cdn.wac.online.office.microsoft.scloud/pods/s/"),e[Bt]=Gt(Bt,Bt+"/pods/s/"),e}(),$t={"https://ffc-powerpoint.officeapps.live.com":"ring1","https://ppc-powerpoint.officeapps.live.com":"ring2_2","https://eurppc-powerpoint.officeapps.live.com":"ring2_1","https://powerpoint.officeapps.live.com":"ring5_3","https://usc-powerpoint.officeapps.live.com":"ring5_3","https://euc-powerpoint.officeapps.live.com":"ring5_3","https://cac-powerpoint.officeapps.live.com":"ring5_2","https://ukc-powerpoint.officeapps.live.com":"ring5_2","https://auc-powerpoint.officeapps.live.com":"ring5_2","https://jpc-powerpoint.officeapps.live.com":"ring5_2","https://inc-powerpoint.officeapps.live.com":"ring5_2","https://krc-powerpoint.officeapps.live.com":"ring5_2","https://frc-powerpoint.officeapps.live.com":"ring5_2","https://sgc-powerpoint.officeapps.live.com":"ring5_2","https://zac-powerpoint.officeapps.live.com":"ring5_2","https://aec-powerpoint.officeapps.live.com":"ring5_2","https://dec-powerpoint.officeapps.live.com":"ring5_1","https://chc-powerpoint.officeapps.live.com":"ring5_1","https://noc-powerpoint.officeapps.live.com":"ring5_1","https://brc-powerpoint.officeapps.live.com":"ring5_1","https://sec-powerpoint.officeapps.live.com":"ring5_1","https://qtc-powerpoint.officeapps.live.com":"ring5_1","https://plc-powerpoint.officeapps.live.com":"ring5_0"};function Gt(e,t=Vt){return{PodsUrl:e+"/pods/",WacCdnStaticServer:t}}function zt(e){const t=e.substring(0,e.indexOf("/p/"));return Jt[t.toLowerCase()]}const jt=["wdPodsUrl","wdPopsUrl","wdNewPodsFrame","wdNewEnabled","wdfs","wdfsection","wdIncludeHostUrl","wdoverrides"];function qt(e,t,i){if(!t)return e;let o=e;const n=null==i,s=o.indexOf("?");if(-1===s)return n?e:o+"?"+t+"="+i;const r=o.substr(s+1),a=r.split("&"),c=t+"=";let d=!1;for(let e=0;e<a.length;e+=1)if(0===a[e].indexOf(c)){o=o.replace(a[e],n?"":c+i),d=!0;break}return d||n||(r.length>0&&(o+="&"),o+=c+i),o}function Kt(e,t){return!e||"wd"!==e.substring(0,2)||jt.indexOf(e)>=0?"":e+"="+t}function Zt(e){let t=e,i="";const o=window.location.search.substring(1).split("&");for(const e of o){const o=e.split("=");"wdoverrides"===o[0]&&(i=o[1]);const n=Kt(o[0],o[1]);n&&(t+="&"+n)}i=i||"";const n=[];for(const e of i.split(/,|%2C/)){const t=e.split(/:|%3A/);2===t.length&&"devicepixelratio"!==t[0].toLowerCase()&&n.push(t[0]+":"+t[1])}return n.push("devicepixelratio:"+ge()),n.push("RenderGifSlideShow:true"),t=qt(t,"wdoverrides",n.join(",")),t}function Xt(e){let t=_("wdPodsUrl");return t&&!T(t)&&(t=""),t||(t=e),"/"!==t.substr(t.length-1)&&(t+="/"),t}function Qt(e,t){const i=e.bootParams,o=e.file;if(!i.isNewFile){if(!o.getUrl)throw Error("Missing FileGetUrl");if(!o.name)throw Error("Missing FileName")}const n=e.preseededSession;n&&n.key&&("_._._."===n.key.slice(0,6)&&"-.-.-."===n.key.slice(-6)||(n.key="_._._."+n.key+"-.-.-."));const s=e.appContext;s.wopiInfoSent=!1,s.bootComplete=!1,s.bootFlowResolve=t,s.bootRecorded=!1;const r=Jt[e.appBaseUrl];e.appBasePath=r?r.PodsUrl:e.appBaseUrl+"/pods/";const a=e.wdParams;let c=a.wdpodsurl;c&&!T(c)&&(c=""),c||(c=e.appBasePath);const d=/\/$/;if(d.test(c)||(c+="/"),!c)throw Error("Invalid PODS URL");s.podsUrl=c;let l=a.wdpopsurl;if(l&&!T(l)&&(l=""),l||(l=c,l=l.substring(0,l.indexOf("/pods/"))),d.test(l)||(l+="/"),!l)throw Error("Invalid POPS URL");if(s.popsUrl=l,e.bootstrapperUrl){const t="/pods/s/";s.cdnBasePath=e.bootstrapperUrl.split(t)[0]+t}else s.cdnBasePath=r?r.WacCdnStaticServer:Vt;s.createNewScenario=function(e,t,i,o){let n=dt.NotCreateNew,s="NotCreateNew";t.isNewFile?i.size?(n=dt.LegacyCreateNew,s="CreateNewWithNonZeroByteFile"):(n=dt.UnifiedCreateNew,s="IsNewFile"):t.isFromHostTemplate?(n=dt.UnifiedCreateNew,s="CreateNewFromHostTemplate"):o&&o.getUrl&&(n=dt.UnifiedCreateNew,s="CreateNewFromTemplateSourceUrl");const r={CreateNewScenario:dt[n],reason:s};return e.ULS.nt(34932951,E.B,F.Info,JSON.stringify(r)),n}(e.logger,i,o,e.newFileTemplate),s.shouldUsePods=function(e,t,i,o,n,s,r){let a=!1,c=!1,d="";t?(a="false"!==t,c=!0,d="wdPodsEnabled is available"):i?e===dt.LegacyCreateNew?(a=!1,c=!1,d="Legacy Create New Scenario because non-zero file size"):o?(a=!1,c=!1,d="Embed View fallback to WAC"):(a=!0,c=!0,d="Supported Region"):(a=!1,c=!1,d="Wac region not currently supported by PODS",r.ULS.nt(589168768,E.B,F.Warning,d+": "+s)),n||e!==dt.NotCreateNew||(a=!1,c=!1,d+=" | FileGetUrl is empty");const l={ShouldUsePodsOrCached:a,ShouldUsePods:a,CanUsePods:c,ApplicationUrl:s,Reason:d,CreateNewScenario:dt[e]};return r.ULS.nt(561640788,E.B,F.Info,JSON.stringify(l)),a}(s.createNewScenario,a.wdpodsenabled,!!r,S(e.appUrl,"embed"),!!o.getUrl,P(e.appBaseUrl),e.logger);const h=e.hostInitDiagnostics;h&&h.userClickTime&&Pe(h.userClickTime,e.logger),function(e){const t=e.hostInitDiagnostics,i=e.bootParams,o=e.file,n=!!o.getUrl,s=!!e.customFontCatalogUrl,r=e.contentBundle,a={BootstrapperType:"TypeScript",JsApiVersion:"v2",Preview:!1,Scenario:"Unified App",ApplicationUrl:P(e.appBaseUrl),IsDeepLink:!!_("nav"),BootstrapperInstanceId:re(),IsMobileView:we(),ApplicationCustomSettings:{OnDemandServer:P(e.appBasePath),EnableWacFallback:!0},SessionInformation:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:i.dataLanguage,DocumentClickTime:t.userClickTime,CurrentTime:H(),UiHost:e.host.uiHostName,WdParams:e.wdParams},Diagnostics:{EntryPoint:t.entryPoint,FileHost:e.host.storageHostName,PodsRing:"",UnifiedUiHostDiagnostics:t.unifiedUiHostDiagnostics},WopiPrecheckInfo:{FileSize:o.size,FileGetUrlBool:n,CustomFontCatalogBool:s,FileGetUrlLength:n?o.getUrl.length:null,FileNameBool:!!o.name,ReadOnly:i.readOnly,IrmEnabled:i.irmEnabled,SupportsDecryptedContentDownload:i.supportsDecryptedContentDownload,ViewOnly:i.viewOnly,PreseededSessionKey:!!e.preseededSession&&!!e.preseededSession.key,FileExtension:X(o.name)||null,BundleInfo:r?{MajorVersion:r.majorVersion,URLBool:!!r.url}:{}},AppInfo:{AppVersionMajor:1,AppVersionMinor:R(),Environment:"wac",UserAgent:window.navigator.userAgent},AdditionalTelemetry:{PostMessageToken:e.sessionId}};e.logger.ULS.nt(22357763,E.B,F.Info,JSON.stringify(a,Q))}(e)}function Yt(e){return e.appBasePath}function ei(e){return e.appBasePath+"RemoteTelemetry.ashx"+((t=e.sessionId)?"?usid="+t:"");var t}function ti(e){return!e.appContext.shouldUsePods}function ii(e){const t=e.ownerDocument.createElement("div");t.id="highContrastDetectionDiv",t.ariaHidden="true";const i=e.ownerDocument.createElement("a");i.id="highContrastDetectionAnchor",i.setAttribute("href","#"),i.ariaHidden="true",t.appendChild(i),e.appendChild(t);const o=e.ownerDocument.createElement("style");o.innerHTML="\n  @media screen and (-ms-high-contrast:active)\n  {\n   div#highContrastDetectionDiv a#highContrastDetectionAnchor\n   {\n  \tbackground-image: none !important;\n   }\n  }\n\n  div#highContrastDetectionDiv\n  {\n   background-color: Window;\n   position: absolute;\n   top: 0px;\n   left: -99999px;\n   width: 1px;\n   height: 1px;\n   opacity: 0;\n   overflow: hidden;\n  }\n\n  div#highContrastDetectionDiv a#highContrastDetectionAnchor\n  {\n   background-image: url('data:image/png;base64,highcontrastdetectordefault');\n  }\n",e.ownerDocument.head.appendChild(o);const n=()=>{e.ownerDocument.head.removeChild(o),e.removeChild(t)},s=si(t),r=si(i);if(s&&r){if(-1===r.backgroundImage.toLowerCase().indexOf("highcontrastdetectordefault")){const e=function(e,t,i){const o=oi(e),n=oi(t),s=oi(i);if(o&&n&&s)return{foregroundTextColor:o,backgroundColor:n,linkColor:s}}(s.color.toLowerCase(),s.backgroundColor.toLowerCase(),r.color.toLowerCase());return n(),{isInHighContrastMode:!0,highContrastColors:e}}return n(),{isInHighContrastMode:!1}}n()}function oi(e){return new RegExp("#[0-9A-Fa-f]{6}").test(e)?e:"transparent"===e||"window"===e?"transparent":function(e){const t=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(t&&4===t.length){return function(e,t,i){return"#"+ni(Number(e),2)+ni(Number(t),2)+ni(Number(i),2)}(t[1],t[2],t[3])}}(e)}function ni(e,t){let i=e.toString(16);for(;i.length<t;)i="0"+i;return i.toLowerCase()}function si(e){if(e.ownerDocument&&e.ownerDocument.defaultView&&e.ownerDocument.defaultView.getComputedStyle)return e.ownerDocument.defaultView.getComputedStyle(e)}function ri(){const e=function(e){const t={width:e.width,height:e.height};let i=t.width<320;return i&&(t.height-=17),t.height<256&&(t.width-=17),!i&&t.width<320&&(i=!0,t.height-=17),t.width=Math.max(t.width,320),t.height=Math.max(t.height,256),t}({width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight-50});return(""+document.cookie).indexOf("WACRibbonMinimizedPPT=true")>=0&&(e.height-=ue()?108:94),e.height-=30,e.height-=23,e}function ai(e){return function(e){const t={width:e.width-20,height:e.height-20};return t.width<424?t.width=424:t.width>1696&&(t.width=1696),t.height<238.5?t.height=238.5:t.height>954&&(t.height=954),t}({height:e.height-32-1,width:e.width-238-1-17})}function ci(e){if(e.Diagnostics&&e.Diagnostics.entryPoint)return e.Diagnostics.entryPoint;if(!e.ApplicationUrl)return null;return I(e.ApplicationUrl,"wdOrigin")||null}function di(e,t,i){if(e)for(let o=0;o<e.length;o+=1){const n=e[o];if(n.name.indexOf(t)>=0)return n.name.toLowerCase()!==t.toLowerCase()&&i.ULS.nt(38147726,E.B,F.Info,"Found partial match for bootstrapper URL perf entry"),n}}function li(e,t){if(t)try{if(!e)return void t.ULS.nt(557454687,E.B,F.Info,"Missing BootstrapperUrl");if(!window.performance)return void t.ULS.nt(557454688,E.B,F.Info,"Performance API not found on browser");let i=void 0;if(window.performance.getEntriesByName&&(i=di(window.performance.getEntriesByName(e),e,t)),!i&&window.performance.getEntries&&(t.ULS.nt(557454689,E.B,F.Info,"Searching all entries for bootstrapper timing entry"),i=di(window.performance.getEntries(),e,t)),!i)return void t.ULS.nt(557454690,E.B,F.Info,"Unable to extract Bootstrapper perf info");const o={name:e,logReason:"UnifiedTSBoot",nameMatchesExpected:i.name===e,connectEnd:i.connectEnd,connectStart:i.connectStart,domainLookupEnd:i.domainLookupEnd,domainLookupStart:i.domainLookupStart,fetchStart:i.fetchStart,initiatorType:i.initiatorType,redirectEnd:i.redirectEnd,redirectStart:i.redirectStart,requestStart:i.requestStart,responseEnd:i.responseEnd,responseStart:i.responseStart,duration:i.duration,entryType:i.entryType,startTime:i.startTime,nextHopProtocol:i.nextHopProtocol,workerStart:i.workerStart,secureConnectionStart:i.secureConnectionStart,transferSize:i.transferSize,encodedBodySize:i.encodedBodySize,decodedBodySize:i.decodedBodySize};t.ULS.nt(34928845,E.B,F.Info,JSON.stringify(o))}catch(e){t.ULS.nt(557454691,E.ce,F.Warning,"Exception extracting Bootstrapper perf info: "+Y(e))}}function hi(e){return!e||e.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):e}function ui(e){const t=e.SessionInformation,i=e.Diagnostics;return{HostName:t.HostName,HostSessionId:t.HostSessionId,UiLocale:t.UiLocale,DataLocale:t.DataLocale,DocumentClickTime:i&&i.userClickTime?i.userClickTime:t.DocumentClickTime?t.DocumentClickTime.getTime():void 0,HostInitTime:t.HostInitTime,UiHost:pi(t.HostName),WdParams:t.WdParams}}function pi(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":return"teams";case"ParticipantApp":case"DragonGate":return e;default:return""}}function fi(e){if(!e)return"";switch(e){case"MSTeams":case"TeamsAndroid":case"TeamsiOS":case"OneDrive":case"ParticipantApp":case"DragonGate":return"SharePoint Online";default:return e}}function mi(e,t,i){if(!e)return;let o="Page lifecycle: "+t+" fired.";i&&(o+="Flushing ULS logger",e.ULS.flushOnClose()),e.ULS.nt(579384268,E.B,F.Warning,o)}function wi(e){return e.toLocaleLowerCase().indexOf("pod")>=0||e.toLocaleLowerCase().indexOf("pop")>=0}function gi(e){let t="";for(const i in e)wi(i)||(t+="&"+i+"="+e[i]);return t}function vi(e){var t;const i=e.wdParams,o=we(),n="true"===i.wdembedview||S(e.appUrl,"embed"),s=e.appContext;let r=o?"pptmobileapp.aspx":n?"pptembed.aspx":"ppt.aspx";const a={},c={};jt.forEach(e=>{p(a,e)});const d=["devicepixelratio:"+ge(),"RenderGifSlideShow:true"],l=i.wdoverrides;l&&l.split(/,|%2C/).forEach(e=>{const t=e.split(/:|%3A/);2===t.length&&"devicepixelratio"!==t[0].toLowerCase()&&d.push(t[0]+":"+t[1])}),u(a,"wdoverrides",d.join(",")),n&&(p(a,"corrid"),p(a,"usid")),ue()&&u(c,"touchdevice","1");const h=window.document.documentElement;h&&(void 0!==h.clientWidth&&u(c,"windowwidth",h.clientWidth.toString()),void 0!==h.clientHeight&&u(c,"windowheight",h.clientHeight.toString()));const m=_("previoussessionid");if(m&&u(c,"previoussessionid",m),null!==(t=e.st)&&void 0!==t&&t.getValue(J.kt,!1)){const t=window;if(t){const i=t._wopiContextJson;if(i){const t=i.PredictedOfficeAppEndPointHintForRealSession;if(e.logger.ULS.nt(506316256,E.B,F.Important,`PredictedOfficeAppEndPointHintForRealSession is ${t};\n            PredictedOfficeAppEndPoint is ${i.PredictedOfficeAppEndPoint};\n            PredictedOfficeAppEndPointAccessTime is ${i.PredictedOfficeAppEndPointAccessTime}`),t){const t=i.PredictedOfficeAppEndPoint;if(t)if(e.st.getValue(J.Dt,!1)){const o=i.PredictedOfficeAppEndPointAccessTime;if(o){const i=new Date(o),n=3e5;((new Date).getTime()-i.getTime()+n)/36e5<=e.st.getValue(J.xt,48)&&(u(a,"wdwaccluster",t),e.logger.ULS.nt(506316255,E.B,F.Important,"Added wdwaccluster to queryParamsOverrides: "+t))}else e.logger.ULS.nt(507299216,E.B,F.Important,"PredictedOfficeAppEndPointAccessTime is null")}else u(a,"wdwaccluster",t)}}}}Te()&&u(c,"lssupported","1");const w=e.host.capabilities;w&&(w.rebootDoc&&(u(c,"sdr",w.rebootDoc.toString()),p(a,"sdr")),w.createNewDoc&&(u(c,"scnd","1"),p(a,"scnd")),w.authToken&&(u(c,"sat","1"),p(a,"sat")),w.customAuthConfig&&(u(c,"cac","1"),p(a,"cac")),w.refreshAccessToken&&(u(c,"rat","1"),p(a,"rat")),w.atMentions&&(u(c,"sams","1"),p(a,"sams")),w.moveToFolder&&(u(c,"mtf","1"),p(a,"mtf")),w.noBrowserModalDialogs&&(u(c,"nbmd","1"),p(a,"nbmd")),w.commonFilePicker&&(u(c,"sfp","1"),p(a,"sfp")),w.directDownload&&(u(c,"sdd","1"),p(a,"sdd")),w.directPrint&&(u(c,"sdp","1"),p(a,"sdp")),w.disableOfficeAddins&&(u(c,"doa","1"),p(a,"doa")));const g=e.ui;(g.hideHeader||"DocGen"===g.contentAssemblyMode||"Templatization"===g.contentAssemblyMode||"ContentAssemblyEdit"===g.contentAssemblyMode||"ContentAssemblyView"===g.contentAssemblyMode)&&(u(c,"hhdr","1"),p(a,"hhdr")),g.hideFileLocationPicker&&(u(c,"hodflp","1"),p(a,"hodflp")),g.hideAppLauncherInHeader&&(u(c,"halh","1"),p(a,"halh")),g.hideChatInHeader&&(u(c,"hch","1"),p(a,"hch")),g.hideMeInHeader&&(u(c,"hmh","1"),p(a,"hmh")),g.hideSearchInHeader&&(u(c,"hsh","1"),p(a,"hsh")),g.hideWorkflowInHeader&&(u(c,"hwfh","1"),p(a,"hwfh")),g.hideSettingsInHeader&&(u(c,"hsth","1"),p(a,"hsth")),g.showAppIconInHeader&&(u(c,"sih","1"),p(a,"sih")),g.useNeutralColorInHeader&&(u(c,"unh","1"),p(a,"unh")),e.hostName&&u(c,"filesrc",e.hostName),e.user.id&&u(c,"userid",e.user.id),g.openLinksInNewWindow&&(u(c,"onw","1"),p(a,"onw")),g.useDarkTheme&&(u(c,"udt","1"),p(a,"udt"));const v=e.viewMode;v&&v.hideToolbar&&u(c,"hvt","1");const I=e.file;I.name&&(u(a,"filename",b(I.name)),p(c,"filename")),I.getUrl&&(u(c,"fileurl",I.getUrl),p(c,"filegeturl")),u(a,"filegeturlbool",I.getUrl?"true":"false"),I.size&&(u(a,"fs",I.size.toString()),p(c,"filesize"));const T=e.newFileTemplate;T&&T.size&&(u(a,"fs",T.size.toString()),p(c,"filesize"));const P=e.contentBundle;P&&P.url&&(u(c,"bundleurl",P.url),p(c,"bundlesrc"));const y=e.bootParams;y.irmEnabled&&u(c,"irmenabled",y.irmEnabled.toString()),y.supportsDecryptedContentDownload&&u(c,"supportsdecryptedcontentdownload",y.supportsDecryptedContentDownload.toString()),y.readOnly&&p(a,"readonly"),u(a,"ro",y.readOnly?y.readOnly.toString():"false"),y.viewOnly&&u(c,"viewonly",y.viewOnly.toString()),y.openViewByDefault&&u(c,"ovbd",y.openViewByDefault.toString());const A=e.preseededSession;A&&(A.key&&(n||u(c,"preseededsessionkey",A.key),p(a,"preseededsessionkey")),A.id&&p(a,"preseededwacsessionid"));const U=e.throttling;U&&(U.protection&&(u(c,"ctp",U.protection),p(a,"ctp")),U.request&&(u(c,"rct",U.request),p(a,"rct")));let O=_("nav");if(O||(O=e.actNavId?e.actNavId:f(e.appUrl,"actnavid")),O){try{const e=C(O),t=JSON.parse(e),i=t.sId;i&&(u(a,"wdslideid",i),u(a,"dc","1"));const o=t.commentId;o&&"null"!==o&&u(a,"wdcommentid",o);const n=t.openMode;n&&"null"!==n&&u(a,"wdopenmode",n)}catch{e.logger.ULS.nt(560329684,E.B,F.Error,"Failed to parse navigation id: "+O)}p(a,"actnavid")}if(s.shouldUsePods){e.appBasePath=s.podsUrl,p(a,"powerpointview"),u(a,"wdpodsurl",b(s.podsUrl)),u(a,"wdpopsurl",b(s.popsUrl)),u(a,"fastboot","true"),u(a,"noauth","1");const t=ri(),o=ai(t);u(a,"thpanel",t.height.toString()),u(a,"sw",o.width.toString()),u(a,"sh",o.height.toString());const n=i.wdfs;n&&u(a,"fslide",n);const r=i.wdfsection;r&&u(a,"fsection",r),(n||r||i.wdincludehosturl&&"false"!==i.wdincludehosturl)&&u(a,"frameurl",b(window.location.href));const d=_("automation");d&&u(a,"automation",d);const l=_("startrehearsal");if(l&&u(a,"startrehearsal",l),u(a,"postmessagetoken",e.sessionId),u(c,"postmessagetoken",e.sessionId),e.wdParams){const t=gi(e.wdParams);t&&u(c,"wdparams",t)}u(c,"jsapiversionminor",R().toString());const h=e.wopi;if(h&&h.source&&(u(c,"wopisrc",h.source),p(a,"wopisrc")),e.container){const t=ii(e.container.element);t&&t.isInHighContrastMode&&(u(c,"isinhighcontrastmode","true"),t.highContrastColors&&u(c,"clientcolorsettings",t.highContrastColors.foregroundTextColor+"_"+t.highContrastColors.backgroundColor+"_"+t.highContrastColors.linkColor))}}else{e.appBasePath||u(a,"nolog","True");const t=e.appUrl.substring(0,e.appUrl.indexOf("?")),i=t.lastIndexOf("/")+1;e.appBasePath=t.substring(0,i),r=t.substring(i);const o=e.wopi;if(o&&o.source){let e=o.source;e.toLowerCase().indexOf("powerpointframe.aspx")>=0&&(e=decodeURIComponent(f(e,"wopisrc"))),u(a,"wopisrc",b(e))}u(a,"wdenableroaming","1"),u(a,"wdo","1")}return{appPageName:r,queryParamsOverrides:a,postDataOverrides:c}}function Si(e){if(e.appContext.shouldUsePods){const t=(i,o)=>{Ii(e),e.removeActionHandler(j._i,t)};e.addActionHandler(j._i,t);const i=(t,i)=>{t===j.vo&&function(e,t){const i=t;if(i&&"number"==typeof i.Tag&&"number"==typeof i.Category&&"number"==typeof i.Level&&"string"==typeof i.Message)try{e.logger.ULS.nt(i.Tag,i.Category,i.Level,i.Message)}catch(t){e.logger.ULS.nt(512235072,E.B,F.Error,"ulsLog exception: "+t)}}(e,i)};e.addActionHandler(j.vo,i)}li(e.bootstrapperUrl,e.logger),window.setTimeout(()=>{e.logger.ULS.flush()},1e4)}function Ii(e){var t,i;const o=e.appContext;if(o.wopiInfoSent||!e.wopi)return;o.wopiInfoSent=!0;let n="";e.wdParams&&(n=Object.keys(e.wdParams).filter(e=>!/po[d/p]/i.test(e)).reduce((t,i)=>`${t}&${i}=${e.wdParams[i]}`,""));const s=e.bootParams,r=e.wopi,a=e.hostInitDiagnostics,c={WopiSrc:r.source,AccessToken:r.accessToken,AccessTokenTTL:r.expiry,ReadOnly:s.readOnly,IrmEnabled:s.irmEnabled,SupportsDecryptedContentDownload:s.supportsDecryptedContentDownload,FileName:e.file.name,SessionContext:e.sessionContext,WdParams:n,DocumentURL:window.location.href,PreviousSessionID:_("PreviousSessionID"),FirstPageFlushTime:null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:a.hostPageFirstFlushTime,BootJsStartTime:window.WOPIPerf_BootJsStartTime,BootJsEndTime:window.WOPIPerf_BootJsEndTime,InitializeWacTime:window.WOPIPerf_InitializeWac,UserClickTime:null!==(i=window.WOPIPerf_UserClick)&&void 0!==i?i:a.userClickTime,UnifiedUiHostDiagnostics:a.unifiedUiHostDiagnostics,ClientDiagnostics:e.clientDiagnostics};if(r.wacToken&&(c.WacToken=r.wacToken),e.hostSessionId){const t=e.hostSessionId.indexOf(".");c.HostSessionId=t>0?e.hostSessionId.substring(0,t):e.hostSessionId}if(a.legacyPerformanceData){const e=a.legacyPerformanceData.host;e&&(void 0!==e.timing.navigationStart&&(c.NavigationStart=e.timing.navigationStart),void 0!==e.timing.fetchStart&&(c.FetchStart=e.timing.fetchStart),void 0!==e.timing.requestStart&&(c.RequestStart=e.timing.requestStart),void 0!==e.timing.responseStart&&(c.ResponseStart=e.timing.responseStart),void 0!==e.timing.responseEnd&&(c.ResponseEnd=e.timing.responseEnd),void 0!==e.navigation.type&&(c.NavigationType=e.navigation.type),void 0!==e.navigation.redirectCount&&(c.NavigationRedirects=e.navigation.redirectCount))}else if(window.performance){const e=window.performance.timing;e&&(c.NavigationStart=e.navigationStart,c.FetchStart=e.fetchStart,c.RequestStart=e.requestStart,c.ResponseStart=e.responseStart,c.ResponseEnd=e.responseEnd);const t=window.performance.navigation;t&&(c.NavigationType=t.type,c.NavigationRedirects=t.redirectCount)}e.container.postMessage(q._n,c),e.logger.ULS.nt(505971357,E.B,F.Info,"Successfully sent post message: WopiPendingSession_CompleteWithWopiInfo")}var _i;!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(_i||(_i={}));function bi(e,t){const i=document.createElement("input");return i.type="hidden",i.name=e,i.value=t,i}class Ci{GetApplicationType(){return"PowerPoint"}GetVersion(){return k()}GetSessionId(){return this.ra}RegisterEventHandler(){}RemoveEventHandler(){}RegisterErrorHandler(){}RemoveErrorHandler(){}PostCommand(){}Dispose(){}constructor(e){this.ra=e}}function Ti(e,t){var i;if(!e.IsFileNew){if(!e.WopiPrecheckInfo.FileGetUrl)throw Error("Missing FileGetUrl from contentParams");if(!e.WopiPrecheckInfo.FileName)throw Error("Null or Empty Filename")}const o=Xt(e.OnDemandServer);if(!o)throw Error("Invalid Pods URL");const n=function(e){let t=_("wdPopsUrl");return t&&!T(t)&&(t=""),t||(t=Xt(e),t=t.substr(0,t.indexOf("/pods/"))),"/"!==t.substr(t.length-1)&&(t+="/"),t}(e.OnDemandServer);if(!n)throw Error("Invalid Pops URL");const s=ri(),r=ai(s),a="true"===_("wdEmbedView")||S(e.ApplicationUrl,"embed");let c=a?"pptembed.aspx":"ppt.aspx";const d=we();t.ULS.nt(51380293,E.B,F.Info,"IsRequestForMobileView:"+d),c=d?"pptmobileapp.aspx":c;let l=o+c+"?wdPodsUrl="+b(o)+"&wdPopsUrl="+b(n)+"&fastBoot=true&sw="+r.width+"&sh="+r.height+"&thPanel="+s.height+"&ro="+e.WopiPrecheckInfo.ReadOnly+"&sftc=1&NoAuth=1&jsApi=1&jsapiver=v1";e.WopiPrecheckInfo.FileName&&(l+="&fileName="+b(e.WopiPrecheckInfo.FileName)),"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||(l+="&readonly=1");const h=_("wdfs");h&&(l+="&fslide="+h);const u=_("wdfsection");if(u&&(l+="&fsection="+u),null!==(i=e.SettingsManager)&&void 0!==i&&i.getValue(J.kt,!1)){const i=window;if(i){const o=i._wopiContextJson;if(o){const i=o.PredictedOfficeAppEndPointHintForRealSession;if(t.ULS.nt(506316259,E.B,F.Important,`PredictedOfficeAppEndPointHintForRealSession is ${i};\n              PredictedOfficeAppEndPoint is ${o.PredictedOfficeAppEndPoint};\n              PredictedOfficeAppEndPointAccessTime is ${o.PredictedOfficeAppEndPointAccessTime}`),i){const i=o.PredictedOfficeAppEndPoint;if(i)if(e.SettingsManager.getValue(J.Dt,!1)){const n=o.PredictedOfficeAppEndPointAccessTime;if(n){const o=new Date(n),s=3e5;((new Date).getTime()-o.getTime()+s)/36e5<=e.SettingsManager.getValue(J.xt,48)&&(l+="&wdwaccluster="+i,t.ULS.nt(506316258,E.B,F.Important,"Added wdwaccluster to frameUrl: "+i))}}else l+="&wdwaccluster="+i,t.ULS.nt(506316257,E.B,F.Important,"Added wdwaccluster to frameUrl: "+i)}}}}const p=_("wdIncludeHostUrl");(h||u||p&&"false"!==p)&&(l=qt(l,"frameURL",b(window.location.href))),l=Zt(l),l=function(e,t){let i=e;const o=function(e){return e.SessionInformation.UiLocale?e.SessionInformation.UiLocale:I(e.ApplicationUrl,"ui")}(t);o&&(i=qt(i,"ui",o));const n=function(e){return e.SessionInformation.DataLocale?e.SessionInformation.DataLocale:I(e.ApplicationUrl,"rs")}(t);n&&(i=qt(i,"rs",n));const s=f(t.ApplicationUrl,"mscc");s&&(i=qt(i,"mscc",s));const r=f(t.ApplicationUrl,"wdFR");r&&(i=qt(i,"wdFR",r));const a=ci(t);a&&(i=qt(i,"wdOrigin",b(a)));const c=hi(t.PostMessageToken);return t.PostMessageToken&&(i+="&postMessageToken="+c),(t.SessionInformation.DisableChat||t.ApplicationUrl.toLowerCase().indexOf("dchat=1")>-1)&&(i=qt(i,"dchat","1")),i=function(e,t){const i=t.indexOf("?");if(-1===i)return e;const o=t.substring(i+1).split("&");let n=e;for(const t of o){const i=t.split("=");if(""===f(e,i[0])){const e=Kt(i[0],i[1]);e&&(n+="&"+e)}}return n}(i,t.ApplicationUrl),i}(l,e),e.IsFileNew&&(l+="&new=1"),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileSize?l+="&fs="+e.NewFileTemplateSource.FileSize:e.WopiPrecheckInfo.FileSize&&(l+="&fs="+e.WopiPrecheckInfo.FileSize);const m=!(w=e.SessionInformation.HostSessionId)||w.toLowerCase().indexOf("#")>-1?Math.random().toString(36).substring(2,25):w;var w;e.SessionInformation.HostSessionId&&(l+="&hid="+m);const g=_("Automation");g&&(l+="&Automation="+g);const v=_("StartRehearsal");v&&(l+="&StartRehearsal="+v),a||(l+="&usid="+e.SessionId),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&(l+="&uiEmbed=1"),e.SessionInformation.SupportsAccessibilityLoop&&(l+="&accloop=1"),e.SessionInformation.IsSynthetic&&(l+="syn=1");const P=I(e.ApplicationUrl,"uih");P&&(l+="&uih="+P),e.SessionInformation.UiHostIntegrationType&&(l+="&uihit="+b(e.SessionInformation.UiHostIntegrationType)),"Microsoft Teams"===e.SessionInformation.HostName&&(t.ULS.nt(507121920,E.B,F.Important,"PowerPoint setting Force View only for Teams WXP Files session."),l+="&fvo=1"),e.SessionInformation.MetaUiHostVersion&&(l+="&muv="+b(e.SessionInformation.MetaUiHostVersion)),e.SessionInformation.HighContrastMode&&(l+="&hcm="+b(e.SessionInformation.HighContrastMode));let y=_("nav");if(y||(y=f(e.ApplicationUrl,"actNavId")),y)try{const e=C(y),t=JSON.parse(e),i=t.sId;i&&(l=qt(l,"wdSlideId",i),l=qt(l,"DC","1"));const o=t.commentId;o&&"null"!==o&&(l=qt(l,"wdCommentId",o));const n=t.openMode;n&&"null"!==n&&(l=qt(l,"wdOpenMode",n))}catch{t.ULS.nt(38580688,E.B,F.Error,"Failed to parse navigation ID: "+y)}const A=e.Container;if(A){const i=document.createElement("iframe");i.id="WebApplicationFrame",i.name="wac_frame",i.title="Office Online Frame",i.frameBorder="0",i.style.top="0",i.style.bottom="0",i.style.left="0",i.style.right="0",i.style.height="100%",i.style.width="100%",i.style.minHeight="200px",i.style.minWidth="300px",i.style.position="absolute",i.setAttribute("allowfullscreen","true"),i.setAttribute("allowTransparency","true");let n="";if(he()===ce.Safari)n+="autoplay;",n+="microphone;",n+="camera;",n+="clipboard-read;",n+="clipboard-write;",n+="display-capture;";else{const t=o+" "+function(e,t){if(t){const e="/pods/s/";return t.split(e)[0]+e}if(e){const t=zt(e);if(t)return t.WacCdnStaticServer;throw Error("Application url provided but region not in region allow list")}return Vt}(e.ApplicationUrl,e.BootstrapperUrl)+";";n+="autoplay "+t,n+="microphone "+t,n+="camera "+t,n+="clipboard-read "+t,n+="clipboard-write "+t,n+="display-capture "+t}i.setAttribute("allow",n),A.style.top="0",A.style.bottom="0",A.style.left="0",A.style.right="0",A.style.height="100%",A.style.width="100%",A.style.minHeight="200px",A.style.minWidth="300px",A.appendChild(i);const s=Date.now(),r=e.WopiPrecheckInfo.FileGetUrl;t.ULS.nt(38580689,E.B,F.Info,r?r.toString().length.toString():"null"),l+="&fileGetUrlBool="+!!r;const c=document.createElement("form");if(c.name="frameForm",c.id="frameForm",c.target="wac_frame",c.action=l,c.method="post",A.appendChild(c),e.WopiInfo){const t=e.WopiInfo.WopiSrc;t&&c.appendChild(bi("WOPISrc",t));const i=e.WopiInfo.AccessToken;i&&c.appendChild(bi("access_token",b(i)));const o=e.WopiInfo.AccessTokenExpiry;o&&c.appendChild(bi("access_token_ttl",o.getTime().toString()));const n=e.WopiInfo.WacToken;n&&c.appendChild(bi("wac_token",b(n)))}const d=e.SessionInformation.SessionContext;if(d&&c.appendChild(bi("sc",d)),e.SessionInformation.WdParams){const t=gi(e.SessionInformation.WdParams);t&&c.appendChild(bi("wdparams",t))}c.appendChild(bi("jsapiversionminor",R().toString())),e.SessionInformation.HideViewerToolbar&&c.appendChild(bi("hvt","1")),r&&c.appendChild(bi("fileUrl",r));const h=e.WopiPrecheckInfo.CustomFontCatalogUrl;h&&c.appendChild(bi("customFontCatalogUrl",h)),e.NewFileTemplateSource&&e.NewFileTemplateSource.FileGetUrl&&c.appendChild(bi("templateUrl",e.NewFileTemplateSource.FileGetUrl)),e.SessionInformation.UserId&&(c.appendChild(bi("UserID",e.SessionInformation.UserId)),c.appendChild(bi("user_id",e.SessionInformation.UserId))),e.WopiPrecheckInfo.IrmEnabled&&c.appendChild(bi("irmEnabled",e.WopiPrecheckInfo.IrmEnabled.toString())),e.WopiPrecheckInfo.SupportsDecryptedContentDownload&&c.appendChild(bi("SupportsDecryptedContentDownload",e.WopiPrecheckInfo.SupportsDecryptedContentDownload.toString())),e.WopiPrecheckInfo.ViewOnly&&c.appendChild(bi("ViewOnly",e.WopiPrecheckInfo.ViewOnly.toString())),e.NewFileTemplateSource&&e.NewFileTemplateSource.ETag?c.appendChild(bi("ETag",e.NewFileTemplateSource.ETag)):e.WopiPrecheckInfo.ETag&&c.appendChild(bi("ETag",e.WopiPrecheckInfo.ETag)),e.WopiPrecheckInfo.CTag&&c.appendChild(bi("RevID",e.WopiPrecheckInfo.CTag)),e.NewFileTemplateSource&&e.NewFileTemplateSource.DocUniqueId?c.appendChild(bi("DocID",e.NewFileTemplateSource.DocUniqueId)):e.WopiPrecheckInfo.DocUniqueId&&c.appendChild(bi("DocID",e.WopiPrecheckInfo.DocUniqueId)),e.WopiPrecheckInfo.BundleInfo&&e.WopiPrecheckInfo.BundleInfo.Url&&c.appendChild(bi("bundleUrl",e.WopiPrecheckInfo.BundleInfo.Url)),e.WopiPrecheckInfo.PreseededSessionKey&&!a&&c.appendChild(bi("PreseededSessionKey",e.WopiPrecheckInfo.PreseededSessionKey)),e.SessionInformation.HostName&&c.appendChild(bi("fileSrc",e.SessionInformation.HostName)),e.ApplicationCustomSettings&&e.ApplicationCustomSettings.HostUIControls&&c.appendChild(bi("huictrls",JSON.stringify(e.ApplicationCustomSettings.HostUIControls))),c.appendChild(bi("feature_status",te(e.FeatureManager,{wdFlights:_("wdFlights")}))),ue()&&c.appendChild(bi("touchDevice","1")),window.document.documentElement&&(void 0!==window.document.documentElement.clientWidth&&c.appendChild(bi("windowWidth",window.document.documentElement.clientWidth.toString())),void 0!==window.document.documentElement.clientHeight&&c.appendChild(bi("windowHeight",window.document.documentElement.clientHeight.toString())));const u=_("PreviousSessionID");if(u&&c.appendChild(bi("PreviousSessionID",u)),Te()&&c.appendChild(bi("LSSupported","1")),c.appendChild(bi("postMessageToken",e.PostMessageToken)),(e.SessionInformation.HideHeader||"teams"===P&&"UnifiedUiHostTeams"!==e.SessionInformation.UiHostIntegrationType&&"TeamsModern"!==e.SessionInformation.UiHostIntegrationType||"owa"===P||"DocGen"===e.SessionInformation.ContentAssemblyMode||"Templatization"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.SessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.SessionInformation.ContentAssemblyMode)&&c.appendChild(bi("hhdr","1")),e.SessionInformation.HideAppLauncherInHeader&&c.appendChild(bi("halh","1")),e.SessionInformation.HideSearchInHeader&&c.appendChild(bi("hsh","1")),e.SessionInformation.HideMeInHeader&&c.appendChild(bi("hmh","1")),e.SessionInformation.HideChatInHeader&&c.appendChild(bi("hch","1")),e.SessionInformation.HideWorkflowInHeader&&c.appendChild(bi("hwfh","1")),e.SessionInformation.HideSettingsInHeader&&c.appendChild(bi("hsth","1")),e.SessionInformation.ShowAppIconInHeader&&c.appendChild(bi("sih","1")),e.SessionInformation.UseNeutralColorInHeader&&c.appendChild(bi("unh","1")),e.SessionInformation.SupportsAuthToken&&c.appendChild(bi("sat","1")),window.docAspxMsalEnabled&&(e.SessionInformation.AuthTokenStrategy="PairwiseBroker"),e.SessionInformation.AuthTokenStrategy&&c.appendChild(bi("ats",e.SessionInformation.AuthTokenStrategy)),e.SessionInformation.SupportsCustomAuthConfig&&c.appendChild(bi("cac","1")),e.SessionInformation.SupportsCreateNewDocument&&c.appendChild(bi("scnd","1")),e.SessionInformation.UseDarkTheme&&c.appendChild(bi("udt","1")),e.SessionInformation.SupportsDirectPrint&&c.appendChild(bi("sdp","1")),e.SessionInformation.DisableOfficeAddins&&c.appendChild(bi("doa","1")),e.SessionInformation.SupportsDirectDownload&&c.appendChild(bi("sdd","1")),"Templatization"!==e.SessionInformation.ContentAssemblyMode&&"DocGen"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.SessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.SessionInformation.ContentAssemblyMode||c.appendChild(bi("caae","1")),e.SessionInformation.ContentAssemblyMode&&c.appendChild(bi("caaemode",e.SessionInformation.ContentAssemblyMode)),e.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&e.SessionInformation.SupportsDocReboot&&c.appendChild(bi("sdr",!0===e.SessionInformation.SupportsDocReboot?"1":e.SessionInformation.SupportsDocReboot.toString())),e.SessionInformation.HideWACOneDriveFileLocationPicker&&c.appendChild(bi("hodflp","1")),e.SessionInformation.SupportsAtMentions&&c.appendChild(bi("sams","1")),e.WopiPrecheckInfo.RequestedCallThrottling){const t=e.WopiPrecheckInfo.RequestedCallThrottling;c.appendChild(bi("rct",t))}if(e.WopiPrecheckInfo.ClientThrottlingProtection){const t=e.WopiPrecheckInfo.ClientThrottlingProtection;c.appendChild(bi("ctp",t))}e.WopiPrecheckInfo.OpenViewByDefault&&c.appendChild(bi("ovbd",e.WopiPrecheckInfo.OpenViewByDefault.toString())),e.SessionInformation.SupportsMoveToFolder&&c.appendChild(bi("mtf","1")),e.SessionInformation.NoBrowserModalDialogs&&c.appendChild(bi("nbmd","1")),e.SessionInformation.SupportsCommonFilePicker&&c.appendChild(bi("sfp","1")),e.SessionInformation.OpenLinksInNewWindow&&c.appendChild(bi("onw","1"));const p=ii(A);p&&p.isInHighContrastMode&&(c.appendChild(bi("IsInHighContrastMode","true")),p.highContrastColors&&c.appendChild(bi("ClientColorSettings",p.highContrastColors.foregroundTextColor+"_"+p.highContrastColors.backgroundColor+"_"+p.highContrastColors.linkColor)));const f=e.SessionInformation.OwlVersion;f&&c.appendChild(bi("owlver",f));const m=e.SessionInformation.OwlRollout;m&&c.appendChild(bi("owlro",m));const w=e.SessionInformation.SupportsInPlaceCreateNew;return w&&c.appendChild(bi("sipcn",w.toString())),e.SessionInformation.DisableEmbedViewCodeSnippet&&c.appendChild(bi("devcs","1")),e.SessionInformation.DisableCoEditInTeams&&c.appendChild(bi("dceit","1")),c.appendChild(bi("jsapibuild",k())),c.submit(),{IFrameElement:i,FrameCreateTime:s}}}function Pi(e){const t=e.appContext;let i="";if(he()===ce.Safari)i+="autoplay;microphone;camera;clipboard-read;clipboard-write;display-capture;";else{const e=t.podsUrl+" "+t.cdnBasePath+";";i+="autoplay "+e,i+="microphone "+e,i+="camera "+e,i+="clipboard-read "+e,i+="clipboard-write "+e,i+="display-capture "+e}return{permissionsPolicy:i,minHeight:t.shouldUsePods?"200px":"150px",minWidth:"300px",useAdditionalDiv:!t.shouldUsePods}}var yi;!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(yi||(yi={}));class Ai{}Ai.logger=Z();class Ui extends class{constructor(e){this.aa={},this.resetCache=()=>{if(!this.ca)return!1;try{return localStorage.removeItem(this.dataSettingsCacheKey),!0}catch(e){return Ai.logger.ULS.nt(557114832,E.B,F.Error,`${this.dataSettingsCacheKey}: Failure trying to Delete data in localStorage: ${Y(e)}`),!1}},this.setCache=e=>{if(e&&this.ca)try{localStorage.setItem(this.dataSettingsCacheKey,JSON.stringify(e))}catch(e){Ai.logger.ULS.nt(557114833,E.B,F.Error,`${this.dataSettingsCacheKey}: Error while saving settings in cache: ${Y(e)}`)}},this.getIntegerSetting=e=>{const t=this.da(e);if(null!=t&&"number"==typeof t){const e=t;if(!isNaN(e))return e}return null},this.getBooleanSetting=e=>{const t=this.da(e);return null!=t&&"boolean"==typeof t?t:null},this.getStringSetting=e=>{const t=this.da(e);return null!=t&&"string"==typeof t?t:null},this.da=e=>{if(!this.ca)return null;try{if(e in this.aa)return this.aa[e];const t=localStorage.getItem(this.dataSettingsCacheKey);if(null!==t){const i=JSON.parse(t)[e];return this.aa[e]=i,i}}catch(t){Ai.logger.ULS.nt(557114834,E.B,F.Error,`${this.dataSettingsCacheKey}: Failure trying to find ${e} setting in localStorage: ${Y(t)}`)}return null},this.dataSettingsCacheKey=e,this.ca=!1;try{localStorage&&(this.ca=!0)}catch(e){Ai.logger.ULS.nt(538018719,E.B,F.Warning,"Local storage not supported: "+Y(e))}}}{static get Instance(){return Ui.la||(Ui.la=new Ui)}constructor(){super(Ui.ha)}}function Ei(e,t){return function(e,t){return e+"RemoteTelemetry.ashx"+(t?"?usid="+t:"")}(function(e){const t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}(e),t)}Ui.ha="OneNote_hostUtilsSettingsCache";const Fi={errorType:yi.AppInitError,errorObject:"Timed out waiting for FnOnInitializeSuccess",Category:0,Code:5,ErrorName:"TimeoutInitialize",EventType:13,ExtraInfo:"Initialization timeout"};class Oi{constructor(e,t){if(this.ua=0,this.pa=0,this.fa=0,this.ma=0,this.wa=!1,this.ga=(e,t)=>{this.ua=H();let i=6e5;const o=_("wdOnSuccessTimeout");o&&parseInt(o,10).toString()===o&&(i=parseInt(o,10),t.ULS.nt(527521921,E.B,F.Warning,"App Timeout is overridden with url override param wdOnSuccessTimeout: "+i)),i&&window.setTimeout(()=>this.va(e,t),i)},this.Sa=(e,t,i,o)=>{const n={Message:`Received ${e} callback after timeout had elapsed`,timeoutTimeMs:this.ma,successTimeMs:this.pa,startTimeMs:this.ua,appInitDiagnostics:i,error:o};t&&t.ULS.nt(38589660,E.B,F.Info,JSON.stringify(n))},this.va=(e,t)=>{if(!(this.fa||this.pa||this.ma)){this.ma=H();try{if(Ve(e.Container)){if(t){const i=`Timed out waiting for FnOnInitializeSuccess to be called. startMs:${this.ua}, timeoutMs:${this.ma}, scenario:Unified, hostSessionId:${e.SessionInformation.HostSessionId}, host: ${e.SessionInformation.HostName}`;t.ULS.nt(38589661,E.B,F.Error,i),Wi(e,5,"TimeoutInitialize",i,t,this.ma,!0)}e.FnOnInitializeFailure&&e.FnOnInitializeFailure(Fi)}else t&&(t.ULS.nt(579604899,E.B,F.Warning,"App container is unloaded. Scenario: Unified"),Wi(e,7,"AppContainerUnloadedTimeout","App container is unloaded",t,this.ma,!1))}catch(e){t&&t.ULS.nt(579604898,E.B,F.Error,"timeoutIfSuccessNotCalled exception: "+Y(e))}}},e.FnOnInitializeSuccess){const i=e.FnOnInitializeSuccess;e.FnOnInitializeSuccess=(o,n)=>{this.pa=H(),this.wa||(this.wa=!0,this.ma?this.Sa("success",t,n):(t&&(t.ULS.nt(38836226,E.B,F.Info,"TimeoutWrapper: Calling fnOnInitializeSuccess"),Wi(e,void 0,void 0,void 0,t,H(),!1,n)),i(o,n)))}}if(e.FnOnInitializeFailure){const i=e.FnOnInitializeFailure;e.FnOnInitializeFailure=(o,n)=>{this.fa=H(),this.wa||(this.wa=!0,this.ma&&o!==Fi?this.Sa("failure",t,n,o):(t&&(Wi(e,o.Code,o.ErrorName,o.errorObject,t,H(),!1,n),t.ULS.nt(38836227,E.B,F.Info,"TimeoutWrapper: Calling fnOnInitializeFailure")),i(o,n)))}}this.ga(e,t)}}function Wi(e,t,i,o,n,s,r,a){const c=null==t&&null==i&&null==o&&!r,d=e.SessionInformation,l=e.WopiPrecheckInfo,h=l.BundleInfo;let u=0;null!=d.DocumentClickTime&&d.DocumentClickTime.getTime&&(u=d.DocumentClickTime.getTime());const p={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:l.FileSize,ApiStartTime:0,HostInitTime:d.HostInitTime,AppVersion:"1."+R(),UseBabylon:"",EntryPoint:ci(e),SessionId:e.SessionId,UserAgent:window.navigator.userAgent,WACRegion:P(e.ApplicationUrl),FileHost:fi(d.HostName),Host:d.HostName,PodsRing:"",UiHost:pi(d.HostName)},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:u,BootSuccess:c,BootTime:s,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:o},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!l.FileGetUrl,FileNameBool:!!l.FileName,ReadOnly:l.ReadOnly,SupportsDecryptedContentDownload:l.SupportsDecryptedContentDownload,ViewOnly:l.ViewOnly,PreseededSessionKey:l.PreseededSessionKey,BundleInfo:h?{MajorVersion:h.MajorVersion,URLBool:!!h.Url}:""},AppBootTimings:a?a.appBootTimingDict:""};n.ULS.nt(r?592007955:587843200,E.B,r?F.Error:F.Info,JSON.stringify(p)),x(Ei(e.ApplicationUrl,e.SessionId),"PowerPoint",c?"bootSuccess":"bootFailure")}function ki(e){let t=6e5;const i=e.wdParams.wdonsuccesstimeout;return i&&parseInt(i,10).toString()===i&&(t=parseInt(i,10)),t}function Ri(e){e.appContext.bootComplete=!0,Ni(e),e.logger.ULS.nt(34932955,E.B,F.Warning,JSON.stringify(e.diagnostics)),Mi(e)}function Ni(e){if(!e.appContext.shouldUsePods)return;const t=e.appInitDiagnostics;t.officeFrameServerDocumentFlushTime=t.documentFlushTime,t.officeFrameServerFirstFlushTime=t.serverFirstFlushTime,t.officeFrameServerStartTime=t.serverStartTime,t.officeServerDocumentProcessStartTime=t.bootStartMs,t.officeServerDocumentProcessEndTime=t.bootEndMs,t.fileRequestsData=[{browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest",correlationId:t.downloadCorrelation,startTime:t.downloadStartMs,endTime:t.downloadEndMs,size:t.downloadSize,incremental:t.incDownload}],delete t.documentFlushTime,delete t.serverFirstFlushTime,delete t.serverStartTime,delete t.bootStartMs,delete t.bootEndMs,delete t.downloadCorrelation,delete t.downloadStartMs,delete t.downloadEndMs,delete t.downloadSize,delete t.incDownload}function Mi(e,t,i,o){const n=e.appContext;if(n.bootRecorded)return;n.bootRecorded=!0;const s=void 0!==t||void 0!==i||void 0!==o,r=!!e.timeoutTime,a=!!e.failureTime,c=!(!e.successTime||r||a||s),d=c?e.successTime:a?e.failureTime:e.timeoutTime,l=e.file,h=e.hostInitDiagnostics,u=e.bootParams,p=e.contentBundle,f=e.preseededSession,m=e.appInitDiagnostics,w={AppMetadata:{BrowserTechnology:"",Browser:"",FileSizeHint:l.size,ApiStartTime:0,HostInitTime:h.hostInitializeCallTime,AppVersion:"1."+R(),UseBabylon:"",EntryPoint:h.entryPoint,SessionId:e.sessionId,UserAgent:window.navigator.userAgent,WACRegion:P(e.appBasePath),FileHost:e.host.storageHostName,Host:e.hostName,PodsRing:"",UiHost:e.host.uiHostName},BootInfo:{PreloadCompleteTime:0,DocumentClickTime:h.userClickTime,BootSuccess:c,BootTime:d,BootMode:""},BundleMetadata:"[]",FatalErrors:c?"":{ErrorCategory:"fatal",ExtraInfo:"",CorrelationId:"",ErrorCode:t,ErrorName:i,Message:o},NonFatalErrors:[],WopiPrecheckInfo:{FileGetUrlBool:!!l.getUrl,FileNameBool:!!l.name,ReadOnly:u.readOnly,SupportsDecryptedContentDownload:u.supportsDecryptedContentDownload,ViewOnly:u.viewOnly,PreseededSessionKey:f?f.key:void 0,BundleInfo:p?{MajorVersion:p.majorVersion,URLBool:!!p.url}:""},AppBootTimings:m?m.appBootTimingDict:""};e.logger.ULS.nt(r?592007955:587843200,E.B,r?F.Error:F.Info,JSON.stringify(w))}function xi(e,t){Mi(e,void 0,t.errorType,Y(t.errorObject))}function Di(e){try{const t=!e.container||!Ve(e.container.element),i=t?7:5,o=t?"AppContainerUnloadedTimeout":"TimeoutInitialize",n=t?"App container is unloaded":`Timed out waiting for boot success. startMs:${e.hostInitDiagnostics.hostInitializeCallTime}, timeoutMs:${e.timeoutTime}, scenario:Unified, hostSessionId:${e.hostSessionId}, host: ${e.hostName}`;if(t)e.failureTime=e.timeoutTime,e.timeoutTime=0;else if(e.appContext.shouldUsePods){const t=(i,o)=>{Se(e.appInitDiagnostics,o.Diagnostics),Ni(e);const n={message:"Received success message after timeout had elapsed",timeoutTime:e.timeoutTime,currentTime:H(),...e.diagnostics};e.logger.ULS.nt(558195677,E.B,F.Info,JSON.stringify(n)),e.removeActionHandler(j.Ti,t)};e.addActionHandler(j.Ti,t)}Mi(e,i,o,n)}catch(t){e.logger.ULS.nt(558893250,E.B,F.Error,"onTimeout exception: "+Y(t))}}function Hi(e,t){Mi(e,void 0,"AppInitError",Y(t))}function Bi(){return!1}function Li(e){e.appContext.shouldUsePods&&Ii(e)}const Vi=(e,t,i,o,n)=>e!==j.oo?Promise.reject("Wrong flow"):i.ui.uiEmbed?((e,t,i,o,n)=>e!==j.oo?Promise.reject("Wrong flow"):new Promise(e=>{i.pendingReboot=!0;let o=void 0;if(t.queryOverrides)try{o=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.nt(592217694,E.B,F.Error,"Failed to parse queryOverrides: "+o)}i.raiseEvent(K.Reboot,{...t,previousSessionId:i.sessionId,queryOverrides:o}),e({completion:"success"})}))(e,t,i):new Promise(e=>{let o=window.location.href;S(o,"wdccsoff")&&(o=g(o,"wdccsoff")),o=m(o,"previoussessionid",i.sessionId,!0),t.controllerServicesParam&&(o=m(o,t.controllerServicesParamName,t.controllerServicesParam)),i.logger.ULS.nt(560740507,E.B,F.Info,"Updating window.location.href"),window.location.href=o,e({completion:"success"})});function Ji(e,t,i=!1){if(!e)throw new TypeError("SessionBootParams");const o=e.appUrl,n=e.appBaseUrl;if(!o&&!n)throw new TypeError("Either appUrl or appBaseUrl should exist");if(o&&"string"!=typeof o)throw new TypeError("AppUrl");if(n&&"string"!=typeof n)throw new TypeError("AppBaseUrl");const s=e.file;if(!s||!i&&!s.name)throw new TypeError("FileInfo");const r=e.container;if(!r||!(r instanceof Je)&&!r.appendChild)throw new TypeError("Container");if(!t&&!ze(e.wopi))throw new TypeError("WopiInfo")}class $i{setFrameError(){this.Ia=!0}setTimeoutStage(e){this._a=e,this.ba="Boot_HeartBeat_"+e+(this.Ia?"_FrameError":"")}restart(){const e=this.Ca.getValue(J.It,!1);this.Ta=D()+(this.Pa?this.Pa:this.Ca.getValue(J.ut,6e5));const t=this.Es?3e3:5e3;this.ya=window.setInterval(()=>{e&&this.mi.ULS.nt(595724178,E.B,F.Info,this.ba),D()>this.Ta&&(this.stop(),this.Aa(),this.Ua&&this.Ua())},this.Ca.getValue(J.St,t)),this.Ea.push(window.setTimeout(this.Aa,this.Ca.getValue(J.pt,3e4),1)),this.Ea.push(window.setTimeout(this.Aa,this.Ca.getValue(J.ft,12e4),2)),this.Ea.push(window.setTimeout(this.Aa,this.Ca.getValue(J.wt,18e4),3))}stop(){this.Ta=0,this.ya&&(window.clearInterval(this.ya),this.ya=void 0),this.Ea.forEach(e=>{window.clearTimeout(e)}),this.Ea=[]}constructor(e,t,i,o,n){this.Ta=0,this.Ea=[],this.Es=!1,this.ba="Boot_HeartBeat",this.Ia=!1,this._a="FrameCreated",this.Aa=e=>{const t="Boot_NotComplete_"+(e||"Final")+"_"+this._a+(this.Ia?"_FrameError":"");this.mi.ULS.nt(594901218,E.B,F.Warning,t),this.mi.ULS.flush()},this.Es=e,this.Ca=t,this.mi=i,this.Ua=o,this.Pa=n,this.restart()}}class Gi{show(){document.body.appendChild(this.m_loader)}hide(){document.body.removeChild(this.m_loader)}createLoader(){let e=document.createElement("div"),t=document.createElement("span"),i=document.createElement("span");return this.attachSpinnerStyle(),e.className="loader",t.className="spinner",i.className="innerSpinner",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.lineHeight="0",e.style.gap="8px",e.style.overflow="hidden",e.style.top="0",e.style.left="0",e.style.right="0",e.style.bottom="0",e.style.position="absolute",t.animate([{transform:"rotate(0deg)"},{transform:"rotate(360deg)"}],{duration:1500,iterations:1/0,easing:"linear"}),t.appendChild(i),e.appendChild(t),e}attachSpinnerStyle(){const e=new CSSStyleSheet;e.insertRule("\n      .spinner {\n        position: relative;\n        flex-shrink: 0;\n        width: 20px;\n        height: 20px;\n        mask-image: radial-gradient(closest-side, transparent calc(100% - 2px - 1px), white calc(100% - 2px) calc(100% - 1px), transparent 100%);\n        background-color: #c5cbfa;\n        color: #5b5fc7;\n      }\n      ",e.cssRules.length),e.insertRule("  .innerSpinner {\n            position: absolute;\n            display: block;\n            width: 100%;\n            height: 100%;\n            -webkit-mask-image: conic-gradient(transparent 105deg, white 105deg);\n            mask-image: conic-gradient(transparent 105deg, white 105deg);\n            animation-duration: 1.5s;\n            animation-iteration-count: infinite;\n            animation-timing-function: cubic-bezier(0.33,0,0.67,1);\n            animation-name: spinner;\n        }\n    ",e.cssRules.length),e.insertRule("\n        .innerSpinner::before {\n            animation-name: spinnerBefore;\n        }\n    ",e.cssRules.length),e.insertRule('\n        .innerSpinner::after {\n            content: "";\n            position: absolute;\n            display: block;\n            width: 100%;\n            height: 100%;\n            animation: inherit;\n            background-image: conic-gradient(currentcolor 135deg, transparent 135deg);\n            animation-name: spinnerAfter;\n        }\n    ',e.cssRules.length),e.insertRule("\n        @keyframes spinnerBefore {\n            0% { transform: rotate(0deg); }\n            50% { transform: rotate(105deg); }\n            100% { transform: rotate(0deg); }\n        }\n    ",e.cssRules.length),e.insertRule("\n        @keyframes spinner {\n            0% { transform: rotate(-135deg); }\n            50% { transform: rotate(0deg); }\n            100% { transform: rotate(225deg); }\n        }\n    ",e.cssRules.length),e.insertRule("\n        @keyframes spinnerAfter {\n            0% { transform: rotate(0deg); }\n            50% { transform: rotate(225deg); }\n            100% { transform: rotate(0deg); }\n        }\n    ",e.cssRules.length),e.insertRule("\n      @media screen and (forced-colors: active) {\n        .spinner {\n          background-color: HighlightText;\n          color: Highlight;\n          forced-color-adjust: none;\n        }\n      }\n    ",e.cssRules.length),document.adoptedStyleSheets.push(e)}constructor(){this.m_loader=this.createLoader()}}const zi=(e,t,i,o,n)=>{var r,a,l,u,p;if(e!==z.boot)return Promise.reject("Wrong flow");const m=decodeURIComponent(window.location.search)||"",w=f(m||"","wdEmbedConfig"),g=f(m||"","wdOrigin");function _(e,t){const i=e.split(",");for(const e of i){const[i,o]=e.split(":");if(i.toLowerCase()===t.toLowerCase())return o}return null}let b=void 0;const T="true"===_(w,"useUniformLoader"),P="true"===_(w,"showFloatingToolbar");var y;T&&(b=new Gi,null===(y=b)||void 0===y||y.show());const A="true"===_(w,"enableEmbedderCommunication"),O=decodeURIComponent(_(w,"embedderOrigin")||"");let W=t.appBaseUrl?t.appBaseUrl.toLowerCase():d(t.appUrl).toLowerCase();t.appUrl&&(W=c(W,f(t.appUrl,"region")));const R=Jt[W];let N;N=R?R.PodsUrl:W+"/pods/",i.st.updateEnvironment(N);const M=["ring1","ring2_1","ring2_2","ring5_0","ring5_1","ring5_2","ring5_3"].includes($t[W]),D=i.st.getValue(J.Pt,M),B=i.st.getValue(J.Mt,100),L=D&&B>window.crypto.getRandomValues(new Uint8Array(1))[0]%100,V=i.st.getValue(J.yt,!1),G=i.st.getValue(J.Ut,!1);let K=S((t.appUrl||"").toLowerCase(),"wdhostscenario","oneuplightspeed")?V:L;"true"===f(t.appUrl||"","wdForceModernEmbedView").toLowerCase()&&(K=!0);let Z="editor";Z=S(t.appUrl||"","embed","1")&&S(t.appUrl||"","PowerPointView","ChromelessView")||void 0!==t.intent&&-1!==t.intent.indexOf("embed")||"interactivepreview"===t.intent?"embed":null!==(r=i.bootParams)&&void 0!==r&&r.viewOnly||null!==(a=i.bootParams)&&void 0!==a&&a.openViewByDefault&&"default"===(null!==(l=t.intent)&&void 0!==l?l:"default")||"view"===t.intent?"reading":"editor";let X=Z;G||"reading"!==X||(X="embed");const Q="editor"===Z||"embed"===Z&&!K;Q&&(X="editor");const Y="embed"===Z?i.st.getValue(J.Rt,"{}"):"reading"===Z?i.st.getValue(J.Nt,"{}"):"{}";return i.logger.ULS.nt(507863259,E.B,F.Warning,JSON.stringify({requestedUiType:Z,actualUiType:X,modernEmbedEnabled:K,modernReadingEnabled:G,intent:t.intent,uiEmbed:i.ui.uiEmbed,viewOnly:null===(u=i.bootParams)||void 0===u?void 0:u.viewOnly,openViewByDefault:null===(p=i.bootParams)||void 0===p?void 0:p.openViewByDefault,featureGates:Y,wdOrigin:g||""})),Q?((e,t,i,o,n)=>e!==z.boot?Promise.reject("Wrong flow"):new Promise(e=>{const r=H();i.state=U.Booting,i.pendingReboot=!1,Ji(t,i.skipWopiValidation,i.skipFileNameCheck),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=je(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics={...t.diagnostics,hostInitializeCallTime:r};let a=!1;const l=i.preseededSession;i.appInfo.usePreseededSessionId&&l&&l.id&&(i.sessionId=l.id,a=!0);let u=!1;const p=t.hostGeneratedSessionId;if(!a&&p&&(i.sessionId=p,u=!0),i.st.getValue(J.Ct,!1)&&Ae(i.hostInitDiagnostics),t.appUrl){const e=t.appUrl;i.appUrl=e;const o=i.bootParams;if(S(e,"new")&&(o.isNewFile=!0),!o.dataLanguage){const t=I(e,"rs");t&&(o.dataLanguage=t)}const n=i.ui;if(S(e,"uiembed")&&(n.uiEmbed=!0),!n.language){const t=I(e,"ui");t&&(n.language=t)}if(!i.hostInitDiagnostics.entryPoint){const t=I(e,"wdorigin");t&&(i.hostInitDiagnostics.entryPoint=t)}if(!i.host.uiHostName){const t=I(e,"uih");t&&(i.host.uiHostName=t)}}else i.appUrl="";let m;if(i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():d(t.appUrl).toLowerCase(),i.appBaseUrl=c(i.appBaseUrl,f(i.appUrl,"region")),i.st.updateEnvironment(i.appBaseUrl),o.initializeAppContext(i,e,t),i.appBasePath=o.buildAppBasePath(i),t.rebootOverride&&(a||u||([i.sessionId,m]=se()),i.pageStateObserver=new Ue(i.logger,!0),i.authTokenTrustValidator=new Oe(i.logger)),i.logger.ULS.nt(38580693,E.B,F.Info,`User session id: ${i.sessionId}, is preseeded: ${a}, is host generated: ${u}`),i.remoteTelemetryUrl=o.buildRemoteTelemetryUrl(i),x(i.remoteTelemetryUrl,i.appInfo.name,"init"),!i.isLoggerFromOwl){let e=i.st.getValue(J.lt,"").toString();e||(e=h(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:e,sessionId:i.sessionId})}if(i.st.initializePeriodicFetch(i.appBasePath,i.sessionId),m&&i.logger.ULS.nt(590966790,E.B,F.Info,JSON.stringify(m)),Ce(i),o.onContextReady&&o.onContextReady(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:k(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",()=>{i.appInitDiagnostics.documentLoadedWithTabSwitch=!0},{once:!0}),!i.container){const e=t.container;i.container=e instanceof Je?e:i.application.createContainer(e)}i.container.setMessageHandler(i.onMessage);const w=!!o.ignoreCompletionMessage&&o.ignoreCompletionMessage(i),g=(e,t)=>{i.successTime=H(),w||(i.container.postMessage(q.Sn,void 0),Se(i.appInitDiagnostics,t.Diagnostics)),i.st.addSettingsChangeListener(i.logger.settingsChangeHandler),o.onSuccess&&o.onSuccess(i,t),i.logger.ULS.nt(596448985,E.B,F.Important,JSON.stringify(i.diagnostics)),x(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(q.yn,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=U.Booted,b({completion:"success"}),Ie(i.appInfo.name,i.logger)},_=(e,t)=>{var n;i.failureTime=H(),o.onFailure&&o.onFailure(i,t.Error),i.logger.ULS.nt(596448986,E.B,F.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),x(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=U.Failed,b({completion:"failure",error:t.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(n=i.appInitDiagnostics)||void 0===n?void 0:n.documentLoadedWithTabSwitch}),Ie(i.appInfo.name,i.logger)},b=t=>{w||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(j.Ti,g),i.removeActionHandler(j.bi,_)),e(t)};n&&n.subscribe(()=>{var e;b({completion:n.reason||"cancelled",documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch})}),w||(i.addActionHandler(j.Ti,g),i.addActionHandler(j.bi,_)),function(e){return"wdjs"in e||"wd1js"in e}(i.wdParams)&&("true"!==window.sessionStorage.getItem("sideLoadingIsEnabled")?Me("sideLoadingIsEnabled","false",0):function(e,t){const i=Ne("sideLoadingIsEnabled");return"true"===i||"false"!==i&&!1}()||Me("sideLoadingIsEnabled","true",1));const C=o.buildBootRequestParams(i),T=Ke(i,C.appPageName,C.queryParamsOverrides),P=Ze(i,C.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(T,i.host.origin))try{o.beforePreload&&o.beforePreload(i);let e=i.bootstrapperUrl;i.featureManager.isFeatureEnabled($.Gt)&&(i.logger.ULS.nt(590966791,E.B,F.Info,"HTTP2 preload enabled"),e=v(e)),i.preloader.preload(e,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.nt(590966792,E.B,F.Error,"Error preloading")}o.beforeContainerBoot&&o.beforeContainerBoot(i,T),i.container.boot(T,P,i.logger,o.buildContainerBootParams(i),()=>{i.appInitDiagnostics.officeFrameCreateTime=H(),i.appBootState="FrameCreated"},()=>{i.appInitDiagnostics.officeFrameLoadTime=H(),i.logger.ULS.nt(506012820,E.B,F.Important,"Frame loaded"),"FrameCreated"===i.appBootState&&(i.appBootState="FrameLoaded",i.bootHeartBeat&&i.bootHeartBeat.setTimeoutStage(i.appBootState))},()=>{i.appInitDiagnostics.officeFrameErrorTime=H(),i.logger.ULS.nt(506012819,E.B,F.Error,"Frame error"),i.bootHeartBeat&&i.bootHeartBeat.setFrameError()}),w?g(j.Ti,{Diagnostics:{bootSuccessWithoutCompletionMessage:!0}}):(i.bootHeartBeat=new $i(s(i.appBaseUrl),i.st,i.logger,()=>{i.timeoutTime=H(),o.onTimeout&&o.onTimeout(i),x(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),b({completion:"timeout",error:{documentLoadedWithTabSwitch:i.appInitDiagnostics.documentLoadedWithTabSwitch},timeoutStage:i.appBootState}),n&&n.cancel()},n&&o.overrideBootTimeout?Math.min(n.timeoutInMs,o.overrideBootTimeout(i)):n?n.timeoutInMs:o.overrideBootTimeout?o.overrideBootTimeout(i):void 0),o.beforeBootCompletionMessage&&o.beforeBootCompletionMessage(i))}).catch(e=>{throw i.failureTime=H(),o.onException&&o.onException(i,e),i.remoteTelemetryUrl&&x(i.remoteTelemetryUrl,i.application.name,"bootException"),i.bootHeartBeat&&i.bootHeartBeat.stop(),{error:e.toString(),errorStack:e.stack}}))(e,t,i,o,n):new Promise(async e=>{var n,s,r,a,c,d,l,u,p,m,w,v;const _=H();i.state=U.Booting,i.pendingReboot=!1,Ji(t,!0),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=je(t.wdParams),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics={...t.diagnostics,hostInitializeCallTime:_};let y=!1;const R=i.preseededSession;i.appInfo.usePreseededSessionId&&R&&R.id&&(i.sessionId=R.id,y=!0);const M=t.hostGeneratedSessionId;if(!y&&M&&(i.sessionId=M),i.st.getValue(J.Et,!0)&&(i.wdParams.wdForceModernSlideShowInTeams="true"),i.st.getValue(J.Ct,!1)&&Ae(i.hostInitDiagnostics),t.appUrl){const e=t.appUrl;i.appUrl=e;const o=i.bootParams;if(S(e,"new")&&(o.isNewFile=!0),!o.dataLanguage){const t=I(e,"rs");t&&(o.dataLanguage=t)}const n=i.ui;if(S(e,"uiembed")&&(n.uiEmbed=!0),!n.language){const t=I(e,"ui");t&&(n.language=t)}if(!i.hostInitDiagnostics.entryPoint){const t=I(e,"wdorigin");t&&(i.hostInitDiagnostics.entryPoint=t)}if(!i.host.uiHostName){const t=I(e,"uih");t&&(i.host.uiHostName=t)}}else i.appUrl="";i.appBaseUrl=W,i.appBasePath=N,i.remoteTelemetryUrl=o.buildRemoteTelemetryUrl(i),x(i.remoteTelemetryUrl,i.appInfo.name,"init");let D=i.st.getValue(J.lt,"").toString();""===D&&(D=h(i.appBasePath)),i.logger.configure({remoteUlsEndpoint:D,sessionId:i.sessionId}),i.st.initializePeriodicFetch(i.appBasePath,i.sessionId),Ce(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:k(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",()=>{i.appInitDiagnostics.documentLoadedWithTabSwitch=!0},{once:!0});const B=(t,o)=>{i.failureTime=H(),i.logger.ULS.nt(596448986,E.B,F.Error,JSON.stringify({diagnostics:i.diagnostics})),x(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=U.Failed,e({completion:"failure",error:{...t,errorSource:o}}),Ie(i.appInfo.name,i.logger)};try{if(!i.bootstrapperUrl)throw new Error("No bootstrapperUrl");const e=new URL(W).hostname;if(!e.includes("powerpoint"))throw new Error("Invalid appBaseUrl");const t=$t[W];if(i.logger.ULS.nt(507357262,E.B,F.Info,JSON.stringify({appBaseUrl:e,previewerRing:t})),!t)throw new Error("Unsupported region");const o=new URL(i.bootstrapperUrl);o.hostname=o.hostname.replace("wise.","res."),o.hostname=o.hostname.replace(".gcc.",".gcch."),o.pathname=`/pptlive-m/5mttl/bootstrap/${t}/powerpoint.preview.boot.js`;const n=async e=>new Promise((t,i)=>{const o=document.createElement("script");o.src=e.href,o.async=!0,o.onload=()=>{t()},o.onerror=e=>{i(e)},document.head.appendChild(o)});await n(o)}catch(e){return void B(e,"JsApi")}if(null===(n=window)||void 0===n||null===(n=n.Microsoft)||void 0===n||null===(n=n.Office)||void 0===n||null===(n=n.PowerPoint)||void 0===n||null===(n=n.Bootstrap)||void 0===n||!n.InitializeWopiPending)return void B(new Error("InitializeWopiPending not found"),"JsApi");const L=parseInt(f(t.appUrl||"","wdslideindex"),10);let V=-1;const $=f(t.appUrl||"","nav");try{if($){const e=C($),t=JSON.parse(e),i=parseInt(t.sId,10);isNaN(i)||(V=i)}}catch{i.logger.ULS.nt(506577984,E.B,F.Error,"Failed to parse navigation id: "+$)}const G={ApplicationUrl:i.appUrl,Container:t.container,SessionInformation:{HostName:i.hostName,HostSessionId:i.sessionId||i.hostSessionId,UserId:i.user.id,DocumentClickTime:null===(s=i.hostInitDiagnostics)||void 0===s?void 0:s.userClickTime,EntryPoint:null===(r=i.hostInitDiagnostics)||void 0===r?void 0:r.entryPoint,HostInitTime:(new Date).toISOString(),WdParams:i.wdParams,UiHostRing:null==t||null===(a=t.diagnostics)||void 0===a?void 0:a.teamsRing,PptFeatureGates:Y,UiLocale:i.ui.language,HostOrigin:O,WdOrigin:g},WopiPrecheckInfo:{FileName:i.file.name,FileGetUrl:i.file.getUrl,FileSize:i.file.size,ReadOnly:null===(c=i.bootParams)||void 0===c?void 0:c.readOnly,IrmEnabled:null===(d=i.bootParams)||void 0===d?void 0:d.irmEnabled,DocUniqueId:i.file.uniqueId,CTag:i.file.cTag,ETag:i.file.cTag,ViewOnly:null===(l=i.bootParams)||void 0===l?void 0:l.viewOnly},ApplicationCustomSettings:{ForceAccessibilityMode:!1,EnableWacFallback:!1,UseTransparentBackground:!1,UiType:X,StartingSlideIndex:!isNaN(L)&&L>=0?L:-1,StartingSlideId:V,ShouldUseUniformLoader:T,ShouldSendPostMessagesToEmbedder:A,ShouldShowFloatingToolbar:P},Diagnostics:{entryPoint:null===(u=i.hostInitDiagnostics)||void 0===u?void 0:u.entryPoint,userClickTime:null===(p=i.hostInitDiagnostics)||void 0===p?void 0:p.userClickTime,hostPageFirstFlushTime:null===(m=i.hostInitDiagnostics)||void 0===m?void 0:m.hostPageFirstFlushTime,officeBootstrapperStartTime:null===(w=i.hostInitDiagnostics)||void 0===w?void 0:w.officeBootstrapperStartTime,officeBootstrapperEndTime:null===(v=i.hostInitDiagnostics)||void 0===v?void 0:v.officeBootstrapperEndTime},FnOnInitializeSuccess:()=>{var t;i.successTime=H(),i.logger.ULS.nt(596448985,E.B,F.Important,JSON.stringify(i.diagnostics)),x(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),Ie(i.appInfo.name,i.logger),i.state=U.Booted,null===(t=b)||void 0===t||t.hide(),e({completion:"success"})},FnOnInitializeFailure:e=>{var t;B(e,"App"),null===(t=b)||void 0===t||t.hide()}};window.Microsoft.Office.PowerPoint.Bootstrap.InitializeWopiPending(G).Complete()})},ji=(e,t,i,o,n)=>e!==j.Io?Promise.reject("Wrong flow"):new Promise(e=>{const o=i.appContext;"FatalError"===t.Reason?function(e,t){const i=e.hostInitDiagnostics,o={ErrorName:t,BootCompleted:e.appContext.bootComplete,SessionInfo:{HostName:e.hostName,HostSessionId:e.hostSessionId,UiLocale:e.ui.language,DataLocale:e.bootParams.dataLanguage,DocumentClickTime:i.userClickTime,HostInitTime:i.hostInitializeCallTime,UiHost:e.host.uiHostName,WdParams:e.wdParams}};e.logger.ULS.nt(587236555,E.B,F.Error,JSON.stringify(o))}(i,t.ErrorName):i.logger.ULS.nt(558421913,E.B,F.Info,`Updating boot complete - reason [${t.Reason}]`),o.bootComplete||(i.bootHeartBeat&&i.bootHeartBeat.stop(),o.bootFlowResolve({completion:"success"})),i.successTime=H(),Mi(i),e({completion:"success"})}),qi=()=>[{[G.appReboot]:Vi,[G.boot]:zi,[G.closeTab]:Ge,[G.createNew]:Xe,[G.dispose]:tt,[G.frameTrust]:it,[G.getAuthToken]:ot,[G.getHostKeyValue]:Ge,[G.handleBootState]:nt,[G.postWacToken]:st,[G.rename]:rt,[G.setOverlayContent]:at,[G.setWacFlightValue]:ct,[G.storeHostKeyValue]:Ge,[G.switchMode]:Ge,[G.updateBootComplete]:ji},{[G.boot]:{initializeAppContext:Qt,buildAppBasePath:Yt,buildRemoteTelemetryUrl:ei,ignoreCompletionMessage:ti,buildBootRequestParams:vi,beforeContainerBoot:Si,buildContainerBootParams:Pi,overrideBootTimeout:ki,onSuccess:Ri,onFailure:xi,onTimeout:Di,onException:Hi},[G.createNew]:{parallelizeStartSessionRequest:Bi,sendCreateNewWopiInfo:Li}}];var Ki;!function(e){e[e.AppPageLoading=0]="AppPageLoading",e[e.AppReadyForPostMessage=1]="AppReadyForPostMessage",e[e.AppBootComplete=2]="AppBootComplete",e[e.DEPRECATED=3]="DEPRECATED",e[e.RefreshPage=4]="RefreshPage",e[e.UpdateInitializationComplete=6]="UpdateInitializationComplete",e[e.ProfileClientResourceUsage=7]="ProfileClientResourceUsage",e[e.ULSLog=8]="ULSLog"}(Ki||(Ki={}));class Zi{static getInstance(){return this.Fa||(this.Fa=new Zi),this.Fa}add(e,t){this.Oa[e]=t}get(e){return this.Oa[e]}remove(e){this.Oa[e]=null}constructor(){this.Oa={},this.Wa=(e,t)=>{for(const i in this.Oa){const o=this.Oa[i];o&&o.log(e,t)}},this.ka=e=>{let t;try{t=JSON.parse(e.data)}catch(e){t=null}if(!t)return;const i=t.m_id||t.Token;if(!i)return;const o=Zi.getInstance(),n=o.get(i);n?n.onMessage(t,e.source):o.Wa("Message received with no targetApi. Id: "+i.toString(),e.data)},window.addEventListener("message",this.ka)}}function Xi(e,t,i,o){return{ShouldUsePODS:e,CanUsePODS:t,Reason:i,CreateNewScenario:o}}function Qi(e,t){const i=e.WopiPrecheckInfo,o=e.ApplicationUrl,n=function(e,t,i,o){let n,s;e.CreateNewInfo?(s=dt.UnifiedCreateNew,n="CreateNewInfo"):e.IsNewFile?(s=dt.UnifiedCreateNew,n="CreateNewInfoIsNewFile"):e.IsNewFileFromHostTemplate?(s=dt.UnifiedCreateNew,n="CreateNewInfoFromHostTemplate"):i&&i.FileGetUrl?(s=dt.UnifiedCreateNew,n="CreateNewInfoFromTemplateSourceUrl"):S(t,"new")?0!==e.FileSize?(s=dt.LegacyCreateNew,n="ApplicationUrlContainsNewAndNonZeroByteFile"):(s=dt.UnifiedCreateNew,n="ApplicationUrlContainsNew"):(s=dt.NotCreateNew,n="NotCreateNew");const r={};return r.CreateNewScenario=dt[s],r.reason=n,o.ULS.nt(34932951,E.B,F.Info,JSON.stringify(r)),s}(i,o,e.NewFileTemplateSource,t),s=_("wdPodsEnabled");return r=i.FileGetUrl,a=s?Xi("false"!==s,!0,"wdPodsEnabled is available",n):function(e,t,i){if(zt(e))return t===dt.LegacyCreateNew?Xi(!1,!1,"Legacy Create New Scenario because application url contains new, but non-zero file size",t):-1!==e.indexOf("&Embed=1")?Xi(!1,!1,"Embed View fallback to WAC",t):Xi(!0,!0,"Supported Region",t);const o="Wac region not currently supported by PODS: "+(P(e)||"");return i.ULS.nt(589168768,E.B,F.Warning,o),Xi(!1,!1,o,t)}(o,n,t),r||a.CreateNewScenario!==dt.NotCreateNew?a:Xi(!1,!1,a.Reason+"| FileGetUrl is empty",a.CreateNewScenario);var r,a}class Yi{registerEventHandler(e){this.Ra.push(e)}removeEventHandler(e){if(e){const t=this.Ra.indexOf(e);this.Ra.splice(t,1)}}stop(){document.removeEventListener("visibilitychange",this.Na)}getVisibilityChangeEvents(){return this.Ma}dispose(){this.stop(),this.Ra=[],this.Ma=[]}constructor(){if(this.Ma=[],this.Ra=[],this.Na=()=>{const e={visibility:document.visibilityState,time:H(),initialState:!1};this.Ma.push(e);for(const t of this.Ra)t&&t(e)},"hidden"===document.visibilityState){const e={visibility:document.visibilityState,time:H(),initialState:!0};this.Ma.push(e)}document.addEventListener("visibilitychange",this.Na)}}const eo={[z.blurFocus]:q.gn,[z.continueAccessibilityLoop]:q.bn,[z.grabFocus]:q.Cn,[z.moveToFolder]:q.Zi,[z.popState]:q.Un,[z.rename]:q.Mn,[z.sendAccessToken]:q.xn,[z.sendAuthToken]:q.Dn,[z.sendCustomAuthConfig]:q.Hn,[z.sendEmbeddedViewUrl]:q.Ln,[z.sendSessionInfo]:q.Vn,[z.sendUserAccessAndPermissions]:q.Jn,[z.sendWopiInfo]:q.$n,[z.sendDavUrl]:q.Gn,[z.completeSharedFilePicker]:q.co,[z.switchMode]:q.Xn,[z.signalShared]:q.ts};class to{registerMessagePayloadHandler(e,t){if(this.Ra[e])throw new Error("Duplicate registration!");this.Ra[e]=t}removeMessageHandler(e){delete this.Ra[e]}sendPostMessage(e,t,i){if(!e||!e.contentWindow)return void this.mi.ULS.nt(595948308,E.B,F.Info,"Missing target for SendPostMessage");this.mi.ULS.nt(596464334,E.B,F.Info,"Sending message: "+t);const o={MessageId:t,SendTime:H(),Values:i};this.xa(e.contentWindow,JSON.stringify(o),this.As)}activate(e,t){this.Da=e,this.Ws=!!t,this.Ha||(window.addEventListener("message",this.Ba,!1),this.Ha=!0)}postMessageForCommand(e,t,i){const o=eo[t];o?(this.mi.ULS.nt(595702598,E.B,F.Info,`Sending message ${o} for command ${t}`),this.sendPostMessage(e,o,i)):this.mi.ULS.nt(595702599,E.B,F.Warning,"No mapping for command "+t)}dispose(){this.Ra={},this.Ha&&(window.removeEventListener("message",this.Ba,!1),this.Ha=!1)}constructor(e,t){var i;if(this.Ha=!1,this.Ra={},this.As="",this.Us="",this.Ws=!1,this.Es=!1,this.Fs=!1,this.Ns=!1,this.La=[],this.Va=!0,this.Ja=(e,t,i)=>{if(!e)return void this.mi.ULS.nt(595736136,E.B,F.Info,"Missing target to send Ack back");const o={MessageId:q.fn,CorrelationId:i,SendTime:H()};this.mi.ULS.nt(595732176,E.B,F.Info,"Sending Ack back"),e.postMessage(JSON.stringify(o),t)},this.Ba=e=>{let t,i=!1,o=!0,n="",s=!1;if(this.Da&&this.Da.contentWindow&&(i=!0,o=e.source===this.Da.contentWindow),e.origin&&(n=l(e.origin,2).toLowerCase(),s=n===this.Us,!s&&this.Ms&&(n=l(e.origin).toLowerCase(),s=this.Ms.includes(n))),!this.Es&&(!this.Fs||s&&o)||this.mi.ULS.nt(595730526,E.B,F.Info,`Window is available: ${i}, window is valid: ${o}, origin is valid: ${s}, expected origin: ${this.Us}, actual origin: ${n}`),!s||this.Ws&&!o)return;try{t=JSON.parse(e.data)}catch(e){return void this.mi.ULS.nt(596464282,E.B,F.Info,`Failed to parse event data: ${Y(e)}.`)}const r=t.MessageId;if(!r)return void((this.Es||this.Fs)&&this.mi.ULS.nt(595730520,E.B,F.Info,"Could not find message id"));var a;if(this.mi.ULS.nt(595714715,E.B,F.Info,`Received messageId: ${r}, correlation: ${t.CorrelationId}`),r!==j.Ti&&r!==j.qi||this.$a(e.origin),this.Ns&&r===j.rn)return window._pageTimings=null!==(a=window._pageTimings)&&void 0!==a?a:{},void(window._pageTimings[t.Values.name]=t.Values.time);t.Values&&t.Values.ackExpected&&this.Ja(e.source,e.origin,t.CorrelationId);const c=this.Ra[r];if(!c)return this.mi.ULS.nt(596464289,E.B,F.Info,"No handler found for message id: "+r),void(this.Va&&r===j.Ji&&(this.La.push(t),this.mi.ULS.nt(543207888,E.B,F.Info,"Kept for later process: "+r)));this.mi.ULS.nt(596464288,E.B,F.Info,"Processing message: "+r),r===j.uo&&(t.Values={...t.Values||{},sendTimeAsClickTime:t.SendTime});try{c(t.Values||{})}catch(e){this.mi.ULS.nt(593773704,E.B,F.Error,"Handler error: "+Y(e))}},this.Ga=()=>{this.Va=!1,this.La.forEach(e=>{const t=e.MessageId,i=this.Ra[t];if(i){this.mi.ULS.nt(543207890,E.B,F.Info,"Processing message after boot complete: "+t);try{i(e.Values||{})}catch(e){this.mi.ULS.nt(543207891,E.B,F.Error,"Handler error: "+Y(e))}}else this.mi.ULS.nt(543207889,E.B,F.Info,"No handler found after boot complete: "+t)}),this.La=[]},this.xa=(e,t,i)=>{e.postMessage(t,i)},this.$a=e=>{const t=e.toLowerCase();this.As&&this.As!==t&&this.mi.ULS.nt(596128131,E.B,F.Warning,`Updating origin: [${P(this.As)}]->[${P(t)}]`),this.As=t,this.Us=l(t,2),this.Es=s(t),this.Fs=r(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.Es=s(e),this.Fs=r(e),this.mi=t,this.$a(e),this.Ns=!(null===(i=window.location)||void 0===i||null===(i=i.search)||void 0===i||!i.match(/wdpa=1/gi))||"1"===Ne("EnableMetricLogging")}}var io;!function(e){e.BrowserEvent="BrowserEvent",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(io||(io={}));let oo=!1,no=!1;function so(e){if(!oo)try{oo=!0,no=!1,function(e){e.innerApplicationFrame&&(e.innerApplicationFrame.src="about:blank",window.setTimeout(()=>{e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()},0))}(e),function(e){const t={disposeStartTime:e.disposeStartTime,disposeEndTime:H(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};if(e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime),e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime),e.appUnloadedMessageValues){const i=e.appUnloadedMessageValues,o=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(o)&&(t.hostToAppPostMessageLatency=o-e.forceAppUnloadStartTime);const n=Number(i.appMessageSent);!isNaN(n)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-n);const s=Number(i.appUnloadStart),r=Number(i.appUnloadEnd);if(isNaN(s)||isNaN(r)||(t.appUnloadLatency=r-s),i.serverTimings){const e=i.serverTimings;for(const i in e)t["st-"+i.toString()]=e[i]}}e.logger.ULS.nt(595855436,E.B,F.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.nt(595714434,E.B,F.Error,"Error disposing: "+Y(t))}}class ro extends class{GetApplicationType(){return"PowerPoint"}GetVersion(){return k()}GetSessionId(){return this.ra}RegisterEventHandler(e,t){switch(e){case io.Unloaded:case io.Disposed:case io.DocumentReboot:case io.WopiInfoFromUrl:case io.DavUrlFromIds:case io.GetAuthToken:case io.GetCustomAuthConfig:case io.MoveToFolder:case io.SharedFilePicker:case io.SetOverlayContent:case io.FileShare:if(this.Ra[e])throw new Error("Duplicate registration");this.Ra[e]=t;break;default:this.za.registerMessagePayloadHandler(e,t)}}RemoveEventHandler(e,t){switch(e){case io.Unloaded:case io.Disposed:case io.DocumentReboot:case io.FileShare:case io.WopiInfoFromUrl:case io.DavUrlFromIds:case io.GetAuthToken:case io.GetCustomAuthConfig:case io.MoveToFolder:case io.SharedFilePicker:case io.SetOverlayContent:if(this.Ra[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ra[e];break;default:this.za.removeMessageHandler(e)}}RegisterErrorHandler(e){}RemoveErrorHandler(e){}PostCommand(e,t){this.za.postMessageForCommand(this.Da,e,t)}Dispose(e,t){!function(e,t,i,o,n,s,r){if(t.ULS.nt(595714433,E.B,F.Important,`Starting disposing the application. unloadApp:${e}; disposed:${oo}; unloading:${no}`),oo||no&&e)return void t.ULS.nt(595714908,E.B,F.Info,"Application is already disposed or unloading");const a={logger:t,postMessenger:i,innerApplicationFrame:o,onDisposed:n,onFrameRemoved:s,unloadTimeoutInMs:r||1e3,forceAppUnload:!1,disposeStartTime:H(),appUnloadTimedOut:!1};if(e&&o)return no=!0,a.forceAppUnload=!0,(c=a).forceAppUnloadStartTime=H(),c.logger.ULS.nt(595855490,E.B,F.Info,"Sending postmessage to unload app"),c.logger.ULS.flush(),c.postMessenger.registerMessagePayloadHandler(j.wo,e=>function(e,t){e.forceAppUnloadEndTime=H(),e.appUnloadedMessageValues=t,e.logger.ULS.nt(595855491,E.B,F.Info,"AppUnloaded received from app"),so(e)}(c,e)),c.postMessenger.sendPostMessage(c.innerApplicationFrame,q.Qn,{}),void window.setTimeout(()=>function(e){!no&&oo||(e.appUnloadTimedOut=!0,e.logger.ULS.nt(595855492,E.B,F.Info,"ApplicationUnload timed out, forcing dispose"),so(e))}(c),c.unloadTimeoutInMs);var c;so(a)}(e||!1,this.mi,this.za,this.Da,()=>{delete this.Da,this.ja(),this.za.dispose(),this.qa(io.Unloaded,{})},()=>{try{this.qa(io.Disposed,{}),this.Ra={}}catch(e){this.mi.ULS.nt(589108815,E.B,F.Error,"onFrameRemoved error: "+Y(e))}},t)}constructor(e,t,i,o,n){this.Ra={},this.Ka=()=>{this.za.registerMessagePayloadHandler(j.oo,this.Za),this.za.registerMessagePayloadHandler(j.zi,this.Xa),this.za.registerMessagePayloadHandler(j.ji,this.Qa),this.za.registerMessagePayloadHandler(j.Ji,this.Ya),this.za.registerMessagePayloadHandler(j.uo,this.ec),this.za.registerMessagePayloadHandler(j.$i,this.tc),this.za.registerMessagePayloadHandler(j.Zi,this.ic),this.za.registerMessagePayloadHandler(j.co,this.oc)},this.qa=(e,t)=>{const i=this.Ra[e];if(i)try{i(t||{})}catch(e){this.mi.ULS.nt(593773706,E.B,F.Error,"Handler error: "+Y(e))}},this.Za=e=>{e.previousSessionId=this.ra,this.qa(io.DocumentReboot,e)},this.Xa=e=>{this.qa(io.WopiInfoFromUrl,e)},this.Qa=e=>{this.qa(io.DavUrlFromIds,e)},this.Ya=e=>{Promise?this.nc.isResourceTrustedForMessage(e).then(t=>{t?this.qa(io.GetAuthToken,e):this.za.sendPostMessage(this.Da,q.Dn,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})},()=>{this.za.sendPostMessage(this.Da,q.Dn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})}):this.za.sendPostMessage(this.Da,q.Dn,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.ec=e=>{this.qa(io.FileShare,e)},this.tc=e=>{this.qa(io.GetCustomAuthConfig,e)},this.ic=e=>{this.qa(io.MoveToFolder,e)},this.oc=e=>{this.qa(io.SharedFilePicker,e)},this.ra=e,this.mi=t,this.Da=n.innerApplicationFrame,this.za=i,this.ja=o,this.nc=new Oe(t),this.Ka(),oo=!1}}{Dispose(e,t){if(!(this.sc||this.rc&&e))if(this.ac.disposeStartTime=H(),e){this.rc=!0,this.ac.appUnloadStartTime=H(),this.ac.forceAppUnload=e,this.za.sendPostMessage(this.Da,q.Qn,{});const i=t||1e3;window.setTimeout(this.cc,i)}else this.dc()}constructor(e,t,i,o,n){super(e,t,i,o,n),this.ac={},this.rc=!1,this.sc=!1,this.dc=()=>{this.sc||(this.sc=!0,this.rc=!1,this.ja&&this.ja(),this.qa(io.Unloaded,{}),this.qa(io.Disposed,{}),this.ac.disposeEndTime=H(),this.mi.ULS.nt(41710159,E.B,F.Important,JSON.stringify(this.ac)),this.Ra={})},this.lc=e=>{this.ac.appUnloadEndTime=H(),e&&(this.ac.wacDisposeTelemetry=e),this.dc()},this.cc=()=>{!this.rc&&this.sc||(this.mi.ULS.nt(41710160,E.B,F.Warning,"Unload timed out"),this.ac.appUnloadTimedOut=!0),this.dc()},this.za.registerMessagePayloadHandler(j.wo,this.lc)}}class ao{getIfAllFieldsSet(){if(this.wopiInfo&&this.hasAppBooted&&this.iframe&&this.podsUrl)return{wopiInfo:this.wopiInfo,iframe:this.iframe,podsUrl:this.podsUrl,readonly:this.readonly,hasAppBooted:this.hasAppBooted,irmEnabled:this.irmEnabled,supportsDecryptedContentDownload:this.supportsDecryptedContentDownload,fileName:this.fileName}}constructor(){this.hasAppBooted=!1}}class co{log(e){this.mi.ULS.nt(39978262,E.B,F.Info,e)}onMessage(e,t){try{if(!e||!this.hc)return void this.mi.ULS.nt(39978263,E.B,F.Error,"Missing message data: "+!e+" or appData: "+!this.hc);switch(this.uc&&this.uc.contentWindow===t||this.mi.ULS.nt(39978264,E.B,F.Error,"Message with the right postMessageToken came from an unexpected iframe"),!e.Data.officeSessionId&&this.hc.AppInitDiagnostics.officeSessionId&&(e.Data.officeSessionId=this.hc.AppInitDiagnostics.officeSessionId),e.Data.messageType||(e.Data.messageType=e.Type),this.mi.ULS.nt(38580691,E.B,F.Warning,JSON.stringify(e.Data)),e.Type){case Ki.AppPageLoading:break;case Ki.AppReadyForPostMessage:this.pc&&(this.pc.hasAppBooted=!0),e.Data.officeSessionId&&(this.hc.AppInitDiagnostics.officeSessionId=e.Data.officeSessionId),window.setTimeout(this.fc,1);break;case Ki.AppBootComplete:if(this.mc=!0,this.hc.PptInitParams.FnOnInitializeSuccess){this.hc.AppInitDiagnostics.officeBootstrapperVersion=k(),e.Data.officeAppEndpoint&&(this.hc.AppInitDiagnostics.officeAppEndpoint=e.Data.officeAppEndpoint),e.Data.officeServerVersion&&(this.hc.AppInitDiagnostics.officeServerVersion=e.Data.officeServerVersion),e.Data.documentLoadedTime&&(this.hc.AppInitDiagnostics.documentLoadedTime=e.Data.documentLoadedTime,this.hc.AppInitDiagnostics.appCompletedTime=e.Data.documentLoadedTime),e.Data.officeFrameFirstFlushTime&&(this.hc.AppInitDiagnostics.officeFrameFirstFlushTime=e.Data.officeFrameFirstFlushTime),e.Data.officeFrameDocumentFlushTime&&(this.hc.AppInitDiagnostics.officeFrameDocumentFlushTime=e.Data.officeFrameDocumentFlushTime),e.Data.documentFlushTime&&(this.hc.AppInitDiagnostics.officeFrameServerDocumentFlushTime=e.Data.documentFlushTime),e.Data.serverFirstFlushTime&&(this.hc.AppInitDiagnostics.officeFrameServerFirstFlushTime=e.Data.serverFirstFlushTime),e.Data.serverStartTime&&(this.hc.AppInitDiagnostics.officeFrameServerStartTime=e.Data.serverStartTime),e.Data.bootStartMs&&(this.hc.AppInitDiagnostics.officeServerDocumentProcessStartTime=e.Data.bootStartMs),e.Data.bootEndMs&&(this.hc.AppInitDiagnostics.officeServerDocumentProcessEndTime=e.Data.bootEndMs),e.Data.cacheHit&&(this.hc.AppInitDiagnostics.cacheHit=e.Data.cacheHit);const t={browserRequest:!1,status:200,isAppCompleteCritical:!0,isDocumentLoadCritical:!0,name:"BootRequest"};e.Data.downloadCorrelation&&(t.correlationId=e.Data.downloadCorrelation),e.Data.downloadStartMs&&(t.startTime=e.Data.downloadStartMs),e.Data.downloadEndMs&&(t.endTime=e.Data.downloadEndMs),e.Data.downloadSize&&(t.size=e.Data.downloadSize),e.Data.incDownload&&(t.incremental=e.Data.incDownload),this.hc.AppInitDiagnostics.fileRequestsData=[t],this.wc.stop();const i=this.wc.getVisibilityChangeEvents();if(i&&i.length>0&&(this.hc.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,this.mi.ULS.nt(38580692,E.B,F.Info,"Visibility Change Events:"+JSON.stringify(i))),this.mi.ULS.nt(34932955,E.B,F.Warning,JSON.stringify(this.hc.AppInitDiagnostics)),!this.Gr)throw this.mi.ULS.nt(51448022,E.B,F.Warning,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),Error("m_postMessageHandler");this.gc=new ro(this.hc.PptInitParams.PostMessageToken,this.mi,this.Gr,this.vc,{innerApplicationFrame:this.uc}),this.hc.PptInitParams.FnOnInitializeSuccess(this.gc,this.hc.AppInitDiagnostics),this.Gr.Ga()}break;case Ki.RefreshPage:{if(this.hc.PptInitParams.ApplicationUrl.toLowerCase().indexOf("uiembed=1")>-1&&this.hc.PptInitParams.SessionInformation.SupportsDocReboot)break;let t=window.location.href;-1!==t.indexOf("&wdccsoff=1")&&(t=g(t,"wdccsoff")),e.Data.officeSessionId&&(t=qt(t,"PreviousSessionID",e.Data.officeSessionId)),e.Data.ControllerServicesParam&&(t=qt(t,e.Data.ControllerServicesParamName,e.Data.ControllerServicesParam)),this.mi.ULS.nt(594068673,E.B,F.Info,"PPTUnifiedSessionLoader::onMessage::RefreshPage Updating window.location.href"),window.location.href=t;break}case Ki.UpdateInitializationComplete:try{if("FatalError"===e.Data.Reason){const t={ErrorName:e.Data.ErrorName,BootCompleted:this.mc,SessionInfo:ui(this.hc.PptInitParams)};this.mi.ULS.nt(587236555,E.B,F.Error,JSON.stringify(t))}else this.mi.ULS.nt(576583120,E.B,F.Info,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete - Reason: "+e.Data.Reason)}catch(e){this.mi.ULS.nt(576582732,E.B,F.Error,"PPTUnifiedSessionLoader::onMessage::UpdateInitializationComplete Caught exception: "+e)}this.Gr||(this.mi.ULS.nt(51448024,E.B,F.Info,"PPTUnifiedSessionLoader::onMessage::AppBootComplete null m_postMessageHandler"),this.Gr=new to(d(this.hc.PptInitParams.ApplicationUrl),this.mi),this.Gr.activate(this.uc)),this.gc=new ro(this.hc.PptInitParams.PostMessageToken,this.mi,this.Gr,this.vc,{innerApplicationFrame:this.uc}),this.hc.PptInitParams.FnOnInitializeSuccess(this.gc,this.hc.AppInitDiagnostics),this.Gr.Ga();break;case Ki.ProfileClientResourceUsage:this.mi.ULS.nt(541388952,E.B,F.Info,JSON.stringify(e.Data));break;case Ki.ULSLog:{const t=e.Data;if(!t||"number"!=typeof t.Tag||"number"!=typeof t.Category||"number"!=typeof t.Level||"string"!=typeof t.Message)break;try{this.mi.ULS.nt(t.Tag,t.Category,t.Level,t.Message)}catch(e){this.mi.ULS.nt(512235073,E.B,F.Error,"PPTUnifiedSessionLoader::onMessage ULSLog exception: "+e)}break}}}catch(e){this.mi.ULS.nt(594121922,E.B,F.Error,"PPTUnifiedSessionLoader::onMessage Caught exception: "+e)}}getWopiPendingApplication(){return this.Sc}constructor(e,t,i,o,n){this.pc=new ao,this.mc=!1,this.wc=new Yi,this.vc=()=>{const e=Zi.getInstance();e&&this.hc&&e.remove(this.hc.PptInitParams.PostMessageToken),this.Gr&&this.Gr.dispose(),this.uc&&this.uc.parentElement&&this.uc.parentElement.removeChild(this.uc),this.uc&&delete this.uc,this.Ic(),this.mi.ULS.nt(587552790,E.B,F.Warning,"PPTUnifiedSessionLoader::dispose:: App dispose"),this.wc.stop()},this.fc=()=>{var e;const t=this.pc&&this.pc.getIfAllFieldsSet();if(this._c||!t||!t.iframe.contentWindow)return;const i={};i.WopiSrc=t.wopiInfo.WopiSrc,i.AccessToken=t.wopiInfo.AccessToken,i.AccessTokenTTL=t.wopiInfo.AccessTokenExpiry?t.wopiInfo.AccessTokenExpiry.getTime():0,i.ReadOnly=t.readonly,i.IrmEnabled=t.irmEnabled,i.SupportsDecryptedContentDownload=t.supportsDecryptedContentDownload,i.FileName=t.fileName,i.SessionContext=this.bc,i.WdParams=this.Cc,i.DocumentURL=window.location.href,t.wopiInfo.WacToken&&(i.WacToken=t.wopiInfo.WacToken);const o=_("PreviousSessionID");var n;o&&(i.PreviousSessionID=o),(null===(e=this.hc)||void 0===e||null===(e=e.PptInitParams)||void 0===e||null===(e=e.SessionInformation)||void 0===e?void 0:e.HostSessionId)&&(i.HostSessionId=null===(n=this.hc)||void 0===n?void 0:n.PptInitParams.SessionInformation.HostSessionId),this.Tc(i),t.iframe.contentWindow.postMessage(JSON.stringify(i),t.podsUrl),this._c=!0},this.Tc=e=>{var t,i,o,n;const s=null!==(t=window.WOPIPerf_FirstPageFlush)&&void 0!==t?t:null===(i=this.hc)||void 0===i||null===(i=i.AppInitDiagnostics)||void 0===i?void 0:i.hostPageFirstFlushTime;s&&(e.FirstPageFlushTime=s);const r=window.WOPIPerf_BootJsStartTime;r&&(e.BootJsStartTime=r);const a=window.WOPIPerf_BootJsEndTime;a&&(e.BootJsEndTime=a);const c=window.WOPIPerf_InitializeWac;c&&(e.InitializeWacTime=c);const d=window.WOPIPerf_UserClick,l=this.hc&&this.hc.AppInitDiagnostics&&this.hc.AppInitDiagnostics.userClickTime;if(d?e.UserClickTime=d:l&&(e.UserClickTime=l),window.performance){const t=window.performance.timing;t&&(e.NavigationStart=t.navigationStart,e.FetchStart=t.fetchStart,e.RequestStart=t.requestStart,e.ResponseStart=t.responseStart,e.ResponseEnd=t.responseEnd);const i=window.performance.navigation;i&&(e.NavigationType=i.type,e.NavigationRedirects=i.redirectCount)}e.UnifiedUiHostDiagnostics=null===(o=this.hc)||void 0===o||null===(o=o.AppInitDiagnostics)||void 0===o?void 0:o.unifiedUiHostDiagnostics,e.ClientDiagnostics=null===(n=this.hc)||void 0===n?void 0:n.PptInitParams.ClientDiagnostics,this.Pc(e)},this.Pc=e=>{if(window.performance&&window.performance.getEntriesByType){var t;const i=null===(t=window.performance.getEntriesByType("navigation")[0])||void 0===t?void 0:t.toJSON();i&&i.name&&(delete i.name,e.HostPerfNavigationTelemetry=i)}},this.yc=(e,t,i)=>{this.pc&&(this.pc.wopiInfo=e),t===dt.UnifiedCreateNew&&function(e){if(e&&e.NewFilePath)window.history.replaceState(null,"",e.NewFilePath),e.UpdatedPageTitle&&(window.document.title=e.UpdatedPageTitle);else if(window.location.href.indexOf("action=editnew")>=0){const e=window.location.href.replace("action=editnew","action=edit");window.history.replaceState(null,window.document.title||"",e)}}(i),window.setTimeout(this.fc,1)},this.Ic=()=>{window.removeEventListener("beforeunload",this.ps,{capture:!0}),window.removeEventListener("pagehide",this.fs,{capture:!0}),window.removeEventListener("visibilitychange",this.ms,{capture:!0})},this.Ac=()=>{const e=Le(this.mi);this.Gr?this.Gr.sendPostMessage(this.uc,q.Li,{isTopFrameTrusted:e}):this.mi.ULS.nt(51237655,E.B,F.Error,"Trust frame request received but the wac frame is null")};let s,r=void 0;Promise&&(this.Uc=new Promise(e=>this.Ec=e));try{let a,l=!1;e.WopiPrecheckInfo&&e.WopiPrecheckInfo.PreseededWacSessionId?(s=e.WopiPrecheckInfo.PreseededWacSessionId,l=!0):i?s=i:[s,a]=se(),x(Ei(e.ApplicationUrl,s),"PowerPoint","init"),function(e){if(void 0===e)throw new TypeError("initParams");const t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");const i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");const o=e.ApplicationUrl;if(void 0===o||"string"!=typeof o)throw new TypeError("ApplicationUrl");const n=e.WopiPrecheckInfo;if(void 0===n||void 0===n.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),function(e){!e.WopiPrecheckInfo.PreseededSessionKey||"_._._."===e.WopiPrecheckInfo.PreseededSessionKey.slice(0,6)&&"-.-.-."===e.WopiPrecheckInfo.PreseededSessionKey.slice(-6)||(e.WopiPrecheckInfo.PreseededSessionKey="_._._."+e.WopiPrecheckInfo.PreseededSessionKey+"-.-.-.")}(e),e.ApplicationUrl=c(e.ApplicationUrl,f(e.ApplicationUrl,"region")),e.ApplicationUrl=g(e.ApplicationUrl,"region");const h=function(e){if(e){const t=zt(e);return t?t.PodsUrl:e.substring(0,e.toLowerCase().indexOf("powerpointframe.aspx")).replace("/p/","/pods/")}return""}(e.ApplicationUrl);r=t||Z({remoteUlsEndpoint:h+"RemoteUls.ashx",sessionId:s}),this.mi=r;const u=hi(e.SessionInformation.HostSessionId),p={...e,SessionId:s,PostMessageToken:u,OnDemandServer:h,FeatureManager:o||ee(e.FnIsFeatureEnabled,r),SettingsManager:n||new oe("PowerPoint",r),UsePodsDetails:Qi(e,r),ClientDiagnostics:be()};n||(p.SettingsManager.addSettingsChangeListener(r.settingsChangeHandler),p.SettingsManager.initializePeriodicFetch(h,s)),new Oi(p,r),r.ULS.nt(38580693,E.B,F.Warning,`PPTBootstrapper - initializing session. Build version: ${k()}; UserSessionId: ${s}; IsSessionIdPreseeded: ${l}; IsSessionIdToUseProvided: ${!!i}`),r.ULS.nt(38580694,E.B,F.Info,"Bootstrapper Init Time: "+(new Date).getTime()),a&&r.ULS.nt(572618978,E.B,F.Info,JSON.stringify(a)),window.addEventListener("unload",()=>{r.ULS.nt(41157219,E.B,F.Warning,"Unloading bootstrapper window."),r.ULS.flushOnClose()}),this.ps=()=>mi(r,"OnBeforeUnload",!0),this.fs=()=>mi(r,"OnPageHide",!0),this.ms=()=>mi(r,"VisibilityChange_"+document.visibilityState,!0),window.addEventListener("beforeunload",this.ps,{capture:!0,once:!0}),window.addEventListener("pagehide",this.fs,{capture:!0}),window.addEventListener("visibilitychange",this.ms,{capture:!0}),r.ULS.nt(38580695,E.B,F.Info,"Application.InitializeWopiPending"),function(e,t){const i={BootstrapperType:"TypeScript",JsApiVersion:"v1",Preview:!1,Scenario:"Unified App",ApplicationUrl:P(e.ApplicationUrl)||null,IsDeepLink:!!_("nav"),BootstrapperInstanceId:re(),IsMobileView:we()};i.ApplicationCustomSettings={OnDemandServer:P(e.OnDemandServer)||null,EnableWacFallback:!0};const o=e.SessionInformation,n=e.Diagnostics,s=n&&n.userClickTime?n.userClickTime:o.DocumentClickTime?o.DocumentClickTime.getTime():null;i.SessionInformation={HostName:o.HostName,HostSessionId:o.HostSessionId,UiLocale:o.UiLocale,DataLocale:o.DataLocale,DocumentClickTime:s,HostInitTime:o.HostInitTime,CurrentTime:H(),UiHost:pi(o.HostName),WdParams:o.WdParams},i.Diagnostics={EntryPoint:ci(e),FileHost:fi(e.SessionInformation.HostName),PodsRing:"",UnifiedUiHostDiagnostics:n?n.unifiedUiHostDiagnostics:null};const r=e.WopiPrecheckInfo,a=!!r.FileGetUrl,c=!!r.CustomFontCatalogUrl;i.WopiPrecheckInfo={FileSize:r.FileSize,FileGetUrlBool:a,CustomFontCatalogBool:c,FileGetUrlLength:a?r.FileGetUrl.length:null,FileNameBool:!!r.FileName,ReadOnly:r.ReadOnly,IrmEnabled:r.IrmEnabled,SupportsDecryptedContentDownload:r.SupportsDecryptedContentDownload,ViewOnly:r.ViewOnly,PreseededSessionKey:!!r.PreseededSessionKey,FileExtension:X(r.FileName)||null,BundleInfo:r.BundleInfo?{MajorVersion:r.BundleInfo.MajorVersion,URLBool:!!r.BundleInfo.Url}:{}},i.AppInfo={AppVersionMajor:1,AppVersionMinor:R(),Environment:"wac",UserAgent:window.navigator.userAgent},i.AdditionalTelemetry={PostMessageToken:e.PostMessageToken},t.ULS.nt(22357763,E.B,F.Info,JSON.stringify(i,Q))}(p,r);const m=p.UsePodsDetails;!function(e,t,i){const o={ShouldUsePodsOrCached:e.ShouldUsePODS,ShouldUsePods:e.ShouldUsePODS,CanUsePods:e.CanUsePODS,ApplicationUrl:P(t)||null,Reason:e.Reason,CreateNewScenario:dt[e.CreateNewScenario]};i.ULS.nt(38580687,E.B,F.Info,JSON.stringify(o))}(m,p.ApplicationUrl,r);const w=m.ShouldUsePODS;if(w){p.Diagnostics&&p.Diagnostics.userClickTime&&Pe(p.Diagnostics.userClickTime,r),p.IsFileNew=m.CreateNewScenario!==dt.NotCreateNew,p.WopiPrecheckInfo.ReadOnly=p.WopiPrecheckInfo.ReadOnly||!1;const e=Ti(p,r);if(!e){const e={Message:"Error creating IFrame",HostSessionId:p.SessionInformation.HostSessionId};throw r.ULS.nt(38580696,E.B,F.Error,JSON.stringify(e)),Error("Error Creating IFrame")}r.ULS.nt(50376725,E.B,F.Warning,"Assigning wopiBootParams"),this.uc=e.IFrameElement,this.Ec&&this.Ec(this.uc),this.pc&&(this.pc.iframe=e.IFrameElement,this.pc.podsUrl=Xt(p.OnDemandServer),this.pc.readonly=p.WopiPrecheckInfo.ReadOnly,this.pc.irmEnabled=p.WopiPrecheckInfo.IrmEnabled,this.pc.supportsDecryptedContentDownload=p.WopiPrecheckInfo.SupportsDecryptedContentDownload,this.pc.fileName=p.WopiPrecheckInfo.FileName),this.Gr=new to(d(p.ApplicationUrl),r),this.Gr.activate(e.IFrameElement),p.SessionInformation.SupportsFrameTrustCheck||this.Gr.registerMessagePayloadHandler(j.Li,this.Ac),this.bc=p.SessionInformation.SessionContext?p.SessionInformation.SessionContext:"",this.Cc="",p.SessionInformation.WdParams&&(this.Cc=gi(p.SessionInformation.WdParams)),this.Cc&&r.ULS.nt(539837381,E.B,F.Warning,"Non-empty WdParams Assigned");const t={...p.Diagnostics,hostName:p.SessionInformation.HostName};t.officeFrameCreateTime=e.FrameCreateTime,t.cacheHit=!1,this.hc={AppInitDiagnostics:t,PptInitParams:p};const i=Zi.getInstance();i&&i.add(u,this)}r.ULS.nt(50376727,E.B,F.Warning,"Creating WopiPendingApplication"),this.Sc={Complete:(e,t)=>{w?this.yc(e,m.CreateNewScenario,t):function(e,t,i,o,n){i.ULS.nt(38147724,E.B,F.Info,"Launching Wac Fallback");const s=document.createElement("iframe");s.id="WebApplicationFrame",s.name="wac_frame",s.title="Office Online Frame",s.frameBorder="0",s.style.top="0",s.style.bottom="0",s.style.left="0",s.style.right="0",s.style.height="100%",s.style.width="100%",s.style.minHeight="200px",s.style.minWidth="300px",s.style.position="absolute",s.setAttribute("allowfullscreen","true"),s.setAttribute("allowTransparency","true"),s.style.minHeight="150px";const r=t.Container;r.style.top="0",r.style.bottom="0",r.style.left="0",r.style.right="0",r.style.height="100%",r.style.width="100%",r.style.minHeight="150px";const a=document.createElement("div");a.style.top="0",a.style.bottom="0",a.style.left="0",a.style.right="0",a.style.height="100%",a.style.width="100%",a.style.minHeight="150px",a.style.backgroundColor="#393a3d",a.style.backfaceVisibility="hidden";const c=document.createElement("form");c.name="wac_form",c.id="wac_form",c.target="wac_frame",c.action=function(e,t){if(e.WopiSrc.indexOf("PowerPointFrame.aspx")>=0){const t=e.WopiSrc.substr(e.WopiSrc.indexOf("WOPISrc=")+8),i=t.indexOf("&");e.WopiSrc=i<0?decodeURIComponent(decodeURI(t)):decodeURIComponent(t.substring(0,i))}const i=t.ApplicationUrl,o=i.indexOf("?");let n=i.substring(0,o);return n+="?wdEnableRoaming=1&wdo=1",n=qt(n,"PowerPointView",f(i,"PowerPointView")),S(i,"new")&&(n=qt(n,"New","1")),S(i,"embed")&&(n=qt(n,"Embed","1")),t.OnDemandServer||(n=qt(n,"noLog","True")),e.WopiSrc&&(n=qt(n,"WOPISrc",b(e.WopiSrc))),n=Zt(n),n}(e,t),c.method="post",c.appendChild(bi("access_token",e.AccessToken)),c.appendChild(bi("access_token_ttl",e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0")),e.WacToken&&c.appendChild(bi("wac_token",e.WacToken)),r.appendChild(c),r.appendChild(a),a.appendChild(s),c.submit();const d={};o.stop();const l=o.getVisibilityChangeEvents();l&&l.length>0&&(d.documentLoadedWithTabSwitch=!0,i.ULS.nt(38147725,E.B,F.Info,"Visibility Change Events:"+JSON.stringify(l))),t.FnOnInitializeSuccess(new Ci(n),d)}(e,p,r,this.wc,u)},Fail:e=>{this.mi.ULS.nt(38293905,E.B,F.Info,"Host failed to give us WopiInfo")},Dispose:(e,t)=>{this.vc(),t&&t()},PostWacToken:(e,t,i)=>{this.Gr?function(e,t,i,o,n,s){const r=H();o.ULS.nt(507774684,E.B,F.Important,"postWacToken flow initiated");const a=()=>{s&&s.flush&&s.flush()};n?n.then(n=>{const c=()=>i.sendPostMessage(n,q.ds,{wacToken:e,postWacTokenStart:t});c();const d=window.setInterval(c,100);i.registerMessagePayloadHandler(j.cn,e=>{o.ULS.nt(507597019,E.B,F.Info,`postWacToken flow completed in ${H()-r} ms`),window.clearInterval(d),window.clearTimeout(l),s&&(s.PostWacTokenResult="success",s.PostWacTokenEndTime=H(),e&&void 0!==e.TokenAlreadySet&&(s.TokenAlreadySet=e.TokenAlreadySet),a())});const l=window.setTimeout(()=>{o.ULS.nt(507597018,E.B,F.Warning,"postWacToken flow timed out after 60000 ms"),window.clearInterval(d),s&&(s.PostWacTokenResult="timeout",s.PostWacTokenEndTime=H(),a())},6e4)}).catch(e=>{o.ULS.nt(507873094,E.B,F.Warning,"This should never reject, error: "+Y(e)),s&&(s.PostWacTokenResult="Unexpected JSAPI V1 error",s.PostWacTokenEndTime=H(),a())}):(o.ULS.nt(507846862,E.B,F.Warning,"`Promise` does not exist natively for this browser."),s&&(s.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",s.PostWacTokenEndTime=H(),a()))}(e,t,this.Gr,this.mi,this.Uc,i):this.mi.ULS.nt(507846861,E.B,F.Info,"PPTUnifiedBootstrapper::PostWacToken, this._postMessageHandler is undefined")}},li(p.BootstrapperUrl,r),window.setTimeout(()=>{r&&r.ULS.flush()},1e4)}catch(t){r&&(r.ULS.nt(38580697,E.B,F.Error,yi.AppInitError+": "+Y(t)),r.ULS.flushOnClose()),e&&(e.ApplicationUrl&&x(Ei(e.ApplicationUrl,s),"PowerPoint","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:yi.AppInitError,errorObject:t}))}}}var lo;!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(lo||(lo={}));const ho=new class{GetVersion(){return k()}GetMinContentVersion(){return 1}Prefetch(){}InitializeWopiPending(e,t,i,o,n,s){return new co(e,t,i,n,s).getWopiPendingApplication()}},uo=e=>{const t={name:"PowerPoint",usePreseededSessionId:!0,preconnector:y()};return new $e(e,t,qi)}}});
//# sourceMappingURL=powerpoint.app.boot.509467e59b35ecb11ca5.js.map